import{Q as Pe}from"./position-engine.3a981107.js";import{c as y,j as Ot,r as O,v as _e,k as h,W as ge,l as Dt,m as Vt,aI as St,F as Xe,Q as I,o as qe,a as Nt,w as _,e as i,i as F,a3 as $,U as et,g as tt,h as at,a4 as G,a2 as lt,a5 as Ft}from"./index.73bff9cd.js";import{a as pe,Q as wt}from"./axios.b07a1420.js";import{_ as Rt,Q as Mt,a as Le,C as ot}from"./UserToolbar.d47430f3.js";import{d as Pt,j as qt,i as Lt,Q as Ht}from"./QInput.c3a5bb47.js";import{Q as $t}from"./QTable.a9a68a7a.js";import{Q as Qt}from"./QSpinnerFacebook.f62ec423.js";import{Q as jt}from"./QTooltip.70ba9f60.js";import{Q as ye}from"./QDialog.b34d5b5e.js";import{u as Ut,e as Yt,Q as Bt,a as Ee,b as K,c as kt}from"./QLayout.5b280beb.js";import{Q as nt,a as J}from"./QItem.e35c8306.js";import{Q as zt}from"./QList.45b896df.js";import{p as re,Q as rt}from"./QSelect.73813252.js";import{Q as Gt}from"./QForm.3e37b79f.js";import{u as Kt}from"./use-cache.b0833c75.js";import{t as Jt,a as st,f as Wt,g as Zt,j as He,_ as Xt}from"./date.4bbf63ce.js";import{Q as ea}from"./QPage.4f87e569.js";import{u as ta}from"./VDB.3f17b6ef.js";import{e as aa}from"./export-file.dc78ba05.js";import{u as la}from"./use-quasar.e4b0f190.js";import{E as it,a as ut}from"./jspdf.plugin.autotable.7ae95d76.js";import{a as oa}from"./axios.4de0bf7a.js";import"./QLinearProgress.acda1738.js";import"./QCheckbox.1931df2e.js";import"./_commonjsHelpers.88e99c8f.js";const na=["gregorian","persian"],ra={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:o=>na.includes(o),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},sa=["update:modelValue"];function ae(o){return o.year+"/"+re(o.month)+"/"+re(o.day)}function ia(o,z){const A=y(()=>o.disable!==!0&&o.readonly!==!0),W=y(()=>A.value===!0?0:-1),Q=y(()=>{const x=[];return o.color!==void 0&&x.push(`bg-${o.color}`),o.textColor!==void 0&&x.push(`text-${o.textColor}`),x.join(" ")});function S(){return o.locale!==void 0?{...z.lang.date,...o.locale}:z.lang.date}function T(x){const p=new Date,U=x===!0?null:0;if(o.calendar==="persian"){const M=Jt(p);return{year:M.jy,month:M.jm,day:M.jd}}return{year:p.getFullYear(),month:p.getMonth()+1,day:p.getDate(),hour:U,minute:U,second:U,millisecond:U}}return{editable:A,tabindex:W,headerClass:Q,getLocale:S,getCurrentDate:T}}const ne=20,ua=["Calendar","Years","Months"],dt=o=>ua.includes(o),$e=o=>/^-?[\d]+\/[0-1]\d$/.test(o),ce=" \u2014 ";function le(o){return o.year+"/"+re(o.month)}var da=Ot({name:"QDate",props:{...ra,...Pt,...Ut,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:$e},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:$e},navigationMaxYearMonth:{type:String,validator:$e},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:dt}},emits:[...sa,"rangeStart","rangeEnd","navigation"],setup(o,{slots:z,emit:A}){const{proxy:W}=Vt(),{$q:Q}=W,S=Yt(o,Q),{getCache:T}=Kt(),{tabindex:x,headerClass:p,getLocale:U,getCurrentDate:M}=ia(o,Q);let Z;const w=qt(o),Ae=Lt(w),ve=O(null),X=O(ke()),E=O(U()),Ie=y(()=>ke()),Oe=y(()=>U()),Y=y(()=>M()),f=O(ze(X.value,E.value)),R=O(o.defaultView),be=Q.lang.rtl===!0?"right":"left",se=O(be.value),n=O(be.value),u=f.value.year,c=O(u-u%ne-(u<0?ne:0)),v=O(null),N=y(()=>{const e=o.landscape===!0?"landscape":"portrait";return`q-date q-date--${e} q-date--${e}-${o.minimal===!0?"minimal":"standard"}`+(S.value===!0?" q-date--dark q-dark":"")+(o.bordered===!0?" q-date--bordered":"")+(o.square===!0?" q-date--square no-border-radius":"")+(o.flat===!0?" q-date--flat no-shadow":"")+(o.disable===!0?" disabled":o.readonly===!0?" q-date--readonly":"")}),m=y(()=>o.color||"primary"),l=y(()=>o.textColor||"white"),B=y(()=>o.emitImmediately===!0&&o.multiple!==!0&&o.range!==!0),D=y(()=>Array.isArray(o.modelValue)===!0?o.modelValue:o.modelValue!==null&&o.modelValue!==void 0?[o.modelValue]:[]),H=y(()=>D.value.filter(e=>typeof e=="string").map(e=>Ne(e,X.value,E.value)).filter(e=>e.dateHash!==null&&e.day!==null&&e.month!==null&&e.year!==null)),k=y(()=>{const e=t=>Ne(t,X.value,E.value);return D.value.filter(t=>St(t)===!0&&t.from!==void 0&&t.to!==void 0).map(t=>({from:e(t.from),to:e(t.to)})).filter(t=>t.from.dateHash!==null&&t.to.dateHash!==null&&t.from.dateHash<t.to.dateHash)}),V=y(()=>o.calendar!=="persian"?e=>new Date(e.year,e.month-1,e.day):e=>{const t=st(e.year,e.month,e.day);return new Date(t.gy,t.gm-1,t.gd)}),ie=y(()=>o.calendar==="persian"?ae:(e,t,a)=>Wt(new Date(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond),t===void 0?X.value:t,a===void 0?E.value:a,e.year,e.timezoneOffset)),ee=y(()=>H.value.length+k.value.reduce((e,t)=>e+1+Zt(V.value(t.to),V.value(t.from)),0)),fe=y(()=>{if(o.title!==void 0&&o.title!==null&&o.title.length>0)return o.title;if(v.value!==null){const a=v.value.init,s=V.value(a);return E.value.daysShort[s.getDay()]+", "+E.value.monthsShort[a.month-1]+" "+a.day+ce+"?"}if(ee.value===0)return ce;if(ee.value>1)return`${ee.value} ${E.value.pluralDay}`;const e=H.value[0],t=V.value(e);return isNaN(t.valueOf())===!0?ce:E.value.headerTitle!==void 0?E.value.headerTitle(t,e):E.value.daysShort[t.getDay()]+", "+E.value.monthsShort[e.month-1]+" "+e.day}),De=y(()=>H.value.concat(k.value.map(t=>t.from)).sort((t,a)=>t.year-a.year||t.month-a.month)[0]),P=y(()=>H.value.concat(k.value.map(t=>t.to)).sort((t,a)=>a.year-t.year||a.month-t.month)[0]),Qe=y(()=>{if(o.subtitle!==void 0&&o.subtitle!==null&&o.subtitle.length>0)return o.subtitle;if(ee.value===0)return ce;if(ee.value>1){const e=De.value,t=P.value,a=E.value.monthsShort;return a[e.month-1]+(e.year!==t.year?" "+e.year+ce+a[t.month-1]+" ":e.month!==t.month?ce+a[t.month-1]:"")+" "+t.year}return H.value[0].year}),xe=y(()=>{const e=[Q.iconSet.datetime.arrowLeft,Q.iconSet.datetime.arrowRight];return Q.lang.rtl===!0?e.reverse():e}),je=y(()=>o.firstDayOfWeek!==void 0?Number(o.firstDayOfWeek):E.value.firstDayOfWeek),ct=y(()=>{const e=E.value.daysShort,t=je.value;return t>0?e.slice(t,7).concat(e.slice(0,t)):e}),te=y(()=>{const e=f.value;return o.calendar!=="persian"?new Date(e.year,e.month,0).getDate():He(e.year,e.month)}),vt=y(()=>typeof o.eventColor=="function"?o.eventColor:()=>o.eventColor),q=y(()=>{if(o.navigationMinYearMonth===void 0)return null;const e=o.navigationMinYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),L=y(()=>{if(o.navigationMaxYearMonth===void 0)return null;const e=o.navigationMaxYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),Ve=y(()=>{const e={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return q.value!==null&&q.value.year>=f.value.year&&(e.year.prev=!1,q.value.year===f.value.year&&q.value.month>=f.value.month&&(e.month.prev=!1)),L.value!==null&&L.value.year<=f.value.year&&(e.year.next=!1,L.value.year===f.value.year&&L.value.month<=f.value.month&&(e.month.next=!1)),e}),Ce=y(()=>{const e={};return H.value.forEach(t=>{const a=le(t);e[a]===void 0&&(e[a]=[]),e[a].push(t.day)}),e}),Ue=y(()=>{const e={};return k.value.forEach(t=>{const a=le(t.from),s=le(t.to);if(e[a]===void 0&&(e[a]=[]),e[a].push({from:t.from.day,to:a===s?t.to.day:void 0,range:t}),a<s){let r;const{year:b,month:d}=t.from,g=d<12?{year:b,month:d+1}:{year:b+1,month:1};for(;(r=le(g))<=s;)e[r]===void 0&&(e[r]=[]),e[r].push({from:void 0,to:r===s?t.to.day:void 0,range:t}),g.month++,g.month>12&&(g.year++,g.month=1)}}),e}),me=y(()=>{if(v.value===null)return;const{init:e,initHash:t,final:a,finalHash:s}=v.value,[r,b]=t<=s?[e,a]:[a,e],d=le(r),g=le(b);if(d!==j.value&&g!==j.value)return;const C={};return d===j.value?(C.from=r.day,C.includeFrom=!0):C.from=1,g===j.value?(C.to=b.day,C.includeTo=!0):C.to=te.value,C}),j=y(()=>le(f.value)),ft=y(()=>{const e={};if(o.options===void 0){for(let a=1;a<=te.value;a++)e[a]=!0;return e}const t=typeof o.options=="function"?o.options:a=>o.options.includes(a);for(let a=1;a<=te.value;a++){const s=j.value+"/"+re(a);e[a]=t(s)}return e}),mt=y(()=>{const e={};if(o.events===void 0)for(let t=1;t<=te.value;t++)e[t]=!1;else{const t=typeof o.events=="function"?o.events:a=>o.events.includes(a);for(let a=1;a<=te.value;a++){const s=j.value+"/"+re(a);e[a]=t(s)===!0&&vt.value(s)}}return e}),ht=y(()=>{let e,t;const{year:a,month:s}=f.value;if(o.calendar!=="persian")e=new Date(a,s-1,1),t=new Date(a,s-1,0).getDate();else{const r=st(a,s,1);e=new Date(r.gy,r.gm-1,r.gd);let b=s-1,d=a;b===0&&(b=12,d--),t=He(d,b)}return{days:e.getDay()-je.value-1,endDay:t}}),Ye=y(()=>{const e=[],{days:t,endDay:a}=ht.value,s=t<0?t+7:t;if(s<6)for(let d=a-s;d<=a;d++)e.push({i:d,fill:!0});const r=e.length;for(let d=1;d<=te.value;d++){const g={i:d,event:mt.value[d],classes:[]};ft.value[d]===!0&&(g.in=!0,g.flat=!0),e.push(g)}if(Ce.value[j.value]!==void 0&&Ce.value[j.value].forEach(d=>{const g=r+d-1;Object.assign(e[g],{selected:!0,unelevated:!0,flat:!1,color:m.value,textColor:l.value})}),Ue.value[j.value]!==void 0&&Ue.value[j.value].forEach(d=>{if(d.from!==void 0){const g=r+d.from-1,C=r+(d.to||te.value)-1;for(let he=g;he<=C;he++)Object.assign(e[he],{range:d.range,unelevated:!0,color:m.value,textColor:l.value});Object.assign(e[g],{rangeFrom:!0,flat:!1}),d.to!==void 0&&Object.assign(e[C],{rangeTo:!0,flat:!1})}else if(d.to!==void 0){const g=r+d.to-1;for(let C=r;C<=g;C++)Object.assign(e[C],{range:d.range,unelevated:!0,color:m.value,textColor:l.value});Object.assign(e[g],{flat:!1,rangeTo:!0})}else{const g=r+te.value-1;for(let C=r;C<=g;C++)Object.assign(e[C],{range:d.range,unelevated:!0,color:m.value,textColor:l.value})}}),me.value!==void 0){const d=r+me.value.from-1,g=r+me.value.to-1;for(let C=d;C<=g;C++)e[C].color=m.value,e[C].editRange=!0;me.value.includeFrom===!0&&(e[d].editRangeFrom=!0),me.value.includeTo===!0&&(e[g].editRangeTo=!0)}f.value.year===Y.value.year&&f.value.month===Y.value.month&&(e[r+Y.value.day-1].today=!0);const b=e.length%7;if(b>0){const d=7-b;for(let g=1;g<=d;g++)e.push({i:g,fill:!0})}return e.forEach(d=>{let g="q-date__calendar-item ";d.fill===!0?g+="q-date__calendar-item--fill":(g+=`q-date__calendar-item--${d.in===!0?"in":"out"}`,d.range!==void 0&&(g+=` q-date__range${d.rangeTo===!0?"-to":d.rangeFrom===!0?"-from":""}`),d.editRange===!0&&(g+=` q-date__edit-range${d.editRangeFrom===!0?"-from":""}${d.editRangeTo===!0?"-to":""}`),(d.range!==void 0||d.editRange===!0)&&(g+=` text-${d.color}`)),d.classes=g}),e}),_t=y(()=>o.disable===!0?{"aria-disabled":"true"}:o.readonly===!0?{"aria-readonly":"true"}:{});_e(()=>o.modelValue,e=>{if(Z===e)Z=0;else{const t=ze(X.value,E.value);ue(t.year,t.month,t)}}),_e(R,()=>{ve.value!==null&&W.$el.contains(document.activeElement)===!0&&ve.value.focus()}),_e(()=>f.value.year+"|"+f.value.month,()=>{A("navigation",{year:f.value.year,month:f.value.month})}),_e(Ie,e=>{Ze(e,E.value,"mask"),X.value=e}),_e(Oe,e=>{Ze(X.value,e,"locale"),E.value=e});function Be(){const e=Y.value,t=Ce.value[le(e)];(t===void 0||t.includes(e.day)===!1)&&we(e),Se(e.year,e.month)}function gt(e){dt(e)===!0&&(R.value=e)}function yt(e,t){["month","year"].includes(e)&&(e==="month"?Ke:Fe)(t===!0?-1:1)}function Se(e,t){R.value="Calendar",ue(e,t)}function bt(e,t){if(o.range===!1||!e){v.value=null;return}const a=Object.assign({...f.value},e),s=t!==void 0?Object.assign({...f.value},t):a;v.value={init:a,initHash:ae(a),final:s,finalHash:ae(s)},Se(a.year,a.month)}function ke(){return o.calendar==="persian"?"YYYY/MM/DD":o.mask}function Ne(e,t,a){return Xt(e,t,a,o.calendar,{hour:0,minute:0,second:0,millisecond:0})}function ze(e,t){const a=Array.isArray(o.modelValue)===!0?o.modelValue:o.modelValue?[o.modelValue]:[];if(a.length===0)return Ge();const s=a[a.length-1],r=Ne(s.from!==void 0?s.from:s,e,t);return r.dateHash===null?Ge():r}function Ge(){let e,t;if(o.defaultYearMonth!==void 0){const a=o.defaultYearMonth.split("/");e=parseInt(a[0],10),t=parseInt(a[1],10)}else{const a=Y.value!==void 0?Y.value:M();e=a.year,t=a.month}return{year:e,month:t,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:e+"/"+re(t)+"/01"}}function Ke(e){let t=f.value.year,a=Number(f.value.month)+e;a===13?(a=1,t++):a===0&&(a=12,t--),ue(t,a),B.value===!0&&Te("month")}function Fe(e){const t=Number(f.value.year)+e;ue(t,f.value.month),B.value===!0&&Te("year")}function xt(e){ue(e,f.value.month),R.value=o.defaultView==="Years"?"Months":"Calendar",B.value===!0&&Te("year")}function Ct(e){ue(f.value.year,e),R.value="Calendar",B.value===!0&&Te("month")}function Tt(e,t){const a=Ce.value[t];(a!==void 0&&a.includes(e.day)===!0?Re:we)(e)}function oe(e){return{year:e.year,month:e.month,day:e.day}}function ue(e,t,a){if(q.value!==null&&e<=q.value.year&&(e=q.value.year,t<q.value.month&&(t=q.value.month)),L.value!==null&&e>=L.value.year&&(e=L.value.year,t>L.value.month&&(t=L.value.month)),a!==void 0){const{hour:r,minute:b,second:d,millisecond:g,timezoneOffset:C,timeHash:he}=a;Object.assign(f.value,{hour:r,minute:b,second:d,millisecond:g,timezoneOffset:C,timeHash:he})}const s=e+"/"+re(t)+"/01";s!==f.value.dateHash&&(se.value=f.value.dateHash<s==(Q.lang.rtl!==!0)?"left":"right",e!==f.value.year&&(n.value=se.value),Xe(()=>{c.value=e-e%ne-(e<0?ne:0),Object.assign(f.value,{year:e,month:t,day:1,dateHash:s})}))}function Je(e,t,a){const s=e!==null&&e.length===1&&o.multiple===!1?e[0]:e;Z=s;const{reason:r,details:b}=We(t,a);A("update:modelValue",s,r,b)}function Te(e){const t=H.value[0]!==void 0&&H.value[0].dateHash!==null?{...H.value[0]}:{...f.value};Xe(()=>{t.year=f.value.year,t.month=f.value.month;const a=o.calendar!=="persian"?new Date(t.year,t.month,0).getDate():He(t.year,t.month);t.day=Math.min(Math.max(1,t.day),a);const s=de(t);Z=s;const{details:r}=We("",t);A("update:modelValue",s,e,r)})}function We(e,t){return t.from!==void 0?{reason:`${e}-range`,details:{...oe(t.target),from:oe(t.from),to:oe(t.to)}}:{reason:`${e}-day`,details:oe(t)}}function de(e,t,a){return e.from!==void 0?{from:ie.value(e.from,t,a),to:ie.value(e.to,t,a)}:ie.value(e,t,a)}function we(e){let t;if(o.multiple===!0)if(e.from!==void 0){const a=ae(e.from),s=ae(e.to),r=H.value.filter(d=>d.dateHash<a||d.dateHash>s),b=k.value.filter(({from:d,to:g})=>g.dateHash<a||d.dateHash>s);t=r.concat(b).concat(e).map(d=>de(d))}else{const a=D.value.slice();a.push(de(e)),t=a}else t=de(e);Je(t,"add",e)}function Re(e){if(o.noUnset===!0)return;let t=null;if(o.multiple===!0&&Array.isArray(o.modelValue)===!0){const a=de(e);e.from!==void 0?t=o.modelValue.filter(s=>s.from!==void 0?s.from!==a.from&&s.to!==a.to:!0):t=o.modelValue.filter(s=>s!==a),t.length===0&&(t=null)}Je(t,"remove",e)}function Ze(e,t,a){const s=H.value.concat(k.value).map(r=>de(r,e,t)).filter(r=>r.from!==void 0?r.from.dateHash!==null&&r.to.dateHash!==null:r.dateHash!==null);A("update:modelValue",(o.multiple===!0?s:s[0])||null,a)}function pt(){if(o.minimal!==!0)return h("div",{class:"q-date__header "+p.value},[h("div",{class:"relative-position"},[h(ge,{name:"q-transition--fade"},()=>h("div",{key:"h-yr-"+Qe.value,class:"q-date__header-subtitle q-date__header-link "+(R.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:x.value,...T("vY",{onClick(){R.value="Years"},onKeyup(e){e.keyCode===13&&(R.value="Years")}})},[Qe.value]))]),h("div",{class:"q-date__header-title relative-position flex no-wrap"},[h("div",{class:"relative-position col"},[h(ge,{name:"q-transition--fade"},()=>h("div",{key:"h-sub"+fe.value,class:"q-date__header-title-label q-date__header-link "+(R.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:x.value,...T("vC",{onClick(){R.value="Calendar"},onKeyup(e){e.keyCode===13&&(R.value="Calendar")}})},[fe.value]))]),o.todayBtn===!0?h(I,{class:"q-date__header-today self-start",icon:Q.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:x.value,onClick:Be}):null])])}function Me({label:e,type:t,key:a,dir:s,goTo:r,boundaries:b,cls:d}){return[h("div",{class:"row items-center q-date__arrow"},[h(I,{round:!0,dense:!0,size:"sm",flat:!0,icon:xe.value[0],tabindex:x.value,disable:b.prev===!1,...T("go-#"+t,{onClick(){r(-1)}})})]),h("div",{class:"relative-position overflow-hidden flex flex-center"+d},[h(ge,{name:"q-transition--jump-"+s},()=>h("div",{key:a},[h(I,{flat:!0,dense:!0,noCaps:!0,label:e,tabindex:x.value,...T("view#"+t,{onClick:()=>{R.value=t}})})]))]),h("div",{class:"row items-center q-date__arrow"},[h(I,{round:!0,dense:!0,size:"sm",flat:!0,icon:xe.value[1],tabindex:x.value,disable:b.next===!1,...T("go+#"+t,{onClick(){r(1)}})})])]}const Et={Calendar:()=>[h("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[h("div",{class:"q-date__navigation row items-center no-wrap"},Me({label:E.value.months[f.value.month-1],type:"Months",key:f.value.month,dir:se.value,goTo:Ke,boundaries:Ve.value.month,cls:" col"}).concat(Me({label:f.value.year,type:"Years",key:f.value.year,dir:n.value,goTo:Fe,boundaries:Ve.value.year,cls:""}))),h("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},ct.value.map(e=>h("div",{class:"q-date__calendar-item"},[h("div",e)]))),h("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[h(ge,{name:"q-transition--slide-"+se.value},()=>h("div",{key:j.value,class:"q-date__calendar-days fit"},Ye.value.map(e=>h("div",{class:e.classes},[e.in===!0?h(I,{class:e.today===!0?"q-date__today":"",dense:!0,flat:e.flat,unelevated:e.unelevated,color:e.color,textColor:e.textColor,label:e.i,tabindex:x.value,...T("day#"+e.i,{onClick:()=>{At(e.i)},onMouseover:()=>{It(e.i)}})},e.event!==!1?()=>h("div",{class:"q-date__event bg-"+e.event}):null):h("div",""+e.i)]))))])])],Months(){const e=f.value.year===Y.value.year,t=s=>q.value!==null&&f.value.year===q.value.year&&q.value.month>s||L.value!==null&&f.value.year===L.value.year&&L.value.month<s,a=E.value.monthsShort.map((s,r)=>{const b=f.value.month===r+1;return h("div",{class:"q-date__months-item flex flex-center"},[h(I,{class:e===!0&&Y.value.month===r+1?"q-date__today":null,flat:b!==!0,label:s,unelevated:b,color:b===!0?m.value:null,textColor:b===!0?l.value:null,tabindex:x.value,disable:t(r+1),...T("month#"+r,{onClick:()=>{Ct(r+1)}})})])});return o.yearsInMonthView===!0&&a.unshift(h("div",{class:"row no-wrap full-width"},[Me({label:f.value.year,type:"Years",key:f.value.year,dir:n.value,goTo:Fe,boundaries:Ve.value.year,cls:" col"})])),h("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},a)},Years(){const e=c.value,t=e+ne,a=[],s=r=>q.value!==null&&q.value.year>r||L.value!==null&&L.value.year<r;for(let r=e;r<=t;r++){const b=f.value.year===r;a.push(h("div",{class:"q-date__years-item flex flex-center"},[h(I,{key:"yr"+r,class:Y.value.year===r?"q-date__today":null,flat:!b,label:r,dense:!0,unelevated:b,color:b===!0?m.value:null,textColor:b===!0?l.value:null,tabindex:x.value,disable:s(r),...T("yr#"+r,{onClick:()=>{xt(r)}})})]))}return h("div",{class:"q-date__view q-date__years flex flex-center"},[h("div",{class:"col-auto"},[h(I,{round:!0,dense:!0,flat:!0,icon:xe.value[0],tabindex:x.value,disable:s(e),...T("y-",{onClick:()=>{c.value-=ne}})})]),h("div",{class:"q-date__years-content col self-stretch row items-center"},a),h("div",{class:"col-auto"},[h(I,{round:!0,dense:!0,flat:!0,icon:xe.value[1],tabindex:x.value,disable:s(t),...T("y+",{onClick:()=>{c.value+=ne}})})])])}};function At(e){const t={...f.value,day:e};if(o.range===!1){Tt(t,j.value);return}if(v.value===null){const a=Ye.value.find(r=>r.fill!==!0&&r.i===e);if(o.noUnset!==!0&&a.range!==void 0){Re({target:t,from:a.range.from,to:a.range.to});return}if(a.selected===!0){Re(t);return}const s=ae(t);v.value={init:t,initHash:s,final:t,finalHash:s},A("rangeStart",oe(t))}else{const a=v.value.initHash,s=ae(t),r=a<=s?{from:v.value.init,to:t}:{from:t,to:v.value.init};v.value=null,we(a===s?t:{target:t,...r}),A("rangeEnd",{from:oe(r.from),to:oe(r.to)})}}function It(e){if(v.value!==null){const t={...f.value,day:e};Object.assign(v.value,{final:t,finalHash:ae(t)})}}return Object.assign(W,{setToday:Be,setView:gt,offsetCalendar:yt,setCalendarTo:Se,setEditingRange:bt}),()=>{const e=[h("div",{class:"q-date__content col relative-position"},[h(ge,{name:"q-transition--fade"},Et[R.value])])],t=Dt(z.default);return t!==void 0&&e.push(h("div",{class:"q-date__actions"},t)),o.name!==void 0&&o.disable!==!0&&Ae(e,"push"),h("div",{class:N.value,..._t.value},[pt(),h("div",{ref:ve,class:"q-date__main col column",tabindex:-1},e)])}}});const ca=F("span",{class:"text-h6"},"Consulta de Pagos",-1),va={class:"justify-end"},fa={key:0},ma={class:"row"},ha={class:"col"},_a={class:"col"},ga={key:0},ya={class:"text-h4"},ba={class:"text-subtitle2"},xa={class:"text-h5"},Ca={class:"text-h5 text-center"},Ta={class:"text-h5 text-center"},pa=F("div",{class:"text-h6 text-center"},"Impresora",-1),Ea={class:"q-pa-md"},Aa=F("div",{class:"q-pb-sm"},null,-1),Ia=F("span",{class:"text-bold text-h6"},"Selecciona el Formato \u{1F60A}",-1),Za={__name:"TarjetaLayout",setup(o){const z=ta(),A=la(),W=[{name:"terminal",label:"TERMINAL",align:"center",field:n=>n.TERMINAL},{name:"ticket",label:"TICKET",align:"center",field:n=>n.TICKET},{name:"cliente",label:"CLIENTE",align:"center",field:n=>n.CLIENTE},{name:"fecha",label:"FECHA",align:"center",field:n=>n.FECHA},{name:"hora",label:"HORA",align:"center",field:n=>n.HORA},{name:"efectivo",label:"EFECTIVO",align:"center",field:n=>n.EFECTIVO},{name:"tarjetas",label:"TARJETAS",align:"center",field:n=>n.TARJETAS},{name:"transferencias",label:"TRANSFERENCIAS",align:"center",field:n=>n.TRANSFERENCIAS},{name:"creditos",label:"CREDITOS",align:"center",field:n=>n.CREDITOS},{name:"vales",label:"VALES",align:"center",field:n=>n.VALES}],Q=O({val:null,body:null}),S=O({state:!1,val:null,body:null}),T=O({val:null,filter:null,state:!1,body:null}),x=O(!1),p=O({state:!1,body:null}),U=O(!1),M=O(!1),Z=O(null),w=O({state:!1,val:null,opts:[{id:1,label:"Factura"},{id:2,label:"Ticket"}]}),Ae=()=>{let n=p.value.body.TICKET.split("-"),u={type:"Reimpresion",serie:n[0],folio:n[1],print:S.value.val.ip_address};U.value=!0;let v=`http://${z.session.store.ip}/access/public/modify/newmod`;pe.post(v,u).then(N=>{console.log(N),U.value=!1,S.value.val=null,S.value.state=!1}).catch(N=>N)},ve=async()=>{console.log("Recibiendo Datos :)"),x.value=!0;let u=`http://${z.session.store.ip}/access/public/reports/getCash`;pe.get(u).then(c=>{Q.value.body=c.data.terminales,T.value.body=c.data.formaspagos,console.log(c.data),T.value.state=!0,x.value=!1,console.log("ya lo recibi que no te enganen :)"),X()}).catch(c=>console.log(c))},X=async()=>{let n=z.session.store.id;console.log(n);try{let u=await oa.get(`/cashier/getPrinters/${n}`);u.status==200&&(S.value.body=u.data,console.log("Impresoras listas :)"))}catch(u){console.log(u),A.notify({message:"No se pudiron obtener las impresoras",type:"negative",position:"center",icon:"error"})}},E=(n,u,c)=>{let v=u!==void 0?u(n,c):n;return v=v==null?"":String(v),v=v.split('"').join('""'),/^\d{1,2}-\d{4}$/.test(v)&&(v=`'${v}`),`"${v}"`},Ie=()=>{const n=[W.map(c=>E(c.label))].concat(T.value.body.map(c=>W.map(v=>E(typeof v.field=="function"?v.field(c):c[v.field===void 0?v.name:v.field],v.format,c)).join(","))).join(`\r
`);aa("reporteCobros.csv",n,"text/csv")!==!0?A.notify({message:"Browser denied file download...",color:"negative",icon:"warning"}):A.notify({message:"Descarga Completa :)",color:"positive",icon:"check",position:"center"})},Oe=()=>{console.log(Z.value);let n={filt:Z.value};console.log("Recibiendo Datos :)"),x.value=!0;let c=`http://${z.session.store.ip}/access/public/reports/filter`;pe.post(c,n).then(v=>{T.value.body=v.data.formaspagos,T.value.state=!0,x.value=!1,M.value=!1,console.log("ya lo recibi que no te enganen :)")}).catch(v=>console.log(v))},Y=(n,u)=>{console.log("aqui se podra reimprimir"),console.log(u.TICKET),p.value.state=!0,p.value.body=u},f=()=>{A.loading.show({message:"Importando Ticket"});let n=z.session.store.ip,u=p.value.body.TICKET;const c=`http://${n}/access/public/modify/getTicket/${u}`;pe.get(c).then(v=>{w.value.val.id==1?se(v.data).then(N=>{A.notify({message:`El ticket ${u} se descargo correctamente`,type:"positive",position:"center"}),w.value.state=!1,w.value.val=null,A.loading.hide()}).catch(N=>{A.notify({message:`El ticket ${u} no se descargo correctamente`,type:"negative",position:"center"})}):w.value.val.id==2&&be(v.data).then(N=>{A.notify({message:`El ticket ${u} se descargo correctamente`,type:"positive",position:"center"}),w.value.state=!1,w.value.val=null,A.loading.hide()}).catch(N=>{A.notify({message:`El ticket ${u} no se descargo correctamente`,type:"negative",position:"center"})})}).catch(v=>console.log(v))},R=(n,u)=>{let c=70;return n.forEach(v=>{c+=7}),c+=10,u.forEach(v=>{c+=4}),c+=41,c},be=n=>new Promise((u,c)=>{try{let v=n.products,N=n.payments,m=R(v,N);console.log(n.products[0].ARTICULO);const l=new it({format:[80,m]});m=62,l.setFontSize(8),l.text("----------------------------------------------------------------------------",2,10),l.text(n.empresa.CTT1TPV,2,13),l.text(n.empresa.CTT2TPV,2,16),l.text(n.empresa.CTT3TPV,2,19),l.text(n.empresa.CTT4TPV,2,22),l.text(n.empresa.CTT5TPV,2,25),l.text(n.header.TERMINAL,2,34),l.text(`N\xBA ${n.header.TICKET}`,2,37),l.text(`FECHA ${n.header.FECHA}`,20,37),l.text(n.header.HORA,50,37),l.text(`Forma de Pago: ${n.header.PAGOPRINCIPAL}`,2,40),l.text(n.header.NOMBRECLIENTE,2,43),l.text(n.header.DOMICILIO,2,46),l.text(n.header.POBALCION+n.header.CODIGOPOSTAL,2,49),l.text(n.header.PROVINCIA,2,52),l.text("_________________________________________________",2,58),l.text("ARTICULO",2,61),l.text("UD.",25,61),l.text("PRECIO",40,61),l.text("TOTAL",57,61),l.text("_________________________________________________",2,62);let B=0;v.forEach(D=>{l.setFontSize(6),m+=3,l.text(D.ARTICULO+"   "+D.DESCRIPCION.substring(0,47),2,m),m+=4,l.text(Number(D.CANTIDAD).toFixed(2),25,m),l.text(Number(D.PRECIO).toFixed(2),40,m),l.text(Number(D.TOTAL).toFixed(2),57,m),B+=Number(D.CANTIDAD)}),m+=10,l.setFontSize(8),l.setFont("helvetica","bold"),l.text("TOTAL",54,m,"right"),l.text(`$ ${Number(n.header.TOTAL).toFixed(2)}`,56,m,"left"),l.setFont("helvetica","normal"),N.forEach(D=>{m+=4,l.text(D.CONCEPTOPAGO,54,m,"right"),l.text(`$ ${Number(D.IMPORTE).toFixed(2)}`,56,m,"left")}),m+=5,l.text(`N Articulos: ${B}`,2,m),m+=5,l.setFontSize(6),l.text(`Le Atendio: ${n.header.DEPENDIENTE}`,2,m),m+=5,l.setFontSize(8),l.text("---------------------------------Grupo-Vizcarra----------------------------",2,m),m+=5,l.text(n.empresa.PTT1TPV,2,m),m+=3,l.text(n.empresa.PTT2TPV,2,m),m+=3,l.text(n.empresa.PTT3TPV,2,m),m+=3,l.text(n.empresa.PTT4TPV,2,m),m+=3,l.text(n.empresa.PTT5TPV,2,m),m+=3,l.text(n.empresa.PTT6TPV,2,m),m+=3,l.text(n.empresa.PTT7TPV,2,m),m+=3,l.text(n.empresa.PTT8TPV,2,m),l.save(`Ticket ${n.header.TICKET}`),u()}catch(v){c(v)}}),se=n=>new Promise((u,c)=>{try{let N=n.products,m=n.payments;const l=new it;let B=[];const D=N.map(k=>Object.values(k)),H=Math.ceil(D.length/20);for(var v=0;v<D.length;v+=20)B.push(D.slice(v,v+20));console.log(B);for(let k=0;k<1;k++)B.forEach(function(V,ie){ie>0&&l.addPage();let ee=0,fe=0;for(let P=0;P<V.length;P++)V[P][1]=V[P][1].replace(/\n/g," "),V[P][2]=parseFloat(V[P][2]),V[P][3]=Number(V[P][3]).toFixed(2),V[P][4]=Number(V[P][4]).toFixed(2),ee+=parseFloat(V[P][2]),fe+=parseFloat(V[P][4]);l.setFontSize(25),l.setFont("helvetica","bold"),l.text("GRUPO VIZCARRA",105,10,"center"),l.setFontSize(8),l.text("Hora Ticket:",10,10,"left"),l.text(n.header.HORA,10,15,"left"),l.setFontSize(12),l.text(`${n.header.NOMBRECLIENTE} ${n.header.CLIENTE}`,10,25,"left"),l.text(`SUCURSAL ${n.empresa.DESTPV}`,120,25,"left"),l.setFontSize(8),l.text(n.header.DOMICILIO,10,30,"left"),l.text(n.header.CODIGOPOSTAL,10,35,"left"),l.text(n.header.POBALCION+n.header.PROVINCIA,10,40,"left"),l.text(n.empresa.CTT3TPV,120,30,"left"),l.text("LLI1210184G8",120,45,"left"),l.rect(120,51,80,5),l.text("DOCUMENTO",121,55,"left"),l.text("FACTURA",121,60,"left"),l.text("NUMERO",143,55,"left"),l.text(n.header.TICKET,143,60,"left"),l.text("PAGINA",165,55,"left"),l.text(`${ie+1} de ${H}`,165,60,"left"),l.text("FECHA",185,55,"left");const De=n.header.FECHA;l.text(De,185,60,"left"),ut(l,{startX:10,startY:65,theme:"grid",styles:{cellPadding:1,fontSize:8,halign:"center"},head:[["CREADOR DOC","ALMACEN","AGENTE","FORMA DE PAGO"]],body:[["APP","GEN",n.header.DEPENDIENTE,m[0].CONCEPTOPAGO]]}),ut(l,{startX:10,startY:80,theme:"striped",styles:{cellPadding:.6,fontSize:8,halign:"left"},head:[["ARTICULO","DESCRIPCION","CANTIDAD","PRECIO","TOTAL"]],body:V,columnStyles:{0:{fontStyle:"bold",halign:"left"},1:{fontStyle:"bold",halign:"left"},2:{halign:"center"},3:{halign:"center"},4:{halign:"center"}}}),l.setFontSize(11),l.text("TOTAL UNIDADES:",60,200,"left"),l.text(Number(ee).toFixed(2),100,200,"left"),l.setFont("helvetica","bold"),l.text("TOTAL:",140,200,"left"),l.text(`$ ${Number(fe).toFixed(2)}`,160,200,"left"),l.setFontSize(8),l.text("Debo(emos) y pagare(mos) incondicionalmente por este pagare a la order de GRUPO VIZCARRA, en la ciudad de Mexico,",5,210,"left"),l.text("la cantidad de el valor recibido a mi(nuestra) entera satisfaccion",5,215,"left"),l.text("Este pagare forma parte de una serie numerica del 1 al y 9 y todos estos estan sujetos a la condicion, de que al no pagarse cualquiera de ellos a su",5,220,"left"),l.text("vencimiento sean exigibles todos los que le sigan en numero, ademas de los ya vencidosm desde la fecha de su vencimiento de el presente documento",5,225,"left"),l.text("hasta el dia de su liquidacion, causaran intereses moratorios al tipo del % mensual en esta ciudad justamente con el principal",5,230,"left"),l.setFontSize(15),l.text("______________",31,248,"center"),l.text("AUTORIZO",20,254,"left"),l.text("______________",85,248,"center"),l.text("CHOFER",75,254,"left"),l.text("______________",140,248,"center"),l.text("RECIBIO",130,254,"left"),l.text("______________",168,248,"left"),l.text("FECHA Y HORA",168,254,"left"),l.setFontSize(9),l.text("UNA VEZ ENTREGADA LA MERCANCIA EN LA FLETERA O DOMICILIO QUE INDIQUE EL CLIENTE ",5,260,"left"),l.text("LLUVIA LIGHT SA DE CV NO ES RESPONSABLE POR PEDIDAS TOTALES, PARCIALES ",5,265,"left"),l.text("O CUALQUIER TIPO DE DANO EN LA MERCANCIA DE ESTE DOCUMENTO ",5,270,"left"),l.setFont("helvetica","bold"),l.setFontSize(12),l.text("NO SE ACEPTAN CAMBIOS NI DEVOLUCIONES",5,275,"left"),l.setFontSize(25),l.setFont("helvetica","bold"),l.text("GRUPO VIZCARRA",105,10,"center")});l.save(`Factura ${n.header.TICKET}`),u()}catch(N){c(N)}});return ve(),(n,u)=>(qe(),Nt(Bt,{view:"hHh Lpr fFf"},{default:_(()=>[i(Mt,{class:"transparent text-dark",bordered:""},{default:_(()=>[i(Rt),i(Pe),i(wt,{class:"justify-between"},{default:_(()=>[F("div",null,[$("Helpers "),i(et,{name:"navigate_next",color:"primary"}),$(),ca])]),_:1})]),_:1}),i(kt,null,{default:_(()=>[i(ea,{padding:""},{default:_(()=>[F("div",va,[i(I,{color:"primary",icon:"event",onClick:u[0]||(u[0]=c=>M.value=!M.value),flat:"",round:""})]),i(Pe,{spaced:"",inset:"",vertical:"",dark:""}),T.value.state?(qe(),tt("div",fa,[i($t,{class:"my-sticky-header-table",title:"Fromas de Pago",rows:T.value.body,"row-key":"name",filter:T.value.filter,separator:"cell",onRowClick:Y,columns:W},{"top-right":_(()=>[F("div",ma,[F("div",ha,[i(Ht,{borderless:"",dense:"",debounce:"300",modelValue:T.value.filter,"onUpdate:modelValue":u[1]||(u[1]=c=>T.value.filter=c),placeholder:"Search"},{append:_(()=>[i(et,{name:"search"})]),_:1},8,["modelValue"])]),i(Pe,{spaced:"",inset:"",vertical:"",dark:""}),F("div",_a,[i(I,{color:"primary",icon:"archive",dense:"","no-caps":"",flat:"",round:"",onClick:Ie})])])]),_:1},8,["rows","filter"])])):at("",!0),i(ye,{modelValue:x.value,"onUpdate:modelValue":u[2]||(u[2]=c=>x.value=c),persistent:""},{default:_(()=>[x.value?(qe(),tt("div",ga,[i(Qt,{color:"primary",size:"7.5em"}),i(jt,{offset:[0,8]},{default:_(()=>[$("Cargando Informacion")]),_:1})])):at("",!0)]),_:1},8,["modelValue"]),i(ye,{modelValue:p.value.state,"onUpdate:modelValue":u[5]||(u[5]=c=>p.value.state=c),persistent:""},{default:_(()=>[i(Ee,{style:{width:"700px","max-width":"70vw"}},{default:_(()=>[i(K,{class:"row justify-between"},{default:_(()=>[F("div",ya,"Ticket : "+G(p.value.body.TICKET),1),F("div",ba,G(p.value.body.TERMINAL),1)]),_:1}),i(K,null,{default:_(()=>[F("div",xa,G(p.value.body.CNOFAC),1)]),_:1}),i(K,null,{default:_(()=>[F("div",Ca,G(p.value.body.CLIENTE),1),F("div",Ta,G(p.value.body.FECHA),1)]),_:1}),i(K,null,{default:_(()=>[i(zt,{bordered:""},{default:_(()=>[i(nt,null,{default:_(()=>[i(J,null,{default:_(()=>[$("EFECTIVO")]),_:1}),i(J,null,{default:_(()=>[$("TARJETA")]),_:1}),i(J,null,{default:_(()=>[$("TRANSFERENCIA")]),_:1}),i(J,null,{default:_(()=>[$("VALE")]),_:1}),i(J,null,{default:_(()=>[$("CREDITO")]),_:1})]),_:1}),i(nt,null,{default:_(()=>[i(J,null,{default:_(()=>[$(G(p.value.body.EFECTIVO),1)]),_:1}),i(J,null,{default:_(()=>[$(G(p.value.body.TARJETAS),1)]),_:1}),i(J,null,{default:_(()=>[$(G(p.value.body.TRANSFERENCIAS),1)]),_:1}),i(J,null,{default:_(()=>[$(G(p.value.body.VALES),1)]),_:1}),i(J,null,{default:_(()=>[$(G(p.value.body.CREDITOS),1)]),_:1})]),_:1})]),_:1})]),_:1}),i(Le,{align:"center"},{default:_(()=>[lt(i(I,{flat:"",color:"negative",icon:"close"},null,512),[[ot]]),i(I,{flat:"",color:"primary",icon:"print",onClick:u[3]||(u[3]=c=>S.value.state=!S.value.state)}),i(I,{flat:"",color:"primary",icon:"picture_as_pdf",onClick:u[4]||(u[4]=c=>w.value.state=!f.state)})]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(ye,{modelValue:S.value.state,"onUpdate:modelValue":u[7]||(u[7]=c=>S.value.state=c)},{default:_(()=>[i(Ee,{class:"my-card"},{default:_(()=>[i(K,null,{default:_(()=>[pa]),_:1}),i(K,null,{default:_(()=>[i(Gt,{onSubmit:Ae,class:"q-gutter-md"},{default:_(()=>[i(rt,{dense:"","option-label":"name",modelValue:S.value.val,"onUpdate:modelValue":u[6]||(u[6]=c=>S.value.val=c),options:S.value.body,label:"Impresora",filled:"",autofocus:"",style:{width:"200px"}},null,8,["modelValue","options"]),F("div",null,[i(I,{label:"Enviar",type:"submit",color:"primary",style:{width:"200px"},disable:S.value.val===null||U.value},null,8,["disable"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(ye,{modelValue:M.value,"onUpdate:modelValue":u[10]||(u[10]=c=>M.value=c)},{default:_(()=>[i(Ee,{class:"my-card"},{default:_(()=>[i(K,null,{default:_(()=>[F("div",Ea,[Aa,i(da,{modelValue:Z.value,"onUpdate:modelValue":u[8]||(u[8]=c=>Z.value=c),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),i(K,null,{default:_(()=>[i(Le,{align:"right"},{default:_(()=>[i(I,{flat:"",icon:"close",color:"negative",onClick:u[9]||(u[9]=c=>M.value=!M.value)}),i(I,{flat:"",icon:"check",color:"positive",onClick:Oe})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(ye,{modelValue:w.value.state,"onUpdate:modelValue":u[12]||(u[12]=c=>w.value.state=c),persistent:""},{default:_(()=>[i(Ee,null,{default:_(()=>[i(K,{class:"row items-center"},{default:_(()=>[i(Ft,{icon:"picture_as_pdf",color:"primary","text-color":"white"}),Ia]),_:1}),i(K,null,{default:_(()=>[i(rt,{modelValue:w.value.val,"onUpdate:modelValue":u[11]||(u[11]=c=>w.value.val=c),options:w.value.opts,label:"Formatos",filled:""},null,8,["modelValue","options"])]),_:1}),i(Le,{align:"right"},{default:_(()=>[lt(i(I,{flat:"",label:"Cancel",color:"negative"},null,512),[[ot]]),i(I,{flat:"",label:"Seleccionar",color:"positive",onClick:f,disable:!w.value.val},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}};export{Za as default};
