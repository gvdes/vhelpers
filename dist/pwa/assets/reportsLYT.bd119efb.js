import{b as v}from"./QList.afdddd43.js";import{Q as O}from"./QHeader.72838204.js";import{a as R,u as L,r as b,o as y,d as F,w as g,e as k,f as w,ak as x,S as P,g as f,a3 as W,a2 as _,h as B,a0 as S}from"./index.a9a112a6.js";import{Q as D}from"./QSelect.1e0417f3.js";import{Q as E}from"./QCardSection.8b2e34ee.js";import{Q as C}from"./QCard.432c7e9b.js";import{Q as T,a as $}from"./QLayout.c6dc08a5.js";import{u as V}from"./use-quasar.bb3321c5.js";import"./jspdf.plugin.autotable.488ce0ab.js";import{r as j}from"./reportApi.b3c20674.js";import{E as u}from"./exceljs.min.9e24d01d.js";import"./dayjs.min.cbcf888d.js";import"./JsBarcode.cb858474.js";import"./browser.c61f550a.js";import{_ as z}from"./UserToolbar.8919e01b.js";import"./use-key-composition.38918a2a.js";import"./QResizeObserver.3e75f45c.js";import"./QScrollObserver.d28ac75c.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.39db32aa.js";import"./QDrawer.31d963c7.js";import"./QCardActions.340d90fe.js";import"./ClosePopup.b92cb407.js";import"./auth.58dac777.js";const A=async t=>{console.log(t);const c=new u.Workbook,i=c.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(c,t.key)},Q=async t=>{console.log(t);const c=new u.Workbook,i=c.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(c,t.key)},U=async t=>{console.log(t);const c=new u.Workbook,i=c.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(c,t.key)},G=async t=>{console.log(t);const c=new u.Workbook,i=c.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(c,t.key)},q=async t=>{console.log(t);const c=new u.Workbook,i=c.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(c,t.key)},N=async t=>{console.log(t);const c=new u.Workbook,i=c.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(c,t.key)},H=async t=>{console.log(t);const c=new u.Workbook,i=c.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(c,t.key)},I=async t=>{console.log(t);const c=new u.Workbook,i=c.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(c,t.key)},X=async(t,c)=>{console.log(t);const i=new u.Workbook,n=i.addWorksheet(t.key);let l=t.value.map(e=>({C\u00F3digo:e.id,Modelo:e.code,Descripci\u00F3n:e.description,Proveedor:e.providers.name,Fabricante:e.makers?e.makers.name:"",Status:e.status.name,Secci\u00F3n:e.category.familia.seccion.name,Familia:e.category.familia.name,Categor\u00EDa:e.category.name,"Piezas x caja":e.pieces,SOTANO:e.stocks.find(s=>s.id==c).pivot.stock,CEDIS:e.stocks.find(s=>s.id==1).pivot.stock,TEXCOCO:e.stocks.find(s=>s.id==2).pivot.stock,Maximo:e.stocks[0].pivot.max,Minimo:e.stocks[0].pivot.min,locations:e.locations.map(s=>s.path).join("/")}));const r=Object.keys(l[0]).map(e=>({name:e,filterButton:!0})),o=l.map(e=>Object.values(e));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:r,rows:o}),n.columns.forEach(e=>{let s=0;e.eachCell({includeEmpty:!0},a=>{const m=a.value?a.value.toString().length:10;m>s&&(s=m)}),e.width=s<10?10:s}),await d(i,t.key)},J=async t=>{console.log(t);const c=new u.Workbook,i=c.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(c,t.key)},Y=async t=>{console.log(t);const c=new u.Workbook,i=c.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(c,t.key)},K=async t=>{console.log(t);const c=new u.Workbook,i=c.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,CEDIS:o.stocks.find(e=>e.id==1).pivot.stock,TEXCOCO:o.stocks.find(e=>e.id==2).pivot.stock,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(c,t.key)},d=async(t,c)=>{try{const i=await t.xlsx.writeBuffer(),n=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=URL.createObjectURL(n),r=document.createElement("a");r.href=l,r.download=`${c}.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(i){console.error("Error al escribir el buffer:",i)}};var p={catalogo:A,conStock:Q,conStockUbicados:U,conStockSinUbicar:G,sinStock:q,sinStockUbicados:N,sinMaximos:H,generalVsExhibicion:I,generalVsCedis:X,conMaximos:J,negativos:Y,cedisStock:K};const Z={class:"row justify-between q-ml-sm"},oo={class:"row"},eo={key:0,class:"row q-pl-sm"},to=["onClick"],ao={class:"text--1 text-right q-pa-md"},Lo={__name:"reportsLYT",setup(t){R();const c=L(),i=V(),n=b([]),l=b({seccion:null,familia:null,categoria:null}),r=b([]),o=async()=>{const a=await j.index();a.error?console.log(a):(console.log(a),n.value=a)},e=async()=>{i.loading.show({message:"Obteniendo Datos"});let a={workpoint:c.session.store.id_viz,secciones:l.value.seccion.map(h=>h.id)};const m=await j.getReport(a);m.error?console.log(m):(console.log(m),r.value=Object.keys(m).map(h=>({key:h,value:m[h]})),i.loading.hide())},s=a=>{i.loading.show({message:"Generando Reporte"});let m=c.session.store.id_viz;switch(a.key){case"catalogo":p.catalogo(a);break;case"conStock":p.conStock(a);break;case"conStockUbicados":p.conStockUbicados(a);break;case"conStockSinUbicar":p.conStockSinUbicar(a);break;case"sinStock":p.sinStock(a);break;case"sinStockUbicados":p.sinStockUbicados(a);break;case"sinMaximos":p.sinMaximos(a);break;case"generalVsExhibicion":p.generalVsExhibicion(a);break;case"generalVsCedis":p.generalVsCedis(a,m);break;case"conMaximos":p.conMaximos(a);break;case"negativos":p.negativos(a);break;case"cedisStock":p.cedisStock(a);break}i.loading.hide()};return o(),(a,m)=>(y(),F(T,{view:"hHh Lpr fFf"},{default:g(()=>[k(O,{class:"transparent text-dark",bordered:""},{default:g(()=>[k(z),k(v),k(v)]),_:1}),k(v,{spaced:"",inset:"",vertical:"",dark:""}),k($,{class:"q-ml-sm"},{default:g(()=>[w("div",Z,[w("div",null,[m[1]||(m[1]=x("Helpers ")),k(P,{name:"navigate_next",color:"primary"}),m[2]||(m[2]=x()),m[3]||(m[3]=w("span",{class:"text-h6"},"Reporteria",-1))])]),k(C,{class:"my-card"},{default:g(()=>[k(E,null,{default:g(()=>[w("div",oo,[k(v,{spaced:"",inset:"",vertical:"",dark:""}),k(D,{dense:"",class:"col",modelValue:l.value.seccion,"onUpdate:modelValue":m[0]||(m[0]=h=>l.value.seccion=h),options:n.value.seccion,label:"Seccion","option-label":"name",filled:"",multiple:"","use-chips":"",onBlur:e},null,8,["modelValue","options"]),k(v,{spaced:"",inset:"",vertical:"",dark:""})])]),_:1})]),_:1}),k(v,{spaced:"",inset:"",vertical:"",dark:""}),r.value.length>0?(y(),f("div",eo,[(y(!0),f(W,null,_(r.value,(h,M)=>(y(),f("div",{class:"col-md-3 col-xs-6 q-pb-sm q-pr-sm",key:M,onClick:so=>s(h)},[k(C,{class:"bg-darkl1"},{default:g(()=>[k(E,{class:"text-h4 text-left"},{default:g(()=>[w("span",null,S(h.value.length),1)]),_:2},1024),w("div",ao,S(h.key.toUpperCase()),1)]),_:2},1024)],8,to))),128))])):B("",!0)]),_:1})]),_:1}))}};export{Lo as default};
