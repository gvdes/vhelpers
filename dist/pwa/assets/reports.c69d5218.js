import{E as l}from"./exceljs.min.9e24d01d.js";import{d as $}from"./dayjs.min.cbcf888d.js";import{u as z}from"./index.0d286209.js";const I=z(),Y=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=t.value.map(o=>({CoCorto:o.name,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,"Fin de Temporada":o.stocks[0].pivot.fdt,locations:o.locations.map(e=>e.path).join("/")}));const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.key)},N=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=t.value.map(o=>({CoCorto:o.name,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,"Fin de Temporada":o.stocks[0].pivot.fdt,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.key)},V=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=t.value.map(o=>{var e,a;return{CoCorto:o.name,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,"Fin de Temporada":o.stocks[0].pivot.fdt,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,UGeneral:(e=o.bodega)==null?void 0:e.map(s=>s.path).join("/"),UExhibicion:(a=o.ventas)==null?void 0:a.map(s=>s.path).join("/")}});const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.key)},_=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=t.value.map(o=>{var e,a;return{CoCorto:o.name,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,"Fin de Temporada":o.stocks[0].pivot.fdt,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,UGeneral:(e=o.bodega)==null?void 0:e.map(s=>s.path).join("/"),UExhibicion:(a=o.ventas)==null?void 0:a.map(s=>s.path).join("/")}});const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.key)},X=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=t.value.map(o=>({CoCorto:o.name,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,"Fin de Temporada":o.stocks[0].pivot.fdt,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.key)},q=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=t.value.map(o=>{var e,a;return{CoCorto:o.name,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,"Fin de Temporada":o.stocks[0].pivot.fdt,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,UGeneral:(e=o.bodega)==null?void 0:e.map(s=>s.path).join("/"),UExhibicion:(a=o.ventas)==null?void 0:a.map(s=>s.path).join("/")}});const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.key)},H=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=t.value.map(o=>({CoCorto:o.name,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,"Fin de Temporada":o.stocks[0].pivot.fdt,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.key)},J=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=t.value.map(o=>({CoCorto:o.name,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,"Fin de Temporada":o.stocks[0].pivot.fdt,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.key)},K=async(t,i)=>{console.log(t);const n=new l.Workbook,c=n.addWorksheet(t.key);let m=t.value.map(e=>({CoCorto:e.name,Modelo:e.code,Descripci\u00F3n:e.description,Proveedor:e.providers.name,Fabricante:e.makers?e.makers.name:"",Status:e.status.name,Secci\u00F3n:e.category.familia.seccion.name,Familia:e.category.familia.name,Categor\u00EDa:e.category.name,"Piezas x caja":e.pieces,StockSucursal:e.stocks.find(a=>a.id==i).pivot.stock,CEDIS:e.stocks.find(a=>a.id==1).pivot.stock,TEXCOCO:e.stocks.find(a=>a.id==2).pivot.stock,Maximo:e.stocks[0].pivot.max,Minimo:e.stocks[0].pivot.min,locations:e.locations.map(a=>a.path).join("/")}));const r=Object.keys(m[0]).map(e=>({name:e,filterButton:!0})),o=m.map(e=>Object.values(e));c.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:r,rows:o}),c.columns.forEach(e=>{let a=0;e.eachCell({includeEmpty:!0},s=>{const p=s.value?s.value.toString().length:10;p>a&&(a=p)}),e.width=a<10?10:a}),await k(n,t.key)},Q=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=t.value.map(o=>({CoCorto:o.name,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,"Fin de Temporada":o.stocks[0].pivot.fdt,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.key)},Z=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=t.value.map(o=>({CoCorto:o.name,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,"Fin de Temporada":o.stocks[0].pivot.fdt,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.key)},oo=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=t.value.map(o=>({CoCorto:o.name,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,CEDIS:o.stocks.find(e=>e.id==1).pivot.stock,TEXCOCO:o.stocks.find(e=>e.id==2).pivot.stock,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.key)},eo=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=t.value.map(o=>{var e,a;return{CoCorto:o.name,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,UGeneral:(e=o.bodega)==null?void 0:e.map(s=>s.path).join("/"),UExhibicion:(a=o.ventas)==null?void 0:a.map(s=>s.path).join("/")}});const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.key)},to=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=[];t.value.forEach(o=>{o.products.forEach(e=>{var a,s,p,d,h,v,w,y,g,b,f,x,S,C,E,j,F,M,O,L,R,T,P,W,D,A,B,U,G;c.push({"Creado por":o.created_by.names,Fecha:$(o.created_at).format("YYYY-MM-DD H:mm:ss"),Preventa:o.id,Nombre:o.name,Modelo:e.code,Descripci\u00F3n:e.description,Secci\u00F3n:(d=(p=(s=(a=e.category)==null?void 0:a.familia)==null?void 0:s.seccion)==null?void 0:p.name)!=null?d:"",Familia:(w=(v=(h=e.category)==null?void 0:h.familia)==null?void 0:v.name)!=null?w:"",Categor\u00EDa:(g=(y=e.category)==null?void 0:y.name)!=null?g:"","Piezas x caja":e.pieces,Surtido:(x=(f=(b=e.pivot)==null?void 0:b.supply_by)==null?void 0:f.name)!=null?x:"",Unidades:(C=(S=e.pivot)==null?void 0:S.amount)!=null?C:"",Cantidad:(j=(E=e.pivot)==null?void 0:E.units)!=null?j:"",Precio:(M=(F=e.pivot)==null?void 0:F.price)!=null?M:"",Total:(L=(O=e.pivot)==null?void 0:O.total)!=null?L:"",stockSuc:(P=(T=(R=e.stocks)==null?void 0:R.find(u=>u.id==I.session.store.id_va))==null?void 0:T.pivot.stock)!=null?P:0,stockCed:(A=(D=(W=e.stocks)==null?void 0:W.find(u=>u.id==1))==null?void 0:D.pivot.stock)!=null?A:0,stockTex:(G=(U=(B=e.stocks)==null?void 0:B.find(u=>u.id==2))==null?void 0:U.pivot.stock)!=null?G:0})})});const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.key)},ao=async t=>{console.log(t);const i=new l.Workbook,n=i.addWorksheet(t.key);let c=[];t.ticketSuc.products.forEach(o=>{c.push({Clave:t.claveDoc,Cliente:t.nclient,"Fecha de elaboraci\xF3n":$().format("DD/MM/YYYY"),"Su pedido":"","Clave del art\xEDculo":o.ARTLFA,Cantidad:o.CANLFA,Precio:Number(Number(o.PRELFA)/1.16).toFixed(6),"Desc. 1":"","Desc. 2":"","Desc. 3":"","Clave de vendedor":"",Comisi\u00F3n:"","Clave de esquema de impuestos":"","Impuesto 1":"","Impuesto 2":"","Impuesto 3":"","Impuesto 4":"","Impuesto 5":"","Impuesto 6":"","Impuesto 7":"","Impuesto 8":"","M\xE9todo de pago":t.mtdpag,"Forma de Pago SAT":t.payments[0].sat,"Uso CFDI":t.cfdi.alias,"Clave SAT":o.sat.clave,"Unidad SAT":o.sat.unidad,Observaciones:"","Observaciones de partida":"","Fecha de entrega":"","Fecha de vencimiento":""})});const m=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));n.addTable({name:"ImportAspel",ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>e&&(e=s)}),o.width=e<10?10:e}),await k(i,t.claveDoc)},k=async(t,i)=>{try{const n=await t.xlsx.writeBuffer(),c=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),m=URL.createObjectURL(c),r=document.createElement("a");r.href=m,r.download=`${i}.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(n){console.error("Error al escribir el buffer:",n)}};var io={catalogo:Y,conStock:N,conStockUbicados:V,conStockSinUbicar:_,sinStock:X,sinStockUbicados:q,sinMaximos:H,generalVsExhibicion:J,generalVsCedis:K,conMaximos:Q,negativos:Z,cedisStock:oo,conStockSinContar:eo,preorders:to,importAspel:ao};export{io as r};
