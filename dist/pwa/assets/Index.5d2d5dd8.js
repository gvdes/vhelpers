import{Q as V}from"./QSeparator.cdcf2534.js";import{r as m,c as T,o as x,a as w,w as l,u as H,e,i as f,a3 as s,Y as A,Q as p,g as M,a0 as P,a1 as z,f as b,a2 as G,a4 as d,a6 as W}from"./index.a84a4054.js";import{Q as J}from"./QHeader.9a368387.js";import{a as O,b as i,Q as $}from"./QSelect.1b95f875.js";import{Q as S}from"./QList.9e2dd5c4.js";import{Q as K}from"./QDate.cb362881.js";import{u as X,Q as I,a as g}from"./use-quasar.95fbdb12.js";import{Q as N}from"./QCardActions.ca581cf5.js";import{Q as R}from"./QDialog.6f0be00e.js";import{Q as Z}from"./QInput.72fca508.js";import{Q as ee}from"./QPage.276ee794.js";import{u as ae}from"./VDB.540e6c37.js";import"./jspdf.plugin.autotable.42dc96ae.js";import{t as C}from"./transferApi.e3cae6e1.js";import"./exceljs.min.9e24d01d.js";import"./browser.94c942de.js";import{d as le}from"./dayjs.min.25545ff6.js";import{_ as te}from"./UserToolbar.b6ce692f.js";import"./QResizeObserver.734dde5b.js";import"./use-key-composition.37581874.js";import"./uid.42677368.js";import"./position-engine.99a461fd.js";import"./rtl.b51694b1.js";import"./use-cache.b0833c75.js";import"./date.a39ca55c.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.30672b3a.js";import"./axios.f1f32898.js";import"./ClosePopup.61fd9554.js";const oe={class:"row justify-between"},se=f("span",{class:"text-h6"},"Traspasos entre Almacenes",-1),ne={class:"q-pa-md"},ie=f("div",{class:"q-pb-sm"},null,-1),Ye={__name:"Index",setup(re){const D=H(),u=ae(),r=X(),c=m(!1),v=m(null),_=m(!1),Q=m([]),y=m([]),n=m({_origin:null,_destiny:null,notes:null}),U=T(()=>n.value._origin&&n.value._destiny&&n.value.notes),k=T(()=>u.session.rol!=="alm"?y.value.filter(o=>[1,2,3,4].includes(o.id)):y.value.filter(o=>[5,6].includes(o.id))),B=async()=>{console.log("Recibiendo Datos :)"),r.loading.show({message:"Obteniendo Datos"});let o=u.session.store.id;const t=await C.index(o);t.error?console.log(t):(console.log(t),Q.value=t.transfer,y.value=t.warehouses,r.loading.hide())},h=async()=>{r.loading.show({message:"Creando Traspaso"}),n.value.created_by=u.session.name,n.value._store=u.session.store.id,console.log(n.value);const o=await C.addTransfer(n.value);o.error?(console.log(o),r.notify({message:"No se logro crear el traspaso",position:"center",type:"negative"})):(r.loading.hide(),r.notify({message:`Traspaso ${o.code_fs} creada`,position:"center",type:"positive"}),D.push(`transfers/${o.id}`))},E=()=>{_.value=!1,n.value={_origin:null,_destiny:null,notes:null}},Y=o=>o.id===n.value._origin.id||u.session.rol!=="aud"&&o.id===4,L=o=>(console.log(o),u.session.rol!="aud"&&o.id==4),q=async()=>{console.log(v.value),r.loading.show({message:"Obteniendo Datos"});let t={store:u.session.store.id,date:v.value};console.log("Recibiendo Datos :)");const a=await C.getDate(t);a.fail?console.log(a):(console.log(a),Q.value=a,r.loading.hide(),v.value=null,c.value=!1)},j=o=>{D.push(`transfers/${o}`)};return B(),(o,t)=>(x(),w(ee,{padding:""},{default:l(()=>[e(J,{class:"transparent text-dark",bordered:""},{default:l(()=>[e(te),e(V),f("div",oe,[f("div",null,[s("Helpers "),e(A,{name:"navigate_next",color:"primary"}),s(),se]),f("div",null,[e(p,{color:"primary",icon:"add",flat:"",onClick:t[0]||(t[0]=a=>_.value=!_.value),round:""}),e(p,{color:"primary",icon:"event",onClick:t[1]||(t[1]=a=>c.value=!c.value),flat:"",round:""})])]),e(V)]),_:1}),e(S,null,{default:l(()=>[e(O,null,{default:l(()=>[e(i,{class:"text-center"},{default:l(()=>[s("ID")]),_:1}),e(i,{class:"text-center"},{default:l(()=>[s("CREADO")]),_:1}),e(i,{class:"text-center"},{default:l(()=>[s("CREADO POR")]),_:1}),e(i,{class:"text-center"},{default:l(()=>[s("NOTAS")]),_:1}),e(i,{class:"text-center"},{default:l(()=>[s("ORIGEN")]),_:1}),e(i,{class:"text-center"},{default:l(()=>[s("DESTINO")]),_:1}),e(i,{class:"text-center"},{default:l(()=>[s("FACTUSOL")]),_:1}),e(i,{class:"text-center"},{default:l(()=>[s("ARTICULOS")]),_:1})]),_:1})]),_:1}),e(V,{spaced:"",inset:"",vertical:"",dark:""}),(x(!0),M(z,null,P(Q.value,(a,F)=>(x(),w(S,{bordered:"",key:F},{default:l(()=>[G((x(),w(O,{clickable:"",onClick:de=>j(a.id)},{default:l(()=>[e(i,{class:"text-center"},{default:l(()=>[s(d(a.id),1)]),_:2},1024),e(i,{class:"text-center"},{default:l(()=>[s(d(b(le)(a.created_at).format("YYYY-MM-D")),1)]),_:2},1024),e(i,{class:"text-center"},{default:l(()=>[s(d(a.created_by),1)]),_:2},1024),e(i,{class:"text-center"},{default:l(()=>[s(d(a.notes),1)]),_:2},1024),e(i,{class:"text-center"},{default:l(()=>[s(d(a.origin.alias),1)]),_:2},1024),e(i,{class:"text-center"},{default:l(()=>[s(d(a.destiny.alias),1)]),_:2},1024),e(i,{class:"text-center"},{default:l(()=>[s(d(a.code_fs),1)]),_:2},1024),e(i,{class:"text-center"},{default:l(()=>[s(d(a.bodie.length),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[W]])]),_:2},1024))),128)),e(R,{modelValue:c.value,"onUpdate:modelValue":t[4]||(t[4]=a=>c.value=a)},{default:l(()=>[e(I,{class:"my-card"},{default:l(()=>[e(g,null,{default:l(()=>[f("div",ne,[ie,e(K,{modelValue:v.value,"onUpdate:modelValue":t[2]||(t[2]=a=>v.value=a),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),e(g,null,{default:l(()=>[e(N,{align:"right"},{default:l(()=>[e(p,{flat:"",icon:"close",color:"negative",onClick:t[3]||(t[3]=a=>c.value=!c.value)}),e(p,{flat:"",icon:"check",color:"positive",onClick:q})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(R,{modelValue:_.value,"onUpdate:modelValue":t[9]||(t[9]=a=>_.value=a),persistent:""},{default:l(()=>[e(I,{style:{width:"700px","max-width":"80vw"}},{default:l(()=>[e(g,{class:"text-h5 text-bold text-center"},{default:l(()=>[s(" Nuevo Traspaso ")]),_:1}),e(g,{class:"row items-center"},{default:l(()=>[e($,{modelValue:n.value._origin,"onUpdate:modelValue":[t[5]||(t[5]=a=>n.value._origin=a),t[6]||(t[6]=a=>n.value._destiny=null)],options:b(k),label:"Almacen Origen",class:"col","option-label":"name","option-disable":a=>L(a)},null,8,["modelValue","options","option-disable"]),e(A,{name:"arrow_forward",class:"col",size:"md"}),e($,{modelValue:n.value._destiny,"onUpdate:modelValue":t[7]||(t[7]=a=>n.value._destiny=a),options:b(k),label:"Almacen Destino",class:"col","option-label":"name","option-disable":a=>Y(a),disable:n.value._origin==null},null,8,["modelValue","options","option-disable","disable"])]),_:1}),e(g,null,{default:l(()=>[e(Z,{modelValue:n.value.notes,"onUpdate:modelValue":t[8]||(t[8]=a=>n.value.notes=a),type:"text",label:"Notas"},null,8,["modelValue"])]),_:1}),e(N,{align:"center"},{default:l(()=>[e(p,{flat:"",label:"Cancelar",color:"negative",onClick:E}),e(p,{flat:"",label:"Crear",color:"positive",onClick:h,disable:!b(U)},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Ye as default};
