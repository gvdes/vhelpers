import{Q as T,a as Y,b as u}from"./QTr.da82e73d.js";import{r as f,c as O,o as y,a as k,w as o,e as l,b1 as D,Y as x,aE as $,Q as w,i as s,a4 as r,a5 as z,f as M,a3 as L}from"./index.60accdeb.js";import{Q}from"./QSelect.21a227b4.js";import{Q as V}from"./QSeparator.784b7f2f.js";import{Q as P}from"./QInput.03e89833.js";import{d as h,Q as j}from"./deposits.06c3c1da.js";import{Q as R}from"./QTable.0491faa9.js";import{Q as U,a as _}from"./QCard.451e90b4.js";import{Q as F}from"./QDialog.b2c3aa5a.js";import{Q as G}from"./QDate.c8143729.js";import{Q as H}from"./QCardActions.8e83f2de.js";import{Q as J}from"./QPage.c2494952.js";import{u as K}from"./VDB.ce5fa8f0.js";import"./ClosePopup.b68326b8.js";import{u as W}from"./use-quasar.1b009705.js";import{d as X}from"./dayjs.min.25545ff6.js";import"./jspdf.plugin.autotable.a39f939c.js";import"./exceljs.min.9e24d01d.js";import"./browser.94c942de.js";import{$socket as C}from"./socket.1159f1bc.js";import"./use-key-composition.4cfe21f0.js";import"./uid.42677368.js";import"./position-engine.77b1ebb9.js";import"./rtl.b51694b1.js";import"./axios.ae0a941c.js";import"./axios.f1f32898.js";import"./QList.9e4dd339.js";import"./QLinearProgress.3d7aea7e.js";import"./QCheckbox.18c0e4b9.js";import"./use-cache.b0833c75.js";import"./date.90891abc.js";import"./_commonjsHelpers.88e99c8f.js";const Z=s("div",{class:"col-2 q-table__title q-mr-xl"},"Depositos",-1),ee={class:"text-bold text-left"},te={class:"text-bold text-center"},le={class:"text-bold text-center"},oe={class:"text-bold text-center"},ae={class:"text-bold text-center"},se={class:"text-bold text-left"},ne={class:"text-bold text-center"},ie={class:"text-bold text-center"},re={class:"text-bold text-left"},de=["src"],ue={class:"text-h6"},ce={class:"text-subtitle2"},me={class:"q-pa-md"},pe=s("div",{class:"q-pb-sm"},null,-1),Ge={__name:"Confirm",setup(ve){K();const c=W(),S=C.connect();S.connected?console.log(`%c Connect ${S.id} `,"background: #222; color: #bada55"):console.log("%c No hay conexion en el socket ","background: #222; color: #bada55"),C.on("List",t=>{console.log(t),v.value.push(t)});const m=f({state:!1,val:null}),n=f({val:{id:1,name:"Pendiente"},opts:[]}),q=["yellow-11","green-11","red-11"],p=f(!1),g=f(null),d=f({val:null,opts:[]}),v=f([]),b=f({columns:[{name:"id",label:"Id",align:"center",field:t=>t.id},{name:"created",label:"Creado por",align:"center",field:t=>t.send_by},{name:"store",label:"Sucursal",align:"center",field:t=>t.store.name},{name:"origin",label:"Origen",align:"center",field:t=>t.origin},{name:"destiny",label:"Destino",align:"center",field:t=>t.destiny},{name:"concept",label:"Concepto",align:"left",field:t=>t.concept},{name:"reference",label:"Referencia / Folio",align:"center",field:t=>t.refernce},{name:"amount",label:"Importe",align:"center",field:t=>t.amount},{name:"status",label:"Estado",align:"left",field:t=>t.status.name},{name:"ticket",label:"Ticket",align:"center",field:t=>t.ticket},{name:"picture",label:"Foto",align:"center",field:t=>t.picture}],filter:""}),A=O(()=>d.value.val&&n.value.val?v.value.filter(t=>t._store==d.value.val.id&&t._status==n.value.val.id):d.value.val&&!n.value.val?v.value.filter(t=>t._store==d.value.val.id):!d.value.val&&n.value.val?v.value.filter(t=>t._status==n.value.val.id):v.value),B=async()=>{let t=new Date,a=X(t).format("YYYY/MM/DD");g.value=a,console.log(a),c.loading.show({message:"Obteniendo Datos"}),c.loading.show({message:"Obteniendo Datos"});const e=await h.getForm({filt:g.value});e.fail?console.log(e):(console.log(e),c.loading.hide(),v.value=e.deposit,n.value.opts=e.status,d.value.opts=e.stores)},E=t=>{m.value.val=t,m.value.state=!0},I=async t=>{c.loading.show({message:"Cambiando estado"});let a={id:t.id,status:t.status.id};console.log(a);const e=await h.changeStatus(a);console.log(e),e.fail?console.log(e):(c.loading.hide(),t._status=t.status.id,C.emit("ChangeStatus",e),c.notify({message:"Se cambio de estado",type:"positive"}))},N=async()=>{console.log(g.value),c.loading.show({message:"Obteniendo Datos"});const t=await h.getForm({filt:g.value});t.fail?console.log(t):(console.log(t),c.loading.hide(),v.value=t.deposit,p.value=!1)};return B(),(t,a)=>(y(),k(J,{padding:""},{default:o(()=>[l(R,{title:"Depositos",rows:M(A),"row-key":"id","rows-per-page-options":[0],separator:"cell",columns:b.value.columns,filter:b.value.filter},{top:o(e=>[Z,l(T),l(Q,{modelValue:d.value.val,"onUpdate:modelValue":a[1]||(a[1]=i=>d.value.val=i),options:d.value.opts,label:"Sucursal","option-label":"name",filled:"",style:{width:"200px"}},D({_:2},[d.value.val?{name:"append",fn:o(()=>[l(x,{name:"cancel",onClick:a[0]||(a[0]=$(i=>d.value.val=null,["stop","prevent"])),class:"cursor-pointer"})]),key:"0"}:void 0]),1032,["modelValue","options"]),l(V,{spaced:"",inset:"",vertical:""}),l(Q,{modelValue:n.value.val,"onUpdate:modelValue":a[3]||(a[3]=i=>n.value.val=i),options:n.value.opts,label:"Estado","option-label":"name",filled:"",style:{width:"200px"}},D({_:2},[n.value.val?{name:"append",fn:o(()=>[l(x,{name:"cancel",onClick:a[2]||(a[2]=$(i=>n.value.val=null,["stop","prevent"])),class:"cursor-pointer"})]),key:"0"}:void 0]),1032,["modelValue","options"]),l(V,{spaced:"",inset:"",vertical:""}),l(w,{color:"primary",icon:"event",onClick:a[4]||(a[4]=i=>p.value=!p.value),flat:"",round:""}),l(V,{spaced:"",inset:"",vertical:""}),l(P,{borderless:"",dense:"",debounce:"300",modelValue:b.value.filter,"onUpdate:modelValue":a[5]||(a[5]=i=>b.value.filter=i),placeholder:"Search"},{append:o(()=>[l(x,{name:"search"})]),_:1},8,["modelValue"])]),body:o(e=>[l(Y,{props:e},{default:o(()=>[l(u,{key:"id",props:e},{default:o(()=>[s("div",ee,r(e.row.id),1)]),_:2},1032,["props"]),l(u,{key:"created",props:e},{default:o(()=>[s("div",te,r(e.row.send_by),1)]),_:2},1032,["props"]),l(u,{key:"store",props:e},{default:o(()=>[s("div",le,r(e.row.store.name),1)]),_:2},1032,["props"]),l(u,{key:"origin",props:e},{default:o(()=>[s("div",oe,r(e.row.origin),1)]),_:2},1032,["props"]),l(u,{key:"destiny",props:e},{default:o(()=>[s("div",ae,r(e.row.destiny),1)]),_:2},1032,["props"]),l(u,{key:"concept",props:e},{default:o(()=>[s("div",se,r(e.row.concept),1)]),_:2},1032,["props"]),l(u,{key:"reference",props:e},{default:o(()=>[s("div",ne,r(e.row.refernce),1)]),_:2},1032,["props"]),l(u,{key:"amount",props:e},{default:o(()=>[s("div",ie,"$ "+r(Number(e.row.import).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),1)]),_:2},1032,["props"]),l(u,{key:"status",props:e},{default:o(()=>[l(Q,{"bg-color":q[e.row.status.id-1],modelValue:e.row.status,"onUpdate:modelValue":[i=>e.row.status=i,i=>I(e.row)],options:n.value.opts,label:"Estado",filled:"","option-label":"name",dense:""},null,8,["bg-color","modelValue","onUpdate:modelValue","options"])]),_:2},1032,["props"]),l(u,{key:"ticket",props:e},{default:o(()=>[s("div",re,r(e.row.ticket),1)]),_:2},1032,["props"]),l(u,{key:"picture",props:e,onClick:i=>E(e.row)},{default:o(()=>[e.row.picture!=null?(y(),k(j,{key:0,src:`http://192.168.10.160:1920/Assist/public/storage/${e.row.picture}`,ratio:1.7,"spinner-color":"primary","spinner-size":"20px",style:{width:"100px"}},null,8,["src","ratio"])):(y(),k(z,{key:1,rounded:"",size:"100px","font-size":"52px",color:"white","text-color":"primary",icon:"close"}))]),_:2},1032,["props","onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"]),l(F,{modelValue:m.value.state,"onUpdate:modelValue":a[6]||(a[6]=e=>m.value.state=e)},{default:o(()=>[l(U,{class:"my-card"},{default:o(()=>[s("img",{src:`http://192.168.10.160:1920/Assist/public/storage/${m.value.val.picture}`},null,8,de),l(_,null,{default:o(()=>[s("div",ue,"Creado: "+r(m.value.val.send_by),1),s("div",ce,"Estado: "+r(m.value.val.status.name),1)]),_:1}),l(_,null,{default:o(()=>[L(r(m.value.val.concept),1)]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(F,{modelValue:p.value,"onUpdate:modelValue":a[9]||(a[9]=e=>p.value=e)},{default:o(()=>[l(U,{class:"my-card"},{default:o(()=>[l(_,null,{default:o(()=>[s("div",me,[pe,l(G,{modelValue:g.value,"onUpdate:modelValue":a[7]||(a[7]=e=>g.value=e),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),l(_,null,{default:o(()=>[l(H,{align:"right"},{default:o(()=>[l(w,{flat:"",icon:"close",color:"negative",onClick:a[8]||(a[8]=e=>p.value=!p.value)}),l(w,{flat:"",icon:"check",color:"positive",onClick:N})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Ge as default};
