import{Q as I,a as T,b as i}from"./QTr.70ac41f4.js";import{r as f,c as A,o as k,a as y,w as l,e as o,b1 as E,Y as N,aE as Y,Q as x,i as s,a4 as n,a5 as q,f as z,a3 as M}from"./index.7bbe54df.js";import{Q as L}from"./QSelect.602dca75.js";import{Q as O}from"./QSeparator.16b9b4cb.js";import{Q}from"./QInput.1dfdd432.js";import{d as V,Q as R}from"./deposits.c4ca32ee.js";import{Q as j}from"./QTable.f584bcd4.js";import{Q as h,a as _}from"./QCard.754b178a.js";import{Q as C}from"./QDialog.b99eb3b5.js";import{Q as P}from"./QDate.f69415db.js";import{Q as G}from"./QCardActions.c989e8fc.js";import{Q as H}from"./QPage.3d2ee8e2.js";import{u as J}from"./VDB.519b9ffa.js";import"./ClosePopup.9fe0d23a.js";import{u as K}from"./use-quasar.e145f8c0.js";import{d as W}from"./dayjs.min.25545ff6.js";import"./jspdf.plugin.autotable.182b4a04.js";import"./exceljs.min.9e24d01d.js";import"./browser.94c942de.js";import{$socket as g}from"./socket.1159f1bc.js";import"./use-key-composition.17c21aa9.js";import"./uid.42677368.js";import"./position-engine.3e040f39.js";import"./rtl.b51694b1.js";import"./format.2bc25e5f.js";import"./axios.eed4c97e.js";import"./axios.f1f32898.js";import"./QList.677c988c.js";import"./QLinearProgress.86f378ff.js";import"./QCheckbox.6a1deabc.js";import"./use-cache.b0833c75.js";import"./date.71943e12.js";import"./_commonjsHelpers.88e99c8f.js";const X=s("div",{class:"col-2 q-table__title"},"Depositos",-1),Z={class:"text-bold text-left"},ee={class:"text-bold text-center"},te={class:"text-bold text-center"},oe={class:"text-bold text-left"},le={class:"text-bold text-center"},ae={class:"text-bold text-center"},se=["src"],ie={class:"text-h6"},ne={class:"text-subtitle2"},re={class:"q-pa-md"},de=s("div",{class:"q-pb-sm"},null,-1),Re={__name:"Validate",setup(ue){const b=J(),v=K(),w=g.connect();w.connected?console.log(`%c Connect ${w.id} `,"background: #222; color: #bada55"):console.log("%c No hay conexion en el socket ","background: #222; color: #bada55"),g.emit("Conexion",b),g.on("Room",e=>{console.log(e)}),g.on("StoreList",e=>{console.log(e),u.value.push(e)}),g.on("ChangeStatus",e=>{let a=u.value.findIndex(t=>t.id==e.id);a>=0&&(u.value[a].status=e.status,u.value[a]._status=e._status,v.notify({message:`El deposito de $ ${e.import} cambio de status a ${e.status.name}`,type:`${e.status.id==2?"positive":"negative"}`,position:"center"}))});const r=f({state:!1,val:null}),D=["yellow-11","green-11","red-11"],d=f({val:null,opts:[]}),m=f(!1),p=f(null),u=f([]),S=f({columns:[{name:"id",label:"Id",align:"center",field:e=>e.id},{name:"created",label:"Creado por",align:"center",field:e=>e.send_by},{name:"store",label:"Sucursal",align:"center",field:e=>e.store.name},{name:"concept",label:"Concepto",align:"left",field:e=>e.concept},{name:"reference",label:"Referencia / Folio",align:"center",field:e=>e.refernce},{name:"amount",label:"Importe",align:"center",field:e=>e.amount},{name:"status",label:"Estado",align:"left",field:e=>e.status.name},{name:"ticket",label:"Ticket",align:"center",field:e=>e.ticket},{name:"picture",label:"Foto",align:"center",field:e=>e.picture}]}),$=A(()=>d.value.val?u.value.filter(e=>e._status==d.value.val.id):u.value),U=async()=>{let e=new Date,a=W(e).format("YYYY/MM/DD");p.value=a,console.log(a),v.loading.show({message:"Obteniendo Datos"});const t=await V.getFormStore(b.session.store.id,{filt:p.value});t.fail?console.log(t):(console.log(t),v.loading.hide(),u.value=t.deposit,d.value.opts=t.status)},B=e=>{r.value.val=e,r.value.state=!0},F=async()=>{console.log(p.value),v.loading.show({message:"Obteniendo Datos"});const e=await V.getFormStore(b.session.store.id,{filt:p.value});e.fail?console.log(e):(console.log(e),v.loading.hide(),u.value=e.deposit,m.value=!1)};return U(),(e,a)=>(k(),y(H,{padding:""},{default:l(()=>[o(j,{title:"Depositos",rows:z($),"row-key":"id","rows-per-page-options":[0],separator:"cell",columns:S.value.columns},{top:l(t=>[X,o(I),o(L,{modelValue:d.value.val,"onUpdate:modelValue":a[1]||(a[1]=c=>d.value.val=c),options:d.value.opts,label:"Estado","option-label":"name",filled:"",style:{width:"200px"}},E({_:2},[d.value.val?{name:"append",fn:l(()=>[o(N,{name:"cancel",onClick:a[0]||(a[0]=Y(c=>d.value.val=null,["stop","prevent"])),class:"cursor-pointer"})]),key:"0"}:void 0]),1032,["modelValue","options"]),o(O,{spaced:"",inset:"",vertical:""}),o(x,{color:"primary",icon:"event",onClick:a[2]||(a[2]=c=>m.value=!m.value),flat:"",round:""})]),body:l(t=>[o(T,{props:t},{default:l(()=>[o(i,{key:"id",props:t},{default:l(()=>[s("div",Z,n(t.row.id),1)]),_:2},1032,["props"]),o(i,{key:"created",props:t},{default:l(()=>[s("div",ee,n(t.row.send_by),1)]),_:2},1032,["props"]),o(i,{key:"store",props:t},{default:l(()=>[s("div",te,n(t.row.store.name),1)]),_:2},1032,["props"]),o(i,{key:"concept",props:t},{default:l(()=>[s("div",oe,n(t.row.concept),1)]),_:2},1032,["props"]),o(i,{key:"reference",props:t},{default:l(()=>[s("div",le,n(t.row.refernce),1)]),_:2},1032,["props"]),o(i,{key:"amount",props:t},{default:l(()=>[s("div",ae,"$ "+n(Number(t.row.import).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),1)]),_:2},1032,["props"]),o(i,{key:"status",props:t},{default:l(()=>[o(Q,{modelValue:t.row.status.name,"onUpdate:modelValue":c=>t.row.status.name=c,type:"text",filled:"","bg-color":D[t.row.status.id-1],dense:"",disable:!0},null,8,["modelValue","onUpdate:modelValue","bg-color"])]),_:2},1032,["props"]),o(i,{key:"ticket",props:t},{default:l(()=>[o(Q,{modelValue:t.row.ticket,"onUpdate:modelValue":c=>t.row.ticket=c,type:"text",label:"Ticket",filled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),o(i,{key:"picture",props:t,onClick:c=>B(t.row)},{default:l(()=>[t.row.picture!=null?(k(),y(R,{key:0,src:`http://192.168.10.160:1920/Assist/public/storage/${t.row.picture}`,ratio:1.7,"spinner-color":"primary","spinner-size":"20px",style:{width:"100px"}},null,8,["src","ratio"])):(k(),y(q,{key:1,rounded:"",size:"100px","font-size":"52px",color:"white","text-color":"primary",icon:"close"}))]),_:2},1032,["props","onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),o(C,{modelValue:r.value.state,"onUpdate:modelValue":a[3]||(a[3]=t=>r.value.state=t)},{default:l(()=>[o(h,{class:"my-card"},{default:l(()=>[s("img",{src:`http://192.168.10.160:1920/Assist/public/storage/${r.value.val.picture}`},null,8,se),o(_,null,{default:l(()=>[s("div",ie,"Creado: "+n(r.value.val.send_by),1),s("div",ne,"Estado: "+n(r.value.val.status.name),1)]),_:1}),o(_,null,{default:l(()=>[M(n(r.value.val.concept),1)]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(C,{modelValue:m.value,"onUpdate:modelValue":a[6]||(a[6]=t=>m.value=t)},{default:l(()=>[o(h,{class:"my-card"},{default:l(()=>[o(_,null,{default:l(()=>[s("div",re,[de,o(P,{modelValue:p.value,"onUpdate:modelValue":a[4]||(a[4]=t=>p.value=t),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),o(_,null,{default:l(()=>[o(G,{align:"right"},{default:l(()=>[o(x,{flat:"",icon:"close",color:"negative",onClick:a[5]||(a[5]=t=>m.value=!m.value)}),o(x,{flat:"",icon:"check",color:"positive",onClick:F})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Re as default};
