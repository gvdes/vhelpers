import{i as q,r as v,c as D,l as L,q as G,j as $,t as z,u as H,o as w,d as N,w as t,e,I as U,Q as C,ak as i,a0 as d,al as K,f as J,a1 as E,g as O,a2 as V,a3 as B,a4 as W}from"./index.3c2bbbed.js";import{Q as X}from"./QInput.5f51302c.js";import{Q as F,b as Z,a as T,d as S,e as Q}from"./QList.a18075e3.js";import{Q as M}from"./QTable.d65e7d09.js";import{Q as Y}from"./QSpace.75f17f73.js";import{Q as x}from"./QCardSection.18240f4b.js";import{t as ee,j as te,d as ae,a as c}from"./QSelect.81e518b9.js";import{Q as I}from"./QCard.6bdcdcd5.js";import{Q as R}from"./QTd.314b6dd7.js";import{Q as le}from"./QCardActions.dae88955.js";import{Q as re}from"./QPage.ffb44cf3.js";import{C as oe}from"./ClosePopup.4498a15b.js";import"./QDrawer.c0d86729.js";import{c as ne}from"./axios.f65a9a8f.js";import{u as se}from"./use-quasar.c7616765.js";import{c as ie}from"./ClientStore.9a316189.js";import{d as j}from"./dayjs.min.cbcf888d.js";import"./jspdf.plugin.autotable.926cdf09.js";import"./exceljs.min.9e24d01d.js";import"./JsBarcode.cb858474.js";import"./browser.c61f550a.js";import"./QLinearProgress.e15039ed.js";import"./QCheckbox.6d5859d1.js";import"./QResizeObserver.e82a7985.js";import"./QScrollObserver.d12aea82.js";import"./_commonjsHelpers.88e99c8f.js";var A=q({name:"QPopupProxy",props:{...ee,breakpoint:{type:[String,Number],default:450}},emits:["show","hide"],setup(h,{slots:g,emit:u,attrs:p}){const{proxy:_}=z(),{$q:y}=_,b=v(!1),f=v(null),k=D(()=>parseInt(h.breakpoint,10)),{canShow:r}=te({showing:b});function a(){return y.screen.width<k.value||y.screen.height<k.value?"dialog":"menu"}const l=v(a()),o=D(()=>l.value==="menu"?{maxHeight:"99vh"}:{});L(()=>a(),s=>{b.value!==!0&&(l.value=s)});function n(s){b.value=!0,u("show",s)}function m(s){b.value=!1,l.value=a(),u("hide",s)}return Object.assign(_,{show(s){r(s)===!0&&f.value.show(s)},hide(s){f.value.hide(s)},toggle(s){f.value.toggle(s)}}),G(_,"currentComponent",()=>({type:l.value,ref:f.value})),()=>{const s={ref:f,...o.value,...p,onShow:n,onHide:m};let P;return l.value==="dialog"?P=F:(P=ae,Object.assign(s,{target:h.target,contextMenu:h.contextMenu,noParentEvent:!0,separateClosePopup:!0})),$(P,s,g.default)}}});const ue=["src"],Me={__name:"Index",setup(h){H();const g=ie();se(),g.setTitle("Clientes"),g.setShowOption(!1);const u=v({state:!1,val:null}),p=v({columns:[{name:"id",label:"ID",field:r=>r.id,align:"center",sortable:!0},{name:"name",label:"NOMBRE",field:r=>r.name,align:"left",sortable:!0},{name:"celphone",label:"TELEFONO",field:r=>r.phone,align:"left",sortable:!0},{name:"email",label:"CORREO",field:r=>r.email,align:"left",sortable:!0},{name:"credits",label:"CREDITOS",field:r=>{var a;return(a=r.credits)==null?void 0:a.reduce((l,o)=>l+Number(o.total),0)},align:"center",sortable:!0},{name:"tickets",label:"TICKETS",field:r=>{var a,l;return(l=(a=r.credits)==null?void 0:a.map(o=>o.tickets))==null?void 0:l.flat().reduce((o,n)=>o+Number(n.total),0)},align:"center",sortable:!0},{name:"pagos",label:"PAGOS",field:r=>{var a,l;return(l=(a=r.credits)==null?void 0:a.map(o=>o.payments))==null?void 0:l.flat().reduce((o,n)=>o+Number(n.import),0)},align:"center",sortable:!0}],filters:null,pagination:{rowsPerPage:0}}),_=v({columns:[{name:"invoice",label:"Factura",field:r=>r.invoice,align:"left"},{name:"created",label:"Fecha",field:r=>j(r.created_at).format("YYYY-MM-DD"),align:"left"},{name:"reference",label:"Referencia",field:r=>r.reference,align:"left"},{name:"total",label:"Total Credito",field:r=>r.total,align:"center"},{name:"tticket",label:"Total Tickets",field:r=>{var a;return(a=r.tickets)==null?void 0:a.reduce((l,o)=>l+Number(o.total),0)},align:"center"},{name:"tpayment",label:"Total Pagos",field:r=>{var a;return(a=r.payments)==null?void 0:a.reduce((l,o)=>l+Number(o.import),0)},align:"center"},{name:"debe",label:"Deuda",field:r=>{var a;return Number(r.total)-Number((a=r.payments)==null?void 0:a.reduce((l,o)=>l+Number(o.import),0))},align:"center"}]}),y=D(()=>g.clients),b=()=>{},f=()=>{},k=()=>{};return(r,a)=>(w(),N(re,{padding:""},{default:t(()=>[e(M,{rows:y.value,filter:p.value.filters,columns:p.value.columns,onRowClick:a[1]||(a[1]=(l,o)=>{u.value.state=!u.value.state,u.value.val=o}),pagination:p.value.pagination},{"top-right":t(()=>[e(X,{borderless:"",dense:"",debounce:"300",modelValue:p.value.filters,"onUpdate:modelValue":a[0]||(a[0]=l=>p.value.filters=l),placeholder:"Buscar"},{append:t(()=>[e(U,{name:"search"})]),_:1},8,["modelValue"]),e(Z,{spaced:"",inset:"",vertical:"",dark:""}),e(C,{color:"primary",icon:"download",onClick:b,flat:"",rounded:""})]),_:1},8,["rows","filter","columns","pagination"]),e(F,{modelValue:u.value.state,"onUpdate:modelValue":a[2]||(a[2]=l=>u.value.state=l),persistent:""},{default:t(()=>[e(I,{style:{width:"900px","max-width":"100vw"}},{default:t(()=>[e(x,{class:"text-center text-bold text-h5"},{default:t(()=>[i(d(u.value.val.name)+" ",1),e(Y),e(K,{size:"150px"},{default:t(()=>[J("img",{src:`${E(ne)}/client/${u.value.val.picture}`},null,8,ue)]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(T,{bordered:""},{default:t(()=>[e(S,null,{default:t(()=>[e(Q,{class:"text-center"},{default:t(()=>[e(c,null,{default:t(()=>a[3]||(a[3]=[i("Celular")])),_:1}),e(c,null,{default:t(()=>[i(d(u.value.val.phone),1)]),_:1})]),_:1}),e(Q,null,{default:t(()=>[e(c,{class:"text-center"},{default:t(()=>a[4]||(a[4]=[i("Correo")])),_:1}),e(c,null,{default:t(()=>[i(d(u.value.val.email),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(M,{rows:u.value.val.credits,columns:_.value.columns},{"body-cell-tticket":t(l=>[e(R,{props:l},{default:t(()=>{var o;return[i(d(((o=l.row.tickets)==null?void 0:o.reduce((n,m)=>n+Number(m.total),0))||0)+" ",1),e(A,{"transition-show":"scale","transition-hide":"scale"},{default:t(()=>[e(I,{class:"q-pa-sm",style:{"min-width":"250px"}},{default:t(()=>[e(x,{class:"text-bold"},{default:t(()=>a[5]||(a[5]=[i("Tickets")])),_:1}),e(T,{dense:"",bordered:"",separator:""},{default:t(()=>[(w(!0),O(B,null,V(l.row.tickets,(n,m)=>(w(),N(S,{key:m},{default:t(()=>[e(Q,null,{default:t(()=>[e(c,null,{default:t(()=>[i(d(n.ticket),1)]),_:2},1024),e(c,{caption:""},{default:t(()=>[i("Total: "+d(n.total),1)]),_:2},1024)]),_:2},1024),e(Q,null,{default:t(()=>[e(c,null,{default:t(()=>[i(d(E(j)(n.created_at).format("YYYY-MM-DD")),1)]),_:2},1024),e(c,{caption:""},{default:t(()=>[i("Sucursal: "+d(n.workpoint.alias),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]}),_:2},1032,["props"])]),"body-cell-tpayment":t(l=>[e(R,{props:l},{default:t(()=>{var o;return[i(d(((o=l.row.payments)==null?void 0:o.reduce((n,m)=>n+Number(m.import),0))||0)+" ",1),e(A,{"transition-show":"scale","transition-hide":"scale"},{default:t(()=>[e(I,{class:"q-pa-sm",style:{"min-width":"250px"}},{default:t(()=>[e(x,{class:"text-bold"},{default:t(()=>a[6]||(a[6]=[i("Pagos")])),_:1}),e(T,{dense:"",bordered:"",separator:""},{default:t(()=>[(w(!0),O(B,null,V(l.row.payments,(n,m)=>(w(),N(S,{key:m},{default:t(()=>[e(Q,null,{default:t(()=>[e(c,null,{default:t(()=>[i(d(n.counterpart.description),1)]),_:2},1024),e(c,{caption:""},{default:t(()=>[i("Importe: "+d(n.import),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]}),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1}),e(le,{align:"left"},{default:t(()=>[W(e(C,{flat:"",icon:"close",color:"negative"},null,512),[[oe]]),e(Y),e(C,{color:"primary",icon:"picture_as_pdf",flat:"",rounded:"",title:"Generar Pdf",onClick:f}),e(C,{color:"primary",icon:"calculate",flat:"",rounded:"",title:"Generar Excel",onClick:k})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Me as default};
