import{Q as w}from"./QSeparator.2d240015.js";import{r as m,c as T,o as y,a as C,w as s,u as H,e,i as f,a3 as a,Y as $,Q as p,g as M,a0 as P,a1 as z,f as b,a2 as G,a4 as u,a6 as W}from"./index.07617b25.js";import{Q as J}from"./QHeader.c733f1d0.js";import{Q as A,a as i}from"./QItemSection.801410fc.js";import{Q as O}from"./QList.685e9412.js";import{Q as K}from"./QDate.a0d3db60.js";import{Q as N,a as _}from"./QCard.4e9d5c9b.js";import{Q as S}from"./QCardActions.327c4db8.js";import{Q as I}from"./QDialog.33132f10.js";import{Q as R}from"./QSelect.eeb98be9.js";import{Q as X}from"./QInput.0cada53d.js";import{Q as Z}from"./QPage.383cb120.js";import{u as ee}from"./VDB.88cbb2d2.js";import{u as le}from"./use-quasar.69149e48.js";import"./jspdf.plugin.autotable.2fa6b80f.js";import{t as D}from"./transferApi.ae8ea540.js";import"./exceljs.min.9e24d01d.js";import"./browser.94c942de.js";import{d as se}from"./dayjs.min.25545ff6.js";import{_ as oe}from"./UserToolbar.7fb5a57a.js";import"./QResizeObserver.88267b3e.js";import"./use-cache.b0833c75.js";import"./use-key-composition.9e872a4a.js";import"./uid.42677368.js";import"./date.1b364f52.js";import"./position-engine.479304e9.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.d0e8637f.js";import"./axios.f1f32898.js";import"./ClosePopup.00946d1e.js";const te={class:"row justify-between"},ae=f("span",{class:"text-h6"},"Traspasos entre Almacenes",-1),ne={class:"q-pa-md"},ie=f("div",{class:"q-pb-sm"},null,-1),qe={__name:"Index",setup(re){const x=H(),r=ee(),d=le(),c=m(!1),v=m(null),g=m(!1),Q=m([]),V=m([]),n=m({_origin:null,_destiny:null,notes:null}),h=T(()=>n.value._origin&&n.value._destiny&&n.value.notes),k=T(()=>r.session.rol!=="alm"?V.value.filter(t=>[1,2,3,4].includes(t.id)):V.value.filter(t=>[5,6].includes(t.id))),U=async()=>{console.log("Recibiendo Datos :)"),d.loading.show({message:"Obteniendo Datos"});let t=r.session.store.id;const o=await D.index(t);o.error?console.log(o):(console.log(o),Q.value=o.transfer,V.value=o.warehouses,d.loading.hide())},B=async()=>{d.loading.show({message:"Creando Traspaso"}),n.value.created_by=r.session.name,n.value._store=r.session.store.id,console.log(n.value);const t=await D.addTransfer(n.value);t.error?(console.log(t),d.notify({message:"No se logro crear el traspaso",position:"center",type:"negative"})):(d.loading.hide(),d.notify({message:`Traspaso ${t.code_fs} creada`,position:"center",type:"positive"}),x.push(`transfers/${t.id}`))},E=()=>{g.value=!1,n.value={_origin:null,_destiny:null,notes:null}},Y=t=>t.id===n.value._origin.id||r.session.rol!=="aud"&&t.id===4,L=t=>(console.log(t),r.session.rol!="aud"&&t.id==4),q=async()=>{console.log(v.value),d.loading.show({message:"Obteniendo Datos"});let o={store:r.session.store.id,date:v.value};console.log("Recibiendo Datos :)");const l=await D.getDate(o);l.fail?console.log(l):(console.log(l),Q.value=l,d.loading.hide(),v.value=null,c.value=!1)},j=t=>{console.log(t);let o=t.id;console.log(t.origin.id!==4&&t.destiny.id!==4),r.session.rol=="aud"?x.push(`transfers/${o}`):(r.session.rol=="aux"||r.session.rol=="gen")&&t.origin.id!==4&&t.destiny.id!==4?x.push(`transfers/${o}`):r.session.rol=="alm"&&([5,6].includes(t.destiny.id)||[5,6].includes(t.origin.id))?x.push(`transfers/${o}`):d.notify({message:"No tienes acceso a este traspaso",type:"negative",position:"center"})};return U(),(t,o)=>(y(),C(Z,{padding:""},{default:s(()=>[e(J,{class:"transparent text-dark",bordered:""},{default:s(()=>[e(oe),e(w),f("div",te,[f("div",null,[a("Helpers "),e($,{name:"navigate_next",color:"primary"}),a(),ae]),f("div",null,[e(p,{color:"primary",icon:"add",flat:"",onClick:o[0]||(o[0]=l=>g.value=!g.value),round:""}),e(p,{color:"primary",icon:"event",onClick:o[1]||(o[1]=l=>c.value=!c.value),flat:"",round:""})])]),e(w)]),_:1}),e(O,null,{default:s(()=>[e(A,null,{default:s(()=>[e(i,{class:"text-center"},{default:s(()=>[a("ID")]),_:1}),e(i,{class:"text-center"},{default:s(()=>[a("CREADO")]),_:1}),e(i,{class:"text-center"},{default:s(()=>[a("CREADO POR")]),_:1}),e(i,{class:"text-center"},{default:s(()=>[a("NOTAS")]),_:1}),e(i,{class:"text-center"},{default:s(()=>[a("ORIGEN")]),_:1}),e(i,{class:"text-center"},{default:s(()=>[a("DESTINO")]),_:1}),e(i,{class:"text-center"},{default:s(()=>[a("FACTUSOL")]),_:1}),e(i,{class:"text-center"},{default:s(()=>[a("ARTICULOS")]),_:1})]),_:1})]),_:1}),e(w,{spaced:"",inset:"",vertical:"",dark:""}),(y(!0),M(z,null,P(Q.value,(l,F)=>(y(),C(O,{bordered:"",key:F},{default:s(()=>[G((y(),C(A,{clickable:"",onClick:de=>j(l)},{default:s(()=>[e(i,{class:"text-center"},{default:s(()=>[a(u(l.id),1)]),_:2},1024),e(i,{class:"text-center"},{default:s(()=>[a(u(b(se)(l.created_at).format("YYYY-MM-D")),1)]),_:2},1024),e(i,{class:"text-center"},{default:s(()=>[a(u(l.created_by),1)]),_:2},1024),e(i,{class:"text-center"},{default:s(()=>[a(u(l.notes),1)]),_:2},1024),e(i,{class:"text-center"},{default:s(()=>[a(u(l.origin.alias),1)]),_:2},1024),e(i,{class:"text-center"},{default:s(()=>[a(u(l.destiny.alias),1)]),_:2},1024),e(i,{class:"text-center"},{default:s(()=>[a(u(l.code_fs),1)]),_:2},1024),e(i,{class:"text-center"},{default:s(()=>[a(u(l.bodie.length),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[W]])]),_:2},1024))),128)),e(I,{modelValue:c.value,"onUpdate:modelValue":o[4]||(o[4]=l=>c.value=l)},{default:s(()=>[e(N,{class:"my-card"},{default:s(()=>[e(_,null,{default:s(()=>[f("div",ne,[ie,e(K,{modelValue:v.value,"onUpdate:modelValue":o[2]||(o[2]=l=>v.value=l),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),e(_,null,{default:s(()=>[e(S,{align:"right"},{default:s(()=>[e(p,{flat:"",icon:"close",color:"negative",onClick:o[3]||(o[3]=l=>c.value=!c.value)}),e(p,{flat:"",icon:"check",color:"positive",onClick:q})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(I,{modelValue:g.value,"onUpdate:modelValue":o[9]||(o[9]=l=>g.value=l),persistent:""},{default:s(()=>[e(N,{style:{width:"700px","max-width":"80vw"}},{default:s(()=>[e(_,{class:"text-h5 text-bold text-center"},{default:s(()=>[a(" Nuevo Traspaso ")]),_:1}),e(_,{class:"row items-center"},{default:s(()=>[e(R,{modelValue:n.value._origin,"onUpdate:modelValue":[o[5]||(o[5]=l=>n.value._origin=l),o[6]||(o[6]=l=>n.value._destiny=null)],options:b(k),label:"Almacen Origen",class:"col","option-label":"name","option-disable":l=>L(l)},null,8,["modelValue","options","option-disable"]),e($,{name:"arrow_forward",class:"col",size:"md"}),e(R,{modelValue:n.value._destiny,"onUpdate:modelValue":o[7]||(o[7]=l=>n.value._destiny=l),options:b(k),label:"Almacen Destino",class:"col","option-label":"name","option-disable":l=>Y(l),disable:n.value._origin==null},null,8,["modelValue","options","option-disable","disable"])]),_:1}),e(_,null,{default:s(()=>[e(X,{modelValue:n.value.notes,"onUpdate:modelValue":o[8]||(o[8]=l=>n.value.notes=l),type:"text",label:"Notas"},null,8,["modelValue"])]),_:1}),e(S,{align:"center"},{default:s(()=>[e(p,{flat:"",label:"Cancelar",color:"negative",onClick:E}),e(p,{flat:"",label:"Crear",color:"positive",onClick:B,disable:!b(h)},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{qe as default};
