import{Q as p}from"./QInput.becc7b73.js";import{Q as w,a as Q}from"./QSelect.26d74289.js";import{a as S,b as D}from"./QSeparator.71b2bdf4.js";import{Q as B}from"./QTooltip.3694dd3f.js";import{i as R,s as N,M as A,aU as E,r as V,c as I,o as i,a as c,w as t,f as r,e as a,aD as L,aE as P,a6 as f,a0 as d,Q as u,h as _,F as T,g as F,a4 as $,a3 as j}from"./index.2755a6d2.js";import{Q as z}from"./QImg.af088f27.js";import{Q as M}from"./QUploader.a406b0e4.js";import{Q as h}from"./QForm.2b66e0c9.js";import{Q as J}from"./QPage.823ea121.js";import{u as K}from"./VDB.a2fb4ba7.js";import"./QList.dc07f2ef.js";import"./QDrawer.aa33fd96.js";import{u as O}from"./use-quasar.f671fe44.js";import"./QCardActions.d47f4c8c.js";import"./ClosePopup.5ffcc6e3.js";import"./axios.0d2bd0f9.js";import{d as G}from"./deposits.65b8c1ff.js";import"./jspdf.plugin.autotable.2e1bd0a9.js";import"./exceljs.min.9e24d01d.js";import"./browser.a927a609.js";import{$socket as m}from"./socket.e8679fa2.js";import"./QResizeObserver.683c7686.js";import"./QScrollObserver.d1f7f033.js";import"./_commonjsHelpers.88e99c8f.js";var H=R({name:"QUploaderAddTrigger",setup(){const v=N(E,A);return v===A&&console.error("QUploaderAddTrigger needs to be child of QUploader"),v}});const W={class:"flex justify-center"},X={class:"row no-wrap items-center q-pa-sm q-gutter-xs"},Y={class:"col"},Z={class:"q-uploader__subtitle"},ee={class:"row"},oe={class:"text-overline"},le={class:"flex justify-center"},xe={__name:"Form",setup(v){const g=K(),b=O();m.connect(),m.emit("paramscon",g),m.on("Room",n=>{console.log(`Joined room ${n}`)}),m.on("disconnect",()=>{console.log("%c No hay conexion en el socket ","background: #222; color: #bada55")});const U=V([{id:1,name:"0110292745",bank:"BBVA"},{id:2,name:"0110292974",bank:"BBVA"},{id:3,name:"0110292834",bank:"BBVA"},{id:4,name:"0110292761",bank:"BBVA"},{id:5,name:"0110292982",bank:"BBVA"},{id:6,name:"0110293040",bank:"BBVA"},{id:7,name:"0473998967",bank:"BBVA"},{id:8,name:"0110292729",bank:"BBVA"}]),y=V(null),e=V({origin:null,destiny:null,reference:null,concepto:null,amount:null,files:[]}),k=()=>{e.value={origin:null,destiny:null,reference:null,concepto:null,amount:null,files:[]},y.value.reset()},x=I(()=>e.value.origin&&e.value.destiny&&e.value.reference&&e.value.concepto&&e.value.amount&&e.value.files.length>0),C=n=>{e.value.files=n,console.log("Archivos a\xF1adidos:",e.value.files)},q=async()=>{b.loading.show({message:"Enviando Formulario"});const n=new FormData;n.append("origin",e.value.origin),n.append("destiny",e.value.destiny.name),n.append("reference",e.value.reference),n.append("concepto",e.value.concepto),n.append("amount",e.value.amount),n.append("_store",g.session.store.id),n.append("send_by",g.session.name),e.value.files.forEach((o,s)=>{n.append(`file_${s}`,o),console.log(e.value.files)});const l=await G.newForm(n);l.fail?console.log(l):(console.log(l),b.loading.hide(),m.emit("Create",l.insert),b.notify({type:"positive",message:l.message}),k())};return(n,l)=>(i(),c(J,{padding:""},{default:t(()=>[r("div",W,[a(h,{onSubmit:q,onReset:k,class:"q-gutter-md"},{default:t(()=>[a(p,{modelValue:e.value.origin,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value.origin=o),type:"number",label:"Cuenta Origen",filled:"",dense:""},null,8,["modelValue"]),a(w,{modelValue:e.value.destiny,"onUpdate:modelValue":l[1]||(l[1]=o=>e.value.destiny=o),options:U.value,label:"Cuenta Destino",filled:"",dense:"","option-label":"name","option-value":"name"},{option:t(o=>[a(S,L(P(o.itemProps)),{default:t(()=>[a(D,null,{default:t(()=>[a(Q,null,{default:t(()=>[f(d(o.opt.name),1)]),_:2},1024),a(Q,{caption:""},{default:t(()=>[f(d(o.opt.bank),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),a(p,{modelValue:e.value.concepto,"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.concepto=o),type:"text",label:"Referencia",filled:"",dense:""},null,8,["modelValue"]),a(p,{modelValue:e.value.reference,"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.reference=o),type:"number",label:"Referencia Numerica / Folio",filled:"",dense:""},null,8,["modelValue"]),a(p,{modelValue:e.value.amount,"onUpdate:modelValue":l[4]||(l[4]=o=>e.value.amount=o),type:"number",label:"Monto",filled:"",dense:""},null,8,["modelValue"]),a(M,{modelValue:e.value.files,"onUpdate:modelValue":l[6]||(l[6]=o=>e.value.files=o),accept:"image/*","auto-upload":!1,onAdded:C,ref_key:"refe",ref:y},{header:t(o=>[r("div",X,[o.queuedFiles.length>0?(i(),c(u,{key:0,icon:"clear_all",onClick:l[5]||(l[5]=()=>{y.value.reset(),e.value.files=[]}),round:"",dense:"",flat:""},{default:t(()=>[a(B,null,{default:t(()=>l[7]||(l[7]=[f("Limpiar")])),_:1})]),_:1})):_("",!0),o.isUploading?(i(),c(T,{key:1,class:"q-uploader__spinner"})):_("",!0),r("div",Y,[l[8]||(l[8]=r("div",{class:"q-uploader__title"},"Subir Archivo",-1)),r("div",Z,d(o.uploadSizeLabel)+" / "+d(o.uploadProgressLabel),1)]),o.canAddFiles?(i(),c(u,{key:2,type:"a",icon:"add_box",onClick:o.pickFiles,round:"",dense:"",flat:""},{default:t(()=>[a(H),a(B,null,{default:t(()=>l[9]||(l[9]=[f("Subir Archivo")])),_:1})]),_:2},1032,["onClick"])):_("",!0)])]),list:t(o=>[(i(!0),F(j,null,$(o.files,s=>(i(),F("div",{key:s.__key},[r("div",ee,[a(z,{src:s.__img.src,ratio:20/8,"spinner-color":"primary","spinner-size":"82px",class:"col"},null,8,["src"]),a(u,{color:"negative",icon:"delete",onClick:()=>{o.removeFile(s),e.value.files=[]},flat:"",rounded:""},null,8,["onClick"])]),r("div",oe,d(s.name),1)]))),128))]),_:1},8,["modelValue"]),r("div",le,[a(u,{label:"Cancelar",type:"reset",color:"primary",flat:"",class:"q-ml-sm"}),a(u,{label:"Enviar",type:"submit",color:"primary",flat:"",disable:!x.value},null,8,["disable"])])]),_:1})])]),_:1}))}};export{xe as default};
