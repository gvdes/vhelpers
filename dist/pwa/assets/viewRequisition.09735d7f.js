import{u as F,f as M,Z as X,r as g,g as b,o as Z,y as z,a as r,c as w,d as e,i as a,a6 as G,a3 as V,k as H,m as h,h as C,a4 as D,p as q,n as Q,j as n,a2 as I,Q as J,l as L,a5 as K,aX as W,a1 as m}from"./index.7b36b598.js";import{Q as k,a as B,b as u}from"./QList.912e2662.js";import{Q as Y}from"./QPage.4fad267d.js";import{C as ee}from"./ClosePopup.8d8b6328.js";import{u as te}from"./use-quasar.d212ba29.js";import{u as ae}from"./layoutStore.12ceff03.js";import{r as R}from"./requisitionApi.72dcc9ce.js";import{i as le}from"./resoursesApi.9aa33a08.js";import"./axios.59d61e02.js";const oe={class:"row"},ve={__name:"viewRequisition",setup(se){const U=F(),f=te(),$=M(),N=X(),c=g(!1),i=ae(),_=N.params.oid,d=g(null),p=g([]),v=g(""),y=b(()=>v.value.length<=0?p.value:p.value.filter(l=>l.description.toLowerCase().includes(v.value.toLowerCase()))),S=b(()=>y.value.some(l=>l.amount>0)),x=b(()=>y.value.filter(l=>l.amount>0)),O=async()=>{f.loading.show({message:"Obteniendo Datos"});const l=await R.getRequisition(U.session.store.id,_);l.status!==200?console.log(l):(f.loading.hide(),console.log(l),d.value=l.data,T(),i.setTitle(`${l.data.notes||_}`),i.setShowCreateButton(!1),i.setShowOrders(!1))},T=async()=>{const l=await le.getAssortmentInsumos();l.error?console.log(l):(console.log(l),p.value=l,d.value.bodie.length>0&&p.value.forEach(t=>{const o=d.value.bodie.find(s=>s.code===t.code);console.log(o),o?t.amount=o.amount:t.amount=0}))},A=async()=>{f.loading.show({message:"Cerrando Pedido"});let l={id:_,products:x.value};const t=await R.finishRequisition(l);t.status!=200?console.log(t):($.push("/assortment"),f.loading.hide())};return Z(()=>{O()}),z(()=>{i.setTitle("Pedidos Insumos"),i.setShowCreateButton(!0),i.setShowOrders(!0)}),(l,t)=>(r(),w(V,null,[e(Y,{padding:""},{default:a(()=>{var o;return[H("div",oe,[e(h,{class:"col",modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=s=>v.value=s),type:"text",label:"Buscar",filled:"",dense:""},null,8,["modelValue"]),S.value?(r(),C(D,{key:0,spaced:"",inset:"",vertical:"",dark:""})):q("",!0),S.value?(r(),C(Q,{key:1,color:"primary",flat:"",dense:"",icon:"send",onClick:t[1]||(t[1]=s=>c.value=!c.value),disable:((o=d.value)==null?void 0:o._status)>1},null,8,["disable"])):q("",!0)]),e(D,{spaced:"",inset:"",vertical:"",dark:""}),e(k,null,{default:a(()=>[e(B,null,{default:a(()=>[e(u,null,{default:a(()=>t[3]||(t[3]=[n("Codigo")])),_:1}),e(u,null,{default:a(()=>t[4]||(t[4]=[n("Descripcion")])),_:1}),e(u,null,{default:a(()=>t[5]||(t[5]=[n("Cantidad")])),_:1})]),_:1})]),_:1}),(r(!0),w(V,null,I(y.value,(s,E)=>(r(),C(k,{bordered:"",key:E},{default:a(()=>[e(B,null,{default:a(()=>[e(u,null,{default:a(()=>[n(m(s.code),1)]),_:2},1024),e(u,null,{default:a(()=>[n(m(s.description),1)]),_:2},1024),e(u,null,{default:a(()=>{var P;return[e(h,{modelValue:s.amount,"onUpdate:modelValue":j=>s.amount=j,type:"number",filled:"",disable:((P=d.value)==null?void 0:P._status)>1},null,8,["modelValue","onUpdate:modelValue","disable"])]}),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]}),_:1}),e(G,{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=o=>c.value=o),persistent:""},{default:a(()=>[e(J,{style:{width:"500px"}},{default:a(()=>[e(L,{class:"text-bold text-h6 text-center"},{default:a(()=>t[6]||(t[6]=[n(" Se Creara Pedido ")])),_:1}),e(L,null,{default:a(()=>[(r(!0),w(V,null,I(x.value,(o,s)=>(r(),C(k,{key:s,bordered:""},{default:a(()=>[e(B,null,{default:a(()=>[e(u,null,{default:a(()=>[n(m(o.code),1)]),_:2},1024),e(u,null,{default:a(()=>[n(m(o.description),1)]),_:2},1024),e(u,null,{default:a(()=>[n(m(o.amount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(K,{align:"right"},{default:a(()=>[W(e(Q,{flat:"",label:"Cancel",color:"primary"},null,512),[[ee]]),e(Q,{flat:"",label:"Crear",color:"primary",onClick:A})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{ve as default};
