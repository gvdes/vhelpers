import{b,a as S,d as $,e as c,Q as X}from"./QList.ad92ec23.js";import{Q as Z}from"./QHeader.041f94f5.js";import{aW as j,a as ee,u as te,r as R,c as C,aX as le,o as k,d as w,w as l,e,f as s,S as D,h as V,Q as A,a0 as o,ak as ae,al as d,a4 as P,aE as se,g as I,an as oe,a2 as K,a3 as O}from"./index.c2f5f4e3.js";import{Q as de,a as m}from"./QSelect.2047fd6e.js";import{Q as re}from"./QToolbar.d547e887.js";import{Q as r}from"./QCardSection.fed8a97e.js";import{Q as g}from"./QCard.7cc3dc50.js";import{Q as ne}from"./QInput.d5f95cb2.js";import{Q as ie}from"./QBadge.1df5a220.js";import{Q as ue}from"./QLinearProgress.789a8ffd.js";import{a as ce}from"./QExpansionItem.e926aa81.js";import{Q as me}from"./QTable.41d37387.js";import{Q as ve,a as fe}from"./QLayout.99a64f83.js";import"./auto.deb582f4.js";import{u as xe}from"./use-quasar.39f9e42d.js";import"./dayjs.min.cbcf888d.js";import{E as be}from"./exceljs.min.9e24d01d.js";import{_ as pe}from"./UserToolbar.0659b2f7.js";import{A as q}from"./assistApi.f38523ed.js";import"./use-key-composition.a7b75bd7.js";import"./QResizeObserver.121c3205.js";import"./QCheckbox.d16d5612.js";import"./use-checkbox.7e1bd460.js";import"./QScrollObserver.e23a7fbb.js";import"./_commonjsHelpers.88e99c8f.js";import"./QDrawer.0e1edfa0.js";import"./QCardActions.d49ddb1a.js";import"./ClosePopup.8bd06445.js";import"./auth.4421878e.js";import"./axios.ea4a1dc9.js";const _e={class:"row"},ke={class:"text-bold text-h6 q-ml-md"},ge={class:"text-h4 text-center"},we={class:"text-h4 text-center"},ye={class:"text-h4 text-center"},Ne={class:"text-h4 text-center"},he={class:"text-h4 text-center"},Fe={class:"text-h4 text-center"},Te={class:"text-h4 text-center"},$e={class:"text-h4 text-center"},Ce={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition"},Ve={class:"text-bold"},Qe={class:"text-overline"},Ee={class:"q-pa-sm flex justify-start"},Se={class:"absolute-full flex flex-center"},Re={key:0,class:""},De={class:"text-h6"},Ae={class:"text-subtitle2"},Ie={class:"text-h5 text-center"},Be={class:"text-h5 text-center"},Le={class:"text-h5 text-center"},He={class:"text-h5 text-center"},Pe={class:"text-h5 text-center"},Ke={class:"text-h5 text-center"},Oe={class:"text-h5 text-center"},qe={class:"text-h5 text-center"},Ue={class:"text-h5 text-center"},ze={class:"text-h5 text-center"},Nt={__name:"SaleStore",setup(Me){const N=xe();j(),ee(),te();const p=R([]),Q=R({pagination:{rowsPerPage:0},filter:""}),i=R({state:!1,val:null}),h=R({val:null}),B=[{id:1,label:"Enero"},{id:2,label:"Febrero"},{id:3,label:"Marzo"},{id:4,label:"Abril"},{id:5,label:"Mayo"},{id:6,label:"Junio"},{id:7,label:"Julio"},{id:8,label:"Agosto"},{id:9,label:"Septiembre"},{id:10,label:"Octubre"},{id:11,label:"Noviembre"},{id:12,label:"Diciembre"}],F=C(()=>N.platform.is.mobile),U=C(()=>Number(p.value.reduce((v,t)=>{var f;return v+Number(((f=t.sales)==null?void 0:f.salesant)*1.1||0)},0)).toFixed(2)),z=C(()=>Number(p.value.reduce((v,t)=>{var f;return v+Number(((f=t.sales)==null?void 0:f.salesact)||0)},0)).toFixed(2)),M=C(()=>Number(p.value.reduce((v,t)=>{var f,a;return v+Number(((f=t.sales)==null?void 0:f.salesact)-((a=t.sales)==null?void 0:a.salesant)*1.1||0)},0)).toFixed(2)),L=C(()=>Number(p.value.reduce((v,t)=>{var f;return v+Number(((f=t.sales)==null?void 0:f.saleshoy)||0)},0)).toFixed(2)),H=async()=>{const t=new Date().getMonth()+1;h.value.val=B.filter(a=>a.id===t)[0],N.loading.show({message:"Cargando Informacion"}),console.log("se inicia el init");const f=await q.GetReportVhelp(t);f.error?console.log(f):(console.log(f),p.value=f,N.loading.hide())};H();const Y=async()=>{p.value=[],N.loading.show({message:"Obteniendo Datos"});const v=await q.GetReportVhelp(h.value.val.id);v.error?console.log(v):(console.log(v),p.value=v,N.loading.hide())},J=v=>{i.value.state=!0,i.value.val=v,console.log(v)},W=async()=>{const v=new be.Workbook,t=v.addWorksheet("Venta");console.log(),t.addTable({name:"Venta",ref:"A1",headerRow:!0,totalsRow:!0,style:{showRowStripes:!0},columns:[{name:"Sucursal",filterButton:!0},{name:"Total",filterButton:!0,totalsRowFunction:"sum"},{name:"Tickets",filterButton:!0,totalsRowFunction:"sum"}],rows:p.value.map(u=>{var _,y;return[u.name,Number((_=u.sales)==null?void 0:_.saleshoy),Number((y=u.sales)==null?void 0:y.hoytck)]})}),t.columns.forEach(u=>{let _=0;u.eachCell({includeEmpty:!0},y=>{const E=y.value?y.value.toString().length:10;E>_&&(_=E)}),u.width=_<10?10:_}),t.getRow(1).eachCell(u=>{u.font={bold:!0}});const f=2,a=p.value.length+2;for(let u=f;u<a;u++)t.getRow(u).eachCell(_=>{_.font={bold:!0}});t.getRow(a).eachCell(u=>{u.font={size:12,bold:!0},u.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFF00"}}});const n=2;t.getColumn(n).numFmt='"$"#,##0.00',t.getCell(`B${a}`).numFmt='"$"#,##0.00',(async()=>{const _=new Date().toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}),y=await v.xlsx.writeBuffer(),E=new Blob([y],{type:"application/octet-stream"}),G=URL.createObjectURL(E),T=document.createElement("a");T.href=G,T.download=`Ventas${_}.xlsx`,document.body.appendChild(T),T.click(),document.body.removeChild(T)})()};return(v,t)=>{const f=le("router-view");return k(),w(ve,{view:"hHh Lpr fFf"},{default:l(()=>[e(fe,{class:"q-ml-md"},{default:l(()=>[e(Z,{class:"bg-grey-3 text-dark",bordered:""},{default:l(()=>[e(pe),e(b)]),_:1}),e(re,{class:"justify-between"},{default:l(()=>[s("div",null,[t[3]||(t[3]=s("span",{class:"text-grey"},"Helpers",-1)),e(D,{name:"navigate_next",color:"primary"}),t[4]||(t[4]=s("span",{class:"text-h6"},"Ventas Sucursales",-1))]),s("div",_e,[F.value?V("",!0):(k(),w(de,{key:0,modelValue:h.value.val,"onUpdate:modelValue":[t[0]||(t[0]=a=>h.value.val=a),Y],options:B,label:"mes",outlined:"",dense:""},null,8,["modelValue"])),e(A,{dense:"",flat:"",color:"primary",icon:"autorenew",onClick:H})])]),_:1}),e(b,{spaced:"",inset:"",vertical:"",dark:""}),s("div",ke,o(h.value.val.label),1),e(b,{spaced:"",inset:"",vertical:"",dark:""}),s("div",{class:ae(F.value?"":"row")},[F.value?V("",!0):(k(),w(g,{key:0,class:"my-card col",bordered:"",dense:""},{default:l(()=>[e(r,null,{default:l(()=>[t[5]||(t[5]=s("div",{class:"text-h6 text-center"},"Ventas 2024",-1)),s("div",ge,o(U.value.replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[6]||(t[6]=s("div",{class:"text-h6 text-center"},"Tickets 2024",-1)),s("div",we,o(Number(p.value.reduce((a,n)=>{var x;return a+Number(((x=n.sales)==null?void 0:x.tiketsant)||0)},0)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1})),e(b,{spaced:"",inset:"",vertical:"",dark:""}),F.value?V("",!0):(k(),w(g,{key:1,class:"my-card col",bordered:"",dense:""},{default:l(()=>[e(r,null,{default:l(()=>[t[7]||(t[7]=s("div",{class:"text-h6 text-center"},"Ventas 2025",-1)),s("div",ye,o(z.value.replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[8]||(t[8]=s("div",{class:"text-h6 text-center"},"Tickets 2025",-1)),s("div",Ne,o(Number(p.value.reduce((a,n)=>{var x;return a+Number(((x=n.sales)==null?void 0:x.tiketsact)||0)},0)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1})),e(b,{spaced:"",inset:"",vertical:"",dark:""}),F.value?V("",!0):(k(),w(g,{key:2,class:"my-card col",bordered:"",dense:""},{default:l(()=>[e(r,null,{default:l(()=>[t[9]||(t[9]=s("div",{class:"text-h6 text-center"},"Diferencia",-1)),s("div",he,o(M.value.replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[10]||(t[10]=s("div",{class:"text-h6 text-center"},"Diferencia Tickets",-1)),s("div",Fe,o(Number(p.value.reduce((a,n)=>{var x,u;return a+Number(((x=n.sales)==null?void 0:x.tiketsact)-((u=n.sales)==null?void 0:u.tiketsant)||0)},0)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1})),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(g,{class:"my-card col",bordered:"",dense:""},{default:l(()=>[e(r,null,{default:l(()=>[t[11]||(t[11]=s("div",{class:"text-h6 text-center"},"VENTAS HOY",-1)),s("div",Te,o(L.value.replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[12]||(t[12]=s("div",{class:"text-h6 text-center"},"Tickets HOY",-1)),s("div",$e,o(p.value.reduce((a,n)=>{var x;return a+Number(((x=n.sales)==null?void 0:x.hoytck)||0)},0)),1)]),_:1})]),_:1})],2),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(me,{title:"Sucursales",rows:p.value.sort((a,n)=>{var x,u;return((x=n.sales)==null?void 0:x.saleshoy)-((u=a.sales)==null?void 0:u.saleshoy)}),"row-key":"id",pagination:Q.value.pagination,filter:Q.value.filter,"hide-header":""},{"top-right":l(()=>[e(ne,{borderless:"",dense:"",debounce:"300",modelValue:Q.value.filter,"onUpdate:modelValue":t[1]||(t[1]=a=>Q.value.filter=a),placeholder:"Buscar"},{append:l(()=>[e(D,{name:"search"})]),_:1},8,["modelValue"]),e(A,{color:"primary",icon:"ios_share",flat:"",onClick:W})]),body:l(a=>[s("div",Ce,[e(S,{bordered:"",dense:""},{default:l(()=>[e($,null,{default:l(()=>[e(c,null,{default:l(()=>[e(m,{class:"flex justify-between"},{default:l(()=>{var n;return[s("div",Ve,o(a.row.name),1),s("div",Qe,[d(o(`Tickets ${(n=a.row.sales)==null?void 0:n.hoytck}`)+" ",1),e(A,{color:"grey",flat:"",dense:"",icon:a.expand?"keyboard_arrow_up":"keyboard_arrow_down",onClick:x=>a.expand=!a.expand},null,8,["icon","onClick"])])]}),_:2},1024),e(m,null,{default:l(()=>{var n;return[s("div",Ee,[e(ue,{value:Number((n=a.row.sales)==null?void 0:n.saleshoy)/Number(L.value),buffer:1,size:"20px"},{default:l(()=>{var x;return[s("div",Se,[e(ie,{color:"white","text-color":"accent",label:`$ ${Number((x=a.row.sales)==null?void 0:x.saleshoy).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")}`},null,8,["label"])])]}),_:2},1032,["value"])])]}),_:2},1024)]),_:2},1024)]),_:2},1024),e(ce,null,{default:l(()=>[a.row.sales?P((k(),I("div",Re,[e(b),P((k(),w($,{class:"text-center",dense:"",clickable:"",onClick:n=>J(a.row)},{default:l(()=>[e(c,null,{default:l(()=>[e(m,{overline:""},{default:l(()=>t[13]||(t[13]=[d("VENTAS 2024")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(Number(a.row.sales.salesant*1.1).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(m,{overline:""},{default:l(()=>t[14]||(t[14]=[d("TICKETS 2024")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(a.row.sales.tiketsant),1)]),_:2},1024)]),_:2},1024),e(c,null,{default:l(()=>[e(m,{overline:""},{default:l(()=>t[15]||(t[15]=[d("Promedio 2024")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(Number(Number(a.row.sales.salesant*1.1)/Number(a.row.sales.tiketsant)).toFixed(2)),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""})]),_:2},1024),e(c,null,{default:l(()=>[e(m,{overline:""},{default:l(()=>t[16]||(t[16]=[d("VENTAS 2025")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(Number(a.row.sales.salesact).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(m,{overline:""},{default:l(()=>t[17]||(t[17]=[d("TICKETS 2025")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(a.row.sales.tiketsact),1)]),_:2},1024)]),_:2},1024),e(c,null,{default:l(()=>[e(m,{overline:""},{default:l(()=>t[18]||(t[18]=[d("Promedio 2025 ")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(Number(Number(a.row.sales.salesact)/Number(a.row.sales.tiketsact)).toFixed(2)),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""})]),_:2},1024),e(c,null,{default:l(()=>[e(m,{overline:""},{default:l(()=>t[19]||(t[19]=[d("DIFERENCIA")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o((Number(a.row.sales.salesact).toFixed(2)-Number(a.row.sales.salesant*1.1).toFixed(2)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(m,{overline:""},{default:l(()=>t[20]||(t[20]=[d("DIFERENCIA TICKETS")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(a.row.sales.tiketsact-a.row.sales.tiketsant),1)]),_:2},1024)]),_:2},1024),e(c,null,{default:l(()=>[e(m,{overline:""},{default:l(()=>t[21]||(t[21]=[d("VENTA HOY ")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(Number(a.row.sales.saleshoy).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(m,{overline:""},{default:l(()=>t[22]||(t[22]=[d("TICKETS HOY")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(a.row.sales.hoytck),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[oe]])],512)),[[se,a.expand]]):V("",!0)]),_:2},1024)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""})])]),_:1},8,["rows","pagination","filter"]),e(X,{modelValue:i.value.state,"onUpdate:modelValue":t[2]||(t[2]=a=>i.value.state=a),"full-width":""},{default:l(()=>[e(g,{class:"my-card"},{default:l(()=>[e(r,null,{default:l(()=>[s("div",De,o(i.value.val.name),1),s("div",Ae,o(i.value.val.alias),1)]),_:1}),e(r,{class:"row"},{default:l(()=>[e(g,{class:"my-card col"},{default:l(()=>[e(r,null,{default:l(()=>[t[23]||(t[23]=s("div",{class:"text-h6 text-center"},"Ventas 2023",-1)),s("div",Ie,o(Number(i.value.val.sales.salesant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[24]||(t[24]=s("div",{class:"text-h6 text-center"},"Tickets 2023",-1)),s("div",Be,o(Number(i.value.val.sales.tiketsant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[25]||(t[25]=s("div",{class:"text-h6 text-center"},"Tickets Promedio 2023",-1)),s("div",Le,o(Number(i.value.val.sales.salesant/i.value.val.sales.tiketsant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1}),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(g,{class:"my-card col"},{default:l(()=>[e(r,null,{default:l(()=>[t[26]||(t[26]=s("div",{class:"text-h6 text-center"},"Ventas 2024",-1)),s("div",He,o(Number(i.value.val.sales.salesact).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[27]||(t[27]=s("div",{class:"text-h6 text-center"},"Tickets 2024",-1)),s("div",Pe,o(Number(i.value.val.sales.tiketsact).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[28]||(t[28]=s("div",{class:"text-h6 text-center"},"Tickets Promedio 2024",-1)),s("div",Ke,o(Number(i.value.val.sales.salesact/i.value.val.sales.tiketsact).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1}),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(g,{class:"my-card col"},{default:l(()=>[e(r,null,{default:l(()=>[t[29]||(t[29]=s("div",{class:"text-h6 text-center"},"Diferencias",-1)),s("div",Oe,o(Number(i.value.val.sales.salesact-i.value.val.sales.salesant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[30]||(t[30]=s("div",{class:"text-h6 text-center"},"Diferencia Tickts",-1)),s("div",qe,o(Number(i.value.val.sales.tiketsact-i.value.val.sales.tiketsant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1}),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(g,{class:"my-card col"},{default:l(()=>[e(r,null,{default:l(()=>[t[31]||(t[31]=s("div",{class:"text-h6 text-center"},"Ventas Hoy",-1)),s("div",Ue,o(Number(i.value.val.sales.saleshoy).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[32]||(t[32]=s("div",{class:"text-h6 text-center"},"Tickets Hoy",-1)),s("div",ze,o(Number(i.value.val.sales.hoytck).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1})]),_:1}),e(r,null,{default:l(()=>[e(g,{class:"my-card"},{default:l(()=>[e(r,null,{default:l(()=>[e(S,{bordered:""},{default:l(()=>[e($,null,{default:l(()=>[e(c,{avatar:""}),e(c,null,{default:l(()=>t[33]||(t[33]=[d("Caja")])),_:1}),e(c,null,{default:l(()=>t[34]||(t[34]=[d("Venta")])),_:1}),e(c,null,{default:l(()=>t[35]||(t[35]=[d("Tickets")])),_:1}),e(c,null,{default:l(()=>t[36]||(t[36]=[d("Promedio")])),_:1})]),_:1})]),_:1})]),_:1}),e(r,null,{default:l(()=>[t[37]||(t[37]=s("div",{class:"text-h6"},"Resumen Dia",-1)),e(S,{bordered:""},{default:l(()=>[(k(!0),I(O,null,K(i.value.val.sales.ventasdepday,(a,n)=>(k(),w($,{key:n},{default:l(()=>[e(c,{avatar:""},{default:l(()=>[e(D,{color:"primary",name:"point_of_sale"})]),_:1}),e(c,null,{default:l(()=>[d(o(a.DESTER),1)]),_:2},1024),e(c,null,{default:l(()=>[d(o(Number(a.VENTA).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(c,null,{default:l(()=>[d(o(a.TCK),1)]),_:2},1024),e(c,null,{default:l(()=>[d(o(Number(a.VENTA/a.TCK).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(r,null,{default:l(()=>[t[38]||(t[38]=s("div",{class:"text-h6"},"Resumen Mensual",-1)),e(S,{bordered:""},{default:l(()=>[(k(!0),I(O,null,K(i.value.val.sales.ventasdepmonth,(a,n)=>(k(),w($,{key:n},{default:l(()=>[e(c,{avatar:""},{default:l(()=>[e(D,{color:"primary",name:"point_of_sale"})]),_:1}),e(c,null,{default:l(()=>[d(o(a.DESTER),1)]),_:2},1024),e(c,null,{default:l(()=>[d(o(Number(a.VENTA).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(c,null,{default:l(()=>[d(o(a.TCK),1)]),_:2},1024),e(c,null,{default:l(()=>[d(o(Number(a.VENTA/a.TCK).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(f)]),_:1})]),_:1})}}};export{Nt as default};
