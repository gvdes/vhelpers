import{Q as c}from"./QInput.3a669571.js";import{Q as q,a as w,b as S,c as Q}from"./QSelect.1b098ddf.js";import{Q as B}from"./QTooltip.9dd9e298.js";import{j as N,E as A,F as R,aT as D,r as y,c as T,o as d,a as p,w as t,i as s,e as a,ax as $,ay as E,a3 as f,a4 as u,Q as m,h as V,Z as I,g as x,a0 as L,a1 as P,f as j}from"./index.a390723b.js";import{d as z,Q as J}from"./deposits.1c3ac67b.js";import{Q as K}from"./QUploader.e398252d.js";import{Q as M}from"./QForm.0204fb5d.js";import{Q as O}from"./QPage.b8d2a46e.js";import{u as Z}from"./VDB.d94ee6b7.js";import"./QCard.7c122fc7.js";import"./QCardActions.f14a16b3.js";import"./QDialog.fb7af7e1.js";import"./ClosePopup.1be853a3.js";import{u as G}from"./use-quasar.c8af5a4c.js";import"./jspdf.plugin.autotable.0e267d73.js";import"./exceljs.min.9e24d01d.js";import"./browser.94c942de.js";import{$socket as H}from"./socket.d2304efb.js";import"./use-key-composition.731fa628.js";import"./uid.42677368.js";import"./position-engine.d68342ec.js";import"./rtl.b51694b1.js";import"./axios.eed4c97e.js";import"./axios.f1f32898.js";import"./_commonjsHelpers.88e99c8f.js";var W=N({name:"QUploaderAddTrigger",setup(){const v=R(D,A);return v===A&&console.error("QUploaderAddTrigger needs to be child of QUploader"),v}});const X={class:"flex justify-center"},Y={class:"row no-wrap items-center q-pa-sm q-gutter-xs"},ee={class:"col"},oe=s("div",{class:"q-uploader__title"},"Subir Archivo",-1),le={class:"q-uploader__subtitle"},ae={class:"row"},ne={class:"text-overline"},te={class:"flex justify-center"},we={__name:"Form",setup(v){const g=Z(),b=G(),i=H.connect();i.connected?console.log(`%c Connect ${i.id} `,"background: #222; color: #bada55"):console.log("%c No hay conexion en el socket ","background: #222; color: #bada55"),i.emit("Conexion",g),i.on("Room",n=>{console.log(`Joined room ${n}`)}),i.on("disconnect",()=>{console.log("%c No hay conexion en el socket ","background: #222; color: #bada55")});const F=y([{id:1,name:"0110292745",bank:"BBVA"},{id:2,name:"0110292974",bank:"BBVA"},{id:3,name:"0110292834",bank:"BBVA"},{id:4,name:"0110292761",bank:"BBVA"},{id:5,name:"0110292982",bank:"BBVA"},{id:6,name:"0110293040",bank:"BBVA"},{id:7,name:"0473998967",bank:"BBVA"},{id:8,name:"0110292729",bank:"BBVA"}]),_=y(null),e=y({origin:null,destiny:null,reference:null,concepto:null,amount:null,files:[]}),k=()=>{e.value={origin:null,destiny:null,reference:null,concepto:null,amount:null,files:[]},_.value.reset()},C=T(()=>e.value.origin&&e.value.destiny&&e.value.reference&&e.value.concepto&&e.value.amount&&e.value.files.length>0),U=n=>{e.value.files=n,console.log("Archivos a\xF1adidos:",e.value.files)},h=async()=>{b.loading.show({message:"Enviando Formulario"});const n=new FormData;n.append("origin",e.value.origin),n.append("destiny",e.value.destiny.name),n.append("reference",e.value.reference),n.append("concepto",e.value.concepto),n.append("amount",e.value.amount),n.append("_store",g.session.store.id),n.append("send_by",g.session.name),e.value.files.forEach((o,r)=>{n.append(`file_${r}`,o),console.log(e.value.files)});const l=await z.newForm(n);l.fail?console.log(l):(console.log(l),b.loading.hide(),i.emit("Create",l.insert),b.notify({type:"positive",message:l.message}),k())};return(n,l)=>(d(),p(O,{padding:""},{default:t(()=>[s("div",X,[a(M,{onSubmit:h,onReset:k,class:"q-gutter-md"},{default:t(()=>[a(c,{modelValue:e.value.origin,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value.origin=o),type:"number",label:"Cuenta Origen",filled:"",dense:""},null,8,["modelValue"]),a(q,{modelValue:e.value.destiny,"onUpdate:modelValue":l[1]||(l[1]=o=>e.value.destiny=o),options:F.value,label:"Cuenta Destino",filled:"",dense:"","option-label":"name","option-value":"name"},{option:t(o=>[a(w,$(E(o.itemProps)),{default:t(()=>[a(S,null,{default:t(()=>[a(Q,null,{default:t(()=>[f(u(o.opt.name),1)]),_:2},1024),a(Q,{caption:""},{default:t(()=>[f(u(o.opt.bank),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),a(c,{modelValue:e.value.concepto,"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.concepto=o),type:"text",label:"Referencia",filled:"",dense:""},null,8,["modelValue"]),a(c,{modelValue:e.value.reference,"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.reference=o),type:"number",label:"Referencia Numerica / Folio",filled:"",dense:""},null,8,["modelValue"]),a(c,{modelValue:e.value.amount,"onUpdate:modelValue":l[4]||(l[4]=o=>e.value.amount=o),type:"number",label:"Monto",filled:"",dense:""},null,8,["modelValue"]),a(K,{modelValue:e.value.files,"onUpdate:modelValue":l[6]||(l[6]=o=>e.value.files=o),accept:"image/*","auto-upload":!1,onAdded:U,ref_key:"refe",ref:_},{header:t(o=>[s("div",Y,[o.queuedFiles.length>0?(d(),p(m,{key:0,icon:"clear_all",onClick:l[5]||(l[5]=()=>{_.value.reset(),e.value.files=[]}),round:"",dense:"",flat:""},{default:t(()=>[a(B,null,{default:t(()=>[f("Limpiar")]),_:1})]),_:1})):V("",!0),o.isUploading?(d(),p(I,{key:1,class:"q-uploader__spinner"})):V("",!0),s("div",ee,[oe,s("div",le,u(o.uploadSizeLabel)+" / "+u(o.uploadProgressLabel),1)]),o.canAddFiles?(d(),p(m,{key:2,type:"a",icon:"add_box",onClick:o.pickFiles,round:"",dense:"",flat:""},{default:t(()=>[a(W),a(B,null,{default:t(()=>[f("Subir Archivo")]),_:1})]),_:2},1032,["onClick"])):V("",!0)])]),list:t(o=>[(d(!0),x(P,null,L(o.files,r=>(d(),x("div",{key:r.__key},[s("div",ae,[a(J,{src:r.__img.src,ratio:20/8,"spinner-color":"primary","spinner-size":"82px",class:"col"},null,8,["src"]),a(m,{color:"negative",icon:"delete",onClick:()=>{o.removeFile(r),e.value.files=[]},flat:"",rounded:""},null,8,["onClick"])]),s("div",ne,u(r.name),1)]))),128))]),_:1},8,["modelValue"]),s("div",te,[a(m,{label:"Cancelar",type:"reset",color:"primary",flat:"",class:"q-ml-sm"}),a(m,{label:"Enviar",type:"submit",color:"primary",flat:"",disable:!j(C)},null,8,["disable"])])]),_:1})])]),_:1}))}};export{we as default};
