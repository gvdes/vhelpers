import{Z as O,f as $,u as C,r as p,a as I,h as B,i as t,d as a,a4 as V,k as n,ah as D,n as c,Q as _,l as u,a5 as T,m as U,j as v,a1 as g,a7 as Y,aX as j,a6 as F}from"./index.12f3892e.js";import{Q as q}from"./QHeader.c41c9533.js";import{Q as E}from"./QDate.349b0dd1.js";import{c as J,Q as X}from"./QSelect.f2b7a151.js";import{Q as Z}from"./QToolbar.89e174eb.js";import{Q as h}from"./QTable.240715d6.js";import{Q as z}from"./QPage.1de9ccfc.js";import{Q as G,a as K}from"./QLayout.111ce811.js";import{Q as P,a as W,b as N}from"./QTabPanels.84e80bca.js";import{Q as ee}from"./QTabs.bdbb11b3.js";import{Q as le}from"./QForm.315f2be3.js";import{C as ae}from"./ClosePopup.9250a65c.js";import"./auto.3644e1d0.js";import{u as oe}from"./use-quasar.ad7bddfa.js";import{d as b}from"./dayjs.min.cbcf888d.js";import"./exceljs.min.9e24d01d.js";import"./jspdf.plugin.autotable.04165fb7.js";import{_ as te}from"./UserToolbar.367e914b.js";import{b as w,a as se}from"./axios.087c86e4.js";import"./QResizeObserver.eaf763c1.js";import"./use-render-cache.3aae9b27.js";import"./date.ffeabcbd.js";import"./QList.76900103.js";import"./QLinearProgress.adaa4375.js";import"./QScrollObserver.00fad532.js";import"./use-panel.e5f1f6f7.js";import"./CandyBus.73965bf9.js";import"./_commonjsHelpers.88e99c8f.js";import"./QImg.60cba884.js";import"./QSpace.56cadeb4.js";import"./QExpansionItem.c6479fcd.js";import"./auth.9cdf3e31.js";const ne={class:"col"},ie={class:"text-bold q-ml-md"},re={class:"text-bold q-ml-md"},ue={class:"text-bold q-ml-md"},de={class:"text-bold q-ml-md"},je={__name:"RefundStoreLYT",setup(me){const r=oe();O(),$(),C();const d=C(),A=new Date,m=p(b(A).format("YYYY-MM-DD")),Q=p("pagos"),y=p([]),f=p({columns:[{name:"refund",label:"Devolucion",field:l=>l.devolucion,align:"left"},{name:"date",label:"Fecha",field:l=>b(l.fecha).format("YYYY-MM-DD"),align:"left"},{name:"hour",label:"Hora",field:l=>b(l.hora).format("HH-mm-ss"),align:"left"},{name:"client",label:"N Cliente",field:l=>Number(l.num_cli),align:"left"},{name:"cli",label:"Cliente",field:l=>l.cliente,align:"left"},{name:"origin",label:"Origen",field:l=>l.origen,align:"left"},{name:"cash",label:"Caja",field:l=>l.caja,align:"left"},{name:"total",label:"Total",field:l=>Number(l.total).toFixed(2),align:"left"},{name:"coment",label:"Comentario",field:l=>l.comentario,align:"left"},{name:"products",label:"Productos",field:l=>{var e,o;return(o=(e=l.products)==null?void 0:e.length)!=null?o:0},align:"left"},{name:"fpas",label:"Formas Pago",field:l=>{var e,o;return(o=(e=l.fpas)==null?void 0:e.length)!=null?o:0},align:"left"}],columnsfpa:[{name:"fpa",label:"Pago",field:l=>l.FPALCO,align:"left"},{name:"des",label:"Descripcion",field:l=>l.CPTLCO,align:"left"},{name:"total",label:"Total",field:l=>Number(l.IMPLCO).toFixed(2),align:"left"}],columnsProducts:[{name:"code",label:"Articulo",field:l=>l.ARTLFA,align:"left"},{name:"description",label:"Descripcion",field:l=>l.DESLFA,align:"left"},{name:"amount",label:"Cantidad",field:l=>Number(l.CANLFA).toFixed(2),align:"left"},{name:"price",label:"Precio",field:l=>Number(l.PRELFA).toFixed(2),align:"left"},{name:"tota",label:"Total",field:l=>Number(l.TOTLFA).toFixed(2),align:"left"}],filter:null}),s=p({val:null,state:!1}),i=p({state:!1,val:null,body:null}),R=async()=>{let l=d.session.store.id;console.log(l);try{let e=await se.get(`/cashier/getPrinters/${l}`);e.status==200&&(i.value.body=e.data,console.log("Impresoras listas :)"))}catch(e){console.log(e),r.notify({message:"No se pudiron obtener las impresoras",type:"negative",position:"center",icon:"error"})}},L=async()=>{console.log(d.session.store),r.loading.show({message:"Obteniendo Registros"}),console.log(m.value);let e=`http://${d.session.store.ip_address}/storetools/public/api/reports/getRefunds`;console.log(e);const o=await w.post(e,{fechas:m.value});console.log(o),o.status!=200?console.log(o):(console.log(o),y.value=o.data,R(),r.loading.hide())},k=async()=>{console.log(s.value.val.devolucion),r.loading.show({message:"Imprimiendo"});let l=s.value.val.devolucion.split("-"),e={type:"Reimpresion",serie:l[0],folio:l[1],print:i.value.val.ip_address},H=`http://${d.session.store.ip_address}/access/public/modify/newmod`;w.post(H,e).then(x=>{console.log(x),i.value.val=null,i.value.state=!1,r.loading.hide()}).catch(x=>x)},M=(l,e)=>{console.log(e),s.value.state=!0,s.value.val=e},S=async()=>{console.log(d.session.store),r.loading.show({message:"Obteniendo Registros"}),console.log(m.value);let e=`http://${d.session.store.ip_address}/storetools/public/api/reports/getRefunds`;console.log(e);const o=await w.post(e,{fechas:m.value});console.log(o),o.status!=200?console.log(o):(console.log(o),y.value=o.data,r.loading.hide())};return L(),(l,e)=>(I(),B(G,{view:"hHh Lpr fFf"},{default:t(()=>[a(q,{class:"bg-grey-3 text-dark",bordered:""},{default:t(()=>[a(te),a(V)]),_:1}),a(K,null,{default:t(()=>[a(z,{padding:""},{default:t(()=>[a(Z,{class:"justify-between row"},{default:t(()=>[n("div",ne,[e[8]||(e[8]=n("span",{class:"text-grey"},"Helpers",-1)),a(D,{name:"navigate_next",color:"primary"}),e[9]||(e[9]=n("span",{class:"text-h6"},"Devoluciones de Sucursales",-1))]),a(c,{color:"primary",icon:"event",flat:"",round:""},{default:t(()=>[a(J,null,{default:t(()=>[a(_,{dense:"",class:"my-card"},{default:t(()=>[a(u,{dense:""},{default:t(()=>[a(E,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=o=>m.value=o),range:"",minimal:"",mask:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),a(T,{vertical:"",align:"center"},{default:t(()=>[a(c,{color:"primary",flat:"",label:"Obtener",onClick:S})]),_:1})]),_:1}),a(V,{spaced:"",inset:"",vertical:"",dark:""})]),_:1})]),_:1})]),_:1}),a(V,{spaced:"",inset:"",vertical:"",dark:""}),a(h,{rows:y.value,columns:f.value.columns,filter:f.value.filter,onRowClick:M},{"top-right":t(()=>[a(U,{borderless:"",dense:"",debounce:"300",modelValue:f.value.filter,"onUpdate:modelValue":e[1]||(e[1]=o=>f.value.filter=o),placeholder:"Buscar"},{append:t(()=>[a(D,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","filter"])]),_:1})]),_:1}),a(F,{modelValue:s.value.state,"onUpdate:modelValue":e[5]||(e[5]=o=>s.value.state=o),persistent:""},{default:t(()=>[a(_,null,{default:t(()=>[a(u,{class:"text-center text-bold text-h5"},{default:t(()=>[v(" Devolucion "+g(s.value.val.devolucion),1)]),_:1}),a(u,null,{default:t(()=>[n("div",null,[e[10]||(e[10]=v("NOTAS: ")),n("span",ie,g(s.value.val.comentario),1)]),n("div",null,[e[11]||(e[11]=v("CLIENTE: ")),n("span",re,g(s.value.val.cliente),1)]),n("div",null,[e[12]||(e[12]=v("CAJA: ")),n("span",ue,g(s.value.val.caja),1)]),n("div",null,[e[13]||(e[13]=v("Fecha y Hora: ")),n("span",de,g(` ${Y(b)(s.value.val.fecha).format("YYYY-MM-DD")}
              ${Y(b)(s.value.val.hora).format("HH:mm:ss")}`),1)])]),_:1}),a(u,null,{default:t(()=>[a(ee,{modelValue:Q.value,"onUpdate:modelValue":e[2]||(e[2]=o=>Q.value=o),class:"text-primary",dense:""},{default:t(()=>[a(P,{name:"pagos",icon:"payments"}),a(P,{name:"products",icon:"inventory_2"})]),_:1},8,["modelValue"])]),_:1}),a(u,null,{default:t(()=>[a(W,{modelValue:Q.value,"onUpdate:modelValue":e[3]||(e[3]=o=>Q.value=o),animated:""},{default:t(()=>[a(N,{name:"pagos"},{default:t(()=>[a(h,{rows:s.value.val.fpas,"hide-bottom":"",columns:f.value.columnsfpa},null,8,["rows","columns"])]),_:1}),a(N,{name:"products"},{default:t(()=>[a(h,{rows:s.value.val.products,columns:f.value.columnsProducts},null,8,["rows","columns"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(T,{align:"center"},{default:t(()=>[j(a(c,{flat:"",icon:"close"},null,512),[[ae]]),a(c,{flat:"",icon:"print",class:"text-primary",onClick:e[4]||(e[4]=o=>i.value.state=!i.value.state)})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(F,{modelValue:i.value.state,"onUpdate:modelValue":e[7]||(e[7]=o=>i.value.state=o)},{default:t(()=>[a(_,{class:"my-card"},{default:t(()=>[a(u,null,{default:t(()=>e[14]||(e[14]=[n("div",{class:"text-h6 text-center"},"Impresora",-1)])),_:1}),a(u,null,{default:t(()=>[a(le,{onSubmit:k,class:"q-gutter-md"},{default:t(()=>[a(X,{dense:"","option-label":"name",modelValue:i.value.val,"onUpdate:modelValue":e[6]||(e[6]=o=>i.value.val=o),options:i.value.body,label:"Impresora",filled:"",autofocus:"",style:{width:"200px"}},null,8,["modelValue","options"]),n("div",null,[a(c,{label:"Enviar",type:"submit",color:"primary",style:{width:"200px"},disable:i.value.val===null},null,8,["disable"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{je as default};
