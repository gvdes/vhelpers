import{Z as U,f as B,u as D,r as P,o as S,w as $,y as R,$ as Y,a as m,h as p,i as n,d as r,a4 as q,a7 as f,k as c,j as y,ah as L,a1 as M,n as j,Q as N,l as A,a5 as H,p as h}from"./index.8c0f41e3.js";import{Q as T}from"./QHeader.eea29f6c.js";import{Q as z}from"./QDate.be635bef.js";import{e as E}from"./QSelect.ca1146ab.js";import{Q as F}from"./QToolbar.a3b2da48.js";import{Q as I,a as Z}from"./QLayout.c82cf49d.js";import{d as G}from"./dayjs.min.cbcf888d.js";import"./axios.c9f3d0b6.js";import{o as O}from"./orderApi.8778c3f0.js";import{u as J}from"./OrderStore.f8ce8a95.js";import{u as K}from"./use-quasar.2bb2ef5c.js";import{_ as W}from"./UserToolbar.9b57cd43.js";import{$sktOrders as t}from"./socket.168d2ba4.js";import"./QResizeObserver.f7d7dc26.js";import"./use-render-cache.3aae9b27.js";import"./date.5c802095.js";import"./QList.b4c12bd4.js";import"./QScrollObserver.1f4160ab.js";import"./_commonjsHelpers.88e99c8f.js";import"./QImg.912bbcad.js";import"./QSpace.70ea1c72.js";import"./QExpansionItem.22b5f00b.js";import"./favorites.9ebca4c8.js";import"./ClosePopup.b46b6957.js";import"./auth.7fb029c1.js";const X={class:"text-h6"},ke={__name:"PreordersLYT",setup(ee){const b=new Audio("sounds/success01.mp3"),V=U();B();const o=J(),d=K(),i=D();let u=!1;const l=P({from:null,to:null}),_=e=>{switch(e){case 1:case 2:case 6:case 12:case 22:case 21:return"admins";case 8:return"sales";case 4:case 24:case 26:case 28:return"supply";default:return"sales"}},g=e=>{console.log(e)},w=e=>{console.log(e)},v=e=>{console.log(e),o.addOrUpdate(e)},Q=e=>{console.log(e),o.addOrUpdate(e),e.order._status==5&&V.path==="/preorders/warehouse"?(console.log("aqui suena"),b.play()):console.log("aqui no suena")},k=async()=>{d.loading.show({message:"Obteniendo datos"});let e=G(new Date).format("YYYY/MM/DD");l.value={from:e,to:e};let s={uid:i.session.credentials.staff.id_va,wid:i.session.store.id_viz,view:_(i.session.credentials._rol),date:l.value};console.log(s);const a=await O.getOrders(s);a.fail?console.log(a):(console.log(a),o.setOrders(a.orders),o.setPrinters(a.prints),o.setUnits(a.units),o.setRules(a.rules),o.setUsers(a.user),o.setProcess(a.process),d.loading.hide())},x=async()=>{d.loading.show({message:"Obteniendo datos"});let e={uid:i.session.credentials.staff.id_va,wid:i.session.store.id_viz,view:_(i.session.credentials._rol),date:l.value};console.log(e);const s=await O.getOrders(e);s.fail?console.log(s):(console.log(s),o.setOrders(s.orders),o.setPrinters(s.prints),o.setUnits(s.units),o.setRules(s.rules),o.setUsers(s.user),o.setProcess(s.process),d.loading.hide())};return S(()=>{k(),t.on("connect",()=>{!u&&o.socket_user&&(u=!0,t.emit("join",o.socket_user))}),t.connect(),$(()=>o.socket_user,e=>{e&&!u&&t.connected&&(u=!0,t.emit("join",e))},{immediate:!0}),t.on("joinedat",g),t.on("newjoin",w),t.on("order_add",v),t.on("order_update",Q)}),R(()=>{t.off("joinedat",g),t.off("newjoin",w),t.off("order_add",v),t.off("order_update",Q)}),(e,s)=>{const a=Y("router-view");return m(),p(I,{view:"hHh Lpr fFf"},{default:n(()=>[r(T,{class:"transparent text-dark",bordered:""},{default:n(()=>[r(W),r(q)]),_:1}),r(Z,null,{default:n(()=>[f(o).showLyt?(m(),p(F,{key:0,class:"justify-between"},{default:n(()=>[c("div",null,[s[1]||(s[1]=y("Helpers ")),r(L,{name:"navigate_next",color:"primary"}),s[2]||(s[2]=y()),c("span",X,M(f(o).title),1)]),f(o).showEvent?(m(),p(j,{key:0,color:"primary",icon:"event",flat:""},{default:n(()=>[r(E,null,{default:n(()=>[r(N,{class:"my-card"},{default:n(()=>[r(A,null,{default:n(()=>[c("div",null,[s[3]||(s[3]=c("div",{class:"q-pb-sm text-center"},null,-1)),r(z,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=C=>l.value=C),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),r(H,{vertical:"",align:"center"},{default:n(()=>[r(j,{flat:"",label:"Obtener",color:"positive",onClick:x})]),_:1})]),_:1})]),_:1})]),_:1})):h("",!0)]),_:1})):h("",!0),r(a)]),_:1})]),_:1})}}};export{ke as default};
