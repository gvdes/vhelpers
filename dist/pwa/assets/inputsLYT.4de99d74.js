import{Q as V}from"./QSeparator.5f295d7c.js";import{a_ as k,r as n,o as m,a as v,w as o,u as O,aD as N,aV as B,e as a,i as D,a3 as _,Y,_ as A,g as L,a0 as P,a1 as U,Q as c,a2 as C,aX as H,h as $,a4 as S,b3 as F,b4 as M}from"./index.d5f50973.js";import{Q as j}from"./QToolbar.824680f5.js";import{Q as z}from"./QHeader.a42c1fd3.js";import{Q as x,a as g}from"./QTr.98400929.js";import{Q as b}from"./QTable.4cfac71c.js";import{Q as X,a as G}from"./QLayout.db01bcad.js";import{Q as J,a as Q}from"./QCard.70a1173a.js";import{Q as K}from"./QSelect.3064671c.js";import{Q as W}from"./QCardActions.b5daf9f8.js";import{Q as Z}from"./QDialog.5b3742ec.js";import{C as ee}from"./ClosePopup.e83bfb80.js";import{u as ae}from"./VDB.68ede9ab.js";import{_ as oe}from"./UserToolbar.158fa8c3.js";import{u as te}from"./use-quasar.9cca4b66.js";import{d as se}from"./dayjs.min.25545ff6.js";import{u as le,r as w}from"./requisitionApi.277e50a3.js";import"./QResizeObserver.1715da82.js";import"./QList.8104b91d.js";import"./QLinearProgress.44cafaa7.js";import"./QCheckbox.c5a15059.js";import"./use-key-composition.f9415d84.js";import"./uid.42677368.js";import"./QItemSection.516a5973.js";import"./position-engine.f258a937.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.76bdd693.js";import"./axios.f1f32898.js";const ie=r=>(F("data-v-0420a722"),r=r(),M(),r),ne={class:"row items-center"},re=ie(()=>D("span",{class:"text-h6"},"Pedidos Insumos ",-1)),ue={__name:"inputsLYT",setup(r){const h=ae();le();const I=O();N();const i=te();n(""),n([]);const u=n([]),t=n({state:!1,val:null}),y=n([]),p=n({columnsReq:[{name:"id",label:"ID",field:e=>e.id},{name:"user",label:"USUARIO",field:e=>e.user.complete_name},{name:"status",label:"ESTADO",field:e=>e.status.name},{name:"date",label:"FECHA",field:e=>se(e.created_at).format("YYYY/MM/DD")},{name:"products",label:"PRODUCTOS",field:e=>e.bodie.length},{name:"notes",label:"NOTAS",field:e=>e.notes}],columns:[{name:"id",label:"ID",field:e=>e.id},{name:"name",label:"NOMBRE",field:e=>e.name},{name:"countRequisition",label:"REQUISISIONES",field:e=>e.requisition_count}],columnsRequired:[{name:"code",label:"CODE",field:e=>e.code},{name:"descripcion",label:"DESCRIPCION",field:e=>e.description},{name:"amount",label:"CANTIDAD",field:e=>e.amount}]}),R=async()=>{i.loading.show({message:"Obteniendo Datos"});const e=await w.getRequisitionsStore();e.status!==200?console.log(e):(i.loading.hide(),u.value=e.data.stores,y.value=e.data.status,console.log(e.data))},q=(e,l)=>{t.value.state=!0,t.value.val=l,console.log(l)},E=async()=>{i.loading.show({message:"Imprimiendo"});const e=await w.printReq(t.value.val._stores,t.value.val.id);e.status!=200?console.log(e):(console.log(e),i.loading.hide())},T=async()=>{i.loading.hide({message:"Cambiando Status"});const e=await w.change(t.value.val._stores,t.value.val.id);e.status!=200?console.log(e):(console.log(e),i.loading.hide(),i.notify({message:"El pedido se cambio de estado",type:"positive",position:"center"}),u.value.forEach(l=>{if(l.id==e.data._stores){let d=l.requisition.findIndex(s=>s.id==e.data.id);d>=0&&(l.requisition[d]=e.data)}}),t.value.val=e.data,t.value.state=!1)};return h.session.rol=="adm"||h.session.rol=="root"?R():(i.notify({message:"No tienes acceso a esta pagina",type:"negative",position:"center"}),I.replace("/")),(e,l)=>{const d=B("router-view");return m(),v(X,{view:"hHh Lpr fFf"},{default:o(()=>[a(z,{class:"transparent text-dark",bordered:""},{default:o(()=>[a(oe),a(V),a(j,{class:"justify-between"},{default:o(()=>[D("div",ne,[_(" Helpers "),a(Y,{name:"navigate_next",color:"primary",class:"q-mx-sm"}),a(A,{name:"fade"},{default:o(()=>[re]),_:1})])]),_:1})]),_:1}),a(G,null,{default:o(()=>[u.value.length>0?(m(),v(b,{key:0,title:"Pedidos",rows:u.value,columns:p.value.columns},{body:o(s=>[a(x,{props:s},{default:o(()=>[(m(!0),L(U,null,P(s.cols,f=>(m(),v(g,{key:f.name,props:s},{default:o(()=>[_(S(f.value),1)]),_:2},1032,["props"]))),128)),a(g,{"auto-width":""},{default:o(()=>[a(c,{size:"sm",color:"accent",round:"",dense:"",onClick:f=>s.expand=!s.expand,icon:s.expand?"remove":"add"},null,8,["onClick","icon"])]),_:2},1024)]),_:2},1032,["props"]),C(a(x,{props:s},{default:o(()=>[a(g,{colspan:"100%"},{default:o(()=>[a(b,{rows:s.row.requisition,columns:p.value.columnsReq,onRowClick:q},null,8,["rows","columns"])]),_:2},1024)]),_:2},1032,["props"]),[[H,s.expand]])]),_:1},8,["rows","columns"])):$("",!0),a(d)]),_:1}),a(Z,{modelValue:t.value.state,"onUpdate:modelValue":l[1]||(l[1]=s=>t.value.state=s),persistent:""},{default:o(()=>[a(J,{style:{width:"500px"}},{default:o(()=>[a(Q,{class:"text-bold text-h6 text-center"},{default:o(()=>[_(" PEDIDO: "+S(t.value.val.id),1)]),_:1}),a(Q,null,{default:o(()=>[a(K,{modelValue:t.value.val.status,"onUpdate:modelValue":l[0]||(l[0]=s=>t.value.val.status=s),options:y.value,label:"Estado",filled:"","option-label":"name",disable:""},null,8,["modelValue","options"])]),_:1}),a(Q,null,{default:o(()=>[a(b,{rows:t.value.val.bodie,columns:p.value.columnsRequired},null,8,["rows","columns"])]),_:1}),a(W,{align:"right"},{default:o(()=>[C(a(c,{flat:"",icon:"close",color:"primary"},null,512),[[ee]]),a(c,{flat:"",icon:"print",color:"primary",onClick:E}),a(c,{flat:"",icon:"send",color:"primary",onClick:T,disable:t.value.val._status>3},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};var Le=k(ue,[["__scopeId","data-v-0420a722"]]);export{Le as default};
