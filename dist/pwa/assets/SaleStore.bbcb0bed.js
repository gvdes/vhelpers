import{b,a as E,d as T,e as c,Q as Z}from"./QList.a1de32fe.js";import{Q as j}from"./QHeader.33b74b8d.js";import{aH as ee,a as te,u as le,r as Q,c as $,a$ as ae,o as g,d as w,w as l,e,f as s,E as R,h as C,Q as I,a0 as o,an as se,ak as d,a4 as K,aA as oe,g as A,am as de,a2 as O,a3 as q}from"./index.16e95011.js";import{Q as re,a as m}from"./QSelect.3b0fa047.js";import{Q as ne}from"./QToolbar.a49d9bc1.js";import{p as M,Q as k,a as i}from"./axios.044944d1.js";import{Q as ie}from"./QInput.baa3c6f9.js";import{Q as ue}from"./QBadge.9cb347b4.js";import{Q as ce}from"./QLinearProgress.f46c28ca.js";import{c as me}from"./QDrawer.83f3a6c2.js";import{Q as ve}from"./QTable.bc0118b7.js";import{Q as fe,a as xe}from"./QLayout.70a3febc.js";import"./auto.5a09eb82.js";import{u as be}from"./use-quasar.a5f9503c.js";import"./dayjs.min.cbcf888d.js";import{E as pe}from"./exceljs.min.9e24d01d.js";import{_ as _e}from"./UserToolbar.cf046e9c.js";import"./QResizeObserver.0b1425b1.js";import"./QScrollObserver.52a4ac9a.js";import"./QCheckbox.7eb2211b.js";import"./_commonjsHelpers.88e99c8f.js";import"./QCardActions.400fc375.js";import"./ClosePopup.2f7199d0.js";import"./auth.5e5531c6.js";const ge={class:"row"},ke={class:"text-bold text-h6 q-ml-md"},we={class:"text-h4 text-center"},ye={class:"text-h4 text-center"},Ne={class:"text-h4 text-center"},he={class:"text-h4 text-center"},Fe={class:"text-h4 text-center"},Te={class:"text-h4 text-center"},$e={class:"text-h4 text-center"},Ce={class:"text-h4 text-center"},Se={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition"},Ve={class:"text-bold"},Ee={class:"text-overline"},Qe={class:"q-pa-sm flex justify-start"},Re={class:"absolute-full flex flex-center"},De={key:0,class:""},Ie={class:"text-h6"},Ae={class:"text-subtitle2"},Be={class:"text-h5 text-center"},He={class:"text-h5 text-center"},Le={class:"text-h5 text-center"},Pe={class:"text-h5 text-center"},Ke={class:"text-h5 text-center"},Oe={class:"text-h5 text-center"},qe={class:"text-h5 text-center"},Me={class:"text-h5 text-center"},Ue={class:"text-h5 text-center"},ze={class:"text-h5 text-center"},_t={__name:"SaleStore",setup(Ye){const D=be();ee(),te(),le();const p=Q([]),S=Q({pagination:{rowsPerPage:0},filter:""}),u=Q({state:!1,val:null}),N=Q({val:null}),B=[{id:1,label:"Enero"},{id:2,label:"Febrero"},{id:3,label:"Marzo"},{id:4,label:"Abril"},{id:5,label:"Mayo"},{id:6,label:"Junio"},{id:7,label:"Julio"},{id:8,label:"Agosto"},{id:9,label:"Septiembre"},{id:10,label:"Octubre"},{id:11,label:"Noviembre"},{id:12,label:"Diciembre"}],h=$(()=>D.platform.is.mobile),U=$(()=>Number(p.value.reduce((x,t)=>{var f;return x+Number(((f=t.sales)==null?void 0:f.salesant)*1.1||0)},0)).toFixed(2)),z=$(()=>Number(p.value.reduce((x,t)=>{var f;return x+Number(((f=t.sales)==null?void 0:f.salesact)||0)},0)).toFixed(2)),Y=$(()=>Number(p.value.reduce((x,t)=>{var f,a;return x+Number(((f=t.sales)==null?void 0:f.salesact)-((a=t.sales)==null?void 0:a.salesant)*1.1||0)},0)).toFixed(2)),H=$(()=>Number(p.value.reduce((x,t)=>{var f;return x+Number(((f=t.sales)==null?void 0:f.saleshoy)||0)},0)).toFixed(2)),L=async()=>{const t=new Date().getMonth()+1;N.value.val=B.filter(n=>n.id===t)[0],D.loading.show({message:"Cargando Informacion"}),console.log("se inicia el init");let f="http://192.168.10.238:2902/Assist/public/api/sales/getSale";const a=await M.get(f);a.error?console.log(a):(console.log(a),p.value=a.data,P(p.value,t))},P=async(x,t)=>{x.forEach((f,a)=>{setTimeout(()=>{let v=`http://${f.domain}/access/public/reports/getSalesPerMonth/${t}`;M.get(v).then(r=>{f.sales=r.data==null?null:r.data,console.log(r)}).catch(r=>{console.log(r.response.data.message)})},a*1e3)}),D.loading.hide()};L();const J=()=>{p.value.map(x=>x.sales=null),P(p.value,N.value.val.id)},W=x=>{u.value.state=!0,u.value.val=x,console.log(x)},G=async()=>{const x=new pe.Workbook,t=x.addWorksheet("Venta");console.log(),t.addTable({name:"Venta",ref:"A1",headerRow:!0,totalsRow:!0,style:{showRowStripes:!0},columns:[{name:"Sucursal",filterButton:!0},{name:"Total",filterButton:!0,totalsRowFunction:"sum"},{name:"Tickets",filterButton:!0,totalsRowFunction:"sum"}],rows:p.value.map(r=>{var _,y;return[r.name,Number((_=r.sales)==null?void 0:_.saleshoy),Number((y=r.sales)==null?void 0:y.hoytck)]})}),t.columns.forEach(r=>{let _=0;r.eachCell({includeEmpty:!0},y=>{const V=y.value?y.value.toString().length:10;V>_&&(_=V)}),r.width=_<10?10:_}),t.getRow(1).eachCell(r=>{r.font={bold:!0}});const f=2,a=p.value.length+2;for(let r=f;r<a;r++)t.getRow(r).eachCell(_=>{_.font={bold:!0}});t.getRow(a).eachCell(r=>{r.font={size:12,bold:!0},r.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFF00"}}});const n=2;t.getColumn(n).numFmt='"$"#,##0.00',t.getCell(`B${a}`).numFmt='"$"#,##0.00',(async()=>{const _=new Date().toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}),y=await x.xlsx.writeBuffer(),V=new Blob([y],{type:"application/octet-stream"}),X=URL.createObjectURL(V),F=document.createElement("a");F.href=X,F.download=`Ventas${_}.xlsx`,document.body.appendChild(F),F.click(),document.body.removeChild(F)})()};return(x,t)=>{const f=ae("router-view");return g(),w(fe,{view:"hHh Lpr fFf"},{default:l(()=>[e(xe,{class:"q-ml-md"},{default:l(()=>[e(j,{class:"bg-grey-3 text-dark",bordered:""},{default:l(()=>[e(_e),e(b)]),_:1}),e(ne,{class:"justify-between"},{default:l(()=>[s("div",null,[t[3]||(t[3]=s("span",{class:"text-grey"},"Helpers",-1)),e(R,{name:"navigate_next",color:"primary"}),t[4]||(t[4]=s("span",{class:"text-h6"},"Ventas Sucursales",-1))]),s("div",ge,[h.value?C("",!0):(g(),w(re,{key:0,modelValue:N.value.val,"onUpdate:modelValue":[t[0]||(t[0]=a=>N.value.val=a),J],options:B,label:"mes",outlined:"",dense:""},null,8,["modelValue"])),e(I,{dense:"",flat:"",color:"primary",icon:"autorenew",onClick:L})])]),_:1}),e(b,{spaced:"",inset:"",vertical:"",dark:""}),s("div",ke,o(N.value.val.label),1),e(b,{spaced:"",inset:"",vertical:"",dark:""}),s("div",{class:se(h.value?"":"row")},[h.value?C("",!0):(g(),w(k,{key:0,class:"my-card col",bordered:"",dense:""},{default:l(()=>[e(i,null,{default:l(()=>[t[5]||(t[5]=s("div",{class:"text-h6 text-center"},"Ventas 2024",-1)),s("div",we,o(U.value.replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(i,null,{default:l(()=>[t[6]||(t[6]=s("div",{class:"text-h6 text-center"},"Tickets 2024",-1)),s("div",ye,o(Number(p.value.reduce((a,n)=>{var v;return a+Number(((v=n.sales)==null?void 0:v.tiketsant)||0)},0)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1})),e(b,{spaced:"",inset:"",vertical:"",dark:""}),h.value?C("",!0):(g(),w(k,{key:1,class:"my-card col",bordered:"",dense:""},{default:l(()=>[e(i,null,{default:l(()=>[t[7]||(t[7]=s("div",{class:"text-h6 text-center"},"Ventas 2025",-1)),s("div",Ne,o(z.value.replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(i,null,{default:l(()=>[t[8]||(t[8]=s("div",{class:"text-h6 text-center"},"Tickets 2025",-1)),s("div",he,o(Number(p.value.reduce((a,n)=>{var v;return a+Number(((v=n.sales)==null?void 0:v.tiketsact)||0)},0)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1})),e(b,{spaced:"",inset:"",vertical:"",dark:""}),h.value?C("",!0):(g(),w(k,{key:2,class:"my-card col",bordered:"",dense:""},{default:l(()=>[e(i,null,{default:l(()=>[t[9]||(t[9]=s("div",{class:"text-h6 text-center"},"Diferencia",-1)),s("div",Fe,o(Y.value.replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(i,null,{default:l(()=>[t[10]||(t[10]=s("div",{class:"text-h6 text-center"},"Diferencia Tickets",-1)),s("div",Te,o(Number(p.value.reduce((a,n)=>{var v,r;return a+Number(((v=n.sales)==null?void 0:v.tiketsact)-((r=n.sales)==null?void 0:r.tiketsant)||0)},0)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1})),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(k,{class:"my-card col",bordered:"",dense:""},{default:l(()=>[e(i,null,{default:l(()=>[t[11]||(t[11]=s("div",{class:"text-h6 text-center"},"VENTAS HOY",-1)),s("div",$e,o(H.value.replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(i,null,{default:l(()=>[t[12]||(t[12]=s("div",{class:"text-h6 text-center"},"Tickets HOY",-1)),s("div",Ce,o(p.value.reduce((a,n)=>{var v;return a+Number(((v=n.sales)==null?void 0:v.hoytck)||0)},0)),1)]),_:1})]),_:1})],2),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(ve,{title:"Sucursales",rows:p.value.sort((a,n)=>{var v,r;return((v=n.sales)==null?void 0:v.saleshoy)-((r=a.sales)==null?void 0:r.saleshoy)}),"row-key":"id",pagination:S.value.pagination,filter:S.value.filter,"hide-header":""},{"top-right":l(()=>[e(ie,{borderless:"",dense:"",debounce:"300",modelValue:S.value.filter,"onUpdate:modelValue":t[1]||(t[1]=a=>S.value.filter=a),placeholder:"Buscar"},{append:l(()=>[e(R,{name:"search"})]),_:1},8,["modelValue"]),e(I,{color:"primary",icon:"ios_share",flat:"",onClick:G})]),body:l(a=>[s("div",Se,[e(E,{bordered:"",dense:""},{default:l(()=>[e(T,null,{default:l(()=>[e(c,null,{default:l(()=>[e(m,{class:"flex justify-between"},{default:l(()=>{var n;return[s("div",Ve,o(a.row.name),1),s("div",Ee,[d(o(`Tickets ${(n=a.row.sales)==null?void 0:n.hoytck}`)+" ",1),e(I,{color:"grey",flat:"",dense:"",icon:a.expand?"keyboard_arrow_up":"keyboard_arrow_down",onClick:v=>a.expand=!a.expand},null,8,["icon","onClick"])])]}),_:2},1024),e(m,null,{default:l(()=>{var n;return[s("div",Qe,[e(ce,{value:Number((n=a.row.sales)==null?void 0:n.saleshoy)/Number(H.value),buffer:1,size:"20px"},{default:l(()=>{var v;return[s("div",Re,[e(ue,{color:"white","text-color":"accent",label:`$ ${Number((v=a.row.sales)==null?void 0:v.saleshoy).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")}`},null,8,["label"])])]}),_:2},1032,["value"])])]}),_:2},1024)]),_:2},1024)]),_:2},1024),e(me,null,{default:l(()=>[a.row.sales?K((g(),A("div",De,[e(b),K((g(),w(T,{class:"text-center",dense:"",clickable:"",onClick:n=>W(a.row)},{default:l(()=>[e(c,null,{default:l(()=>[e(m,{overline:""},{default:l(()=>t[13]||(t[13]=[d("VENTAS 2024")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(Number(a.row.sales.salesant*1.1).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(m,{overline:""},{default:l(()=>t[14]||(t[14]=[d("TICKETS 2024")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(a.row.sales.tiketsant),1)]),_:2},1024)]),_:2},1024),e(c,null,{default:l(()=>[e(m,{overline:""},{default:l(()=>t[15]||(t[15]=[d("Promedio 2024")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(Number(Number(a.row.sales.salesant*1.1)/Number(a.row.sales.tiketsant)).toFixed(2)),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""})]),_:2},1024),e(c,null,{default:l(()=>[e(m,{overline:""},{default:l(()=>t[16]||(t[16]=[d("VENTAS 2025")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(Number(a.row.sales.salesact).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(m,{overline:""},{default:l(()=>t[17]||(t[17]=[d("TICKETS 2025")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(a.row.sales.tiketsact),1)]),_:2},1024)]),_:2},1024),e(c,null,{default:l(()=>[e(m,{overline:""},{default:l(()=>t[18]||(t[18]=[d("Promedio 2025 ")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(Number(Number(a.row.sales.salesact)/Number(a.row.sales.tiketsact)).toFixed(2)),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""})]),_:2},1024),e(c,null,{default:l(()=>[e(m,{overline:""},{default:l(()=>t[19]||(t[19]=[d("DIFERENCIA")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o((Number(a.row.sales.salesact).toFixed(2)-Number(a.row.sales.salesant*1.1).toFixed(2)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(m,{overline:""},{default:l(()=>t[20]||(t[20]=[d("DIFERENCIA TICKETS")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(a.row.sales.tiketsact-a.row.sales.tiketsant),1)]),_:2},1024)]),_:2},1024),e(c,null,{default:l(()=>[e(m,{overline:""},{default:l(()=>t[21]||(t[21]=[d("VENTA HOY ")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(Number(a.row.sales.saleshoy).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(m,{overline:""},{default:l(()=>t[22]||(t[22]=[d("TICKETS HOY")])),_:1}),e(m,{caption:""},{default:l(()=>[d(o(a.row.sales.hoytck),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[de]])],512)),[[oe,a.expand]]):C("",!0)]),_:2},1024)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""})])]),_:1},8,["rows","pagination","filter"]),e(Z,{modelValue:u.value.state,"onUpdate:modelValue":t[2]||(t[2]=a=>u.value.state=a),"full-width":""},{default:l(()=>[e(k,{class:"my-card"},{default:l(()=>[e(i,null,{default:l(()=>[s("div",Ie,o(u.value.val.name),1),s("div",Ae,o(u.value.val.alias),1)]),_:1}),e(i,{class:"row"},{default:l(()=>[e(k,{class:"my-card col"},{default:l(()=>[e(i,null,{default:l(()=>[t[23]||(t[23]=s("div",{class:"text-h6 text-center"},"Ventas 2023",-1)),s("div",Be,o(Number(u.value.val.sales.salesant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(i,null,{default:l(()=>[t[24]||(t[24]=s("div",{class:"text-h6 text-center"},"Tickets 2023",-1)),s("div",He,o(Number(u.value.val.sales.tiketsant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(i,null,{default:l(()=>[t[25]||(t[25]=s("div",{class:"text-h6 text-center"},"Tickets Promedio 2023",-1)),s("div",Le,o(Number(u.value.val.sales.salesant/u.value.val.sales.tiketsant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1}),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(k,{class:"my-card col"},{default:l(()=>[e(i,null,{default:l(()=>[t[26]||(t[26]=s("div",{class:"text-h6 text-center"},"Ventas 2024",-1)),s("div",Pe,o(Number(u.value.val.sales.salesact).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(i,null,{default:l(()=>[t[27]||(t[27]=s("div",{class:"text-h6 text-center"},"Tickets 2024",-1)),s("div",Ke,o(Number(u.value.val.sales.tiketsact).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(i,null,{default:l(()=>[t[28]||(t[28]=s("div",{class:"text-h6 text-center"},"Tickets Promedio 2024",-1)),s("div",Oe,o(Number(u.value.val.sales.salesact/u.value.val.sales.tiketsact).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1}),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(k,{class:"my-card col"},{default:l(()=>[e(i,null,{default:l(()=>[t[29]||(t[29]=s("div",{class:"text-h6 text-center"},"Diferencias",-1)),s("div",qe,o(Number(u.value.val.sales.salesact-u.value.val.sales.salesant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(i,null,{default:l(()=>[t[30]||(t[30]=s("div",{class:"text-h6 text-center"},"Diferencia Tickts",-1)),s("div",Me,o(Number(u.value.val.sales.tiketsact-u.value.val.sales.tiketsant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1}),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(k,{class:"my-card col"},{default:l(()=>[e(i,null,{default:l(()=>[t[31]||(t[31]=s("div",{class:"text-h6 text-center"},"Ventas Hoy",-1)),s("div",Ue,o(Number(u.value.val.sales.saleshoy).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(i,null,{default:l(()=>[t[32]||(t[32]=s("div",{class:"text-h6 text-center"},"Tickets Hoy",-1)),s("div",ze,o(Number(u.value.val.sales.hoytck).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(k,{class:"my-card"},{default:l(()=>[e(i,null,{default:l(()=>[e(E,{bordered:""},{default:l(()=>[e(T,null,{default:l(()=>[e(c,{avatar:""}),e(c,null,{default:l(()=>t[33]||(t[33]=[d("Caja")])),_:1}),e(c,null,{default:l(()=>t[34]||(t[34]=[d("Venta")])),_:1}),e(c,null,{default:l(()=>t[35]||(t[35]=[d("Tickets")])),_:1}),e(c,null,{default:l(()=>t[36]||(t[36]=[d("Promedio")])),_:1})]),_:1})]),_:1})]),_:1}),e(i,null,{default:l(()=>[t[37]||(t[37]=s("div",{class:"text-h6"},"Resumen Dia",-1)),e(E,{bordered:""},{default:l(()=>[(g(!0),A(q,null,O(u.value.val.sales.ventasdepday,(a,n)=>(g(),w(T,{key:n},{default:l(()=>[e(c,{avatar:""},{default:l(()=>[e(R,{color:"primary",name:"point_of_sale"})]),_:1}),e(c,null,{default:l(()=>[d(o(a.DESTER),1)]),_:2},1024),e(c,null,{default:l(()=>[d(o(Number(a.VENTA).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(c,null,{default:l(()=>[d(o(a.TCK),1)]),_:2},1024),e(c,null,{default:l(()=>[d(o(Number(a.VENTA/a.TCK).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(i,null,{default:l(()=>[t[38]||(t[38]=s("div",{class:"text-h6"},"Resumen Mensual",-1)),e(E,{bordered:""},{default:l(()=>[(g(!0),A(q,null,O(u.value.val.sales.ventasdepmonth,(a,n)=>(g(),w(T,{key:n},{default:l(()=>[e(c,{avatar:""},{default:l(()=>[e(R,{color:"primary",name:"point_of_sale"})]),_:1}),e(c,null,{default:l(()=>[d(o(a.DESTER),1)]),_:2},1024),e(c,null,{default:l(()=>[d(o(Number(a.VENTA).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(c,null,{default:l(()=>[d(o(a.TCK),1)]),_:2},1024),e(c,null,{default:l(()=>[d(o(Number(a.VENTA/a.TCK).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(f)]),_:1})]),_:1})}}};export{_t as default};
