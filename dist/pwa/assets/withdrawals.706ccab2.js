import{Q as u}from"./QSeparator.1c73cca5.js";import{aE as U,u as N,r as v,c as S,o as P,a as $,w as s,e as l,f as d,Y as B,Q as g,a5 as M,a3 as _}from"./index.54d447e3.js";import{Q as y,d as q}from"./QSelect.711403d0.js";import{Q as L}from"./QToolbar.eb82c9cb.js";import{Q as W}from"./QHeader.781663ae.js";import{Q as f}from"./QInput.f4aaafa9.js";import{Q as h}from"./QDate.a591d058.js";import{Q as j}from"./QTable.d3f01a8d.js";import{Q as G,a as J}from"./QLayout.bc7b9374.js";import{u as Y,Q as C,a as V}from"./use-quasar.e7b3e98f.js";import{Q as z}from"./QForm.cff053ef.js";import{Q}from"./QDialog.711949b7.js";import{Q as K}from"./QCardActions.4ba469fb.js";import{C as X}from"./ClosePopup.5a0721b4.js";import"./AppFullscreen.55e0e68b.js";import"./auto.ba62c17c.js";import"./dayjs.min.cbcf888d.js";import"./exceljs.min.9e24d01d.js";import"./jspdf.plugin.autotable.57a91780.js";import{_ as Z}from"./UserToolbar.39f31d3c.js";import{A as ee}from"./assistApi.2e43d6ae.js";import{u as T}from"./VDB.cb7932a0.js";import{a as w}from"./axios.9ab26c22.js";import{a as le}from"./axios.ba7b1b0e.js";import"./use-key-composition.eac0cc74.js";import"./uid.937d8ee7.js";import"./position-engine.b9957c85.js";import"./rtl.276c3f1b.js";import"./QResizeObserver.eb637c66.js";import"./use-render-cache.3aae9b27.js";import"./date.804f7234.js";import"./QList.fa7ccc12.js";import"./QLinearProgress.11942ba4.js";import"./QCheckbox.a9d08855.js";import"./_commonjsHelpers.88e99c8f.js";const ae={class:"col"},te={class:"col"},oe={class:"row"},se={class:"q-ml-sm"},qe={__name:"withdrawals",setup(re){const m=Y();U();const x=N(),R=T(),O=T(),i=v([]),p=v(null),c=v([]),o=v({val:null,state:!1}),n=v({val:null,opts:[]}),r=v({state:!1,val:null,body:null}),b=v({filter:"",columns:[{name:"date",label:"FECHA",field:a=>a.FECHA,align:"left",sortable:!0},{name:"time",label:"TIME",field:a=>a.HORA,align:"left",sortable:!0},{name:"code",label:"CODIGO",field:a=>a.CODRET,align:"left",sortable:!0},{name:"idter",label:"ID",field:a=>a.CAJRET,align:"center",sortable:!0},{name:"ter",label:"TERMINAL",field:a=>a.DESTER,align:"left",sortable:!0},{name:"conc",label:"CONCEPTO",field:a=>a.CONRET,align:"left",sortable:!0},{name:"import",label:"IMPORTE",field:a=>Number(a.IMPRET).toFixed(2),align:"center",sortable:!0},{name:"provider",label:"PROVEEDOR",field:a=>Number(a.PRORET).toFixed(2),align:"center",sortable:!0}]}),A=S(()=>p.value&&!n.value.val?c.value.filter(a=>a.FECHA==p.value):!p.value&&n.value.val?c.value.filter(a=>a.TERATE==n.value.val.CODTER):p.value&&n.value.val?c.value.filter(a=>a.FECHA==p.value&&a.TERATE==n.value.val.CODTER):c.value),D=async()=>{m.loading.show({message:"Cargando Informacion"}),console.log("se inicia el init");const a=await ee.index();a.error||(console.log(a),i.value.opts=a,m.loading.hide(),k())},I=(a,e)=>{o.value.state=!o.value.state,o.value.val=e},k=async()=>{let a=O.session.store.id;console.log(a);try{let e=await le.get(`/cashier/getPrinters/${a}`);e.status==200&&(r.value.body=e.data,console.log("Impresoras listas :)"))}catch(e){console.log(e),m.notify({message:"No se pudiron obtener las impresoras",type:"negative",position:"center",icon:"error"})}},H=async()=>{console.log(i.value.val.ip_address),m.loading.show({message:"Obteniendo Registros"});let e="http://192.168.10.160:1619/storetools/public/api/reports/getWithdrawals";const t=await w.get(e);t.status!=200?console.log(t):(console.log(t.data),c.value=t.data.cuts,n.value.opts=t.data.terminal,m.loading.hide())},F=async()=>{console.log(i.value.val.ip_address);let a={print:r.value.val.ip_address,codret:o.value.val.CODRET};console.log(a),m.loading.show({message:"Obteniendo Registros"});let t="http://192.168.10.160:1619/storetools/public/api/reports/printWitrawal";const E=await w.post(t,a);E.status!=200?console.log(E):(console.log(E.data),r.value.state=!1,r.value.val=null,o.value.val=null,o.value.state=!1,m.loading.hide())};return R.session.rol==="adm"||R.session.rol==="root"?D():(m.notify({message:"No tienes acceso a esta pagina",type:"negative",position:"center"}),x.replace("/")),(a,e)=>(P(),$(G,{view:"hHh Lpr fFf"},{default:s(()=>[l(W,{class:"bg-grey-3 text-dark",bordered:""},{default:s(()=>[l(Z),l(u),l(L,{class:"justify-between row"},{default:s(()=>[d("div",ae,[e[13]||(e[13]=d("span",{class:"text-grey"},"Helpers",-1)),l(B,{name:"navigate_next",color:"primary"}),e[14]||(e[14]=d("span",{class:"text-h6"},"Cajas Abiertas",-1))]),d("div",te,[d("div",oe,[e[15]||(e[15]=d("div",{class:"col"},null,-1)),l(y,{class:"col",modelValue:i.value.val,"onUpdate:modelValue":[e[0]||(e[0]=t=>i.value.val=t),H],options:i.value.opts,label:"Sucursales",filled:"","option-label":"name",dense:""},null,8,["modelValue","options"])])])]),_:1})]),_:1}),l(J,null,{default:s(()=>[l(u,{spaced:"",inset:"",vertical:"",dark:""}),l(j,{rows:A.value,filter:b.value.filter,columns:b.value.columns,onRowClick:I},{"top-right":s(()=>[l(f,{modelValue:b.value.filter,"onUpdate:modelValue":e[1]||(e[1]=t=>b.value.filter=t),type:"text",label:"Buscar",filled:"",dense:"",disable:!i.value.val},null,8,["modelValue","disable"]),l(u,{spaced:"",inset:"",vertical:"",dark:""}),l(y,{modelValue:n.value.val,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.val=t),options:n.value.opts,label:"Terminal",filled:"",style:{"min-width":"150px"},dense:"","option-label":"DESTER",disable:!i.value.val},null,8,["modelValue","options","disable"]),l(u,{spaced:"",inset:"",vertical:"",dark:""}),l(g,{color:"primary",icon:"event",flat:"",round:"",disable:!i.value.val},{default:s(()=>[l(q,null,{default:s(()=>[l(h,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=t=>p.value=t),landscape:"",minimal:""},null,8,["modelValue"])]),_:1})]),_:1},8,["disable"])]),_:1},8,["rows","filter","columns"])]),_:1}),l(Q,{modelValue:r.value.state,"onUpdate:modelValue":e[5]||(e[5]=t=>r.value.state=t)},{default:s(()=>[l(C,{class:"my-card"},{default:s(()=>[l(V,null,{default:s(()=>e[16]||(e[16]=[d("div",{class:"text-h6 text-center"},"Impresora",-1)])),_:1}),l(V,null,{default:s(()=>[l(z,{onSubmit:F,class:"q-gutter-md"},{default:s(()=>[l(y,{dense:"","option-label":"name",modelValue:r.value.val,"onUpdate:modelValue":e[4]||(e[4]=t=>r.value.val=t),options:r.value.body,label:"Impresora",filled:"",autofocus:"",style:{width:"200px"}},null,8,["modelValue","options"]),d("div",null,[l(g,{label:"Enviar",type:"submit",color:"primary",style:{width:"200px"},disable:r.value.val===null},null,8,["disable"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Q,{modelValue:o.value.state,"onUpdate:modelValue":e[12]||(e[12]=t=>o.value.state=t),persistent:""},{default:s(()=>[l(C,{style:{width:"300px"}},{default:s(()=>[l(V,{class:"text-bold text-center text-h5"},{default:s(()=>[d("span",se,"Retirada "+M(o.value.val.CODRET),1)]),_:1}),l(V,null,{default:s(()=>[l(f,{modelValue:o.value.val.FECHA,"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.val.FECHA=t),type:"date",label:"Fecha",dense:"",filled:"",disable:""},null,8,["modelValue"]),l(u,{spaced:"",inset:"",vertical:"",dark:""}),l(f,{modelValue:o.value.val.HORA,"onUpdate:modelValue":e[7]||(e[7]=t=>o.value.val.HORA=t),type:"time",label:"Hora",dense:"",filled:"",disable:""},null,8,["modelValue"]),l(u,{spaced:"",inset:"",vertical:"",dark:""}),l(f,{modelValue:o.value.val.DESTER,"onUpdate:modelValue":e[8]||(e[8]=t=>o.value.val.DESTER=t),type:"text",label:"Terminal",dense:"",filled:"",disable:""},null,8,["modelValue"]),l(u,{spaced:"",inset:"",vertical:"",dark:""}),l(f,{modelValue:o.value.val.CONRET,"onUpdate:modelValue":e[9]||(e[9]=t=>o.value.val.CONRET=t),type:"text",label:"Concepto",dense:"",filled:"",disable:""},null,8,["modelValue"]),l(u,{spaced:"",inset:"",vertical:"",dark:""}),l(f,{modelValue:o.value.val.IMPRET,"onUpdate:modelValue":e[10]||(e[10]=t=>o.value.val.IMPRET=t),type:"number",label:"Importe",dense:"",filled:"",disable:""},null,8,["modelValue"]),l(u,{spaced:"",inset:"",vertical:"",dark:""})]),_:1}),l(K,{align:"center"},{default:s(()=>[_(l(g,{flat:"",color:"negative",icon:"close"},null,512),[[X]]),l(g,{flat:"",color:"primary",icon:"print",onClick:e[11]||(e[11]=t=>r.value.state=!r.value.state)})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{qe as default};
