import{a as _,b as k,c as i,Q as T,d as $}from"./QList.c491f837.js";import{a as H,u as M,r as p,c as A,o as y,d as w,w as t,e as l,f,a6 as a,S as O,Q as c,g as P,a4 as z,a3 as G,a5 as W,a0 as u,a1 as J,a8 as K}from"./index.0318acbf.js";import{Q as X}from"./QHeader.9aef2b0a.js";import{Q as Z}from"./QDate.eb53ce59.js";import{Q as S,a as x}from"./QCard.e6a2a46a.js";import{Q as N}from"./QCardActions.d3711fb5.js";import{Q as I}from"./QSelect.4ff8e0df.js";import{Q as h}from"./QInput.fa0db633.js";import{Q as ee}from"./QPage.ad91cc96.js";import{u as le}from"./axios.48019e0f.js";import"./jspdf.plugin.autotable.dd8aeb60.js";import{t as C}from"./transferApi.7c6870ed.js";import"./exceljs.min.9e24d01d.js";import"./browser.eff7c919.js";import{d as se}from"./dayjs.min.cbcf888d.js";import{_ as te}from"./UserToolbar.f0602939.js";import"./QResizeObserver.23e7f204.js";import"./use-render-cache.3aae9b27.js";import"./date.8b2fc90e.js";import"./_commonjsHelpers.88e99c8f.js";import"./QExpansionItem.9d64062d.js";import"./QDrawer.d66a88bf.js";import"./QScrollObserver.e91f47b9.js";import"./touch.9135741d.js";import"./ClosePopup.b8e1c166.js";import"./auth.7f7ca47d.js";const oe={class:"row justify-between"},ae={class:"q-pa-md"},Re={__name:"Index",setup(ne){const b=H(),r=M(),d=le(),m=p(!1),v=p(null),g=p(!1),Q=p([]),V=p([]),n=p({_origin:null,_destiny:null,notes:null}),R=A(()=>n.value._origin&&n.value._destiny&&n.value.notes),D=A(()=>r.session.rol!=="alm"?V.value.filter(o=>[1,2,3,4].includes(o.id)):V.value.filter(o=>[5,6,7].includes(o.id))),U=async()=>{console.log("Recibiendo Datos :)"),d.loading.show({message:"Obteniendo Datos"});let o=r.session.store.id;const e=await C.index(o);e.error?console.log(e):(console.log(e),Q.value=e.transfer,V.value=e.warehouses,d.loading.hide())},B=async()=>{d.loading.show({message:"Creando Traspaso"}),n.value.created_by=r.session.name,n.value._store=r.session.store.id,console.log(n.value);const o=await C.addTransfer(n.value);o.error?(console.log(o),d.notify({message:"No se logro crear el traspaso",position:"center",type:"negative"})):(d.loading.hide(),d.notify({message:`Traspaso ${o.code_fs} creada`,position:"center",type:"positive"}),b.push(`transfers/${o.id}`))},E=()=>{g.value=!1,n.value={_origin:null,_destiny:null,notes:null}},L=o=>o.id===n.value._origin.id||r.session.rol!=="aud"&&o.id===4,Y=o=>(console.log(o),r.session.rol!="aud"&&o.id==4),q=async()=>{console.log(v.value),d.loading.show({message:"Obteniendo Datos"});let e={store:r.session.store.id,date:v.value};console.log("Recibiendo Datos :)");const s=await C.getDate(e);s.fail?console.log(s):(console.log(s),Q.value=s,d.loading.hide(),v.value=null,m.value=!1)},j=o=>{console.log(o);let e=o.id;console.log(o.origin.id!==4&&o.destiny.id!==4),r.session.rol=="aud"?b.push(`transfers/${e}`):(r.session.rol=="aux"||r.session.rol=="gen")&&o.origin.id!==4&&o.destiny.id!==4?b.push(`transfers/${e}`):r.session.rol=="alm"&&([5,6,7].includes(o.destiny.id)||[5,6,7].includes(o.origin.id))?b.push(`transfers/${e}`):d.notify({message:"No tienes acceso a este traspaso",type:"negative",position:"center"})};return U(),(o,e)=>(y(),w(ee,{padding:""},{default:t(()=>[l(X,{class:"transparent text-dark",bordered:""},{default:t(()=>[l(te),l(_),f("div",oe,[f("div",null,[e[10]||(e[10]=a("Helpers ")),l(O,{name:"navigate_next",color:"primary"}),e[11]||(e[11]=a()),e[12]||(e[12]=f("span",{class:"text-h6"},"Traspasos entre Almacenes",-1))]),f("div",null,[l(c,{color:"primary",icon:"add",flat:"",onClick:e[0]||(e[0]=s=>g.value=!g.value),round:""}),l(c,{color:"primary",icon:"event",onClick:e[1]||(e[1]=s=>m.value=!m.value),flat:"",round:""})])]),l(_)]),_:1}),l(T,null,{default:t(()=>[l(k,null,{default:t(()=>[l(i,{class:"text-center"},{default:t(()=>e[13]||(e[13]=[a("ID")])),_:1}),l(i,{class:"text-center"},{default:t(()=>e[14]||(e[14]=[a("CREADO")])),_:1}),l(i,{class:"text-center"},{default:t(()=>e[15]||(e[15]=[a("CREADO POR")])),_:1}),l(i,{class:"text-center"},{default:t(()=>e[16]||(e[16]=[a("NOTAS")])),_:1}),l(i,{class:"text-center"},{default:t(()=>e[17]||(e[17]=[a("ORIGEN")])),_:1}),l(i,{class:"text-center"},{default:t(()=>e[18]||(e[18]=[a("DESTINO")])),_:1}),l(i,{class:"text-center"},{default:t(()=>e[19]||(e[19]=[a("FACTUSOL")])),_:1}),l(i,{class:"text-center"},{default:t(()=>e[20]||(e[20]=[a("ARTICULOS")])),_:1})]),_:1})]),_:1}),l(_,{spaced:"",inset:"",vertical:"",dark:""}),(y(!0),P(G,null,z(Q.value,(s,F)=>(y(),w(T,{bordered:"",key:F},{default:t(()=>[W((y(),w(k,{clickable:"",onClick:ie=>j(s)},{default:t(()=>[l(i,{class:"text-center"},{default:t(()=>[a(u(s.id),1)]),_:2},1024),l(i,{class:"text-center"},{default:t(()=>[a(u(J(se)(s.created_at).format("YYYY-MM-D")),1)]),_:2},1024),l(i,{class:"text-center"},{default:t(()=>[a(u(s.created_by),1)]),_:2},1024),l(i,{class:"text-center"},{default:t(()=>[a(u(s.notes),1)]),_:2},1024),l(i,{class:"text-center"},{default:t(()=>[a(u(s.origin.alias),1)]),_:2},1024),l(i,{class:"text-center"},{default:t(()=>[a(u(s.destiny.alias),1)]),_:2},1024),l(i,{class:"text-center"},{default:t(()=>[a(u(s.code_fs),1)]),_:2},1024),l(i,{class:"text-center"},{default:t(()=>[a(u(s.bodie.length),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[K]])]),_:2},1024))),128)),l($,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=s=>m.value=s)},{default:t(()=>[l(S,{class:"my-card"},{default:t(()=>[l(x,null,{default:t(()=>[f("div",ae,[e[21]||(e[21]=f("div",{class:"q-pb-sm"},null,-1)),l(Z,{modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=s=>v.value=s),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),l(x,null,{default:t(()=>[l(N,{align:"right"},{default:t(()=>[l(c,{flat:"",icon:"close",color:"negative",onClick:e[3]||(e[3]=s=>m.value=!m.value)}),l(c,{flat:"",icon:"check",color:"positive",onClick:q})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l($,{modelValue:g.value,"onUpdate:modelValue":e[9]||(e[9]=s=>g.value=s),persistent:""},{default:t(()=>[l(S,{style:{width:"700px","max-width":"80vw"}},{default:t(()=>[l(x,{class:"text-h5 text-bold text-center"},{default:t(()=>e[22]||(e[22]=[a(" Nuevo Traspaso ")])),_:1}),l(x,{class:"row items-center"},{default:t(()=>[l(I,{modelValue:n.value._origin,"onUpdate:modelValue":[e[5]||(e[5]=s=>n.value._origin=s),e[6]||(e[6]=s=>n.value._destiny=null)],options:D.value,label:"Almacen Origen",class:"col","option-label":"name","option-disable":s=>Y(s)},null,8,["modelValue","options","option-disable"]),l(O,{name:"arrow_forward",class:"col",size:"md"}),l(I,{modelValue:n.value._destiny,"onUpdate:modelValue":e[7]||(e[7]=s=>n.value._destiny=s),options:D.value,label:"Almacen Destino",class:"col","option-label":"name","option-disable":s=>L(s),disable:n.value._origin==null},null,8,["modelValue","options","option-disable","disable"])]),_:1}),l(x,null,{default:t(()=>[l(h,{modelValue:n.value.notes,"onUpdate:modelValue":e[8]||(e[8]=s=>n.value.notes=s),type:"text",label:"Notas"},null,8,["modelValue"])]),_:1}),l(N,{align:"center"},{default:t(()=>[l(c,{flat:"",label:"Cancelar",color:"negative",onClick:E}),l(c,{flat:"",label:"Crear",color:"positive",onClick:B,disable:!R.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Re as default};
