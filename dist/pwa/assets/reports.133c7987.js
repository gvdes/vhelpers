import{E as l}from"./exceljs.min.9e24d01d.js";import{d as A}from"./dayjs.min.cbcf888d.js";import{u as U}from"./index.f154296f.js";const V=U(),Y=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},_=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},I=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>{var t,a;return{C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,UGeneral:(t=o.bodega)==null?void 0:t.map(s=>s.path).join("/"),UExhibicion:(a=o.ventas)==null?void 0:a.map(s=>s.path).join("/")}});const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},X=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>{var t,a;return{C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,UGeneral:(t=o.bodega)==null?void 0:t.map(s=>s.path).join("/"),UExhibicion:(a=o.ventas)==null?void 0:a.map(s=>s.path).join("/")}});const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},H=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},J=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>{var t,a;return{C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,UGeneral:(t=o.bodega)==null?void 0:t.map(s=>s.path).join("/"),UExhibicion:(a=o.ventas)==null?void 0:a.map(s=>s.path).join("/")}});const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},N=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},q=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},K=async(e,c)=>{console.log(e);const n=new l.Workbook,i=n.addWorksheet(e.key);let m=e.value.map(t=>({C\u00F3digo:t.id,Modelo:t.code,Descripci\u00F3n:t.description,Proveedor:t.providers.name,Fabricante:t.makers?t.makers.name:"",Status:t.status.name,Secci\u00F3n:t.category.familia.seccion.name,Familia:t.category.familia.name,Categor\u00EDa:t.category.name,"Piezas x caja":t.pieces,StockSucursal:t.stocks.find(a=>a.id==c).pivot.stock,CEDIS:t.stocks.find(a=>a.id==1).pivot.stock,TEXCOCO:t.stocks.find(a=>a.id==2).pivot.stock,Maximo:t.stocks[0].pivot.max,Minimo:t.stocks[0].pivot.min,locations:t.locations.map(a=>a.path).join("/")}));const r=Object.keys(m[0]).map(t=>({name:t,filterButton:!0})),o=m.map(t=>Object.values(t));i.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:r,rows:o}),i.columns.forEach(t=>{let a=0;t.eachCell({includeEmpty:!0},s=>{const p=s.value?s.value.toString().length:10;p>a&&(a=p)}),t.width=a<10?10:a}),await k(n,e.key)},Q=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},Z=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},oo=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,CEDIS:o.stocks.find(t=>t.id==1).pivot.stock,TEXCOCO:o.stocks.find(t=>t.id==2).pivot.stock,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},to=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>{var t,a;return{C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,UGeneral:(t=o.bodega)==null?void 0:t.map(s=>s.path).join("/"),UExhibicion:(a=o.ventas)==null?void 0:a.map(s=>s.path).join("/")}});const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},eo=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=[];e.value.forEach(o=>{o.products.forEach(t=>{var a,s,p,d,h,v,g,y,w,b,f,x,S,E,j,C,M,O,L,R,P,F,W,D,B,T,G,$,z;i.push({"Creado por":o.created_by.names,Fecha:A(o.created_at).format("YYYY-MM-DD H:mm:ss"),Preventa:o.id,Nombre:o.name,Modelo:t.code,Descripci\u00F3n:t.description,Secci\u00F3n:(d=(p=(s=(a=t.category)==null?void 0:a.familia)==null?void 0:s.seccion)==null?void 0:p.name)!=null?d:"",Familia:(g=(v=(h=t.category)==null?void 0:h.familia)==null?void 0:v.name)!=null?g:"",Categor\u00EDa:(w=(y=t.category)==null?void 0:y.name)!=null?w:"","Piezas x caja":t.pieces,Surtido:(x=(f=(b=t.pivot)==null?void 0:b.supply_by)==null?void 0:f.name)!=null?x:"",Unidades:(E=(S=t.pivot)==null?void 0:S.amount)!=null?E:"",Cantidad:(C=(j=t.pivot)==null?void 0:j.units)!=null?C:"",Precio:(O=(M=t.pivot)==null?void 0:M.price)!=null?O:"",Total:(R=(L=t.pivot)==null?void 0:L.total)!=null?R:"",stockSuc:(W=(F=(P=t.stocks)==null?void 0:P.find(u=>u.id==V.session.store.id_va))==null?void 0:F.pivot.stock)!=null?W:0,stockCed:(T=(B=(D=t.stocks)==null?void 0:D.find(u=>u.id==1))==null?void 0:B.pivot.stock)!=null?T:0,stockTex:(z=($=(G=t.stocks)==null?void 0:G.find(u=>u.id==2))==null?void 0:$.pivot.stock)!=null?z:0})})});const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},k=async(e,c)=>{try{const n=await e.xlsx.writeBuffer(),i=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),m=URL.createObjectURL(i),r=document.createElement("a");r.href=m,r.download=`${c}.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(n){console.error("Error al escribir el buffer:",n)}};var io={catalogo:Y,conStock:_,conStockUbicados:I,conStockSinUbicar:X,sinStock:H,sinStockUbicados:J,sinMaximos:N,generalVsExhibicion:q,generalVsCedis:K,conMaximos:Q,negativos:Z,cedisStock:oo,conStockSinContar:to,preorders:eo};export{io as r};
