import{Q as v}from"./QSeparator.799f4ab8.js";import{r as b,o as y,a as R,w as g,u as _,e as m,i as w,a3 as x,Y as L,g as f,a1 as F,a0 as P,h as W,a4 as S}from"./index.d494b13b.js";import{Q as B}from"./QHeader.a922db4b.js";import{Q as D}from"./QSelect.266c796b.js";import{u as T,Q as E,a as C}from"./use-quasar.9f1f2a9c.js";import{Q as $,a as z}from"./QLayout.63c45faa.js";import{u as V}from"./VDB.1e014727.js";import"./jspdf.plugin.autotable.50eded01.js";import{v as j}from"./axios.30672b3a.js";import{E as u}from"./exceljs.min.9e24d01d.js";import"./dayjs.min.25545ff6.js";import"./browser.94c942de.js";import{_ as A}from"./UserToolbar.ea676dfe.js";import"./QResizeObserver.2a2e8bad.js";import"./use-key-composition.720c71eb.js";import"./uid.42677368.js";import"./QItemSection.bf4a904b.js";import"./position-engine.a17c0855.js";import"./QDialog.6ace5f50.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.f1f32898.js";import"./QCardActions.8f9c87fb.js";import"./ClosePopup.a64c36aa.js";var M={index(){return j.get("/reports").then(t=>t.data).catch(t=>({fail:t}))},getReport(t){return j.post("/reports/getReport",t).then(i=>i.data).catch(i=>({fail:i}))}};const Q=async t=>{console.log(t);const i=new u.Workbook,c=i.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));c.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),c.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(i,t.key)},U=async t=>{console.log(t);const i=new u.Workbook,c=i.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));c.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),c.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(i,t.key)},G=async t=>{console.log(t);const i=new u.Workbook,c=i.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));c.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),c.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(i,t.key)},q=async t=>{console.log(t);const i=new u.Workbook,c=i.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));c.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),c.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(i,t.key)},N=async t=>{console.log(t);const i=new u.Workbook,c=i.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));c.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),c.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(i,t.key)},H=async t=>{console.log(t);const i=new u.Workbook,c=i.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));c.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),c.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(i,t.key)},I=async t=>{console.log(t);const i=new u.Workbook,c=i.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));c.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),c.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(i,t.key)},X=async t=>{console.log(t);const i=new u.Workbook,c=i.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));c.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),c.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(i,t.key)},Y=async(t,i)=>{console.log(t);const c=new u.Workbook,n=c.addWorksheet(t.key);let l=t.value.map(e=>({C\u00F3digo:e.id,Modelo:e.code,Descripci\u00F3n:e.description,Proveedor:e.provider.name,Fabricante:e.maker?e.maker.name:"",Status:e.status.name,Secci\u00F3n:e.category.familia.seccion.name,Familia:e.category.familia.name,Categor\u00EDa:e.category.name,"Piezas x caja":e.pieces,SOTANO:e.stocks.find(s=>s.id==i).pivot.stock,CEDIS:e.stocks.find(s=>s.id==1).pivot.stock,TEXCOCO:e.stocks.find(s=>s.id==2).pivot.stock,Maximo:e.stocks[0].pivot.max,Minimo:e.stocks[0].pivot.min,locations:e.locations.map(s=>s.path).join("/")}));const r=Object.keys(l[0]).map(e=>({name:e,filterButton:!0})),o=l.map(e=>Object.values(e));n.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:r,rows:o}),n.columns.forEach(e=>{let s=0;e.eachCell({includeEmpty:!0},a=>{const k=a.value?a.value.toString().length:10;k>s&&(s=k)}),e.width=s<10?10:s}),await d(c,t.key)},J=async t=>{console.log(t);const i=new u.Workbook,c=i.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));c.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),c.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(i,t.key)},K=async t=>{console.log(t);const i=new u.Workbook,c=i.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));c.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),c.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(i,t.key)},Z=async t=>{console.log(t);const i=new u.Workbook,c=i.addWorksheet(t.key);let n=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,CEDIS:o.stocks.find(e=>e.id==1).pivot.stock,TEXCOCO:o.stocks.find(e=>e.id==2).pivot.stock,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(n[0]).map(o=>({name:o,filterButton:!0})),r=n.map(o=>Object.values(o));c.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),c.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(i,t.key)},d=async(t,i)=>{try{const c=await t.xlsx.writeBuffer(),n=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=URL.createObjectURL(n),r=document.createElement("a");r.href=l,r.download=`${i}.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(c){console.error("Error al escribir el buffer:",c)}};var p={catalogo:Q,conStock:U,conStockUbicados:G,conStockSinUbicar:q,sinStock:N,sinStockUbicados:H,sinMaximos:I,generalVsExhibicion:X,generalVsCedis:Y,conMaximos:J,negativos:K,cedisStock:Z};const oo={class:"row justify-between"},eo=w("span",{class:"text-h6"},"Reporteria",-1),to={class:"row"},ao={key:0,class:"row q-pl-sm"},so=["onClick"],io={class:"text--1 text-right q-pa-md"},Fo={__name:"reportsLYT",setup(t){_();const i=V(),c=T(),n=b([]),l=b({seccion:null,familia:null,categoria:null}),r=b([]),o=async()=>{const a=await M.index();a.error?console.log(a):(console.log(a),n.value=a)},e=async()=>{c.loading.show({message:"Obteniendo Datos"});let a={workpoint:i.session.store.id_viz,secciones:l.value.seccion.map(h=>h.id)};const k=await M.getReport(a);k.error?console.log(k):(console.log(k),r.value=Object.keys(k).map(h=>({key:h,value:k[h]})),c.loading.hide())},s=a=>{let k=i.session.store.id_viz;switch(a.key){case"catalogo":p.catalogo(a);break;case"conStock":p.conStock(a);break;case"conStockUbicados":p.conStockUbicados(a);break;case"conStockSinUbicar":p.conStockSinUbicar(a);break;case"sinStock":p.sinStock(a);break;case"sinStockUbicados":p.sinStockUbicados(a);break;case"sinMaximos":p.sinMaximos(a);break;case"generalVsExhibicion":p.generalVsExhibicion(a);break;case"generalVsCedis":p.generalVsCedis(a,k);break;case"conMaximos":p.conMaximos(a);break;case"negativos":p.negativos(a);break;case"cedisStock":p.cedisStock(a);break}};return o(),(a,k)=>(y(),R($,{view:"hHh Lpr fFf"},{default:g(()=>[m(B,{class:"transparent text-dark",bordered:""},{default:g(()=>[m(A),m(v),w("div",oo,[w("div",null,[x("Helpers "),m(L,{name:"navigate_next",color:"primary"}),x(),eo])]),m(v)]),_:1}),m(v,{spaced:"",inset:"",vertical:"",dark:""}),m(z,null,{default:g(()=>[m(E,{class:"my-card"},{default:g(()=>[m(C,null,{default:g(()=>[w("div",to,[m(v,{spaced:"",inset:"",vertical:"",dark:""}),m(D,{dense:"",class:"col",modelValue:l.value.seccion,"onUpdate:modelValue":k[0]||(k[0]=h=>l.value.seccion=h),options:n.value.seccion,label:"Seccion","option-label":"name",filled:"",multiple:"","use-chips":"",onBlur:e},null,8,["modelValue","options"]),m(v,{spaced:"",inset:"",vertical:"",dark:""})])]),_:1})]),_:1}),m(v,{spaced:"",inset:"",vertical:"",dark:""}),r.value.length>0?(y(),f("div",ao,[(y(!0),f(F,null,P(r.value,(h,O)=>(y(),f("div",{class:"col-md-3 col-xs-6 q-pb-sm q-pr-sm",key:O,onClick:co=>s(h)},[m(E,{class:"bg-darkl1"},{default:g(()=>[m(C,{class:"text-h4 text-left"},{default:g(()=>[w("span",null,S(h.value.length),1)]),_:2},1024),w("div",io,S(h.key.toUpperCase()),1)]),_:2},1024)],8,so))),128))])):W("",!0)]),_:1})]),_:1}))}};export{Fo as default};
