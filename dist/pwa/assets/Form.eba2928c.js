import{Q as d}from"./QInput.fcedfc08.js";import{Q}from"./QTooltip.90e13836.js";import{j as w,E as k,F as h,aT as B,r as F,c as S,o as i,a as c,w as t,i as s,e as n,Q as u,a3 as C,h as y,Z as D,a4 as _,g as x,a0 as N,a1 as R,f as T}from"./index.a398b87a.js";import{d as E,Q as $}from"./deposits.18c6cf93.js";import{Q as j}from"./QUploader.f24bbac9.js";import{Q as L}from"./QForm.781b9b16.js";import{Q as z}from"./QPage.a9aa8a57.js";import{u as I}from"./VDB.f91c493a.js";import"./QCard.3d4f36ea.js";import"./QCardActions.3d95d1b0.js";import"./QDialog.ff319547.js";import"./ClosePopup.35ff784d.js";import{u as P}from"./use-quasar.edf415c4.js";import"./jspdf.plugin.autotable.04ab0f02.js";import"./exceljs.min.9e24d01d.js";import"./browser.94c942de.js";import{$socket as m}from"./socket.1159f1bc.js";import"./use-key-composition.b68e04f7.js";import"./uid.42677368.js";import"./position-engine.dc9ebcfa.js";import"./axios.eed4c97e.js";import"./axios.f1f32898.js";import"./format.2bc25e5f.js";import"./_commonjsHelpers.88e99c8f.js";var K=w({name:"QUploaderAddTrigger",setup(){const f=h(B,k);return f===k&&console.error("QUploaderAddTrigger needs to be child of QUploader"),f}});const M={class:"flex justify-center"},O={class:"row no-wrap items-center q-pa-sm q-gutter-xs"},Z={class:"col"},G=s("div",{class:"q-uploader__title"},"Subir Archivo",-1),H={class:"q-uploader__subtitle"},J={class:"row"},W={class:"text-overline"},X={class:"flex justify-center"},Fe={__name:"Form",setup(f){m.connect();const p=I(),v=P(),b=m.connect();b.connected?console.log(`%c Connect ${b.id} `,"background: #222; color: #bada55"):console.log("%c No hay conexion en el socket ","background: #222; color: #bada55"),m.emit("Conexion",p),m.on("Room",a=>{console.log(a)}),console.log(p.session.name);const g=F(null),e=F({origin:null,destiny:null,reference:null,concepto:null,amount:null,files:[]}),V=()=>{e.value={origin:null,destiny:null,reference:null,concepto:null,amount:null,files:[]},g.value.reset()},U=S(()=>e.value.origin&&e.value.destiny&&e.value.reference&&e.value.concepto&&e.value.amount&&e.value.files.length>0),A=a=>{e.value.files=a,console.log("Archivos a\xF1adidos:",e.value.files)},q=async()=>{v.loading.show({message:"Enviando Formulario"});const a=new FormData;a.append("origin",e.value.origin),a.append("destiny",e.value.destiny),a.append("reference",e.value.reference),a.append("concepto",e.value.concepto),a.append("amount",e.value.amount),a.append("_store",p.session.store.id),a.append("send_by",p.session.name),e.value.files.forEach((o,r)=>{a.append(`file_${r}`,o),console.log(e.value.files)});const l=await E.newForm(a);l.fail?console.log(l):(console.log(l),v.loading.hide(),m.emit("Create",l.insert),v.notify({type:"positive",message:l.message}),V())};return(a,l)=>(i(),c(z,{padding:""},{default:t(()=>[s("div",M,[n(L,{onSubmit:q,onReset:V,class:"q-gutter-md"},{default:t(()=>[n(d,{modelValue:e.value.origin,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value.origin=o),type:"number",label:"Cuenta Origen",filled:"",dense:""},null,8,["modelValue"]),n(d,{modelValue:e.value.destiny,"onUpdate:modelValue":l[1]||(l[1]=o=>e.value.destiny=o),type:"number",label:"Cuenta Destino",filled:"",dense:""},null,8,["modelValue"]),n(d,{modelValue:e.value.concepto,"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.concepto=o),type:"text",label:"Referencia",filled:"",dense:""},null,8,["modelValue"]),n(d,{modelValue:e.value.reference,"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.reference=o),type:"number",label:"Referencia Numerica / Folio",filled:"",dense:""},null,8,["modelValue"]),n(d,{modelValue:e.value.amount,"onUpdate:modelValue":l[4]||(l[4]=o=>e.value.amount=o),type:"number",label:"Monto",filled:"",dense:""},null,8,["modelValue"]),n(j,{modelValue:e.value.files,"onUpdate:modelValue":l[6]||(l[6]=o=>e.value.files=o),accept:"image/*","auto-upload":!1,onAdded:A,ref_key:"refe",ref:g},{header:t(o=>[s("div",O,[o.queuedFiles.length>0?(i(),c(u,{key:0,icon:"clear_all",onClick:l[5]||(l[5]=()=>{g.value.reset(),e.value.files=[]}),round:"",dense:"",flat:""},{default:t(()=>[n(Q,null,{default:t(()=>[C("Limpiar")]),_:1})]),_:1})):y("",!0),o.isUploading?(i(),c(D,{key:1,class:"q-uploader__spinner"})):y("",!0),s("div",Z,[G,s("div",H,_(o.uploadSizeLabel)+" / "+_(o.uploadProgressLabel),1)]),o.canAddFiles?(i(),c(u,{key:2,type:"a",icon:"add_box",onClick:o.pickFiles,round:"",dense:"",flat:""},{default:t(()=>[n(K),n(Q,null,{default:t(()=>[C("Subir Archivo")]),_:1})]),_:2},1032,["onClick"])):y("",!0)])]),list:t(o=>[(i(!0),x(R,null,N(o.files,r=>(i(),x("div",{key:r.__key},[s("div",J,[n($,{src:r.__img.src,ratio:20/8,"spinner-color":"primary","spinner-size":"82px",class:"col"},null,8,["src"]),n(u,{color:"negative",icon:"delete",onClick:()=>{o.removeFile(r),e.value.files=[]},flat:"",rounded:""},null,8,["onClick"])]),s("div",W,_(r.name),1)]))),128))]),_:1},8,["modelValue"]),s("div",X,[n(u,{label:"Cancelar",type:"reset",color:"primary",flat:"",class:"q-ml-sm"}),n(u,{label:"Enviar",type:"submit",color:"primary",flat:"",disable:!T(U)},null,8,["disable"])])]),_:1})])]),_:1}))}};export{Fe as default};
