import{Q as _}from"./QToolbarTitle.3e31f9e5.js";import{Q}from"./QSeparator.8a831898.js";import{u as b,r as h,o as P,d as y,w as m,e as o,Q as v,f as B}from"./index.d87ba090.js";import{Q as $}from"./QToolbar.df69cb8a.js";import{Q as S}from"./QPage.ce47e99b.js";import{E as F}from"./exceljs.min.9e24d01d.js";import{u as I}from"./use-quasar.eba3be69.js";import"./dayjs.min.cbcf888d.js";import"./axios.a1a5c455.js";import{u as T}from"./ProductsStore.499bc88d.js";import"./use-dark.af54e05c.js";import"./_commonjsHelpers.88e99c8f.js";const K={__name:"PictureProducts",setup(C){I(),b(),T().setTitle("Imagenes Productos");const l=h(null),f=()=>{l.value.click()},p=async()=>{const t=document.getElementById("inputFile").files[0];if(!t){console.warn("No se seleccion\xF3 ning\xFAn archivo.");return}const c=await t.arrayBuffer(),a=new F.Workbook;await a.xlsx.load(c);const u=a.worksheets[0],r=u.getImages();console.log(`\u{1F4F8} Se encontraron ${r.length} im\xE1genes en el archivo.`);const g=n=>new Promise(i=>setTimeout(i,n));let d=0;for(const n of r){d++;const{range:i,imageId:k}=n,e=a.model.media.find(x=>x.index===k);if(!e||!e.buffer)continue;const w=i.tl.nativeRow+1,s=u.getCell(`C${w}`).value;!s||(`${e.extension}${e.buffer.toString("base64")}`,console.log(`\u{1F9FE} [${d}/${r.length}] Procesando c\xF3digo: ${s}`),console.log(`\u2705 Enviada imagen del c\xF3digo ${s}`),await g(50))}console.log("\u{1F389} Proceso completado.")};return(t,c)=>(P(),y(S,{padding:""},{default:m(()=>[o($,null,{default:m(()=>[o(_),o(Q,{spaced:"",inset:"",vertical:"",dark:""}),o(v,{flat:"",round:"",dense:"",icon:"upload_file",size:"lg",onClick:f,title:"Subir Archivo"})]),_:1}),B("input",{type:"file",ref_key:"inputFile",ref:l,id:"inputFile",onInput:p,hidden:"",accept:".xlsx,.xls"},null,544)]),_:1}))}};export{K as default};
