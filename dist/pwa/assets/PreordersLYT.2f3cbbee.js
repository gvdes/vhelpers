import{b as x}from"./QList.fbe92372.js";import{Q as O}from"./QHeader.5328a33a.js";import{aH as k,a as B,u as S,p as V,l as $,m as b,a$ as C,o as m,d as f,w as n,e as r,a1 as _,f as w,ak as g,S as H,a0 as L,h as N}from"./index.de8d81c3.js";import{Q as R}from"./QToolbar.3c981c3a.js";import{Q as U,a as q}from"./QLayout.5bda3682.js";import"./dayjs.min.cbcf888d.js";import"./axios.29bdad68.js";import{o as D}from"./orderApi.4534f36c.js";import{u as P}from"./OrderStore.67449c7c.js";import{u as T}from"./use-quasar.608984ce.js";import{_ as A}from"./UserToolbar.3a313100.js";import{$sktOrders as o}from"./socket.05630e21.js";import"./use-key-composition.a00e15d3.js";import"./QResizeObserver.ed45798b.js";import"./QScrollObserver.f4fa5630.js";import"./_commonjsHelpers.88e99c8f.js";import"./QSelect.40eb47ae.js";import"./QExpansionItem.a37d0abd.js";import"./QDrawer.d0ae7c5f.js";import"./QCardSection.bdc282f9.js";import"./QCardActions.2df30c51.js";import"./QCard.685d9ac6.js";import"./ClosePopup.f5853d13.js";import"./auth.ca73d5a9.js";const me={__name:"PreordersLYT",setup(z){const j=new Audio("sounds/success01.mp3"),Q=k();B();const t=P(),d=T(),i=S();let a=!1;const h=e=>{switch(e){case 1:case 2:case 6:return"admins";case 8:return"sales";case 4:case 24:case 28:return"supply";default:return"sales"}},u=e=>{console.log(e)},l=e=>{console.log(e)},p=e=>{console.log(e),t.addOrUpdate(e)},c=e=>{console.log(e),t.addOrUpdate(e),e.order._status==5&&Q.path==="/preorders/warehouse"?(console.log("aqui suena"),j.play()):console.log("aqui no suena")},y=async()=>{d.loading.show({message:"Obteniendo datos"});let e={uid:i.session.credentials.staff.id_va,wid:i.session.store.id_viz,view:h(i.session.credentials._rol)};console.log(e);const s=await D.getOrders(e);s.fail?console.log(s):(console.log(s),t.setOrders(s.orders),t.setPrinters(s.prints),t.setUnits(s.units),t.setRules(s.rules),d.loading.hide())};return V(()=>{y(),o.on("connect",()=>{!a&&t.socket_user&&(a=!0,o.emit("join",t.socket_user))}),o.connect(),$(()=>t.socket_user,e=>{e&&!a&&o.connected&&(a=!0,o.emit("join",e))},{immediate:!0}),o.on("joinedat",u),o.on("newjoin",l),o.on("order_add",p),o.on("order_update",c)}),b(()=>{o.off("joinedat",u),o.off("newjoin",l),o.off("order_add",p),o.off("order_update",c)}),(e,s)=>{const v=C("router-view");return m(),f(U,{view:"hHh Lpr fFf"},{default:n(()=>[r(O,{class:"transparent text-dark",bordered:""},{default:n(()=>[r(A),r(x)]),_:1}),r(q,null,{default:n(()=>[_(t).showLyt?(m(),f(R,{key:0,class:"justify-between"},{default:n(()=>[w("div",null,[s[0]||(s[0]=g("Helpers ")),r(H,{name:"navigate_next",color:"primary"}),g(" "+L(_(t).title)+" ",1),s[1]||(s[1]=w("span",{class:"text-h6"},null,-1))])]),_:1})):N("",!0),r(v)]),_:1})]),_:1})}}};export{me as default};
