import{a as f,Q as g}from"./QCard.16a5fd4d.js";import{Q as w}from"./QSeparator.225c3a52.js";import{Q as R,a as u}from"./QItemSection.682f7762.js";import{Q as D}from"./QList.a9c4dc9c.js";import{Q as E}from"./QInput.39c087d0.js";import{u as H,aE as O,r as m,c as N,o as b,a as C,w as o,h as j,e as t,f as l,a5 as r,a0 as M,a4 as c,g as T,a1 as z,a2 as G,Q as _,a3 as P,a7 as h}from"./index.5ced3e40.js";import{Q as S}from"./QCardActions.cacfffe3.js";import{Q as B}from"./QDialog.f34fdc5b.js";import{Q as J}from"./QForm.a5d85d3b.js";import{Q as K}from"./QFooter.16b4a895.js";import{Q as W}from"./QPage.d7ba5a03.js";import{C as X}from"./ClosePopup.046aed46.js";import{u as Z}from"./VDB.daf2eb22.js";import{u as ee}from"./use-quasar.6d58fe31.js";import"./jspdf.plugin.autotable.376ae8f7.js";import{r as V}from"./refundsApi.2501a52a.js";import"./exceljs.min.9e24d01d.js";import"./browser.a927a609.js";import{d as te}from"./dayjs.min.cbcf888d.js";import"./QSelect.06e40bd4.js";import"./axios.ba7b1b0e.js";/* empty css                                                                         */import"./use-key-composition.33c3d238.js";import"./uid.937d8ee7.js";import"./QResizeObserver.3dcb8e42.js";import"./_commonjsHelpers.88e99c8f.js";import"./position-engine.28d4061c.js";import"./rtl.276c3f1b.js";import"./axios.9ab26c22.js";const oe={class:"text-center"},le={class:"text-bold"},se={class:"col text-center"},ae={class:"text-bold"},ie={class:"col text-center"},re={class:"text-bold"},ne={class:"col text-center"},de={class:"text-bold"},ue={class:"col text-center"},ce={class:"text-bold"},ve={class:"text-center text-h4"},me={class:"text-center text-h6 text-grey-14"},pe={class:"row items-start justify-between"},fe={class:"text-center col text-primary"},_e={class:"text-bold"},xe={class:"text-center col"},ge={class:"text-center col"},be={class:"col"},We={__name:"veriferRefund",setup(ye){const y=H(),Q=O(),p=Z(),d=ee();m([]),m([]);const n=m(null),x=m(!1),v=m(null),a=m({state:!1,val:null}),I=N(()=>n.value.bodie.reduce((i,e)=>Number(i)+Number(e.to_received),0)),F=N(()=>v.value?n.value.bodie.filter(i=>{var e;return i.product.toLowerCase().includes((e=v.value)==null?void 0:e.toLowerCase())}):n.value.bodie),k=async()=>{d.loading.show({message:"Obteniendo Datos"});let i=p.session.store.id,e=Q.params.rid;console.log(e);const s=await V.getRefundto(i,e);s.error?console.log(s):s.status.id==3?(console.log(s),d.loading.hide(),n.value=s):(d.notify({message:"Ya no se puede modificar la recepion",type:"negative",position:"top"}),y.replace("/refunds"))},L=()=>{a.value={val:null,state:!1}},$=async()=>{d.loading.show({message:"Creando Proceso"});const i=await V.finallyRefund({id:Q.params.rid});console.log(i),i.fail?console.log(i):(console.log(i),d.notify({message:"Se Realizo correctamente el proceso ",type:"positive",position:"center"}),y.push("/refunds")),d.loading.hide()},A=async()=>{d.loading.show({message:"Editando Producto"}),console.log(a.value.val),a.value.val._refund=Q.params.rid;const i=await V.editProductReceipt(a.value.val);if(i.fail)console.log(i);else{console.log(i);let e=n.value.bodie.findIndex(s=>s.product==a.value.val.product);e>=0&&(n.value.bodie[e].to_received=a.value.val.to_received,d.notify({type:"positive",position:"center"}),a.value={val:null,state:!1},d.loading.hide())}},Y=i=>{a.value.state=!0,a.value.val=i},U=()=>{if(v.value!=null){let i=n.value.bodie.find(e=>e.product.toLowerCase()==v.value.toLowerCase());i?(a.value.state=!0,a.value.val=i):d.notify({message:`No se encuentra el producto ${v.value}`,type:"negative",position:"top"}),v.value=null}};return p.session.rol=="aux"||p.session.rol=="gen"||p.session.rol=="aud"||p.session.rol=="root"?k():(d.notify({message:"No tienes acceso a esta pagina",type:"negative",position:"center"}),y.replace("/")),k(),(i,e)=>n.value?(b(),C(W,{key:0,padding:""},{default:o(()=>[t(g,{class:"my-card"},{default:o(()=>[t(f,{class:"row"},{default:o(()=>[l("div",oe,[e[5]||(e[5]=l("div",{class:"text-caption"},"ID",-1)),l("div",le,r(n.value.id),1)]),l("div",se,[e[6]||(e[6]=l("div",{class:"text-caption"},"REFERENCIA",-1)),l("div",ae,r(n.value.reference),1)]),l("div",ie,[e[7]||(e[7]=l("div",{class:"text-caption"},"ORIGEN",-1)),l("div",re,r(n.value.storefrom.name),1)]),l("div",ne,[e[8]||(e[8]=l("div",{class:"text-caption"},"CREADO",-1)),l("div",de,r(n.value.createdby.complete_name),1)]),l("div",ue,[e[9]||(e[9]=l("div",{class:"text-caption"},"FECHA",-1)),l("div",ce,r(M(te)(n.value.created_at).format("DD-MM-YYYY HH:mm:ss")),1)])]),_:1})]),_:1}),t(w,{spaced:"",inset:"",vertical:"",dark:""}),t(D,{bordered:""},{default:o(()=>[t(R,null,{default:o(()=>[t(u,null,{default:o(()=>e[10]||(e[10]=[c(" Producto ")])),_:1}),t(u,null,{default:o(()=>e[11]||(e[11]=[c(" Descripcion ")])),_:1}),t(u,{class:"text-center"},{default:o(()=>e[12]||(e[12]=[c(" Enviado ")])),_:1}),t(u,{class:"text-center"},{default:o(()=>e[13]||(e[13]=[c(" Recibido ")])),_:1}),t(u,{class:"text-center"},{default:o(()=>e[14]||(e[14]=[c(" Diferencia ")])),_:1})]),_:1})]),_:1}),(b(!0),T(G,null,z(F.value,(s,q)=>(b(),C(D,{bordered:"",key:q},{default:o(()=>[P((b(),C(R,{clickable:"",onClick:Qe=>Y(s)},{default:o(()=>[t(u,null,{default:o(()=>[c(r(s.product),1)]),_:2},1024),t(u,null,{default:o(()=>[c(r(s.description),1)]),_:2},1024),t(u,{class:"text-center"},{default:o(()=>[c(r(s.to_delivered),1)]),_:2},1024),t(u,{class:"text-center"},{default:o(()=>[c(r(s.to_received),1)]),_:2},1024),t(u,{class:"text-center"},{default:o(()=>[c(r(s.to_delivered-s.to_received),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[h]]),t(w)]),_:2},1024))),128)),t(B,{modelValue:a.value.state,"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.state=s),persistent:"",position:"bottom"},{default:o(()=>[t(g,{style:{width:"300","max-width":"40vw"}},{default:o(()=>[t(f,null,{default:o(()=>[l("div",ve,r(a.value.val.product),1),l("div",me,r(a.value.val.description),1)]),_:1}),t(f,null,{default:o(()=>[l("div",pe,[l("div",fe,[e[15]||(e[15]=l("div",null,"Enviado",-1)),l("div",_e,r(a.value.val.to_delivered),1)]),l("div",xe,[e[16]||(e[16]=l("div",null,"Recibido",-1)),t(E,{dense:"",borderless:"",modelValue:a.value.val.to_received,"onUpdate:modelValue":e[0]||(e[0]=s=>a.value.val.to_received=s),type:"number",min:"0","input-class":"text-h6 text-center",ref:"iptcounter"},null,8,["modelValue"])]),l("div",ge,[e[17]||(e[17]=l("div",null,"Diferencia",-1)),l("div",null,r(a.value.val.to_delivered-a.value.val.to_received),1)])])]),_:1}),t(S,{align:"center"},{default:o(()=>[t(_,{flat:"",icon:"close",color:"red-10",onClick:L}),t(_,{flat:"",label:"Editar",color:"blue-10",onClick:A})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(B,{modelValue:x.value,"onUpdate:modelValue":e[2]||(e[2]=s=>x.value=s),persistent:""},{default:o(()=>[t(g,null,{default:o(()=>[t(f,{class:"row items-center"},{default:o(()=>e[18]||(e[18]=[l("span",{class:"text text-h6"},"Estas Seguro de terminar la verificacion no se podra editar",-1)])),_:1}),t(S,{align:"right"},{default:o(()=>[P(t(_,{flat:"",icon:"close",color:"negative"},null,512),[[X]]),t(_,{flat:"",icon:"check",color:"positive",onClick:$})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(K,{reveal:"",elevated:"",bordered:"",class:"bg-white"},{default:o(()=>[t(g,{class:"q-mb-md",flat:"",bordered:"",dense:""},{default:o(()=>[t(f,{class:"row"},{default:o(()=>[l("div",be,[t(J,{onSubmit:U},{default:o(()=>[t(E,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=s=>v.value=s),type:"text",label:"Buscar Codigo",dense:""},null,8,["modelValue"])]),_:1})]),t(w,{spaced:"",inset:"",vertical:"",dark:""}),t(_,{color:"primary",icon:"send",label:"Terminar",onClick:e[4]||(e[4]=s=>x.value=!x.value),disable:I.value==0},null,8,["disable"])]),_:1})]),_:1})]),_:1})]),_:1})):j("",!0)}};export{We as default};
