import{b as v}from"./QList.65556c5b.js";import{Q as R}from"./QHeader.426a104e.js";import{a as L,u as F,r as b,o as y,d as P,w as g,e as k,f as w,ak as x,S as W,g as f,a3 as _,a2 as B,h as D,a0 as S}from"./index.596ff177.js";import{Q as T}from"./QSelect.e9788ea3.js";import{Q as E,a as C}from"./QCard.0898c542.js";import{Q as $,a as z}from"./QLayout.0a1188d8.js";import{v as j,u as V}from"./axios.cedf9a23.js";import"./jspdf.plugin.autotable.f8ac0a16.js";import{E as u}from"./exceljs.min.9e24d01d.js";import"./dayjs.min.cbcf888d.js";import"./browser.eff7c919.js";import{_ as A}from"./UserToolbar.c12b1c77.js";import"./QResizeObserver.3fbd0e80.js";import"./QScrollObserver.91e32615.js";import"./_commonjsHelpers.88e99c8f.js";import"./QExpansionItem.7f810534.js";import"./QDrawer.27b7c764.js";import"./touch.9135741d.js";import"./QCardActions.2d66543a.js";import"./ClosePopup.9507fddf.js";import"./auth.8d3adbb1.js";var M={index(){return j.get("/reports").then(t=>t.data).catch(t=>({fail:t}))},getReport(t){return j.post("/reports/getReport",t).then(n=>n.data).catch(n=>({fail:n}))}};const Q=async t=>{console.log(t);const n=new u.Workbook,i=n.addWorksheet(t.key);let c=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(n,t.key)},U=async t=>{console.log(t);const n=new u.Workbook,i=n.addWorksheet(t.key);let c=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(n,t.key)},G=async t=>{console.log(t);const n=new u.Workbook,i=n.addWorksheet(t.key);let c=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(n,t.key)},q=async t=>{console.log(t);const n=new u.Workbook,i=n.addWorksheet(t.key);let c=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(n,t.key)},N=async t=>{console.log(t);const n=new u.Workbook,i=n.addWorksheet(t.key);let c=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(n,t.key)},H=async t=>{console.log(t);const n=new u.Workbook,i=n.addWorksheet(t.key);let c=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(n,t.key)},I=async t=>{console.log(t);const n=new u.Workbook,i=n.addWorksheet(t.key);let c=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(n,t.key)},X=async t=>{console.log(t);const n=new u.Workbook,i=n.addWorksheet(t.key);let c=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(n,t.key)},J=async(t,n)=>{console.log(t);const i=new u.Workbook,c=i.addWorksheet(t.key);let l=t.value.map(e=>({C\u00F3digo:e.id,Modelo:e.code,Descripci\u00F3n:e.description,Proveedor:e.provider.name,Fabricante:e.maker?e.maker.name:"",Status:e.status.name,Secci\u00F3n:e.category.familia.seccion.name,Familia:e.category.familia.name,Categor\u00EDa:e.category.name,"Piezas x caja":e.pieces,SOTANO:e.stocks.find(s=>s.id==n).pivot.stock,CEDIS:e.stocks.find(s=>s.id==1).pivot.stock,TEXCOCO:e.stocks.find(s=>s.id==2).pivot.stock,Maximo:e.stocks[0].pivot.max,Minimo:e.stocks[0].pivot.min,locations:e.locations.map(s=>s.path).join("/")}));const r=Object.keys(l[0]).map(e=>({name:e,filterButton:!0})),o=l.map(e=>Object.values(e));c.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:r,rows:o}),c.columns.forEach(e=>{let s=0;e.eachCell({includeEmpty:!0},a=>{const m=a.value?a.value.toString().length:10;m>s&&(s=m)}),e.width=s<10?10:s}),await d(i,t.key)},Y=async t=>{console.log(t);const n=new u.Workbook,i=n.addWorksheet(t.key);let c=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(n,t.key)},K=async t=>{console.log(t);const n=new u.Workbook,i=n.addWorksheet(t.key);let c=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(n,t.key)},Z=async t=>{console.log(t);const n=new u.Workbook,i=n.addWorksheet(t.key);let c=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,CEDIS:o.stocks.find(e=>e.id==1).pivot.stock,TEXCOCO:o.stocks.find(e=>e.id==2).pivot.stock,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(c[0]).map(o=>({name:o,filterButton:!0})),r=c.map(o=>Object.values(o));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),i.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},s=>{const a=s.value?s.value.toString().length:10;a>e&&(e=a)}),o.width=e<10?10:e}),await d(n,t.key)},d=async(t,n)=>{try{const i=await t.xlsx.writeBuffer(),c=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=URL.createObjectURL(c),r=document.createElement("a");r.href=l,r.download=`${n}.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(i){console.error("Error al escribir el buffer:",i)}};var p={catalogo:Q,conStock:U,conStockUbicados:G,conStockSinUbicar:q,sinStock:N,sinStockUbicados:H,sinMaximos:I,generalVsExhibicion:X,generalVsCedis:J,conMaximos:Y,negativos:K,cedisStock:Z};const oo={class:"row justify-between q-ml-sm"},eo={class:"row"},to={key:0,class:"row q-pl-sm"},ao=["onClick"],so={class:"text--1 text-right q-pa-md"},Oo={__name:"reportsLYT",setup(t){L();const n=F(),i=V(),c=b([]),l=b({seccion:null,familia:null,categoria:null}),r=b([]),o=async()=>{const a=await M.index();a.error?console.log(a):(console.log(a),c.value=a)},e=async()=>{i.loading.show({message:"Obteniendo Datos"});let a={workpoint:n.session.store.id_viz,secciones:l.value.seccion.map(h=>h.id)};const m=await M.getReport(a);m.error?console.log(m):(console.log(m),r.value=Object.keys(m).map(h=>({key:h,value:m[h]})),i.loading.hide())},s=a=>{i.loading.show({message:"Generando Reporte"});let m=n.session.store.id_viz;switch(a.key){case"catalogo":p.catalogo(a);break;case"conStock":p.conStock(a);break;case"conStockUbicados":p.conStockUbicados(a);break;case"conStockSinUbicar":p.conStockSinUbicar(a);break;case"sinStock":p.sinStock(a);break;case"sinStockUbicados":p.sinStockUbicados(a);break;case"sinMaximos":p.sinMaximos(a);break;case"generalVsExhibicion":p.generalVsExhibicion(a);break;case"generalVsCedis":p.generalVsCedis(a,m);break;case"conMaximos":p.conMaximos(a);break;case"negativos":p.negativos(a);break;case"cedisStock":p.cedisStock(a);break}i.loading.hide()};return o(),(a,m)=>(y(),P($,{view:"hHh Lpr fFf"},{default:g(()=>[k(R,{class:"transparent text-dark",bordered:""},{default:g(()=>[k(A),k(v),k(v)]),_:1}),k(v,{spaced:"",inset:"",vertical:"",dark:""}),k(z,{class:"q-ml-sm"},{default:g(()=>[w("div",oo,[w("div",null,[m[1]||(m[1]=x("Helpers ")),k(W,{name:"navigate_next",color:"primary"}),m[2]||(m[2]=x()),m[3]||(m[3]=w("span",{class:"text-h6"},"Reporteria",-1))])]),k(E,{class:"my-card"},{default:g(()=>[k(C,null,{default:g(()=>[w("div",eo,[k(v,{spaced:"",inset:"",vertical:"",dark:""}),k(T,{dense:"",class:"col",modelValue:l.value.seccion,"onUpdate:modelValue":m[0]||(m[0]=h=>l.value.seccion=h),options:c.value.seccion,label:"Seccion","option-label":"name",filled:"",multiple:"","use-chips":"",onBlur:e},null,8,["modelValue","options"]),k(v,{spaced:"",inset:"",vertical:"",dark:""})])]),_:1})]),_:1}),k(v,{spaced:"",inset:"",vertical:"",dark:""}),r.value.length>0?(y(),f("div",to,[(y(!0),f(_,null,B(r.value,(h,O)=>(y(),f("div",{class:"col-md-3 col-xs-6 q-pb-sm q-pr-sm",key:O,onClick:io=>s(h)},[k(E,{class:"bg-darkl1"},{default:g(()=>[k(C,{class:"text-h4 text-left"},{default:g(()=>[w("span",null,S(h.value.length),1)]),_:2},1024),w("div",so,S(h.key.toUpperCase()),1)]),_:2},1024)],8,ao))),128))])):D("",!0)]),_:1})]),_:1}))}};export{Oo as default};
