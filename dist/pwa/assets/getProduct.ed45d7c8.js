import{d as $,e as A,b as f}from"./QList.a5a3c49b.js";import{u as q,r as g,c as z,o as u,g as v,e,w as t,d as k,al as E,ak as b,b5 as M,I as N,f as a,Q as D,aF as G,aG as J,a0 as i,h as Q,n as K,a as W,aH as X,T as Y,a2 as Z,a3 as ee}from"./index.347d0b78.js";import{Q as te}from"./QToolbar.ad50d0b1.js";import{Q as ae}from"./QHeader.4bf65821.js";import{Q as x}from"./QCardSection.5706caf2.js";import{Q as S}from"./QTd.3c673998.js";import{Q as oe}from"./QTr.3a92c07b.js";import{Q as se}from"./QTable.6727b456.js";import{Q as P}from"./QCard.bfe4a2c0.js";import{Q as le}from"./QFooter.eadd9c44.js";import{Q as re}from"./QPage.3ea915af.js";import{Q as ie,a as ce}from"./QLayout.b388972e.js";import{Q as ne}from"./QBadge.7cea3b84.js";import{Q as I}from"./QSelect.000b8de9.js";import{Q as de}from"./QInput.b1ffda30.js";import{Q as ue}from"./QForm.2cb57edf.js";import{p as C}from"./productsApi.bf13b6e0.js";import{u as T}from"./use-quasar.a16220f0.js";import{H as pe}from"./html5-qrcode-scanner.64619f17.js";import{_ as me}from"./UserToolbar.b251fe6f.js";import"./axios.1856f029.js";import"./QResizeObserver.c29ee97c.js";import"./QLinearProgress.dbf85e1e.js";import"./QCheckbox.12c01702.js";import"./QScrollObserver.88adafb7.js";import"./_commonjsHelpers.88e99c8f.js";import"./QDrawer.5955e554.js";import"./QCardActions.ea3a5e63.js";import"./ClosePopup.fa75c376.js";import"./auth.1ce1df4e.js";const fe={class:"QuickRegular row items-center text-black"},ve={class:"col"},_e={key:0},xe={class:"row items-center justify-between no-wrap QuickRegular"},ge={class:"col"},be={class:"text-grey-4 q-pl-md"},he={class:"text--2 text-grey-5"},ye={key:1},we={key:2,class:"flex flex-center q-pa-md"},Qe={__name:"ProductAutocomplete",props:{limit:{default:30,type:Number},with_locations:{default:null,type:Boolean},with_image:{default:null,type:Boolean},with_prices:{default:null,type:Boolean},with_prices_Invoice:{default:null,type:Boolean},with_stock:{default:null,type:Boolean}},emits:["input","similarcodes","agregar"],setup(V,{emit:c}){T();const h=q(),m=V;let p=null;const _=g(!1),r=g({val:{id:1,label:"Autocomplete",icon:"keyboard"},opts:[{id:1,label:"Autocomplete",icon:"keyboard"},{id:2,label:"barcode",icon:"fas fa-barcode"},{id:3,label:"qr_code",icon:"qr_code"}]}),o=g({buscar:"",iptsearch:{processing:!1,type:"number",icon:"fas fa-font"},options:void 0,read_barcode:!0}),d=z(()=>({search:o.value.buscar,with_locations:m.with_locations,with_stock:m.with_stock,with_prices:m.with_prices,limit:m.limit,_workpoint:h.session.store.id_viz,rol:h.session.credentials.rol})),R=()=>{switch(o.value.iptsearch.type){case"text":o.value.iptsearch.type="number",o.value.iptsearch.icon="fas fa-font";break;case"number":o.value.iptsearch.type="text",o.value.iptsearch.icon="fas fa-hashtag";break}},j=async(n,l,s)=>{let y=n.trim().toUpperCase();if(y.length>=3){o.value.buscar=y,console.log(d.value);const w=await C.autoCompleteProduct(d.value);if(w.fail)console.log(w);else{console.log(w);let U=w;l(()=>{o.value.options=U},B=>{B.setOptionIndex(-1),B.moveOptionSelection(1,!0)})}}},F=async()=>{if(o.value.buscar.trim().toUpperCase(),o.value.buscar.length){const n=await C.exactSearch(d.value);n.fail,console.log(n)}},H=async()=>{if(p){console.log("La c\xE1mara ya est\xE1 activa");return}_.value=!0,K(()=>{p=new pe("reader");const n={fps:20,qrbox:130};p.start({facingMode:"environment"},n,async l=>{try{const s=JSON.parse(l);if(console.log(s),s.modelo){o.value.buscar=s.modelo;const y=await C.scanSearch(d.value);console.log(y)}}catch{console.log("QR inv\xE1lido: "+l)}}).catch(l=>console.log("Error al iniciar c\xE1mara: "+l.message)),console.log("C\xE1mara iniciada")})},L=()=>{if(!p){console.log("La c\xE1mara no estaba activa");return}p.stop().then(()=>{p.clear(),p=null,_.value=!1,console.log("C\xE1mara detenida")}).catch(n=>console.log("Error al detener c\xE1mara: "+n.message))},O=(n,l)=>{n.id==3?H():L()};return(n,l)=>(u(),v("div",fe,[e(I,{modelValue:r.value.val,"onUpdate:modelValue":[l[0]||(l[0]=s=>r.value.val=s),O],class:"flex items-center justify-center","options-dense":"",options:r.value.opts,filled:"",style:{width:"60px"},"hide-dropdown-icon":""},{selected:t(()=>[r.value.val?(u(),k(E,{key:0,size:"xl","text-color":"primary",class:"text-left flex items-left justify-left",icon:r.value.val.icon},null,8,["icon"])):(u(),k(ne,{key:1},{default:t(()=>l[3]||(l[3]=[b("*no hay :{*")])),_:1}))]),option:t(s=>[e($,M(s.itemProps,{class:"flex items-center justify-center"}),{default:t(()=>[e(A,{avatar:"",class:"text-center"},{default:t(()=>[e(N,{name:s.opt.icon},null,8,["name"])]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),a("div",ve,[r.value.val.id==1?(u(),v("div",_e,[e(I,{modelValue:o.value.buscar,"onUpdate:modelValue":l[1]||(l[1]=s=>o.value.buscar=s),"hide-selected":"",behavior:"menu",options:o.value.options,filled:"","hide-dropdown-icon":"","use-input":"",class:"text-uppercase","input-class":"text-h6 text-bold",onFilter:j,"input-debounce":400,autofocus:""},{prepend:t(()=>[e(D,{size:"md",flat:"",padding:"none",onClick:R,icon:o.value.iptsearch.icon,color:"grey-6"},null,8,["icon"])]),option:t(s=>[e($,G(J(s.itemProps)),{default:t(()=>[e(A,null,{default:t(()=>[a("div",xe,[a("div",ge,[a("div",null,[b(i(s.opt.code)+" ",1),a("span",be,i(s.opt.name),1)]),a("div",he,i(s.opt.description),1)])])]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])])):Q("",!0),r.value.val.id==2?(u(),v("div",ye,[e(ue,{onSubmit:F,class:"q-gutter-md"},{default:t(()=>[e(de,{modelValue:o.value.buscar,"onUpdate:modelValue":l[2]||(l[2]=s=>o.value.buscar=s),type:"text",filled:"",class:"text-uppercase","input-class":"text-h6 text-bold",autofocus:""},null,8,["modelValue"])]),_:1})])):Q("",!0),r.value.val.id==3?(u(),v("div",we,[e(P,{class:"camera-card"},{default:t(()=>[e(x,{class:"flex flex-center"},{default:t(()=>l[4]||(l[4]=[a("div",{id:"reader",class:"qr-reader"},null,-1)])),_:1})]),_:1})])):Q("",!0)])]))}};const ke={class:"col"},Se={class:"row justify-center"},Ce={class:"row"},Pe={class:"text-subtitle2 col text-bold text-left text-grey text-overline"},Ve={class:"text-subtitle2 col text-bold text-center text-grey text-overline"},Be={class:"text-subtitle2 col text-bold text-right text-grey text-overline"},$e={class:"row"},Ae={class:"text-h6 col text-bold text-left"},Ie={class:"col text-bold text-center"},qe={class:"text-h6 col text-bold text-right"},Ne={class:"text-subtitle2 col"},Te={class:"text-weight-bold"},Re={class:"text-bold text-blue-13"},je={class:"row q-ml-sm"},ft={__name:"getProduct",setup(V){q(),T(),W(),X();const c=g(null),h=g({columns:[{name:"anio",label:"A\xD1O",field:"year",align:"center"},{name:"sales",label:"COMPRAS",field:"compras",align:"center"},{name:"purchases",label:"VENTAS",field:"ventas",align:"center"}]}),m=_=>{},p=_=>{};return(_,r)=>(u(),k(ie,{view:"hHh Lpr fFf"},{default:t(()=>[e(ae,{class:"bg-grey-3 text-dark",bordered:""},{default:t(()=>[e(me),e(f),e(te,{class:"justify-between row"},{default:t(()=>[a("div",ke,[r[0]||(r[0]=a("span",{class:"text-grey"},"Helpers",-1)),e(N,{name:"navigate_next",color:"primary"}),r[1]||(r[1]=a("span",{class:"text-h6"},"Informaci\xF3n Producto",-1))])]),_:1})]),_:1}),e(ce,null,{default:t(()=>[e(re,{padding:""},{default:t(()=>[a("div",Se,[e(Y,{name:"bounce"},{default:t(()=>[c.value?(u(),k(P,{key:0,class:"my-card"},{default:t(()=>[e(x,{class:"item-center"},{default:t(()=>[a("div",Ce,[a("div",Pe,i(c.value.category.familia.seccion.name),1),a("div",Ve,i(c.value.category.familia.name),1),a("div",Be,i(c.value.category.name),1)])]),_:1}),e(x,{class:"item-center"},{default:t(()=>[a("div",$e,[a("div",Ae,i(c.value.code),1),a("div",Ie,[r[2]||(r[2]=a("div",{class:"text-caption"},"Stock",-1)),a("div",null,i(c.value.total_stock),1)]),a("div",qe,i(c.value.name),1)]),a("div",Ne,i(c.value.description),1)]),_:1}),e(x,{class:"item-center row"},{default:t(()=>[(u(!0),v(ee,null,Z(c.value.prices,(o,d)=>(u(),v("div",{class:"col text-subtitle2 text-center",key:d},[a("div",Te,i(o.alias),1),e(f,{spaced:"",inset:"",vertical:"",dark:""}),a("div",Re,i(o.pivot.price),1),e(f,{spaced:"",inset:"",vertical:"",dark:""})]))),128))]),_:1}),e(x,null,{default:t(()=>[e(se,{rows:c.value.details,hideBottom:"",columns:h.value.columns,pagination:{rowsPerPage:0}},{"bottom-row":t(()=>[e(oe,{class:"text-bold bg-yellow-12"},{default:t(()=>[e(S,{class:"text-center"},{default:t(()=>r[3]||(r[3]=[b(" Total ")])),_:1}),e(S,{class:"text-center"},{default:t(()=>[b(i(c.value.details.reduce((o,d)=>o+Number(d.compras),0)),1)]),_:1}),e(S,{class:"text-center"},{default:t(()=>[b(i(c.value.details.reduce((o,d)=>o+Number(d.ventas),0)),1)]),_:1})]),_:1})]),_:1},8,["rows","columns"])]),_:1})]),_:1})):Q("",!0)]),_:1})]),e(le,{reveal:"",elevated:"",bordered:""},{default:t(()=>[e(f,{spaced:"",inset:"",vertical:"",dark:""}),a("div",je,[e(P,{class:"col"},{default:t(()=>[e(Qe,{checkState:!1,onInput:m,with_prices_Invoice:"",with_stock:"",onAgregar:p,with_locations:""})]),_:1}),e(f,{spaced:"",inset:"",vertical:"",dark:""})]),e(f,{spaced:"",inset:"",vertical:"",dark:""})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{ft as default};
