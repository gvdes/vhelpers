import{Y as y,d as F,u as B,r as m,e as k,Z as I,a as A,f as E,g as t,h as a,a3 as Q,j as n,ag as b,m as v,l as O,n as P,a5 as M,Q as H,k as R,a4 as S}from"./index.02fec612.js";import{Q as D}from"./QHeader.58f7d548.js";import{Q as T}from"./QSelect.4e4b152c.js";import{Q as L}from"./QToolbar.0d9deca6.js";import{Q as N}from"./QTable.b77f1771.js";import{Q as U}from"./QDate.5e388333.js";import{Q as j,a as $}from"./QLayout.64a719bd.js";import"./auto.c3952605.js";import{u as Y}from"./use-quasar.5cb75810.js";import{d as G}from"./dayjs.min.cbcf888d.js";import{E as q}from"./exceljs.min.9e24d01d.js";import"./jspdf.plugin.autotable.b5999051.js";import{_ as K}from"./UserToolbar.cc29d536.js";import{A as J}from"./assistApi.9faed796.js";import{b as W}from"./axios.a188c3a3.js";import"./QResizeObserver.a576a0e4.js";import"./QList.ec23182b.js";import"./QLinearProgress.33c83220.js";import"./use-render-cache.3aae9b27.js";import"./date.333feaf0.js";import"./QScrollObserver.7934ab8b.js";import"./_commonjsHelpers.88e99c8f.js";import"./QExpansionItem.267ef44c.js";import"./QDrawer.210381f4.js";import"./ClosePopup.b90a3e10.js";import"./auth.622669d6.js";const Z={class:"col"},z={class:"col"},X={class:"row"},ee={class:"row"},le={class:"col"},ae={class:"q-pa-md"},ye={__name:"BoxesReport",setup(oe){const i=Y();y(),F(),B();const u=m(!1),p=m(null),d=m({opts:[],val:null}),c=m({columns:[{name:"cash",label:"CAJA",field:l=>l.TERMINAL,align:"left",sortable:!0},{name:"ticket",label:"TICKET",field:l=>l.TICKET,align:"left",sortable:!0},{name:"cliet",label:"CLIENTE",field:l=>l.CLIENTE,align:"left",sortable:!0},{name:"date",label:"FECHA",field:l=>l.FECHA,align:"left",sortable:!0},{name:"hour",label:"HORA",field:l=>l.HORA,align:"left",sortable:!0},{name:"fop",label:"FORMA DE PAGO",field:l=>l.FORMA_PAGO,align:"left",sortable:!0},{name:"import",label:"IMPORTE",field:l=>parseFloat(l.IMPORTE),align:"left",sortable:!0}],pagination:{rowsPerPage:20},filter:""}),C=m([]),r=m({val:null,opts:[]});k(()=>i.platform.is.mobile);const g=k(()=>C.value.filter(l=>r.value.val?l.FORMA_PAGO==r.value.val.DESFPA:l)),V=async()=>{i.loading.show({message:"Cargando Informacion"}),console.log("se inicia el init");const l=await J.index();if(!l.error){console.log(l),d.value.opts=l;let e=new Date,s=G(e).format("YYYY/MM/DD");p.value=s,console.log(s),i.loading.hide()}},w=async()=>{console.log(d.value.val.ip_address),i.loading.show({message:"Obteniendo Registros"}),console.log(p.value);let e=`http://${d.value.val.ip_address}/access/public/reports/getCashCob`;const s=await W.post(e,{filt:p.value});s.status!=200?console.log(s):(console.log(s.data),C.value=s.data.formaspagos,r.value.opts=s.data.formas,u.value=!1,i.loading.hide())};V();const _=()=>{i.loading.show({message:"Importando Ticket"});const l=new q.Workbook;l.addWorksheet("Venta").addTable({name:"Venta",ref:"A1",headerRow:!0,totalsRow:!0,style:{showRowStripes:!0},columns:[{name:"Terminal",filterButton:!0},{name:"Tickets",filterButton:!0},{name:"Cliente",filterButton:!0},{name:"Fecha",filterButton:!0},{name:"Hora",filterButton:!0},{name:"Forma de Pago",filterButton:!0},{name:"Importe",filterButton:!0,totalsRowFunction:"sum"}],rows:g.value.map(o=>[o.TERMINAL,o.TICKET,o.CLIENTE,o.FECHA,o.HORA,o.FORMA_PAGO,parseFloat(o.IMPORTE)])}),(async()=>{const o=await l.xlsx.writeBuffer(),h=new Blob([o],{type:"application/octet-stream"}),x=URL.createObjectURL(h),f=document.createElement("a");f.href=x,f.download="ReporteCajas.xlsx",document.body.appendChild(f),f.click(),document.body.removeChild(f)})(),i.loading.hide()};return(l,e)=>{const s=I("router-view");return A(),E(j,{view:"hHh Lpr fFf"},{default:t(()=>[a($,null,{default:t(()=>[a(D,{class:"bg-grey-3 text-dark",bordered:""},{default:t(()=>[a(K),a(Q)]),_:1}),a(L,{class:"justify-between row"},{default:t(()=>[n("div",Z,[e[8]||(e[8]=n("span",{class:"text-grey"},"Helpers",-1)),a(b,{name:"navigate_next",color:"primary"}),e[9]||(e[9]=n("span",{class:"text-h6"},"Cajas Abiertas",-1))]),n("div",z,[n("div",X,[e[10]||(e[10]=n("div",{class:"col"},null,-1)),a(v,{color:"primary",icon:"event",onClick:e[0]||(e[0]=o=>u.value=!u.value),flat:"",round:"",disable:!d.value.val},null,8,["disable"]),a(v,{color:"primary",icon:"download",onClick:_,flat:"",round:"",disable:g.value.length<=0},null,8,["disable"]),a(T,{class:"col",modelValue:d.value.val,"onUpdate:modelValue":[e[1]||(e[1]=o=>d.value.val=o),w],options:d.value.opts,label:"Sucursales",filled:"","option-label":"name",dense:""},null,8,["modelValue","options"])])])]),_:1}),a(N,{title:"Tickets",rows:g.value,pagination:c.value.pagination,filter:c.value.filter,columns:c.value.columns},{"top-right":t(()=>[n("div",ee,[n("div",le,[a(O,{borderless:"",dense:"",debounce:"300",modelValue:c.value.filter,"onUpdate:modelValue":e[2]||(e[2]=o=>c.value.filter=o),placeholder:"Buscar"},{append:t(()=>[a(b,{name:"search"})]),_:1},8,["modelValue"])]),a(Q,{spaced:"",inset:"",vertical:"",dark:""}),a(T,{class:"col",modelValue:r.value.val,"onUpdate:modelValue":e[4]||(e[4]=o=>r.value.val=o),options:r.value.opts,label:"Formas de pago",filled:"","option-label":"DESFPA",dense:""},{append:t(()=>[r.value.val?(A(),E(b,{key:0,name:"close",onClick:e[3]||(e[3]=o=>r.value.val=null)})):P("",!0)]),_:1},8,["modelValue","options"])])]),_:1},8,["rows","pagination","filter","columns"]),a(M,{modelValue:u.value,"onUpdate:modelValue":e[7]||(e[7]=o=>u.value=o)},{default:t(()=>[a(H,{class:"my-card"},{default:t(()=>[a(R,null,{default:t(()=>[n("div",ae,[e[11]||(e[11]=n("div",{class:"q-pb-sm"},null,-1)),a(U,{modelValue:p.value,"onUpdate:modelValue":e[5]||(e[5]=o=>p.value=o),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),a(R,null,{default:t(()=>[a(S,{align:"right"},{default:t(()=>[a(v,{flat:"",icon:"close",color:"negative",onClick:e[6]||(e[6]=o=>u.value=!u.value)}),a(v,{flat:"",icon:"check",color:"positive",onClick:w})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(s)]),_:1})]),_:1})}}};export{ye as default};
