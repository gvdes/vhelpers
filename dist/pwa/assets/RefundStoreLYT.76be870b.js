import{b as V,Q as h}from"./QList.07e4a383.js";import{Q as O}from"./QHeader.4f002372.js";import{aH as $,a as I,u as D,r as p,o as B,d as U,w as t,e as a,f as n,S as T,Q as c,ak as v,a0 as g,a1 as Y,a4 as q}from"./index.5d1587b8.js";import{Q as j}from"./QDate.5bd53ca2.js";import{Q as u}from"./QCardSection.126a1f08.js";import{Q as F}from"./QCardActions.ac2250ab.js";import{Q as _}from"./QCard.54bfbc35.js";import{d as E,Q as J}from"./QSelect.2830bf69.js";import{Q as z}from"./QToolbar.dad2e338.js";import{Q as G}from"./QInput.8a11a2ce.js";import{Q as w}from"./QTable.52a96cf7.js";import{Q as K}from"./QPage.2113692a.js";import{Q as W,a as X}from"./QLayout.29d67d4c.js";import{Q as P,a as Z,b as N}from"./QTabPanels.13f257d7.js";import{Q as ee}from"./QTabs.4a86ebc7.js";import{Q as le}from"./QForm.d2e5bb26.js";import{C as ae}from"./ClosePopup.18137bc7.js";import"./auto.9014db6f.js";import{u as oe}from"./use-quasar.c1bcf1af.js";import{d as b}from"./dayjs.min.cbcf888d.js";import"./exceljs.min.9e24d01d.js";import"./jspdf.plugin.autotable.0712c099.js";import{_ as te}from"./UserToolbar.ef610af6.js";import{b as C,a as se}from"./axios.7afe1591.js";import"./use-key-composition.e6d81a7d.js";import"./QResizeObserver.942de858.js";import"./use-render-cache.3aae9b27.js";import"./date.a97bc80b.js";import"./QLinearProgress.1c16105b.js";import"./QCheckbox.41464cb5.js";import"./QScrollObserver.9edb0cab.js";import"./QDrawer.321cde08.js";import"./_commonjsHelpers.88e99c8f.js";import"./auth.fdac1b77.js";const ne={class:"col"},ie={class:"text-bold q-ml-md"},re={class:"text-bold q-ml-md"},ue={class:"text-bold q-ml-md"},de={class:"text-bold q-ml-md"},Ee={__name:"RefundStoreLYT",setup(me){const r=oe();$(),I(),D();const d=D(),A=new Date,m=p(b(A).format("YYYY-MM-DD")),Q=p("pagos"),y=p([]),f=p({columns:[{name:"refund",label:"Devolucion",field:l=>l.devolucion,align:"left"},{name:"date",label:"Fecha",field:l=>b(l.fecha).format("YYYY-MM-DD"),align:"left"},{name:"hour",label:"Hora",field:l=>b(l.hora).format("HH-mm-ss"),align:"left"},{name:"client",label:"N Cliente",field:l=>Number(l.num_cli),align:"left"},{name:"cli",label:"Cliente",field:l=>l.cliente,align:"left"},{name:"origin",label:"Origen",field:l=>l.origen,align:"left"},{name:"cash",label:"Caja",field:l=>l.caja,align:"left"},{name:"total",label:"Total",field:l=>Number(l.total).toFixed(2),align:"left"},{name:"coment",label:"Comentario",field:l=>l.comentario,align:"left"},{name:"products",label:"Productos",field:l=>{var e,o;return(o=(e=l.products)==null?void 0:e.length)!=null?o:0},align:"left"},{name:"fpas",label:"Formas Pago",field:l=>{var e,o;return(o=(e=l.fpas)==null?void 0:e.length)!=null?o:0},align:"left"}],columnsfpa:[{name:"fpa",label:"Pago",field:l=>l.FPALCO,align:"left"},{name:"des",label:"Descripcion",field:l=>l.CPTLCO,align:"left"},{name:"total",label:"Total",field:l=>Number(l.IMPLCO).toFixed(2),align:"left"}],columnsProducts:[{name:"code",label:"Articulo",field:l=>l.ARTLFA,align:"left"},{name:"description",label:"Descripcion",field:l=>l.DESLFA,align:"left"},{name:"amount",label:"Cantidad",field:l=>Number(l.CANLFA).toFixed(2),align:"left"},{name:"price",label:"Precio",field:l=>Number(l.PRELFA).toFixed(2),align:"left"},{name:"tota",label:"Total",field:l=>Number(l.TOTLFA).toFixed(2),align:"left"}],filter:null}),s=p({val:null,state:!1}),i=p({state:!1,val:null,body:null}),R=async()=>{let l=d.session.store.id;console.log(l);try{let e=await se.get(`/cashier/getPrinters/${l}`);e.status==200&&(i.value.body=e.data,console.log("Impresoras listas :)"))}catch(e){console.log(e),r.notify({message:"No se pudiron obtener las impresoras",type:"negative",position:"center",icon:"error"})}},L=async()=>{console.log(d.session.store),r.loading.show({message:"Obteniendo Registros"}),console.log(m.value);let e=`http://${d.session.store.ip_address}/storetools/public/api/reports/getRefunds`;console.log(e);const o=await C.post(e,{fechas:m.value});console.log(o),o.status!=200?console.log(o):(console.log(o),y.value=o.data,R(),r.loading.hide())},S=async()=>{console.log(s.value.val.devolucion),r.loading.show({message:"Imprimiendo"});let l=s.value.val.devolucion.split("-"),e={type:"Reimpresion",serie:l[0],folio:l[1],print:i.value.val.ip_address},M=`http://${d.session.store.ip_address}/access/public/modify/newmod`;C.post(M,e).then(x=>{console.log(x),i.value.val=null,i.value.state=!1,r.loading.hide()}).catch(x=>x)},k=(l,e)=>{console.log(e),s.value.state=!0,s.value.val=e},H=async()=>{console.log(d.session.store),r.loading.show({message:"Obteniendo Registros"}),console.log(m.value);let e=`http://${d.session.store.ip_address}/storetools/public/api/reports/getRefunds`;console.log(e);const o=await C.post(e,{fechas:m.value});console.log(o),o.status!=200?console.log(o):(console.log(o),y.value=o.data,r.loading.hide())};return L(),(l,e)=>(B(),U(W,{view:"hHh Lpr fFf"},{default:t(()=>[a(O,{class:"bg-grey-3 text-dark",bordered:""},{default:t(()=>[a(te),a(V)]),_:1}),a(X,null,{default:t(()=>[a(K,{padding:""},{default:t(()=>[a(z,{class:"justify-between row"},{default:t(()=>[n("div",ne,[e[8]||(e[8]=n("span",{class:"text-grey"},"Helpers",-1)),a(T,{name:"navigate_next",color:"primary"}),e[9]||(e[9]=n("span",{class:"text-h6"},"Devoluciones de Sucursales",-1))]),a(c,{color:"primary",icon:"event",flat:"",round:""},{default:t(()=>[a(E,null,{default:t(()=>[a(_,{dense:"",class:"my-card"},{default:t(()=>[a(u,{dense:""},{default:t(()=>[a(j,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=o=>m.value=o),range:"",minimal:"",mask:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),a(F,{vertical:"",align:"center"},{default:t(()=>[a(c,{color:"primary",flat:"",label:"Obtener",onClick:H})]),_:1})]),_:1}),a(V,{spaced:"",inset:"",vertical:"",dark:""})]),_:1})]),_:1})]),_:1}),a(V,{spaced:"",inset:"",vertical:"",dark:""}),a(w,{rows:y.value,columns:f.value.columns,filter:f.value.filter,onRowClick:k},{"top-right":t(()=>[a(G,{borderless:"",dense:"",debounce:"300",modelValue:f.value.filter,"onUpdate:modelValue":e[1]||(e[1]=o=>f.value.filter=o),placeholder:"Buscar"},{append:t(()=>[a(T,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","filter"])]),_:1})]),_:1}),a(h,{modelValue:s.value.state,"onUpdate:modelValue":e[5]||(e[5]=o=>s.value.state=o),persistent:""},{default:t(()=>[a(_,null,{default:t(()=>[a(u,{class:"text-center text-bold text-h5"},{default:t(()=>[v(" Devolucion "+g(s.value.val.devolucion),1)]),_:1}),a(u,null,{default:t(()=>[n("div",null,[e[10]||(e[10]=v("NOTAS: ")),n("span",ie,g(s.value.val.comentario),1)]),n("div",null,[e[11]||(e[11]=v("CLIENTE: ")),n("span",re,g(s.value.val.cliente),1)]),n("div",null,[e[12]||(e[12]=v("CAJA: ")),n("span",ue,g(s.value.val.caja),1)]),n("div",null,[e[13]||(e[13]=v("Fecha y Hora: ")),n("span",de,g(` ${Y(b)(s.value.val.fecha).format("YYYY-MM-DD")}
              ${Y(b)(s.value.val.hora).format("HH:mm:ss")}`),1)])]),_:1}),a(u,null,{default:t(()=>[a(ee,{modelValue:Q.value,"onUpdate:modelValue":e[2]||(e[2]=o=>Q.value=o),class:"text-primary",dense:""},{default:t(()=>[a(P,{name:"pagos",icon:"payments"}),a(P,{name:"products",icon:"inventory_2"})]),_:1},8,["modelValue"])]),_:1}),a(u,null,{default:t(()=>[a(Z,{modelValue:Q.value,"onUpdate:modelValue":e[3]||(e[3]=o=>Q.value=o),animated:""},{default:t(()=>[a(N,{name:"pagos"},{default:t(()=>[a(w,{rows:s.value.val.fpas,"hide-bottom":"",columns:f.value.columnsfpa},null,8,["rows","columns"])]),_:1}),a(N,{name:"products"},{default:t(()=>[a(w,{rows:s.value.val.products,columns:f.value.columnsProducts},null,8,["rows","columns"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(F,{align:"center"},{default:t(()=>[q(a(c,{flat:"",icon:"close"},null,512),[[ae]]),a(c,{flat:"",icon:"print",class:"text-primary",onClick:e[4]||(e[4]=o=>i.value.state=!i.value.state)})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(h,{modelValue:i.value.state,"onUpdate:modelValue":e[7]||(e[7]=o=>i.value.state=o)},{default:t(()=>[a(_,{class:"my-card"},{default:t(()=>[a(u,null,{default:t(()=>e[14]||(e[14]=[n("div",{class:"text-h6 text-center"},"Impresora",-1)])),_:1}),a(u,null,{default:t(()=>[a(le,{onSubmit:S,class:"q-gutter-md"},{default:t(()=>[a(J,{dense:"","option-label":"name",modelValue:i.value.val,"onUpdate:modelValue":e[6]||(e[6]=o=>i.value.val=o),options:i.value.body,label:"Impresora",filled:"",autofocus:"",style:{width:"200px"}},null,8,["modelValue","options"]),n("div",null,[a(c,{label:"Enviar",type:"submit",color:"primary",style:{width:"200px"},disable:i.value.val===null},null,8,["disable"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Ee as default};
