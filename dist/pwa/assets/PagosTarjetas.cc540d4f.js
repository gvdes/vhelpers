import{Q as r}from"./position-engine.2b09cd9b.js";import{r as p,c as h,o as R,a as V,w as n,e as o,i as l,U as I,f,Q as x}from"./index.cb6bf114.js";import{Q as D}from"./QSelect.ed1cf371.js";import{a as F,Q as H}from"./axios.9869c6a6.js";import{Q as L,_ as N}from"./UserToolbar.6b5b03b3.js";import{Q as O}from"./QInput.5db4f9cb.js";import{Q as $}from"./QForm.7e64568e.js";import{Q}from"./QTable.c93c33dd.js";import{Q as J}from"./QPage.d30ff791.js";import{Q as P,c as M}from"./QLayout.c205f1a3.js";import{u as U}from"./VDB.72514136.js";import{e as y}from"./jspdf.plugin.autotable.d5a5550a.js";import{u as q}from"./use-quasar.d185c755.js";import"./axios.8dd358a8.js";import"./index.6ece48f5.js";import"./QDialog.503a09f9.js";import"./QItem.78cc4d88.js";import"./QList.aa060c1b.js";import"./QLinearProgress.06b5132d.js";import"./QCheckbox.b113dfe4.js";import"./_commonjsHelpers.88e99c8f.js";const K=l("span",{class:"text-grey"},"Helpers",-1),z=l("span",{class:"text-h6"},"Tarjetas",-1),G={class:"row"},W={class:"row"},X={class:"row"},Y={class:"col"},Z={class:"row"},ee={class:"col"},ae={class:"row"},te={class:"col"},Ce={__name:"PagosTarjetas",setup(oe){const k=U(),i=q(),v=p(null),c=p([]),C=p([]),d=p({val:"SELECCIONA CAJA",opts:[]}),b=p([{name:"bauchers",label:"Baucher",field:a=>a}]),u=p([{name:"terminal",label:"Caja",align:"left",field:a=>a.TERMINAL},{name:"ticket",label:"Ticket",field:a=>a.TICKET},{name:"total",label:"Total",field:a=>a.TARJETAS},{name:"fecha",label:"Fecha",field:a=>a.FECHA},{name:"hora",label:"Hora",field:a=>a.HORA},{name:"cliente",label:"Cliente",align:"left",field:a=>a.CLIENTE}]),g=h(()=>d.value.val?C.value.filter(a=>a.TERMINAL==d.value.val.DESTER):[]),_=h(()=>{if(c.value.length>0){let a=[...c.value];return g.value.filter(s=>{const e=a.indexOf(s.TARJETAS);return e!==-1?(a.splice(e,1),!0):!1})}else return[]}),T=h(()=>{if(c.value.length>0){let a=[...c.value];return g.value.filter(s=>{const e=a.indexOf(s.TARJETAS);return e!==-1?(a.splice(e,1),!1):!0})}else return g.value}),w=h(()=>{let a=[...g.value];return c.value.filter(s=>{const e=a.findIndex(t=>t.TARJETAS===s);return e!==-1?(a.splice(e,1),!1):!0})}),E=()=>{v.value&&(c.value.push(v.value),v.value=null)},S=async()=>{console.log("Recibiendo Datos :)"),i.loading.show({message:"Obteniendo datos"});let s=`http://${k.session.store.ip}/access/public/reports/getCashCard`;F.get(s).then(e=>{console.log(e),C.value=e.data.formaspagos,d.value.opts=e.data.terminales,i.loading.hide()}).catch(e=>console.log(e))},j=()=>{const a=[b.value.map(e=>m(e.label))].concat(w.value.map(e=>b.value.map(t=>m(typeof t.field=="function"?t.field(e):e[t.field===void 0?t.name:t.field],t.format,e)).join(","))).join(`\r
`);y("SobrantesBauchers.csv",a,"text/csv")!==!0?i.notify({message:"Browser denied file download...",color:"negative",icon:"warning"}):i.notify({message:"Descarga Completa :)",color:"positive",icon:"check",position:"center"})},A=()=>{const a=[u.value.map(e=>m(e.label))].concat(T.value.map(e=>u.value.map(t=>m(typeof t.field=="function"?t.field(e):e[t.field===void 0?t.name:t.field],t.format,e)).join(","))).join(`\r
`);y("BucherFaltantes.csv",a,"text/csv")!==!0?i.notify({message:"Browser denied file download...",color:"negative",icon:"warning"}):i.notify({message:"Descarga Completa :)",color:"positive",icon:"check",position:"center"})},B=()=>{const a=[u.value.map(e=>m(e.label))].concat(_.value.map(e=>u.value.map(t=>m(typeof t.field=="function"?t.field(e):e[t.field===void 0?t.name:t.field],t.format,e)).join(","))).join(`\r
`);y("BauchersEncontrados.csv",a,"text/csv")!==!0?i.notify({message:"Browser denied file download...",color:"negative",icon:"warning"}):i.notify({message:"Descarga Completa :)",color:"positive",icon:"check",position:"center"})},m=(a,s,e)=>{let t=s!==void 0?s(a,e):a;return t=t==null?"":String(t),t=t.split('"').join('""'),/^\d{1,2}-\d{4}$/.test(t)&&(t=`'${t}`),`"${t}"`};return S(),(a,s)=>(R(),V(P,{view:"hHh Lpr fFf"},{default:n(()=>[o(M,null,{default:n(()=>[o(J,{padding:""},{default:n(()=>[o(L,{class:"bg-grey-3 text-dark",bordered:""},{default:n(()=>[o(N),o(r),o(H,{class:"justify-between"},{default:n(()=>[l("div",null,[K,o(I,{name:"navigate_next",color:"primary"}),z]),l("div",G,[o(D,{modelValue:d.value.val,"onUpdate:modelValue":s[0]||(s[0]=e=>d.value.val=e),options:d.value.opts,"option-label":"DESTER",label:"Caja",outlined:"",dense:""},null,8,["modelValue","options"])])]),_:1})]),_:1}),o(r,{spaced:"",inset:"",vertical:"",dark:""}),o($,{onSubmit:E,class:"q-gutter-md"},{default:n(()=>[o(O,{modelValue:v.value,"onUpdate:modelValue":s[1]||(s[1]=e=>v.value=e),type:"number",label:"IMPORTE",outlined:""},null,8,["modelValue"])]),_:1}),o(r,{spaced:"",inset:"",vertical:"",dark:""}),l("div",W,[o(Q,{title:"Bauchers Faltantes",rows:f(w),"row-key":"name",class:"col",columns:b.value},{"top-right":n(()=>[l("div",X,[o(r,{spaced:"",inset:"",vertical:"",dark:""}),l("div",Y,[o(x,{color:"primary",icon:"archive",dense:"","no-caps":"",flat:"",round:"",onClick:j,disable:!(f(w).length>0)},null,8,["disable"])])])]),_:1},8,["rows","columns"]),o(r,{spaced:"",inset:"",vertical:"",dark:""}),o(Q,{title:"Cobros Faltantes",rows:f(T),"row-key":"name",class:"col",columns:u.value},{"top-right":n(()=>[l("div",Z,[o(r,{spaced:"",inset:"",vertical:"",dark:""}),l("div",ee,[o(x,{color:"primary",icon:"archive",dense:"","no-caps":"",flat:"",round:"",onClick:A,disable:!(f(T).length>0)},null,8,["disable"])])])]),_:1},8,["rows","columns"])]),o(r,{spaced:"",inset:"",vertical:"",dark:""}),o(Q,{title:"Cobros Encontrados",rows:f(_),"row-key":"name",columns:u.value},{"top-right":n(()=>[l("div",ae,[o(r,{spaced:"",inset:"",vertical:"",dark:""}),l("div",te,[o(x,{color:"primary",icon:"archive",dense:"","no-caps":"",flat:"",round:"",onClick:B,disable:!(f(_).length>0)},null,8,["disable"])])])]),_:1},8,["rows","columns"])]),_:1})]),_:1})]),_:1}))}};export{Ce as default};
