import{f as H,u as M,r as p,g as D,a as y,h as Q,i as o,d as s,a4 as w,k as f,j as n,ah as T,n as c,b9 as P,a7 as $,c as G,a2 as W,a3 as X,Q as A,l as x,a5 as O,a6 as N,m as J,aX as K,a1 as u,aj as Z}from"./index.0d286209.js";import{Q as h}from"./QHeader.bdd66876.js";import{a as S,b as r,Q as I}from"./QList.c6b82b90.js";import{Q as ee}from"./QDate.9c856ba6.js";import{Q as R}from"./QSelect.75fb6875.js";import{Q as se}from"./QPage.c6de2f38.js";import{u as le}from"./use-quasar.99736a50.js";import"./jspdf.plugin.autotable.1bc3e9d3.js";import{t as C}from"./transferApi.efc79a24.js";import"./exceljs.min.9e24d01d.js";import"./JsBarcode.cb858474.js";import"./browser.c61f550a.js";import{d as oe}from"./dayjs.min.cbcf888d.js";import{_ as te}from"./UserToolbar.abe3d599.js";import"./QResizeObserver.b173e2da.js";import"./use-render-cache.3aae9b27.js";import"./date.142480ff.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.641704b8.js";import"./QImg.f121d2fb.js";import"./QSpace.f0ea4fd4.js";import"./QExpansionItem.9fa686a6.js";import"./favorites.28144d1a.js";import"./QScrollObserver.24fbe5fa.js";import"./ClosePopup.b1db4109.js";import"./auth.e905e1b7.js";const ae={class:"row justify-between"},ne={class:"q-pa-md"},Ue={__name:"Index",setup(ie){const b=H(),a=M(),d=le(),m=p(!1),v=p(null),g=p(!1),V=p([]),_=p([]),i=p({_origin:null,_destiny:null,notes:null}),U=D(()=>i.value._origin&&i.value._destiny&&i.value.notes),k=D(()=>a.session.rol!=="alm"&&a.session.rol!=="vld"&&a.session.rol!=="gce"?_.value.filter(t=>[1,2,3,4].includes(t.id)):_.value.filter(t=>[5,6,7,8,9].includes(t.id))),j=async()=>{console.log("Recibiendo Datos :)"),d.loading.show({message:"Obteniendo Datos"});let t=a.session.store.id;const e=await C.index(t);e.error?console.log(e):(console.log(e),V.value=e.transfer,_.value=e.warehouses,d.loading.hide())},B=async()=>{d.loading.show({message:"Creando Traspaso"}),i.value.created_by=a.session.name,i.value._store=a.session.store.id,console.log(i.value);const t=await C.addTransfer(i.value);t.error?(console.log(t),d.notify({message:"No se logro crear el traspaso",position:"center",type:"negative"})):(d.loading.hide(),d.notify({message:`Traspaso ${t.code_fs} creada`,position:"center",type:"positive"}),b.push(`transfers/${t.id}`))},z=()=>{g.value=!1,i.value={_origin:null,_destiny:null,notes:null}},E=t=>t.id===i.value._origin.id||a.session.rol!=="gro"&&a.session.rol!=="jfz"&&a.session.rol!=="axo"&&t.id===4,L=t=>t.id==4&&a.session.rol!="gro"&&a.session.rol!="jfz"&&a.session.rol!="axo",Y=async()=>{console.log(v.value),d.loading.show({message:"Obteniendo Datos"});let e={store:a.session.store.id,date:v.value};console.log("Recibiendo Datos :)");const l=await C.getDate(e);l.fail?console.log(l):(console.log(l),V.value=l,d.loading.hide(),v.value=null,m.value=!1)},q=t=>{console.log(t);let e=t.id;console.log(t.origin.id!==4&&t.destiny.id!==4),a.session.rol=="axo"||a.session.rol=="root"||a.session.rol=="jfz"||a.session.rol=="gro"||a.session.rol=="des"?b.push(`transfers/${e}`):(a.session.rol=="aux"||a.session.rol=="gen")&&t.origin.id!==4&&t.destiny.id!==4?b.push(`transfers/${e}`):(a.session.rol=="alm"||a.session.rol=="vld"||a.session.rol=="gce")&&([5,6,7].includes(t.destiny.id)||[5,6,7].includes(t.origin.id))?b.push(`transfers/${e}`):d.notify({message:"No tienes acceso a este traspaso",type:"negative",position:"center"})};return j(),(t,e)=>(y(),Q(se,{padding:""},{default:o(()=>[s(h,{class:P($(d).dark.isActive?"text-white bg-dark":"text-dark bg-white"),bordered:""},{default:o(()=>[s(te),s(w),f("div",ae,[f("div",null,[e[10]||(e[10]=n("Helpers ")),s(T,{name:"navigate_next",color:"primary"}),e[11]||(e[11]=n()),e[12]||(e[12]=f("span",{class:"text-h6"},"Traspasos entre Almacenes",-1))]),f("div",null,[s(c,{color:"primary",icon:"add",flat:"",onClick:e[0]||(e[0]=l=>g.value=!g.value),round:""}),s(c,{color:"primary",icon:"event",onClick:e[1]||(e[1]=l=>m.value=!m.value),flat:"",round:""})])]),s(w)]),_:1},8,["class"]),s(I,null,{default:o(()=>[s(S,null,{default:o(()=>[s(r,{class:"text-center"},{default:o(()=>e[13]||(e[13]=[n("ID")])),_:1}),s(r,{class:"text-center"},{default:o(()=>e[14]||(e[14]=[n("CREADO")])),_:1}),s(r,{class:"text-center"},{default:o(()=>e[15]||(e[15]=[n("CREADO POR")])),_:1}),s(r,{class:"text-center"},{default:o(()=>e[16]||(e[16]=[n("NOTAS")])),_:1}),s(r,{class:"text-center"},{default:o(()=>e[17]||(e[17]=[n("ORIGEN")])),_:1}),s(r,{class:"text-center"},{default:o(()=>e[18]||(e[18]=[n("DESTINO")])),_:1}),s(r,{class:"text-center"},{default:o(()=>e[19]||(e[19]=[n("FACTUSOL")])),_:1}),s(r,{class:"text-center"},{default:o(()=>e[20]||(e[20]=[n("ARTICULOS")])),_:1})]),_:1})]),_:1}),s(w,{spaced:"",inset:"",vertical:"",dark:""}),(y(!0),G(X,null,W(V.value,(l,F)=>(y(),Q(I,{bordered:"",key:F},{default:o(()=>[K((y(),Q(S,{clickable:"",onClick:re=>q(l)},{default:o(()=>[s(r,{class:"text-center"},{default:o(()=>[n(u(l.id),1)]),_:2},1024),s(r,{class:"text-center"},{default:o(()=>[n(u($(oe)(l.created_at).format("YYYY-MM-D")),1)]),_:2},1024),s(r,{class:"text-center"},{default:o(()=>[n(u(l.created_by),1)]),_:2},1024),s(r,{class:"text-center"},{default:o(()=>[n(u(l.notes),1)]),_:2},1024),s(r,{class:"text-center"},{default:o(()=>[n(u(l.origin.alias),1)]),_:2},1024),s(r,{class:"text-center"},{default:o(()=>[n(u(l.destiny.alias),1)]),_:2},1024),s(r,{class:"text-center"},{default:o(()=>[n(u(l.code_fs),1)]),_:2},1024),s(r,{class:"text-center"},{default:o(()=>[n(u(l.bodie.length),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[Z]])]),_:2},1024))),128)),s(N,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=l=>m.value=l)},{default:o(()=>[s(A,{class:"my-card"},{default:o(()=>[s(x,null,{default:o(()=>[f("div",ne,[e[21]||(e[21]=f("div",{class:"q-pb-sm"},null,-1)),s(ee,{modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=l=>v.value=l),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),s(x,null,{default:o(()=>[s(O,{align:"right"},{default:o(()=>[s(c,{flat:"",icon:"close",color:"negative",onClick:e[3]||(e[3]=l=>m.value=!m.value)}),s(c,{flat:"",icon:"check",color:"positive",onClick:Y})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(N,{modelValue:g.value,"onUpdate:modelValue":e[9]||(e[9]=l=>g.value=l),persistent:""},{default:o(()=>[s(A,{style:{width:"700px","max-width":"80vw"}},{default:o(()=>[s(x,{class:"text-h5 text-bold text-center"},{default:o(()=>e[22]||(e[22]=[n(" Nuevo Traspaso ")])),_:1}),s(x,{class:"row items-center"},{default:o(()=>[s(R,{modelValue:i.value._origin,"onUpdate:modelValue":[e[5]||(e[5]=l=>i.value._origin=l),e[6]||(e[6]=l=>i.value._destiny=null)],options:k.value,label:"Almacen Origen",class:"col","option-label":"name","option-disable":l=>L(l)},null,8,["modelValue","options","option-disable"]),s(T,{name:"arrow_forward",class:"col",size:"md"}),s(R,{modelValue:i.value._destiny,"onUpdate:modelValue":e[7]||(e[7]=l=>i.value._destiny=l),options:k.value,label:"Almacen Destino",class:"col","option-label":"name","option-disable":l=>E(l),disable:i.value._origin==null},null,8,["modelValue","options","option-disable","disable"])]),_:1}),s(x,null,{default:o(()=>[s(J,{modelValue:i.value.notes,"onUpdate:modelValue":e[8]||(e[8]=l=>i.value.notes=l),type:"text",label:"Notas"},null,8,["modelValue"])]),_:1}),s(O,{align:"center"},{default:o(()=>[s(c,{flat:"",label:"Cancelar",color:"negative",onClick:z}),s(c,{flat:"",label:"Crear",color:"positive",onClick:B,disable:!U.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Ue as default};
