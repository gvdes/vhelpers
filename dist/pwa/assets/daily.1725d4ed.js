import{Q as L}from"./QPage.2e793c9e.js";import{br as M,a as T,u as _,r as n,c as k,q as $,J as C,o as D,d as F,w as G,e as d,X as h}from"./index.02e98f23.js";import"./QSelect.53941b07.js";import{u as R}from"./use-quasar.dc53eb3e.js";import"./dayjs.min.cbcf888d.js";import"./QList.87ca2251.js";import"./QExpansionItem.3c424fa7.js";import"./QDrawer.eb1e7cb5.js";import"./ClosePopup.5123f35e.js";import"./axios.87cc1b88.js";import{u as X,m as f}from"./vue3-apexcharts.736611a5.js";import"./_commonjsHelpers.88e99c8f.js";import"./QResizeObserver.04e1b2fd.js";import"./QScrollObserver.beba53c5.js";const tt={__name:"daily",setup(B){const x=R(),r=X();M(),T(),_();const v=n({}),A=n([]),b=n({}),g=n([]),m=n(null),y=n({}),O=n([]),u=n(null),S=k(()=>x.platform.is.mobile),i=k(()=>u.value==null?r.stores:r.stores.filter(t=>t.sucursal.id==u.value.sucursal.id)),w=()=>{v.value={chart:{id:"stores",background:"none",toolbar:{show:!1},events:{dataPointSelection(t,o,{dataPointIndex:e}){e===m.value?(m.value=null,u.value=null,p(),c()):(m.value=e,u.value=r.stores[e],p(),c(),console.log(i.value))}}},tooltip:{y:{formatter:t=>"$"+t.toLocaleString("es-MX")}},xaxis:{categories:r.stores.map(t=>S.value?t.sucursal.alias:t.sucursal.name),labels:{show:!1}},plotOptions:{bar:{horizontal:!0,columnWidth:"100%",barHeight:"90%"}},dataLabels:{formatter:t=>"$ "+t.toLocaleString("es-MX"),style:{colors:["#333"]}}},A.value=[{name:`VENTA ${r.today}`,data:r.stores.map(t=>{var o,e;return((e=(o=t.data)==null?void 0:o.salesAct)==null?void 0:e.total)||0})}]},c=()=>{const t={};i.value.forEach(e=>{e.data.salesAct.desglose.forEach(a=>{t[a.FORMAPAGO]?t[a.FORMAPAGO]+=parseFloat(a.TOTAL):t[a.FORMAPAGO]=parseFloat(a.TOTAL)})});let o=Object.entries(t).map(([e,a])=>({FORMAPAGO:e,TOTAL:a}));console.log(o),y.value={chart:{type:"donut",background:"none",toolbar:{show:!1}},labels:o.map(e=>e.FORMAPAGO),tooltip:{y:{formatter:e=>"$"+e.toLocaleString("es-MX")}},legend:{position:"bottom"}},O.value=o.map(e=>e.TOTAL)},p=()=>{const t=i.value.reduce((s,l)=>s+(l.data.salesAct.total||0),0),o=i.value.reduce((s,l)=>s+(l.data.salesAnt.total||0),0),e=i.value.reduce((s,l)=>s+(l.data.salesAct.tickets||0),0),a=i.value.reduce((s,l)=>s+(l.data.salesAnt.tickets||0),0);b.value={chart:{id:"global",toolbar:{show:!1},background:"transparent"},colors:["#4ECDC4","#556270"],tooltip:{y:{formatter:s=>"$"+s.toLocaleString("es-MX")}},xaxis:{categories:["A\xD1O Anterior","A\xD1O Actual"]},yaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},dataLabels:{formatter:(s,{dataPointIndex:l})=>`${"$ "+s.toLocaleString("es-MX")}
Tcks: ${l===0?a:e}`,style:{colors:["#333"]}}},g.value=[{data:[o,t]}]};return $(()=>{r.stores.length>0?(w(),p(),c()):C(()=>r.stores,t=>{t.length>0&&(w(),p(),c())},{immediate:!0})}),(t,o)=>(D(),F(L,{padding:""},{default:G(()=>[d(h(f),{type:"bar",width:"97%",height:"300px",options:b.value,series:g.value},null,8,["options","series"]),d(h(f),{type:"bar",width:"97%",height:"400px",options:v.value,series:A.value},null,8,["options","series"]),d(h(f),{type:"donut",width:"97%",height:"200x",options:y.value,series:O.value},null,8,["options","series"])]),_:1}))}};export{tt as default};
