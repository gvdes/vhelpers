import{Q as b}from"./QSeparator.ab9ec637.js";import{aE as P,u as U,r as m,c as x,o as h,a as k,w as t,e as a,f as o,Y as E,a4 as v,Q as f,a2 as w,a_ as D,ak as $,h as j,a3 as y}from"./index.a5990bc3.js";import{Q as J}from"./QToolbar.ba422aa0.js";import{Q as z}from"./QHeader.649c8c08.js";import{Q as _,a as i}from"./QCard.60d6119c.js";import{Q as V}from"./QTable.39b37b57.js";import{Q as Y}from"./QSlideTransition.0831843a.js";import{Q as G}from"./QImg.ac31610e.js";import{a as Q,Q as K}from"./QSelect.839ba1bc.js";import{Q as W,a as A}from"./QItemSection.cdb4e2cb.js";import{Q as X}from"./QList.162205f8.js";import{Q as Z}from"./QSpace.d74cdbd5.js";import{Q as ee}from"./QCardActions.2d41314a.js";import{Q as O}from"./QDialog.1324623e.js";import{Q as ae}from"./QForm.cd06ca52.js";import{Q as le,a as te}from"./QLayout.c2f7d720.js";import{C as oe}from"./ClosePopup.eb7ed3c0.js";import"./AppFullscreen.b644a089.js";import{u as se}from"./use-quasar.66224bff.js";import"./auto.38810c21.js";import{d as M}from"./dayjs.min.cbcf888d.js";import"./exceljs.min.9e24d01d.js";import"./jspdf.plugin.autotable.1a1584bd.js";import{O as B}from"./OpenCash.c69e4f99.js";import{_ as ne}from"./UserToolbar.765041fa.js";import"./axios.128a942b.js";import{u as N}from"./VDB.ca67c27e.js";import"./QResizeObserver.c8607ef2.js";import"./QLinearProgress.37d71b42.js";import"./QCheckbox.01948c94.js";import"./use-key-composition.b73fdae9.js";import"./uid.937d8ee7.js";import"./position-engine.0aff5bbf.js";import"./rtl.276c3f1b.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.9ab26c22.js";const re={class:"col"},ie={class:"row"},de={class:"col"},ue={class:"row"},ce={class:"col"},me={class:"row"},fe={class:"col"},We={__name:"reportOpenLYT",setup(pe){const p=se();P();const T=U();N();const u=N(),r=m({state:!1,val:null,img:null}),s=m({state:!1,val:null,opts:[]}),n=m({descuadre:!1,devolucion:!1,retiradas:!1}),c=m({columnsDescruadre:[{name:"id",label:"Id",field:e=>e.id,align:"center"},{name:"date",label:"Fecha",field:e=>M(e.created_at).format("YYYY-MM-DD"),align:"left"},{name:"createdby",label:"Apertura",field:e=>e.createdby.complete_name,align:"left"},{name:"cashier",label:"Cajero",field:e=>e.cashier.complete_name,align:"left"},{name:"cash_name",label:"Caja",field:e=>e.cash_name,align:"left"},{name:"unsquare",label:"Descuadre",field:e=>e.unsquare,align:"center"},{name:"mismatch_reason",label:"Motivo",field:e=>e.mismatch_reason,align:"left"}],columnsDevolucion:[{name:"id",label:"Id",field:e=>e.id,align:"center"},{name:"date",label:"Fecha",field:e=>M(e.created_at).format("YYYY-MM-DD"),align:"left"},{name:"createdby",label:"Apertura",field:e=>e.createdby.complete_name,align:"left"},{name:"cashier",label:"Cajero",field:e=>e.cashier.complete_name,align:"left"},{name:"cash_name",label:"Caja",field:e=>e.cash_name,align:"left"},{name:"ticket",label:"Ticket Original",field:e=>e.ticket,align:"center"},{name:"refund",label:"Devolucion",field:e=>e.refund_ticket,align:"center"},{name:"refund_reason",label:"Motivo Devolucion",field:e=>e.refund_reason,align:"left"}],columnsRetiradas:[{name:"id",label:"Id",field:e=>e.id,align:"center"},{name:"date",label:"Fecha",field:e=>M(e.created_at).format("YYYY-MM-DD"),align:"left"},{name:"createdby",label:"Apertura",field:e=>e.createdby.complete_name,align:"left"},{name:"cashier",label:"Cajero",field:e=>e.cashier.complete_name,align:"left"},{name:"cash_name",label:"Caja",field:e=>e.cash_name,align:"left"},{name:"withdrawanumber",label:"Retirada",field:e=>e.withdrawal_number,align:"center"},{name:"originalmount",label:"Monto Original",field:e=>e.withdrawal_original_mount,align:"center"},{name:"modify",label:"Monto Modificado",field:e=>{var l;return(l=e.withdrawal_mount)!=null?l:0},align:"center"},{name:"modify_reason",label:"Motivo Modificacion",field:e=>e.reason_modify,align:"left"}],pagination:{rowsPerPage:0}}),g=m([]),F=m(`http://192.168.10.238:2902/Assist/public/storage/uploads/cuts/${u.session.store.id}/`),S=x(()=>g.value.filter(e=>e._type==1)),I=x(()=>g.value.filter(e=>e._type==2)),R=x(()=>g.value.filter(e=>e._type==3)),H=async()=>{p.loading.show({message:"Obteniendo Datos"});let e=u.session.store.id;const l=await B.getCutsBoxes(e);l.fail?console.log(l):(g.value=l.opens,s.value.opts=l.prints,console.log(l),p.loading.hide())},L=async()=>{p.loading.show({message:"Imprimiendo Corte Anterior"});let e={id:r.value.val.id,print:s.value.val.ip_address};console.log(e);const l=await B.getCurrenCut(e);l.fail?console.log(l):(console.log(l),s.value.val=null,s.value.state=!1,p.loading.hide())},C=(e,l)=>{console.log(l),r.value.state=!0,r.value.val=l,r.value.img=`${F.value}/${l.current_cut}`},q=()=>{window.open(r.value.img,"_blank")};return u.session.rol==="aud"||u.session.rol==="root"?H():(p.notify({message:"No tienes acceso a esta pagina",type:"negative",position:"center"}),T.replace("/")),(e,l)=>(h(),k(le,{view:"hHh Lpr fFf"},{default:t(()=>[a(z,{class:"bg-grey-3 text-dark",bordered:""},{default:t(()=>[a(ne),a(b),a(J,{class:"justify-between row"},{default:t(()=>[o("div",re,[l[7]||(l[7]=o("span",{class:"text-grey"},"Helpers",-1)),a(E,{name:"navigate_next",color:"primary"}),l[8]||(l[8]=o("span",{class:"text-h6"},"Rerporte Aperturas de Cajas",-1))])]),_:1})]),_:1}),a(te,null,{default:t(()=>[o("div",null,[a(_,{class:"my-card"},{default:t(()=>[a(i,{class:"text-center text-bold text-h6"},{default:t(()=>[o("div",ie,[o("div",de,"Descuadre ("+v(S.value.length)+")",1),a(f,{color:"grey",round:"",flat:"",dense:"",icon:n.value.descuadre?"keyboard_arrow_up":"keyboard_arrow_down",onClick:l[0]||(l[0]=d=>n.value.descuadre=!n.value.descuadre)},null,8,["icon"])])]),_:1}),a(i,null,{default:t(()=>[a(Y,null,{default:t(()=>[w(o("div",null,[a(V,{rows:S.value,columns:c.value.columnsDescruadre,pagination:c.value.pagination,"hide-bottom":"",onRowClick:C},null,8,["rows","columns","pagination"])],512),[[D,n.value.descuadre]])]),_:1})]),_:1})]),_:1}),a(b,{spaced:"",inset:"",vertical:"",dark:""}),$(u).session.store.id!=1?(h(),k(_,{key:0,class:"my-card"},{default:t(()=>[a(i,{class:"text-center text-bold text-h6"},{default:t(()=>[o("div",ue,[o("div",ce,"Devolucion ("+v(I.value.length)+")",1),a(f,{color:"grey",round:"",flat:"",dense:"",icon:n.value.devolucion?"keyboard_arrow_up":"keyboard_arrow_down",onClick:l[1]||(l[1]=d=>n.value.devolucion=!n.value.devolucion)},null,8,["icon"])])]),_:1}),a(i,null,{default:t(()=>[a(Y,null,{default:t(()=>[w(o("div",null,[a(V,{rows:I.value,columns:c.value.columnsDevolucion,pagination:c.value.pagination,"hide-bottom":"",onRowClick:C},null,8,["rows","columns","pagination"])],512),[[D,n.value.devolucion]])]),_:1})]),_:1})]),_:1})):j("",!0),a(b,{spaced:"",inset:"",vertical:"",dark:""}),$(u).session.store.id!=1?(h(),k(_,{key:1,class:"my-card"},{default:t(()=>[a(i,{class:"text-center text-bold text-h6"},{default:t(()=>[o("div",me,[o("div",fe,"Retiradas ("+v(R.value.length)+")",1),a(f,{color:"grey",round:"",flat:"",dense:"",icon:n.value.retiradas?"keyboard_arrow_up":"keyboard_arrow_down",onClick:l[2]||(l[2]=d=>n.value.retiradas=!n.value.retiradas)},null,8,["icon"])])]),_:1}),a(i,null,{default:t(()=>[a(Y,null,{default:t(()=>[w(o("div",null,[a(V,{rows:R.value,columns:c.value.columnsRetiradas,pagination:c.value.pagination,"hide-bottom":"",onRowClick:C},null,8,["rows","columns","pagination"])],512),[[D,n.value.retiradas]])]),_:1})]),_:1})]),_:1})):j("",!0)]),a(O,{modelValue:r.value.state,"onUpdate:modelValue":l[4]||(l[4]=d=>r.value.state=d),persistent:""},{default:t(()=>[a(_,null,{default:t(()=>[a(i,null,{default:t(()=>[a(G,{src:r.value.img,ratio:1,onClick:q},null,8,["src"])]),_:1}),a(i,{class:"row items-center"},{default:t(()=>[a(X,{bordered:""},{default:t(()=>[a(W,null,{default:t(()=>[a(A,null,{default:t(()=>[a(Q,{class:"text-center text-bold"},{default:t(()=>l[9]||(l[9]=[y("Descuadre ")])),_:1}),a(Q,{class:"text-center text-bold"},{default:t(()=>[y(v(JSON.parse(r.value.val.details_cut).descuadre),1)]),_:1})]),_:1}),a(b,{spaced:"",inset:"",vertical:"",dark:""}),a(A,null,{default:t(()=>[a(Q,{class:"text-center text-bold"},{default:t(()=>l[10]||(l[10]=[y("Hora ")])),_:1}),a(Q,{class:"text-bold text-center"},{default:t(()=>[y(v(JSON.parse(r.value.val.details_cut).corte.HORA),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(ee,null,{default:t(()=>[w(a(f,{flat:"",icon:"close",color:"negative"},null,512),[[oe]]),a(Z),a(f,{flat:"",icon:"print",color:"primary",onClick:l[3]||(l[3]=d=>s.value.state=!s.value.state)})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(O,{modelValue:s.value.state,"onUpdate:modelValue":l[6]||(l[6]=d=>s.value.state=d)},{default:t(()=>[a(_,{class:"my-card"},{default:t(()=>[a(i,null,{default:t(()=>l[11]||(l[11]=[o("div",{class:"text-h6 text-center"},"Selecciona Impresora",-1)])),_:1}),a(i,null,{default:t(()=>[a(ae,{onSubmit:L,class:"q-gutter-md"},{default:t(()=>[a(K,{dense:"","option-label":"name",modelValue:s.value.val,"onUpdate:modelValue":l[5]||(l[5]=d=>s.value.val=d),options:s.value.opts,label:"Impresora",filled:""},null,8,["modelValue","options"]),o("div",null,[a(f,{label:"Enviar",type:"submit",color:"primary",class:"full-width",disable:s.value.val==null},null,8,["disable"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}};export{We as default};
