import{b as I,Q as G,a as te,d as oe,e as M}from"./QList.9dac75ed.js";import{Q as pe}from"./QHeader.1c188215.js";import{i as ie,aL as ve,c as g,j as A,t as re,F as me,L as H,M as ge,k as be,u as xe,r as P,o as V,d as B,w as l,e as t,f as n,ak as $,I as ae,Q as v,an as ye,a1 as ke,g as N,a3 as T,h as J,a0 as m,a2 as K,al as _e,a4 as le}from"./index.ed46ba9f.js";import{j as we,k as he,Q as R}from"./QCard.c94ee954.js";import{Q as Qe}from"./QRadio.189d16a0.js";import{Q as Ce}from"./QCheckbox.98a5f7b8.js";import{Q as Ve}from"./QToggle.f129f21b.js";import{Q as se}from"./QBtnGroup.72840caf.js";import{b as Fe}from"./QDrawer.491a6612.js";import{Q as Pe}from"./QInput.aac25485.js";import{q as Se,a as W}from"./QSelect.85ff34c6.js";import{Q as D}from"./axios.8d0593ce.js";import{Q as X}from"./QCardActions.1f1bcae3.js";import{Q as $e}from"./QTable.bd84f301.js";import{Q as qe}from"./QPage.c1672739.js";import{Q as Le,a as De}from"./QLayout.0b6698b4.js";import{C as ne}from"./ClosePopup.6b82a008.js";import{_ as Oe}from"./UserToolbar.1411ce2a.js";import{P as Ee,d as Ie}from"./ProductsAutocomplete.5dc2742e.js";import{_ as Be}from"./OptionsLabels.737f8fdd.js";import{u as Ne}from"./use-quasar.7338a526.js";import{E as Ae}from"./exceljs.min.9e24d01d.js";import"./browser.eff7c919.js";import"./jspdf.plugin.autotable.201eb9cd.js";import"./dayjs.min.cbcf888d.js";import"./QResizeObserver.6b3f34db.js";import"./QScrollObserver.cf33601f.js";import"./QLinearProgress.54c41149.js";import"./auth.e7e51415.js";/* empty css                                                                         */import"./QImg.7b715ccd.js";import"./_commonjsHelpers.88e99c8f.js";const de={radio:Qe,checkbox:Ce,toggle:Ve},je=Object.keys(de);function Y(a,w){if(typeof a=="function")return a;const r=a!==void 0?a:w;return p=>p[r]}var ze=ie({name:"QOptionGroup",props:{...we,modelValue:{required:!0},options:{type:Array,validator:a=>a.every(ve),default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],name:String,type:{type:String,default:"radio",validator:a=>je.includes(a)},color:String,keepColor:Boolean,dense:Boolean,size:String,leftLabel:Boolean,inline:Boolean,disable:Boolean},emits:["update:modelValue"],setup(a,{emit:w,slots:r}){const{proxy:{$q:p}}=re(),x=Array.isArray(a.modelValue);a.type==="radio"?x===!0&&console.error("q-option-group: model should not be array"):x===!1&&console.error("q-option-group: model should be array in your case");const y=he(a,p),h=g(()=>de[a.type]),k=g(()=>Y(a.optionValue,"value")),q=g(()=>Y(a.optionLabel,"label")),d=g(()=>Y(a.optionDisable,"disable")),O=g(()=>a.options.map(s=>({val:k.value(s),name:s.name===void 0?a.name:s.name,disable:a.disable||d.value(s),leftLabel:s.leftLabel===void 0?a.leftLabel:s.leftLabel,color:s.color===void 0?a.color:s.color,checkedIcon:s.checkedIcon,uncheckedIcon:s.uncheckedIcon,dark:s.dark===void 0?y.value:s.dark,size:s.size===void 0?a.size:s.size,dense:a.dense,keepColor:s.keepColor===void 0?a.keepColor:s.keepColor}))),c=g(()=>"q-option-group q-gutter-x-sm"+(a.inline===!0?" q-option-group--inline":"")),Q=g(()=>{const s={role:"group"};return a.type==="radio"&&(s.role="radiogroup",a.disable===!0&&(s["aria-disabled"]="true")),s});function b(s){w("update:modelValue",s)}return()=>A("div",{class:c.value,...Q.value},a.options.map((s,_)=>{const j=r["label-"+_]!==void 0?()=>r["label-"+_](s):r.label!==void 0?()=>r.label(s):void 0;return A("div",[A(h.value,{label:j===void 0?q.value(s):null,modelValue:a.modelValue,"onUpdate:modelValue":b,...O.value[_]},j)])}))}});const Te={position:{type:String,default:"bottom-right",validator:a=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(a)},offset:{type:Array,validator:a=>a.length===2},expand:Boolean};function Re(){const{props:a,proxy:{$q:w}}=re(),r=me(ge,H);if(r===H)return console.error("QPageSticky needs to be child of QLayout"),H;const p=g(()=>{const c=a.position;return{top:c.indexOf("top")!==-1,right:c.indexOf("right")!==-1,bottom:c.indexOf("bottom")!==-1,left:c.indexOf("left")!==-1,vertical:c==="top"||c==="bottom",horizontal:c==="left"||c==="right"}}),x=g(()=>r.header.offset),y=g(()=>r.right.offset),h=g(()=>r.footer.offset),k=g(()=>r.left.offset),q=g(()=>{let c=0,Q=0;const b=p.value,s=w.lang.rtl===!0?-1:1;b.top===!0&&x.value!==0?Q=`${x.value}px`:b.bottom===!0&&h.value!==0&&(Q=`${-h.value}px`),b.left===!0&&k.value!==0?c=`${s*k.value}px`:b.right===!0&&y.value!==0&&(c=`${-s*y.value}px`);const _={transform:`translate(${c}, ${Q})`};return a.offset&&(_.margin=`${a.offset[1]}px ${a.offset[0]}px`),b.vertical===!0?(k.value!==0&&(_[w.lang.rtl===!0?"right":"left"]=`${k.value}px`),y.value!==0&&(_[w.lang.rtl===!0?"left":"right"]=`${y.value}px`)):b.horizontal===!0&&(x.value!==0&&(_.top=`${x.value}px`),h.value!==0&&(_.bottom=`${h.value}px`)),_}),d=g(()=>`q-page-sticky row flex-center fixed-${a.position} q-page-sticky--${a.expand===!0?"expand":"shrink"}`);function O(c){const Q=be(c.default);return A("div",{class:d.value,style:q.value},a.expand===!0?Q:[A("div",Q)])}return{$layout:r,getStickyContent:O}}var Ue=ie({name:"QPageSticky",props:Te,setup(a,{slots:w}){const{getStickyContent:r}=Re();return()=>r(w)}});const Ge={class:"flex jutify-between row"},Me={class:"col"},He={class:"q-pa-md"},Je={class:"q-pa-md"},Ke={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},We={class:"text-h5 text-bold text-center"},Xe={class:"text-subtitle2 text-bold text-center"},Ye={class:"text-subtitle2 text-bold text-center"},Ze={class:"text-subtitle2 text-bold text-center"},et={class:"text-subtitle2 text-bold text-center"},tt={class:"row"},ot={class:"text-center"},at={class:"text-center"},lt={class:"text-bold q-pb-sm text-center"},st={class:"row q-pt-xs"},nt={class:"text-negative"},zt={__name:"LabelsLayout",setup(a){const w=xe(),r=Ne(),p=P([]),x=P({filter:"",pagination:{rowsPerPage:9}}),y=P({state:!1}),h=P({state:!1}),k=P({val:[0,1,2,4],opts:[{label:"Menudeo",value:1},{label:"Mayoreo",value:2},{label:"Docena",value:3},{label:"Caja",value:4}]}),q=P(null),d=P({state:!1,wndGetRows:[],wndNoDataFound:[],wndTotal:[],wndGetAdded:[],_supply_by:0,message:"",messageRepeat:"",wndNotExist:[]}),O=i=>{let o=[],e=[],u=new Object;return i.products.map(f=>c(f.prices)?o.push(f):e.push(f)),console.log(i),u.notFound=o,u.add=e,u},c=i=>{let o=!0;return i.map((e,u)=>{o=e.pivot.price==0}),o},Q=i=>{console.log(i)},b=P({state:!1}),s=i=>{console.log(i);let o=p.value.findIndex(e=>e.id==i.id);if(console.log(o),o>=0)r.notify({message:"El Producto ya esta agregado",type:"negative",position:"center"});else{let e=Z(i.prices,i.pieces);i._copies=1,i.type=e.type,i.usedPrices=e.prices,i._copies=1,p.value.push(i),console.log(i)}},_=i=>{let o=p.value.findIndex(e=>e.id==i.id);p.value.splice(o,1)},j=()=>{p.value=[],y.value.state=!1},ue=()=>{q.value.click()},ce=async()=>{let i=document.getElementById("inputFile").files[0],o=new Ae.Workbook,e=[],u=[],f=0;o.xlsx.load(i).then(F=>{if(o.worksheets[0].getColumn("A").eachCell({includeEmpty:!0},function(S,L){S.value&&e.push(S.value)}),u=e.filter((S,L,E)=>E.indexOf(S)==L),e.length){let S={codes:e,_workpoint:w.session.store.id_viz};console.log(S),r.loading.show({message:"Procesando archivo, espera.."}),Ie.getMassive(S).then(L=>{let E=L.data,U=0,z=O(E);if(E.fails.notFound.map(C=>d.value.wndNotExist.push(C)),d.value.wndGetRows=z.add.length,d.value.state=!d.value.state,d.value.wndGetAdded=z.add,d.value.wndNoDataFound=z.notFound,d.value.wndNoDataFound.length>0){let C=d.value.wndNoDataFound.length;d.value.message=C<=1?"El producto no contiene precios.":"Los productos no contienen precios."}z.add.map(C=>{let ee=Z(C.prices,C.pieces);C._copies=1,C.type=ee.type,C.usedPrices=ee.prices,p.value.push(C),U++}),U&&!E.fails.notFound.length&&u.length==e.length?r.notify({message:`Etiquetas generadas: ${U}`,color:"positive",icon:"done",timeout:1e3}):(f=e.length-u.length,d.value.messageRepeat=f<=1?`${f} producto se repitio. Favor de validar su documento antes de subirlo.`:`${f} productos se repitieron. Favor de validar su documento antes de subirlo.`),console.log(d.value),r.loading.hide()}).catch(L=>{console.log(L),r.notify({message:"Hay un problema con obtener los datos :/.",icon:"fas fa-grin-beam-sweat",color:"negative"})})}else r.notify({message:"Vaya!! Al parecer este archivo esta vacio.",icon:"fas fa-grin-beam-sweat",color:"negative"})})},Z=(i,o)=>{let e=[...i];const u=e.find(F=>F.pivot._type==4),f=e.find(F=>F.pivot._type==1);if(u.pivot.price==f.pivot.price){let F={id:0,alias:"OFERTA",name:"Oferta",pivot:{price:e[0].pivot.price},used:!0};return console.log("oferta"),{type:"off",prices:[F]}}else return console.log("estandar"),{type:"std",prices:e}},fe=i=>{switch(i){case"off":return"orange-9";case"std":return"green-9"}};return(i,o)=>(V(),B(Le,{view:"hHh Lpr fFf"},{default:l(()=>[t(pe,{class:"transparent text-dark",bordered:""},{default:l(()=>[t(Oe),t(I)]),_:1}),t(De,null,{default:l(()=>[t(qe,{padding:""},{default:l(()=>[n("div",Ge,[n("div",Me,[o[9]||(o[9]=$("Helpers ")),t(ae,{name:"navigate_next",color:"primary"}),o[10]||(o[10]=$()),o[11]||(o[11]=n("span",{class:"text-h6"},"Creacion de Etiquetas",-1))]),t(v,{class:"flex justify-end",flat:"",onClick:o[0]||(o[0]=e=>b.value.state=!b.value.state),round:"",dense:"",icon:"menu"})]),t(R,{class:"my-card"},{default:l(()=>[t(Ee,{checkState:!1,onInput:Q,with_prices:"",onAgregar:s,with_locations:"",withHistoric:""})]),_:1}),t(I,{spaced:"",inset:"",vertical:"",dark:""}),t(Fe,{modelValue:b.value.state,"onUpdate:modelValue":o[4]||(o[4]=e=>b.value.state=e),width:200,breakpoint:500,bordered:"",class:ye(ke(r).dark.isActive?"bg-grey-9":"bg-grey-3")},{default:l(()=>[n("div",null,[t(I,{spaced:"",inset:"",vertical:"",dark:""}),o[12]||(o[12]=n("div",{class:"text-center text-bold"},"Precios",-1)),n("div",He,[t(ze,{options:k.value.opts,type:"checkbox",modelValue:k.value.val,"onUpdate:modelValue":o[1]||(o[1]=e=>k.value.val=e)},null,8,["options","modelValue"])])]),t(I,{spaced:"",inset:"",vertical:"",dark:""}),o[13]||(o[13]=n("div",{class:"text-center text-bold"}," Opciones ",-1)),n("div",Je,[t(se,{spread:""},{default:l(()=>[t(v,{color:"primary",icon:"upload_file",flat:"",title:"Subir Etiquetas",onClick:ue}),p.value.length?(V(),N(T,{key:0},[t(v,{color:"primary",icon:"delete",flat:"",title:"Eliminar Etiquetas",onClick:o[2]||(o[2]=e=>y.value.state=!y.value.state)}),t(v,{color:"primary",icon:"download",flat:"",title:"Descargar Etquetas",onClick:o[3]||(o[3]=e=>h.value.state=!h.value.state)})],64)):J("",!0)]),_:1}),n("input",{type:"file",ref_key:"inputFile",ref:q,id:"inputFile",onInput:ce,hidden:"",accept:".xlsx,.xls"},null,544)])]),_:1},8,["modelValue","class"]),t($e,{rows:p.value,"row-key":"name",grid:"",filter:x.value.filter,pagination:x.value.pagination,"no-data-label":"''"},{"top-right":l(()=>[t(Pe,{borderless:"",dense:"",debounce:"300",modelValue:x.value.filter,"onUpdate:modelValue":o[5]||(o[5]=e=>x.value.filter=e),placeholder:"Buscar"},{append:l(()=>[t(ae,{name:"search"})]),_:1},8,["modelValue"])]),item:l(e=>[n("div",Ke,[t(R,{class:"my-card"},{default:l(()=>[t(D,null,{default:l(()=>{var u;return[t(Se,{size:"sm",class:"fixed-right absolute-right text-bold text-white text-uppercase",color:fe(e.row.type)},{default:l(()=>[$(m(e.row.type),1)]),_:2},1032,["color"]),n("div",We,m(e.row.code),1),n("div",Xe,m(e.row.name),1),n("div",Ye,m(e.row.label),1),n("div",Ze,"Longitud: "+m(e.row.large),1),n("div",et,"Ubicacion: "+m((u=e.row.locations)==null?void 0:u.map(f=>f.path).join("/")),1),t(I,{spaced:"",inset:"",vertical:"",dark:""}),n("div",tt,[(V(!0),N(T,null,K(e.row.usedPrices.filter(f=>k.value.val.includes(f.id)),(f,F)=>(V(),N("div",{class:"col items-start",key:F},[n("div",ot,m(f.alias),1),n("div",at,m(f.pivot.price),1)]))),128))])]}),_:2},1024),t(X,{align:"center"},{default:l(()=>[t(v,{flat:"",icon:"delete",color:"negative",onClick:u=>_(e.row)},null,8,["onClick"]),t(v,{flat:"",icon:"add",onClick:u=>e.row._copies++},null,8,["onClick"]),n("div",null,[o[14]||(o[14]=n("div",{class:"text-caption text--2"},"copias",-1)),n("div",lt,m(e.row._copies),1)]),t(v,{flat:"",icon:"remove",onClick:u=>e.row._copies<=1?"":e.row._copies--},null,8,["onClick"])]),_:2},1024)]),_:2},1024)])]),bottom:l(e=>[t(Ue,{position:"bottom",class:"full-width",offset:[0,18]},{default:l(()=>[n("div",st,[t(se,{rounded:"",flat:"",color:"primary"},{default:l(()=>[e.pagesNumber>2?(V(),B(v,{key:0,icon:"first_page",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.firstPage,class:"q-px-sm"},null,8,["disable","onClick"])):J("",!0),t(v,{icon:"chevron_left",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.prevPage,class:"q-px-sm"},null,8,["disable","onClick"]),t(v,{flat:"",disable:"","no-caps":""},{default:l(()=>[$(m(e.pagination.page)+" / "+m(e.pagesNumber),1)]),_:2},1024),t(v,{icon:"chevron_right",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.nextPage,class:"q-px-sm"},null,8,["disable","onClick"]),e.pagesNumber>2?(V(),B(v,{key:1,icon:"last_page",round:"",dense:"",flat:"",onClick:e.lastPage,class:"q-px-sm"},null,8,["onClick"])):J("",!0)]),_:2},1024)])]),_:2},1024)]),"no-data":l(()=>o[15]||(o[15]=[])),_:1},8,["rows","filter","pagination"]),t(G,{modelValue:y.value.state,"onUpdate:modelValue":o[6]||(o[6]=e=>y.value.state=e),persistent:""},{default:l(()=>[t(R,null,{default:l(()=>[t(D,{class:"row items-center"},{default:l(()=>[t(_e,{icon:"warning",color:"white","text-color":"negative"}),o[16]||(o[16]=n("div",{class:"q-ml-sm"},"Se eliminaran todos los articulos de la lista ",-1))]),_:1}),t(D,null,{default:l(()=>o[17]||(o[17]=[n("div",{class:"q-ml-sm"},"Deseas Continuar?",-1)])),_:1}),t(X,{align:"right"},{default:l(()=>[le(t(v,{flat:"",label:"No",color:"positive"},null,512),[[ne]]),t(v,{flat:"",label:"Si",color:"negative",onClick:j})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(G,{modelValue:h.value.state,"onUpdate:modelValue":o[7]||(o[7]=e=>h.value.state=e),persistent:""},{default:l(()=>[t(Be,{products:p.value,prices:k.value},null,8,["products","prices"])]),_:1},8,["modelValue"]),t(G,{modelValue:d.value.state,"onUpdate:modelValue":o[8]||(o[8]=e=>d.value.state=e)},{default:l(()=>[t(R,{class:"my-card",style:{width:"70%"}},{default:l(()=>[t(D,{class:"items-center"},{default:l(()=>[o[18]||(o[18]=n("div",{class:"text-center text-bold"},"Repetidos",-1)),n("div",nt,m(d.value.messageRepeat),1)]),_:1}),t(D,null,{default:l(()=>[o[19]||(o[19]=n("div",{class:"text-center"},"Productos Sin Precio",-1)),t(te,null,{default:l(()=>[(V(!0),N(T,null,K(d.value.wndNoDataFound,(e,u)=>(V(),B(oe,{key:u},{default:l(()=>[t(M,null,{default:l(()=>[t(W,{overline:""},{default:l(()=>[$(m(e.code),1)]),_:2},1024)]),_:2},1024),t(M,null,{default:l(()=>[t(W,{caption:""},{default:l(()=>[$(m(e.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(D,null,{default:l(()=>[o[20]||(o[20]=n("div",{class:"text-center"},"Productos Sin Existencia",-1)),t(te,null,{default:l(()=>[(V(!0),N(T,null,K(d.value.wndNotExist,(e,u)=>(V(),B(oe,{key:u},{default:l(()=>[t(M,null,{default:l(()=>[t(W,{overline:""},{default:l(()=>[$(m(e),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(X,{align:"right"},{default:l(()=>[le(t(v,{flat:"",label:"OK",color:"primary"},null,512),[[ne]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}};export{zt as default};
