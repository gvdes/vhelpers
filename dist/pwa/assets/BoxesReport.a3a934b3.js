import{Q as A}from"./QSeparator.225c3a52.js";import{aE as B,u as I,r as d,c as E,aW as O,o as k,a as R,w as t,e as a,f as r,Y as b,Q as v,h as P}from"./index.5ced3e40.js";import{Q as T}from"./QSelect.06e40bd4.js";import{Q as M}from"./QToolbar.6cc16027.js";import{Q as H}from"./QHeader.1c7b6b4e.js";import{Q as S}from"./QInput.39c087d0.js";import{Q as D}from"./QTable.5a0e4381.js";import{Q as L}from"./QDate.e9f20d09.js";import{Q as N,a as V}from"./QCard.16a5fd4d.js";import{Q as $}from"./QCardActions.cacfffe3.js";import{Q as U}from"./QDialog.f34fdc5b.js";import{Q as j,a as Y}from"./QLayout.21c8a301.js";import"./AppFullscreen.fe64e94d.js";import{u as G}from"./use-quasar.6d58fe31.js";import"./auto.ba62c17c.js";import{d as q}from"./dayjs.min.cbcf888d.js";import{E as K}from"./exceljs.min.9e24d01d.js";import"./jspdf.plugin.autotable.376ae8f7.js";import{_ as W}from"./UserToolbar.7fed3c0e.js";import{A as J}from"./assistApi.2e43d6ae.js";import{u as z}from"./VDB.daf2eb22.js";import{a as X}from"./axios.9ab26c22.js";import"./use-key-composition.33c3d238.js";import"./uid.937d8ee7.js";import"./QItemSection.682f7762.js";import"./position-engine.28d4061c.js";import"./rtl.276c3f1b.js";import"./QResizeObserver.3dcb8e42.js";import"./QList.a9c4dc9c.js";import"./QLinearProgress.8780d75f.js";import"./QCheckbox.21f4ef4f.js";import"./use-render-cache.3aae9b27.js";import"./date.9be02fd0.js";import"./_commonjsHelpers.88e99c8f.js";import"./ClosePopup.046aed46.js";import"./axios.ba7b1b0e.js";const Z={class:"col"},ee={class:"col"},oe={class:"row"},ae={class:"row"},le={class:"col"},te={class:"q-pa-md"},$e={__name:"BoxesReport",setup(se){const n=G();B();const _=I(),C=z(),u=d(!1),p=d(null),m=d({opts:[],val:null}),c=d({columns:[{name:"cash",label:"CAJA",field:o=>o.TERMINAL,align:"left",sortable:!0},{name:"ticket",label:"TICKET",field:o=>o.TICKET,align:"left",sortable:!0},{name:"cliet",label:"CLIENTE",field:o=>o.CLIENTE,align:"left",sortable:!0},{name:"date",label:"FECHA",field:o=>o.FECHA,align:"left",sortable:!0},{name:"hour",label:"HORA",field:o=>o.HORA,align:"left",sortable:!0},{name:"fop",label:"FORMA DE PAGO",field:o=>o.FORMA_PAGO,align:"left",sortable:!0},{name:"import",label:"IMPORTE",field:o=>parseFloat(o.IMPORTE),align:"left",sortable:!0}],pagination:{rowsPerPage:20},filter:""}),w=d([]),i=d({val:null,opts:[]});E(()=>n.platform.is.mobile);const g=E(()=>w.value.filter(o=>i.value.val?o.FORMA_PAGO==i.value.val.DESFPA:o)),y=async()=>{n.loading.show({message:"Cargando Informacion"}),console.log("se inicia el init");const o=await J.index();if(!o.error){console.log(o),m.value.opts=o;let e=new Date,s=q(e).format("YYYY/MM/DD");p.value=s,console.log(s),n.loading.hide()}},Q=async()=>{console.log(m.value.val.ip_address),n.loading.show({message:"Obteniendo Registros"}),console.log(p.value);let e=`http://${m.value.val.ip_address}/access/public/reports/getCashCob`;const s=await X.post(e,{filt:p.value});s.status!=200?console.log(s):(console.log(s.data),w.value=s.data.formaspagos,i.value.opts=s.data.formas,u.value=!1,n.loading.hide())};C.session.rol==="adm"||C.session.rol==="root"?y():(n.notify({message:"No tienes acceso a esta pagina",type:"negative",position:"center"}),_.replace("/"));const h=()=>{n.loading.show({message:"Importando Ticket"});const o=new K.Workbook;o.addWorksheet("Venta").addTable({name:"Venta",ref:"A1",headerRow:!0,totalsRow:!0,style:{showRowStripes:!0},columns:[{name:"Terminal",filterButton:!0},{name:"Tickets",filterButton:!0},{name:"Cliente",filterButton:!0},{name:"Fecha",filterButton:!0},{name:"Hora",filterButton:!0},{name:"Forma de Pago",filterButton:!0},{name:"Importe",filterButton:!0,totalsRowFunction:"sum"}],rows:g.value.map(l=>[l.TERMINAL,l.TICKET,l.CLIENTE,l.FECHA,l.HORA,l.FORMA_PAGO,parseFloat(l.IMPORTE)])}),(async()=>{const l=await o.xlsx.writeBuffer(),x=new Blob([l],{type:"application/octet-stream"}),F=URL.createObjectURL(x),f=document.createElement("a");f.href=F,f.download="ReporteCajas.xlsx",document.body.appendChild(f),f.click(),document.body.removeChild(f)})(),n.loading.hide()};return(o,e)=>{const s=O("router-view");return k(),R(j,{view:"hHh Lpr fFf"},{default:t(()=>[a(Y,null,{default:t(()=>[a(H,{class:"bg-grey-3 text-dark",bordered:""},{default:t(()=>[a(W),a(A),a(M,{class:"justify-between row"},{default:t(()=>[r("div",Z,[e[8]||(e[8]=r("span",{class:"text-grey"},"Helpers",-1)),a(b,{name:"navigate_next",color:"primary"}),e[9]||(e[9]=r("span",{class:"text-h6"},"Cajas Abiertas",-1))]),r("div",ee,[r("div",oe,[e[10]||(e[10]=r("div",{class:"col"},null,-1)),a(v,{color:"primary",icon:"event",onClick:e[0]||(e[0]=l=>u.value=!u.value),flat:"",round:"",disable:!m.value.val},null,8,["disable"]),a(v,{color:"primary",icon:"download",onClick:h,flat:"",round:"",disable:g.value.length<=0},null,8,["disable"]),a(T,{class:"col",modelValue:m.value.val,"onUpdate:modelValue":[e[1]||(e[1]=l=>m.value.val=l),Q],options:m.value.opts,label:"Sucursales",filled:"","option-label":"name",dense:""},null,8,["modelValue","options"])])])]),_:1})]),_:1}),a(D,{title:"Tickets",rows:g.value,pagination:c.value.pagination,filter:c.value.filter,columns:c.value.columns},{"top-right":t(()=>[r("div",ae,[r("div",le,[a(S,{borderless:"",dense:"",debounce:"300",modelValue:c.value.filter,"onUpdate:modelValue":e[2]||(e[2]=l=>c.value.filter=l),placeholder:"Buscar"},{append:t(()=>[a(b,{name:"search"})]),_:1},8,["modelValue"])]),a(A,{spaced:"",inset:"",vertical:"",dark:""}),a(T,{class:"col",modelValue:i.value.val,"onUpdate:modelValue":e[4]||(e[4]=l=>i.value.val=l),options:i.value.opts,label:"Formas de pago",filled:"","option-label":"DESFPA",dense:""},{append:t(()=>[i.value.val?(k(),R(b,{key:0,name:"close",onClick:e[3]||(e[3]=l=>i.value.val=null)})):P("",!0)]),_:1},8,["modelValue","options"])])]),_:1},8,["rows","pagination","filter","columns"]),a(U,{modelValue:u.value,"onUpdate:modelValue":e[7]||(e[7]=l=>u.value=l)},{default:t(()=>[a(N,{class:"my-card"},{default:t(()=>[a(V,null,{default:t(()=>[r("div",te,[e[11]||(e[11]=r("div",{class:"q-pb-sm"},null,-1)),a(L,{modelValue:p.value,"onUpdate:modelValue":e[5]||(e[5]=l=>p.value=l),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),a(V,null,{default:t(()=>[a($,{align:"right"},{default:t(()=>[a(v,{flat:"",icon:"close",color:"negative",onClick:e[6]||(e[6]=l=>u.value=!u.value)}),a(v,{flat:"",icon:"check",color:"positive",onClick:Q})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(s)]),_:1})]),_:1})}}};export{$e as default};
