import{Q as y}from"./QSeparator.1c524e3d.js";import{r as m,c as j,o as x,a as V,w as t,u as F,e,i as f,a3 as o,Y as D,Q as p,g as H,a0 as M,a1 as P,f as k,a2 as z,a4 as d,a6 as G}from"./index.f230f022.js";import{Q as J}from"./QHeader.7126e984.js";import{a as T,b as i,Q as A}from"./QSelect.c1eea1d3.js";import{Q as O}from"./QList.e86be665.js";import{Q as K}from"./QDate.ccd90733.js";import{u as W,Q as $,a as g}from"./use-quasar.e39b8eab.js";import{Q as S}from"./QCardActions.399bf6db.js";import{Q as I}from"./QDialog.4e21d602.js";import{Q as X}from"./QInput.55e7d485.js";import{Q as Z}from"./QPage.e6a2a5a9.js";import{u as ee}from"./VDB.62c6e2ff.js";import"./jspdf.plugin.autotable.0b626374.js";import{t as w}from"./transferApi.e3cae6e1.js";import"./exceljs.min.9e24d01d.js";import"./browser.94c942de.js";import{d as ae}from"./dayjs.min.25545ff6.js";import{_ as te}from"./UserToolbar.7a022b79.js";import"./QResizeObserver.f839cf65.js";import"./use-key-composition.951681c7.js";import"./uid.42677368.js";import"./position-engine.b4a3ff3c.js";import"./rtl.b51694b1.js";import"./use-cache.b0833c75.js";import"./date.352da036.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.30672b3a.js";import"./axios.f1f32898.js";import"./ClosePopup.f972e7f6.js";const le={class:"row justify-between"},oe=f("span",{class:"text-h6"},"Traspasos entre Almacenes",-1),se={class:"q-pa-md"},ne=f("div",{class:"q-pb-sm"},null,-1),Ee={__name:"Index",setup(ie){const C=F(),c=ee(),r=W(),u=m(!1),v=m(null),_=m(!1),b=m([]),Q=m([]),s=m({_origin:null,_destiny:null,notes:null}),N=j(()=>s.value._origin&&s.value._destiny&&s.value.notes),R=async()=>{console.log("Recibiendo Datos :)"),r.loading.show({message:"Obteniendo Datos"});let n=c.session.store.id;const l=await w.index(n);l.error?console.log(l):(console.log(l),b.value=l.transfer,Q.value=l.warehouses,r.loading.hide())},U=async()=>{r.loading.show({message:"Creando Traspaso"}),s.value.created_by=c.session.name,s.value._store=c.session.store.id,console.log(s.value);const n=await w.addTransfer(s.value);n.error?(console.log(n),r.notify({message:"No se logro crear el traspaso",position:"center",type:"negative"})):(r.loading.hide(),r.notify({message:`Traspaso ${n.code_fs} creada`,position:"center",type:"positive"}),C.push(`transfers/${n.id}`))},B=()=>{_.value=!1,s.value={_origin:null,_destiny:null,notes:null}},h=n=>n.id===s.value._origin.id||c.session.rol!=="aud"&&n.id===4,E=n=>(console.log(n),c.session.rol!="aud"&&n.id==4),Y=async()=>{console.log(v.value),r.loading.show({message:"Obteniendo Datos"});let l={store:c.session.store.id,date:v.value};console.log("Recibiendo Datos :)");const a=await w.getDate(l);a.fail?console.log(a):(console.log(a),b.value=a,r.loading.hide(),v.value=null,u.value=!1)},L=n=>{C.push(`transfers/${n}`)};return R(),(n,l)=>(x(),V(Z,{padding:""},{default:t(()=>[e(J,{class:"transparent text-dark",bordered:""},{default:t(()=>[e(te),e(y),f("div",le,[f("div",null,[o("Helpers "),e(D,{name:"navigate_next",color:"primary"}),o(),oe]),f("div",null,[e(p,{color:"primary",icon:"add",flat:"",onClick:l[0]||(l[0]=a=>_.value=!_.value),round:""}),e(p,{color:"primary",icon:"event",onClick:l[1]||(l[1]=a=>u.value=!u.value),flat:"",round:""})])]),e(y)]),_:1}),e(O,null,{default:t(()=>[e(T,null,{default:t(()=>[e(i,{class:"text-center"},{default:t(()=>[o("ID")]),_:1}),e(i,{class:"text-center"},{default:t(()=>[o("CREADO")]),_:1}),e(i,{class:"text-center"},{default:t(()=>[o("CREADO POR")]),_:1}),e(i,{class:"text-center"},{default:t(()=>[o("NOTAS")]),_:1}),e(i,{class:"text-center"},{default:t(()=>[o("ORIGEN")]),_:1}),e(i,{class:"text-center"},{default:t(()=>[o("DESTINO")]),_:1}),e(i,{class:"text-center"},{default:t(()=>[o("FACTUSOL")]),_:1}),e(i,{class:"text-center"},{default:t(()=>[o("ARTICULOS")]),_:1})]),_:1})]),_:1}),e(y,{spaced:"",inset:"",vertical:"",dark:""}),(x(!0),H(P,null,M(b.value,(a,q)=>(x(),V(O,{bordered:"",key:q},{default:t(()=>[z((x(),V(T,{clickable:"",onClick:re=>L(a.id)},{default:t(()=>[e(i,{class:"text-center"},{default:t(()=>[o(d(a.id),1)]),_:2},1024),e(i,{class:"text-center"},{default:t(()=>[o(d(k(ae)(a.created_at).format("YYYY-MM-D")),1)]),_:2},1024),e(i,{class:"text-center"},{default:t(()=>[o(d(a.created_by),1)]),_:2},1024),e(i,{class:"text-center"},{default:t(()=>[o(d(a.notes),1)]),_:2},1024),e(i,{class:"text-center"},{default:t(()=>[o(d(a.origin.alias),1)]),_:2},1024),e(i,{class:"text-center"},{default:t(()=>[o(d(a.destiny.alias),1)]),_:2},1024),e(i,{class:"text-center"},{default:t(()=>[o(d(a.code_fs),1)]),_:2},1024),e(i,{class:"text-center"},{default:t(()=>[o(d(a.bodie.length),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[G]])]),_:2},1024))),128)),e(I,{modelValue:u.value,"onUpdate:modelValue":l[4]||(l[4]=a=>u.value=a)},{default:t(()=>[e($,{class:"my-card"},{default:t(()=>[e(g,null,{default:t(()=>[f("div",se,[ne,e(K,{modelValue:v.value,"onUpdate:modelValue":l[2]||(l[2]=a=>v.value=a),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),e(g,null,{default:t(()=>[e(S,{align:"right"},{default:t(()=>[e(p,{flat:"",icon:"close",color:"negative",onClick:l[3]||(l[3]=a=>u.value=!u.value)}),e(p,{flat:"",icon:"check",color:"positive",onClick:Y})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(I,{modelValue:_.value,"onUpdate:modelValue":l[9]||(l[9]=a=>_.value=a),persistent:""},{default:t(()=>[e($,{style:{width:"700px","max-width":"80vw"}},{default:t(()=>[e(g,{class:"text-h5 text-bold text-center"},{default:t(()=>[o(" Nuevo Traspaso ")]),_:1}),e(g,{class:"row items-center"},{default:t(()=>[e(A,{modelValue:s.value._origin,"onUpdate:modelValue":[l[5]||(l[5]=a=>s.value._origin=a),l[6]||(l[6]=a=>s.value._destiny=null)],options:Q.value,label:"Almacen Origen",class:"col","option-label":"name","option-disable":a=>E(a)},null,8,["modelValue","options","option-disable"]),e(D,{name:"arrow_forward",class:"col",size:"md"}),e(A,{modelValue:s.value._destiny,"onUpdate:modelValue":l[7]||(l[7]=a=>s.value._destiny=a),options:Q.value,label:"Almacen Destino",class:"col","option-label":"name","option-disable":a=>h(a),disable:s.value._origin==null},null,8,["modelValue","options","option-disable","disable"])]),_:1}),e(g,null,{default:t(()=>[e(X,{modelValue:s.value.notes,"onUpdate:modelValue":l[8]||(l[8]=a=>s.value.notes=a),type:"text",label:"Notas"},null,8,["modelValue"])]),_:1}),e(S,{align:"center"},{default:t(()=>[e(p,{flat:"",label:"Cancelar",color:"negative",onClick:B}),e(p,{flat:"",label:"Crear",color:"positive",onClick:U,disable:!k(N)},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Ee as default};
