import{i as G,aR as J,aS as K,j as W,r as x,o as k,d as C,w as s,e as l,a1 as t,ak as m,a0 as c,an as X,Q as w,a4 as B,c as $,f as d,al as Y,h as D}from"./index.347d0b78.js";import{Q as f}from"./QCardSection.5706caf2.js";import{b as q,Q as z}from"./QList.a5a3c49b.js";import{Q as A}from"./QInput.b1ffda30.js";import{Q as I}from"./QTable.6727b456.js";import{Q as N}from"./QCard.bfe4a2c0.js";import{Q as ee}from"./QTooltip.a662a80d.js";import{Q as E}from"./QCardActions.ea3a5e63.js";import{Q as le}from"./QPage.3ea915af.js";import{C as P}from"./ClosePopup.fa75c376.js";import{u as te}from"./use-quasar.a16220f0.js";import{c as h}from"./clientApi.26171472.js";import{c as ae}from"./axios.1856f029.js";import{Q as b}from"./QTd.3c673998.js";import{Q as se}from"./QTr.3a92c07b.js";import"./QSelect.000b8de9.js";import"./QLinearProgress.dbf85e1e.js";import"./QCheckbox.12c01702.js";const oe='<g transform="translate(1 1)" stroke-width="2" fill="none" fill-rule="evenodd"><circle cx="5" cy="50" r="5"><animate attributeName="cy" begin="0s" dur="2.2s" values="50;5;50;50" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="cx" begin="0s" dur="2.2s" values="5;27;49;5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="27" cy="5" r="5"><animate attributeName="cy" begin="0s" dur="2.2s" from="5" to="5" values="5;50;50;5" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="cx" begin="0s" dur="2.2s" from="27" to="27" values="27;49;5;27" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="49" cy="50" r="5"><animate attributeName="cy" begin="0s" dur="2.2s" values="50;50;5;50" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="cx" from="49" to="49" begin="0s" dur="2.2s" values="49;5;27;49" calcMode="linear" repeatCount="indefinite"></animate></circle></g>';var ie=G({name:"QSpinnerBall",props:J,setup(T){const{cSize:p,classes:r}=K(T);return()=>W("svg",{class:r.value,stroke:"currentColor",width:p.value,height:p.value,viewBox:"0 0 57 57",xmlns:"http://www.w3.org/2000/svg",innerHTML:oe})}});const re={__name:"QuotesArchive",props:{quotes:{default:[],type:Array}},emits:["restore","destroy"],setup(T,{emit:p}){let r={0:{label:"Nueva",color:"text-pink"},1:{label:"Aprobada",color:"text-light-green-10"},2:{label:"Rechazada",color:"text-red-14"}},o=x({cols:[{name:"id",label:"ID"},{name:"client",label:"Cliente"},{name:"address",label:"Domicilio",field:u=>`${u.street}, ${u.num_ext}`},{name:"celphone",label:"Telefono"},{name:"email",label:"Correo"},{name:"price",label:"Precio"},{name:"tickets",label:"Ticket"},{name:"status",label:"Estado",field:u=>r[u._status].label,classes:u=>r[u._status].color},{name:"store",label:"Sucursal"},{name:"actions",label:"Actions"}]}),v=p,S=T;const y=u=>{v("restore",u)},g=u=>{v("destroy",u)};return(u,R)=>(k(),C(f,{class:"col"},{default:s(()=>[l(I,{title:"Rechazadas",rows:t(S).quotes,"row-key":"name",columns:t(o).cols},{body:s(i=>[l(se,{props:i},{default:s(()=>[l(b,{key:"id",props:i},{default:s(()=>[m(c(i.row.id),1)]),_:2},1032,["props"]),l(b,{key:"client",props:i},{default:s(()=>[m(c(i.row.nom_cli),1)]),_:2},1032,["props"]),l(b,{key:"address",props:i},{default:s(()=>[m(c(`${i.row.street}, ${i.row.num_ext}`),1)]),_:2},1032,["props"]),l(b,{key:"celphone",props:i},{default:s(()=>[m(c(i.row.celphone),1)]),_:2},1032,["props"]),l(b,{key:"email",props:i},{default:s(()=>[m(c(i.row.email),1)]),_:2},1032,["props"]),l(b,{key:"price",props:i},{default:s(()=>[m(c(i.row.price),1)]),_:2},1032,["props"]),l(b,{key:"tickets",props:i},{default:s(()=>[m(c(i.row.tickets),1)]),_:2},1032,["props"]),l(b,{key:"status",props:i,class:X(t(r)[i.row._status].color)},{default:s(()=>[m(c(t(r)[i.row._status].label),1)]),_:2},1032,["props","class"]),l(b,{key:"store",props:i},{default:s(()=>[m(c(i.row.sucursal),1)]),_:2},1032,["props"]),l(b,{key:"actions",props:i},{default:s(()=>[l(w,{flat:"",round:"",icon:"settings_backup_restore",color:"primary",onClick:V=>y(i.row.id),title:"Restaurar"},null,8,["onClick"]),l(w,{flat:"",round:"",icon:"delete_forever",color:"negative",onClick:V=>g(i.row.id),title:"Eliminar permanentemente"},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),l(N,{class:"my-card"},{default:s(()=>[l(f,null,{default:s(()=>[l(E,null,{default:s(()=>[B(l(w,{flat:"",label:"Cancelar"},null,512),[[P]])]),_:1})]),_:1})]),_:1})]),_:1}))}},ne={class:"full-width row justify-between item-center"},ce={class:"full-width row justify-between item-center"},ue={class:"full-width row justify-between item-center"},de=["src"],me={class:"text-h6 text-center"},fe={class:"text-h5 text-left"},pe={class:"text-subtitle2 text-left"},_e={class:"text-subtitle2 text-left"},be={class:"text-subtitle2 text-left"},ve={class:"text-subtitle2 text-left"},we={class:"text-subtitle2 text-left"},ze={__name:"addCli",setup(T){const p=te();let r=x([]),o=x({state:!1,row:null,pts:!1}),v={0:{label:"Nueva",color:"text-pink"},1:{label:"Aprobada",color:"text-light-green-10"},2:{label:"Rechazada",color:"text-red-14"},3:{label:"Sincronizadas",color:"text-deep-orange-10"},4:{label:"Eliminadas",color:"text-deep-orange-10"}},S=x({state:!1,row:null}),y=x({vcolumns:["client","celphone","price","status"],cols:[{name:"id",label:"ID",field:"id"},{name:"client",label:"Cliente",field:"nom_cli"},{name:"address",label:"Domicilio",field:e=>`${e.street}, ${e.num_ext}`},{name:"celphone",label:"Telefono",field:"celphone"},{name:"email",label:"Correo",field:"email"},{name:"price",label:"Precio",field:"price"},{name:"tickets",label:"Ticket",field:"tickets"},{name:"status",label:"Estado",field:e=>v[e._status].label,classes:e=>v[e._status].color},{name:"store",label:"Sucursal",field:"sucursal"}],filter:""}),g=x({vcolumns:["client","celphone","price","status","idfs","ReplyStore"],cols:[{name:"id",label:"ID",field:"id"},{name:"idfs",label:"Factusol",field:"fs_id"},{name:"client",label:"Cliente",field:"nom_cli"},{name:"address",label:"Domicilio",field:e=>`${e.street}, ${e.num_ext}`},{name:"celphone",label:"Telefono",field:"celphone"},{name:"email",label:"Correo",field:"email"},{name:"price",label:"Precio",field:"price"},{name:"tickets",label:"Ticket",field:"tickets"},{name:"status",label:"Estado",field:e=>v[e._status].label,classes:e=>v[e._status].color},{name:"store",label:"Sucursal",field:"sucursal"},{name:"ReplyStore",label:"ReplicadoEn:",field:"Stores"}],filter:""}),u=x({vcolumns:["client","celphone","price","status","idfs"],cols:[{name:"id",label:"ID",field:"id"},{name:"idfs",label:"Factusol",field:"fs_id"},{name:"client",label:"Cliente",field:"nom_cli"},{name:"address",label:"Domicilio",field:e=>`${e.street}, ${e.num_ext}`},{name:"celphone",label:"Telefono",field:"celphone"},{name:"email",label:"Correo",field:"email"},{name:"price",label:"Precio",field:"price"},{name:"tickets",label:"Ticket",field:"tickets"},{name:"status",label:"Estado",field:e=>v[e._status].label,classes:e=>v[e._status].color},{name:"store",label:"Sucursal",field:"sucursal"}],filter:""}),R=$(()=>r.value.filter(e=>e._status==0)),i=$(()=>r.value.filter(e=>e._status==2)),V=$(()=>r.value.filter(e=>e._status==1)),M=$(()=>r.value.filter(e=>e._status==3));const U=async()=>{console.log("Traiendo solicitudes creadas");const e=await h.getSolicitud();console.log(e),r.value=e.solicitudes},j=(e,a)=>{console.log(a._status),o.value.row=a,o.value.state=!0},O=async()=>{o.value.pts=!0;let e=await h.addClient(o.value.row);if(console.log(e),e.fail){console.log(e),console.log("error brou"),console.log(e);let a=e.fail.response.data.error.msg;o.value.pts=!1,p.notify({message:a,icon:"close",color:"negative"})}else{let a=e.id,n=r.value.findIndex(_=>_.id==a);r.value[n]._status=e._status,r.value[n].fs_id=e.fs_id,o.value.state=!1,o.value.pts=!1,p.notify({message:"Cliente Creado",icon:"check_circle",color:"positive"}),console.log(e)}},L=async()=>{o.value.pts=!0;const e=await h.ignoredClient(o.value.row);let a=e.id,n=r.value.findIndex(_=>_.id==a);r.value[n]._status=e._status,o.value.state=!1,o.value.pts=!1,console.log(n),p.notify({message:"Cliente Ignorado",icon:"close",color:"danger"}),console.log(e)},F=async e=>{let a=await h.restoreClient({id:e}),n=a.id,_=r.value.findIndex(Q=>Q.id==n);r.value[_]._status=a._status,p.notify({message:"Restaurado",icon:"check",color:"primary"}),console.log(a)},Z=async e=>{console.log("amo a destruira "+e);let a=await h.deleteClient({id:e}),n=a.id,_=r.value.findIndex(Q=>Q.id==n);r.value[_]._status=a._status,p.notify({message:"Eliminado",icon:"close",color:"negative"}),console.log(a)},H=async()=>{o.value.state=!0,o.value.pts=!0,console.log("SINCRONIZANDO CLIENTES");let e=await h.synclient();console.log(e),e.fail?p.notify({message:"hubo problemas con la replicacion",icon:"close",color:"negative"}):(e.forEach(n=>{let _=r.value.findIndex(Q=>Q.id==n.id);r.value[_]._status=n._status,r.value[_].Stores=n.Stores}),o.value.state=!1,o.value.pts=!1,p.notify({message:"CLIENTES SINCRONIZADOS",icon:"check_circle",color:"positive"}))};return U(),(e,a)=>(k(),C(le,{padding:""},{default:s(()=>[l(N,{class:"my-card"},{default:s(()=>[l(f,{class:"text-right"},{default:s(()=>[l(w,{color:"negative",icon:"archive",label:"",onClick:a[0]||(a[0]=n=>t(S).state=!0)})]),_:1}),l(q),l(f,{horizontal:""},{default:s(()=>[l(f,{class:"col"},{default:s(()=>[l(I,{title:"Solicitudes",rows:t(R),"row-key":"name",columns:t(y).cols,onRowClick:j,filter:t(y).filter,"visible-columns":t(y).vcolumns},{top:s(()=>[d("div",ne,[a[6]||(a[6]=d("div",{class:"text-h5"},"Pendientes",-1)),l(A,{modelValue:t(y).filter,"onUpdate:modelValue":a[1]||(a[1]=n=>t(y).filter=n),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter","visible-columns"])]),_:1}),l(f,{class:"col"},{default:s(()=>[l(I,{title:"Aceptados",rows:t(V),columns:t(g).cols,"row-key":"name",filter:t(g).filter,"visible-columns":t(g).vcolumns},{top:s(()=>[d("div",ce,[d("div",null,[l(w,{color:"positive",icon:"sync",onClick:H,disabled:t(V)<=0},null,8,["disabled"])]),a[7]||(a[7]=d("div",{class:"text-h5"},"Aceptadas",-1)),l(A,{modelValue:t(g).filter,"onUpdate:modelValue":a[2]||(a[2]=n=>t(g).filter=n),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter","visible-columns"])]),_:1})]),_:1})]),_:1}),l(N,{class:"my-card"},{default:s(()=>[l(f,{class:"text-right"}),l(q),l(f,{horizontal:""},{default:s(()=>[l(f,{class:"col"},{default:s(()=>[l(I,{title:"Terminadas",rows:t(M),"row-key":"name",columns:t(u).cols,filter:t(u).filter,"visible-columns":t(u).vcolumns},{top:s(()=>[d("div",ue,[a[8]||(a[8]=d("div",{class:"text-h5"},"En Sucursales",-1)),l(A,{modelValue:t(u).filter,"onUpdate:modelValue":a[3]||(a[3]=n=>t(u).filter=n),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter","visible-columns"])]),_:1})]),_:1})]),_:1}),l(z,{modelValue:t(o).state,"onUpdate:modelValue":a[4]||(a[4]=n=>t(o).state=n),persistent:t(o).pts},{default:s(()=>[t(o).pts?(k(),C(N,{key:0},{default:s(()=>[l(f,null,{default:s(()=>[l(ie,{color:"primary",size:"md"}),l(ee,{offset:[0,8]},{default:s(()=>a[9]||(a[9]=[m("Dando de alta en sucursales :)")])),_:1})]),_:1})]),_:1})):(k(),C(N,{key:1},{default:s(()=>[l(Y,{size:"300px"},{default:s(()=>[d("img",{src:`${t(ae)}/client/${t(o).row.picture}`},null,8,de)]),_:1}),t(o).row._status==0?(k(),C(f,{key:0},{default:s(()=>[d("div",me,"Solicitud: "+c(t(o).row.id),1),a[10]||(a[10]=d("div",{class:"text-h5 text-left"},"Cliente",-1)),d("div",fe,c(t(o).row.nom_cli),1),d("div",pe,"Sucursal: "+c(t(o).row.sucursal),1),d("div",_e,"Precio: "+c(t(o).row.price),1),d("div",be,"Telefono: "+c(t(o).row.celphone),1),d("div",ve,"Correo: "+c(t(o).row.email),1),d("div",we,"Solicitado: "+c(t(o).row.created_at),1)]),_:1})):D("",!0),l(E,{align:"right"},{default:s(()=>[l(w,{flat:"",onClick:L,color:"negative"},{default:s(()=>a[11]||(a[11]=[m("Rechazar")])),_:1}),l(w,{flat:"",onClick:O,color:"positive"},{default:s(()=>a[12]||(a[12]=[m("Aprobar")])),_:1})]),_:1}),t(o).row._status==1?(k(),C(f,{key:1},{default:s(()=>[m(c(t(o).row)+" - 1 ",1)]),_:1})):D("",!0),t(o).row._status==2?(k(),C(f,{key:2},{default:s(()=>[m(c(t(o).row)+" - 2 ",1)]),_:1})):D("",!0),l(E,null,{default:s(()=>[B(l(w,{flat:"",label:"Cancelar"},null,512),[[P]])]),_:1})]),_:1}))]),_:1},8,["modelValue","persistent"]),l(z,{modelValue:t(S).state,"onUpdate:modelValue":a[5]||(a[5]=n=>t(S).state=n),persistent:""},{default:s(()=>[l(re,{quotes:t(i),onRestore:F,onDestroy:Z},null,8,["quotes"])]),_:1},8,["modelValue"])]),_:1}))}};export{ze as default};
