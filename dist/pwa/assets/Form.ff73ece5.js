import{Q as d}from"./QInput.b14ac6c2.js";import{Q as b}from"./QTooltip.c1b928eb.js";import{j as A,E as V,F as q,aT as w,r as Q,c as h,o as i,a as m,w as t,i as s,e as a,Q as u,a3 as k,h as g,Z as B,a4 as y,g as F,a0 as S,a1 as D,f as T}from"./index.7ded638f.js";import{d as E,Q as N}from"./deposits.eb165f68.js";import{Q as R}from"./QUploader.2d69e41f.js";import{Q as j}from"./QForm.d3c06739.js";import{Q as L}from"./QPage.7674c300.js";import{u as $}from"./VDB.733f137f.js";import"./QCard.f0e183b6.js";import"./QCardActions.df110778.js";import"./QDialog.05f54e67.js";import"./ClosePopup.ce59bb50.js";import{u as z}from"./use-quasar.ef17de3c.js";import"./jspdf.plugin.autotable.eabbebae.js";import"./exceljs.min.9e24d01d.js";import"./browser.94c942de.js";import"./use-key-composition.c6b4d655.js";import"./uid.42677368.js";import"./position-engine.e4f86561.js";import"./axios.ae0a941c.js";import"./axios.f1f32898.js";import"./format.2bc25e5f.js";import"./_commonjsHelpers.88e99c8f.js";var I=A({name:"QUploaderAddTrigger",setup(){const p=q(w,V);return p===V&&console.error("QUploaderAddTrigger needs to be child of QUploader"),p}});const P={class:"flex justify-center"},K={class:"row no-wrap items-center q-pa-sm q-gutter-xs"},M={class:"col"},O=s("div",{class:"q-uploader__title"},"Subir Archivo",-1),Z={class:"q-uploader__subtitle"},G={class:"row"},H={class:"text-overline"},J={class:"flex justify-center"},Ve={__name:"Form",setup(p){const c=$(),f=z();console.log(c.session.name);const v=Q(null),e=Q({origin:null,destiny:null,reference:null,concepto:null,amount:null,files:[]}),_=()=>{e.value={origin:null,destiny:null,reference:null,concepto:null,amount:null,files:[]},v.value.reset()},U=h(()=>e.value.origin&&e.value.destiny&&e.value.reference&&e.value.concepto&&e.value.amount&&e.value.files.length>0),x=n=>{e.value.files=n,console.log("Archivos a\xF1adidos:",e.value.files)},C=async()=>{f.loading.show({message:"Enviando Formulario"});const n=new FormData;n.append("origin",e.value.origin),n.append("destiny",e.value.destiny),n.append("reference",e.value.reference),n.append("concepto",e.value.concepto),n.append("amount",e.value.amount),n.append("_store",c.session.store.id),n.append("send_by",c.session.name),e.value.files.forEach((l,r)=>{n.append(`file_${r}`,l),console.log(e.value.files)});const o=await E.newForm(n);o.fail?console.log(o):(console.log(o),f.loading.hide(),f.notify({type:"positive",message:o.message}),_())};return(n,o)=>(i(),m(L,{padding:""},{default:t(()=>[s("div",P,[a(j,{onSubmit:C,onReset:_,class:"q-gutter-md"},{default:t(()=>[a(d,{modelValue:e.value.origin,"onUpdate:modelValue":o[0]||(o[0]=l=>e.value.origin=l),type:"number",label:"Cuenta Origen",filled:"",dense:""},null,8,["modelValue"]),a(d,{modelValue:e.value.destiny,"onUpdate:modelValue":o[1]||(o[1]=l=>e.value.destiny=l),type:"number",label:"Cuenta Destino",filled:"",dense:""},null,8,["modelValue"]),a(d,{modelValue:e.value.concepto,"onUpdate:modelValue":o[2]||(o[2]=l=>e.value.concepto=l),type:"text",label:"Referencia",filled:"",dense:""},null,8,["modelValue"]),a(d,{modelValue:e.value.reference,"onUpdate:modelValue":o[3]||(o[3]=l=>e.value.reference=l),type:"number",label:"Referencia Numerica / Folio",filled:"",dense:""},null,8,["modelValue"]),a(d,{modelValue:e.value.amount,"onUpdate:modelValue":o[4]||(o[4]=l=>e.value.amount=l),type:"number",label:"Monto",filled:"",dense:""},null,8,["modelValue"]),a(R,{modelValue:e.value.files,"onUpdate:modelValue":o[6]||(o[6]=l=>e.value.files=l),accept:"image/*","auto-upload":!1,onAdded:x,ref_key:"refe",ref:v},{header:t(l=>[s("div",K,[l.queuedFiles.length>0?(i(),m(u,{key:0,icon:"clear_all",onClick:o[5]||(o[5]=()=>{v.value.reset(),e.value.files=[]}),round:"",dense:"",flat:""},{default:t(()=>[a(b,null,{default:t(()=>[k("Limpiar")]),_:1})]),_:1})):g("",!0),l.isUploading?(i(),m(B,{key:1,class:"q-uploader__spinner"})):g("",!0),s("div",M,[O,s("div",Z,y(l.uploadSizeLabel)+" / "+y(l.uploadProgressLabel),1)]),l.canAddFiles?(i(),m(u,{key:2,type:"a",icon:"add_box",onClick:l.pickFiles,round:"",dense:"",flat:""},{default:t(()=>[a(I),a(b,null,{default:t(()=>[k("Subir Archivo")]),_:1})]),_:2},1032,["onClick"])):g("",!0)])]),list:t(l=>[(i(!0),F(D,null,S(l.files,r=>(i(),F("div",{key:r.__key},[s("div",G,[a(N,{src:r.__img.src,ratio:20/8,"spinner-color":"primary","spinner-size":"82px",class:"col"},null,8,["src"]),a(u,{color:"negative",icon:"delete",onClick:()=>{l.removeFile(r),e.value.files=[]},flat:"",rounded:""},null,8,["onClick"])]),s("div",H,y(r.name),1)]))),128))]),_:1},8,["modelValue"]),s("div",J,[a(u,{label:"Cancelar",type:"reset",color:"primary",flat:"",class:"q-ml-sm"}),a(u,{label:"Enviar",type:"submit",color:"primary",flat:"",disable:!T(U)},null,8,["disable"])])]),_:1})])]),_:1}))}};export{Ve as default};
