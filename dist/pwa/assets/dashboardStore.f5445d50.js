import{a as U,b as W,Q as w,d as X,e as Q}from"./QList.50729234.js";import{Q as P}from"./QTable.0cd03545.js";import{Q as Z}from"./QExpansionItem.a803090b.js";import{aI as ee,a as te,u as ae,r as c,c as Y,o as x,d as R,w as o,f as g,e,S as oe,al as u,a0 as d,g as le,a2 as se,a3 as re,a4 as S,Q as f,am as ie,a1 as ne}from"./index.eed437d0.js";import{Q as ue}from"./QInput.b65338fd.js";import{Q as m}from"./QCardSection.4706c313.js";import{Q as h}from"./QCardActions.e38329fe.js";import{Q as V}from"./QCard.5cada9f8.js";import{Q as de}from"./QSelect.e2b065f9.js";import{Q as me}from"./QPage.a405e71e.js";import{C as k}from"./ClosePopup.d2e53e88.js";import{d as A}from"./dayjs.min.cbcf888d.js";import{R as pe}from"./RestockApi.243db0a4.js";import{u as ce}from"./Restock.3c8434a2.js";import{u as fe}from"./use-quasar.4cc3dfd9.js";import"./socket.05630e21.js";import"./QBtnGroup.e1956354.js";import"./use-key-composition.88110e91.js";import"./QLinearProgress.ae99a0c2.js";import"./QCheckbox.ebfa3b1a.js";import"./use-checkbox.5c639eab.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.1827c22f.js";import"./QToolbar.6dbcfc22.js";import"./QForm.6b344576.js";import"./QRadio.fda810a4.js";import"./QTd.79ee2f47.js";import"./QPopupEdit.2d47a8b7.js";import"./QTr.64b79515.js";import"./QLayout.3c127cbd.js";import"./QScrollObserver.43f8b16a.js";import"./QResizeObserver.f5192848.js";import"./QDrawer.fa8bbbae.js";import"./jspdf.plugin.autotable.cf4f64f1.js";import"./exceljs.min.9e24d01d.js";import"./JsBarcode.cb858474.js";import"./browser.c61f550a.js";/* empty css                                                       */const ve={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},ge={class:"row justify-end q-gutter-sm full-width"},be={class:"q-ml-sm"},_e={class:"text-bold"},lt={__name:"dashboardStore",setup(we){ee();const M=te(),p=ce(),b=fe(),y=ae(),i=c({state:!1,val:null}),s=c({state:!1,val:null}),r=c({state:!1,val:null}),O=c({rowsPerPage:[0]}),_=c(null),C=c({columns:[{name:"id",label:"ID",field:l=>l.id,align:"center"},{name:"invoice",label:"Factura",field:l=>l.invoice,align:"center"},{name:"invoiceReceived",label:"Factura R",field:l=>l.invoice_received,align:"center"},{name:"status",label:"Estado",field:l=>l.status.name,align:"left"},{name:"UACT",label:"U.Act",field:l=>{var t,a;return A((a=(t=l.log)==null?void 0:t.find(n=>n.id==l._status))==null?void 0:a.pivot.updated_at).format("YYYY/MM/DD HH:mm:ss")},align:"left"}],pagination:{rowsPerPage:10}}),T=Y(()=>p.ordersok.filter(l=>l._workpoint_from==y.session.store.id_viz)),N=Y(()=>p.printers.find(l=>l.id==y.session.store.id_viz).printers),q=()=>{M.push(`/distribute/dashboardStore/${s.value.val.id}`)},E=async()=>{p.setShowLYT(!0),p.setTitle("Dashboard"),p.setButtonShow(!0),p.setButtonShowAdd(!0)},F=(l,t)=>{i.value.state=!0,i.value.val=t},H=["text-grey-5","text-h6 text-red","text-indigo","4","5","text-pink-7","text-orange-8","8","text-primary","text-positive"],j=l=>{s.value.state=!0,s.value.val=l},L=(l,t)=>{const a=t.toUpperCase();return l.filter(n=>{var $,D;const J=Object.values(n).some(v=>String(v!=null?v:"").toUpperCase().includes(a)),K=(D=($=n.partition)==null?void 0:$.some(v=>{var I;return(I=v.products)==null?void 0:I.some(G=>{var B;return(B=G.code)==null?void 0:B.toUpperCase().includes(a)})}))!=null?D:!1;return J||K})},z=async()=>{b.loading.show({message:"..."});let l={ip:r.value.val.ip,port:9100,order:s.value.val.id};const t=await pe.printforsupplyStore(l);console.log(t),t.status==200?(t.data?(b.notify({message:"Impresion correcta",icon:"done",color:"positive",position:"top"}),r.value.state=!1):b.notify({message:`Sin conexion a <b>${l.name} <small>(${l.ip})</small></b>`,icon:"fas fa-bug",color:"negative",position:"center",html:!0,timeout:4e3}),b.loading.hide()):(console.error(t),alert(`Error ${t.status}: ${t.data}`))};return E(),(l,t)=>(x(),R(me,{padding:""},{default:o(()=>[g("div",null,[e(P,{rows:T.value,"row-key":"name",grid:"",pagination:O.value,filter:_.value,"hide-bottom":"","filter-method":L},{item:o(a=>[g("div",ve,[e(U,{bordered:"",onDblclick:n=>j(a.row)},{default:o(()=>[e(Z,{"header-class":`${H[a.row.status.id-1]}`,dense:"",icon:"list",label:`${a.row.id.toString()} (${a.row.status.name})`,caption:`${a.row.to.name} (${a.row.notes})`},{default:o(()=>[e(W),e(P,{"hide-bottom":"",flat:"",rows:a.row.partition,columns:C.value.columns,pagination:C.value.pagination,onRowClick:F},null,8,["rows","columns","pagination"])]),_:2},1032,["header-class","label","caption"])]),_:2},1032,["onDblclick"])])]),top:o(()=>[g("div",ge,[e(ue,{dense:"",debounce:"300",modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=a=>_.value=a),placeholder:"Buscar",class:"col-auto",outlined:""},{append:o(()=>[e(oe,{name:"search"})]),_:1},8,["modelValue"])])]),_:1},8,["rows","pagination","filter"])]),e(w,{modelValue:i.value.state,"onUpdate:modelValue":t[1]||(t[1]=a=>i.value.state=a),persistent:""},{default:o(()=>[e(V,null,{default:o(()=>[e(m,{class:"text-center text-h6"},{default:o(()=>[u(" ID: "+d(i.value.val.id),1)]),_:1}),e(m,{class:"text-center text-bold"},{default:o(()=>[u(d(i.value.val.status.name),1)]),_:1}),e(m,null,{default:o(()=>[(x(!0),le(re,null,se(i.value.val.log,(a,n)=>(x(),R(U,{bordered:"",key:n},{default:o(()=>[e(X,null,{default:o(()=>[e(Q,null,{default:o(()=>[u(d(a.name),1)]),_:2},1024),e(Q,null,{default:o(()=>[u(d(JSON.parse(a.pivot.details).responsable),1)]),_:2},1024),e(Q,null,{default:o(()=>[u(d(ne(A)(a.pivot.updated_at).format("YYYY/MM/DD HH:mm:ss")),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(h,{align:"right"},{default:o(()=>[S(e(f,{flat:"",label:"OK",color:"primary"},null,512),[[k]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(w,{modelValue:s.value.state,"onUpdate:modelValue":t[3]||(t[3]=a=>s.value.state=a),persistent:""},{default:o(()=>[e(V,null,{default:o(()=>[e(m,{class:"row items-center"},{default:o(()=>[e(ie,{icon:"receipt_long",color:"primary","text-color":"white"}),g("span",be,d(s.value.val.id),1)]),_:1}),e(m,{class:"text-h6"},{default:o(()=>[t[6]||(t[6]=u(" Notas : ")),g("span",_e,d(s.value.val.notes),1)]),_:1}),e(h,{align:"right"},{default:o(()=>[S(e(f,{flat:"",icon:"close",color:"negative"},null,512),[[k]]),e(f,{color:"teal",flat:"",icon:"print",onClick:t[2]||(t[2]=a=>r.value.state=!r.value.state),disabled:s.value.val._status==1},null,8,["disabled"]),e(f,{flat:"",icon:"send",color:"blue",onClick:q})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(w,{modelValue:r.value.state,"onUpdate:modelValue":t[5]||(t[5]=a=>r.value.state=a),persistent:""},{default:o(()=>[e(V,null,{default:o(()=>[e(m,{class:"row items-center bg-primary text-white text-h6"},{default:o(()=>t[7]||(t[7]=[u(" Selecciona Impresora ")])),_:1}),e(m,{class:""},{default:o(()=>[e(de,{modelValue:r.value.val,"onUpdate:modelValue":t[4]||(t[4]=a=>r.value.val=a),options:N.value,label:"Impresoras","option-label":"name",filled:""},null,8,["modelValue","options"])]),_:1}),e(h,{align:"right"},{default:o(()=>[S(e(f,{flat:"",label:"Cancelar",color:"primary"},null,512),[[k]]),e(f,{flat:"",label:"Terminar",color:"primary",onClick:z,disabled:!r.value.val},null,8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{lt as default};
