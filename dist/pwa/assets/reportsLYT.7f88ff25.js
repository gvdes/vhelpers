import{Q as w}from"./QSeparator.2c1c8002.js";import{u as L,r as f,o as b,a as F,w as v,e as p,f as y,a4 as S,Y as P,g as x,a2 as W,a1 as _,h as B,a5 as E}from"./index.e6ba6b13.js";import{Q as D}from"./QHeader.721c219d.js";import{Q as T}from"./QSelect.650158f7.js";import{Q as C,a as j}from"./QCard.f42267e5.js";import{Q as $,a as z}from"./QLayout.b38ce65b.js";import{u as V}from"./VDB.8271e3ab.js";import{u as A}from"./use-quasar.ebba6db6.js";import"./jspdf.plugin.autotable.9d7ccc52.js";import{v as M}from"./axios.ba7b1b0e.js";import{E as d}from"./exceljs.min.9e24d01d.js";import"./dayjs.min.cbcf888d.js";import"./browser.a927a609.js";import{_ as Q}from"./UserToolbar.37c60823.js";import"./QResizeObserver.95fc5e14.js";import"./use-key-composition.edb796c3.js";import"./uid.937d8ee7.js";import"./QItemSection.b3b5f24d.js";import"./position-engine.8b8bb76a.js";import"./QDialog.b1ed1693.js";import"./rtl.276c3f1b.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.9ab26c22.js";import"./QCardActions.0b3522c6.js";import"./ClosePopup.d7a79b53.js";var O={index(){return M.get("/reports").then(t=>t.data).catch(t=>({fail:t}))},getReport(t){return M.post("/reports/getReport",t).then(n=>n.data).catch(n=>({fail:n}))}};const U=async t=>{console.log(t);const n=new d.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await h(n,t.key)},G=async t=>{console.log(t);const n=new d.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await h(n,t.key)},N=async t=>{console.log(t);const n=new d.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await h(n,t.key)},q=async t=>{console.log(t);const n=new d.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await h(n,t.key)},H=async t=>{console.log(t);const n=new d.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await h(n,t.key)},I=async t=>{console.log(t);const n=new d.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await h(n,t.key)},X=async t=>{console.log(t);const n=new d.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await h(n,t.key)},Y=async t=>{console.log(t);const n=new d.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await h(n,t.key)},J=async(t,n)=>{console.log(t);const s=new d.Workbook,i=s.addWorksheet(t.key);let l=t.value.map(e=>({C\u00F3digo:e.id,Modelo:e.code,Descripci\u00F3n:e.description,Proveedor:e.provider.name,Fabricante:e.maker?e.maker.name:"",Status:e.status.name,Secci\u00F3n:e.category.familia.seccion.name,Familia:e.category.familia.name,Categor\u00EDa:e.category.name,"Piezas x caja":e.pieces,SOTANO:e.stocks.find(a=>a.id==n).pivot.stock,CEDIS:e.stocks.find(a=>a.id==1).pivot.stock,TEXCOCO:e.stocks.find(a=>a.id==2).pivot.stock,Maximo:e.stocks[0].pivot.max,Minimo:e.stocks[0].pivot.min,locations:e.locations.map(a=>a.path).join("/")}));const r=Object.keys(l[0]).map(e=>({name:e,filterButton:!0})),o=l.map(e=>Object.values(e));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:r,rows:o}),i.columns.forEach(e=>{let a=0;e.eachCell({includeEmpty:!0},c=>{const m=c.value?c.value.toString().length:10;m>a&&(a=m)}),e.width=a<10?10:a}),await h(s,t.key)},K=async t=>{console.log(t);const n=new d.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await h(n,t.key)},Z=async t=>{console.log(t);const n=new d.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await h(n,t.key)},oo=async t=>{console.log(t);const n=new d.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,CEDIS:o.stocks.find(e=>e.id==1).pivot.stock,TEXCOCO:o.stocks.find(e=>e.id==2).pivot.stock,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await h(n,t.key)},h=async(t,n)=>{try{const s=await t.xlsx.writeBuffer(),i=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=URL.createObjectURL(i),r=document.createElement("a");r.href=l,r.download=`${n}.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(s){console.error("Error al escribir el buffer:",s)}};var u={catalogo:U,conStock:G,conStockUbicados:N,conStockSinUbicar:q,sinStock:H,sinStockUbicados:I,sinMaximos:X,generalVsExhibicion:Y,generalVsCedis:J,conMaximos:K,negativos:Z,cedisStock:oo};const eo={class:"row justify-between"},to={class:"row"},ao={key:0,class:"row q-pl-sm"},so=["onClick"],io={class:"text--1 text-right q-pa-md"},Wo={__name:"reportsLYT",setup(t){const n=L(),s=V(),i=A(),l=f([]),r=f({seccion:null,familia:null,categoria:null}),o=f([]),e=async()=>{const m=await O.index();m.error?console.log(m):(console.log(m),l.value=m)},a=async()=>{i.loading.show({message:"Obteniendo Datos"});let m={workpoint:s.session.store.id_viz,secciones:r.value.seccion.map(g=>g.id)};const k=await O.getReport(m);k.error?console.log(k):(console.log(k),o.value=Object.keys(k).map(g=>({key:g,value:k[g]})),i.loading.hide())},c=m=>{i.loading.show({message:"Generando Reporte"});let k=s.session.store.id_viz;switch(m.key){case"catalogo":u.catalogo(m);break;case"conStock":u.conStock(m);break;case"conStockUbicados":u.conStockUbicados(m);break;case"conStockSinUbicar":u.conStockSinUbicar(m);break;case"sinStock":u.sinStock(m);break;case"sinStockUbicados":u.sinStockUbicados(m);break;case"sinMaximos":u.sinMaximos(m);break;case"generalVsExhibicion":u.generalVsExhibicion(m);break;case"generalVsCedis":u.generalVsCedis(m,k);break;case"conMaximos":u.conMaximos(m);break;case"negativos":u.negativos(m);break;case"cedisStock":u.cedisStock(m);break}i.loading.hide()};return s.session.rol=="aux"||s.session.rol=="gen"||s.session.rol=="aud"||s.session.rol=="root"?e():(i.notify({message:"No tienes acceso a esta pagina",type:"negative",position:"center"}),n.replace("/")),(m,k)=>(b(),F($,{view:"hHh Lpr fFf"},{default:v(()=>[p(D,{class:"transparent text-dark",bordered:""},{default:v(()=>[p(Q),p(w),y("div",eo,[y("div",null,[k[1]||(k[1]=S("Helpers ")),p(P,{name:"navigate_next",color:"primary"}),k[2]||(k[2]=S()),k[3]||(k[3]=y("span",{class:"text-h6"},"Reporteria",-1))])]),p(w)]),_:1}),p(w,{spaced:"",inset:"",vertical:"",dark:""}),p(z,null,{default:v(()=>[p(C,{class:"my-card"},{default:v(()=>[p(j,null,{default:v(()=>[y("div",to,[p(w,{spaced:"",inset:"",vertical:"",dark:""}),p(T,{dense:"",class:"col",modelValue:r.value.seccion,"onUpdate:modelValue":k[0]||(k[0]=g=>r.value.seccion=g),options:l.value.seccion,label:"Seccion","option-label":"name",filled:"",multiple:"","use-chips":"",onBlur:a},null,8,["modelValue","options"]),p(w,{spaced:"",inset:"",vertical:"",dark:""})])]),_:1})]),_:1}),p(w,{spaced:"",inset:"",vertical:"",dark:""}),o.value.length>0?(b(),x("div",ao,[(b(!0),x(W,null,_(o.value,(g,R)=>(b(),x("div",{class:"col-md-3 col-xs-6 q-pb-sm q-pr-sm",key:R,onClick:no=>c(g)},[p(C,{class:"bg-darkl1"},{default:v(()=>[p(j,{class:"text-h4 text-left"},{default:v(()=>[y("span",null,E(g.value.length),1)]),_:2},1024),y("div",io,E(g.key.toUpperCase()),1)]),_:2},1024)],8,so))),128))])):B("",!0)]),_:1})]),_:1}))}};export{Wo as default};
