import{b,a as me,d as pe,e as B,Q as I}from"./QList.4b82bea1.js";import{Q as fe}from"./QHeader.230716a5.js";import{u as be,r as w,c as h,o as p,d as M,w as t,e as l,f as s,ak as m,E as Y,Q as g,a1 as j,g as x,h as N,T as ge,a0 as r,aI as ye,al as H,a2 as F,a3 as R,a4 as xe}from"./index.938714a3.js";import{d as we,Q as U,a as V}from"./QSelect.81ba3450.js";import{Q as L}from"./QInput.f1377cb5.js";import{Q as A}from"./QForm.7bca7a30.js";import{Q as Ve}from"./QToolbar.0dbab3ac.js";import{j as ke,Q as y,a as u,p as G}from"./axios.dff4915a.js";import{Q as J}from"./QSpace.55cef42c.js";import{Q as W}from"./QTable.57c315c1.js";import{Q as q}from"./QCardActions.5df6ac92.js";import{Q as _e}from"./QPage.0c0c3b94.js";import{Q as Ce}from"./QFooter.56a568bc.js";import{Q as Qe,a as he}from"./QLayout.6784bbe1.js";import{C as Pe}from"./ClosePopup.09fc13bb.js";import{_ as Te}from"./UserToolbar.a9759a56.js";import{u as Ie}from"./use-quasar.e423981b.js";/* empty css                                                                         */import"./QResizeObserver.fb3b4a7f.js";import"./QLinearProgress.49ad1ca3.js";import"./QCheckbox.cad10586.js";import"./QScrollObserver.3a3a8a77.js";import"./QDrawer.17d6fe5f.js";import"./auth.cad8bd4d.js";const Ue={key:0,class:"text-right"},qe={key:0},Se={class:"row justify-center"},De={class:"row"},Be={class:"row justify-center"},Ne={class:"row justify-between"},Fe={class:"text-left"},Re={class:"text--3"},Ee={class:"text-right"},$e={class:"text-bold"},Me={class:"text--2"},je={class:"row"},He={class:"text-center col"},Le={class:"text-center col"},Ae={class:"text-center col"},Oe={class:"text-h6"},gl={__name:"TckVerifyLYT",setup(ze){const S=be(),v=Ie(),Z=S.series,P=w(null),k=w(null),T=w(""),c=w({state:!1,val:null,body:null}),E=w({state:!1}),i=w({state:!1,body:[],head:null}),d=w({state:!1,val:null}),$=w([]),f=w({pagination:{rowsPerPage:10},visibleColumns:["code","description"],visibleColumnstwo:["code","description","checkout","diferencia"],columns:[{name:"code",label:"Codigo",field:o=>o.codigo,required:!0,align:"left",sortable:!0},{name:"barcode",label:"CB",field:o=>o.cb,align:"left",sortable:!0},{name:"shortcode",label:"Corto",field:o=>o.corto,align:"center",sortable:!0},{name:"description",label:"Descripcion",field:o=>o.descripcion,align:"left",sortable:!0},{name:"checkout",label:"Validado",field:o=>o.checkout,align:"center",sortable:!0},{name:"diferencia",label:"Diferencia",field:o=>o.diferencia,align:"center",sortable:!0}]}),ee=h(()=>P.value&&T.value.length),C=h(()=>i.value.body.filter(o=>o.validate==0)),_=h(()=>i.value.body.filter(o=>o.validate==1)),Q=h(()=>{var o;return(o=i.value.body)==null?void 0:o.filter(e=>e.diferencia!=0)}),O=h(()=>_.value.length>0&&Q.value.length==0&&C.value.length==0),z=h(()=>_.value.length>0&&Q.value.length>0&&C.value.length==0),le=async()=>{v.loading.show({message:"Se esta obteniendo el ticket"});let o={serie:P.value,folio:T.value},a=`http://${S.session.store.ip_address}/access/public/modify/getTck`;G.post(a,o).then(n=>{console.log(n.data),i.value.head=n.data.ticket,i.value.body=n.data.product,i.value.state=!0,v.loading.hide()}).catch(n=>{console.log(n.response.data),v.notify({html:!0,message:n.response.data,color:"negative",position:"center"}),v.loading.hide()})},te=()=>{let o=d.value.val,e=i.value.body.findIndex(a=>a.codigo==o.codigo);e>=0?(i.value.body[e].checkout=o.conteo*o.pxc,i.value.body[e].validate=1,i.value.body[e].diferencia=o.checkout-o.cantidad,i.value.body[e].diferencia!=0?(console.log("Hay diferencia se bloquea productos sin revisar para que se analice el producto revisado ?"),v.notify({message:"El producto esta mal contado",type:"negative",icon:"sentiment_dissatisfied",position:"top"})):v.notify({message:"El producto esta bien contado",type:"positive",icon:"mood",position:"top"}),d.value.val=null,d.value.state=!1):v.notify({message:"No se encuentra el articulo"})},K=(o,e)=>{console.log(e),d.value.state=!0,d.value.val=e},ae=()=>{console.log("conteo terminado"),P.value=null,k.value="",T.value="",i.value={state:!1,body:[],head:null},d.value={state:!1,val:null}},oe=()=>{console.log("Terminado Incompleto"),E.value.state=!0},se=()=>{Q.value.forEach(o=>{let e=i.value.body.findIndex(a=>a.codigo==o.codigo);e>=0&&(i.value.body[e].checkout=0,i.value.body[e].diferencia=0,i.value.body[e].conteo=0,i.value.body[e].validate=0)})},ie=(o,e,a)=>{e(()=>{const n=o.toUpperCase();$.value=i.value.body.filter(D=>{const re=D.variants.some(ce=>ce.cb.toUpperCase().indexOf(n)>-1),ve=D.codigo.toUpperCase().indexOf(n)>-1||D.cb.toUpperCase().indexOf(n)>-1||D.corto.toUpperCase().indexOf(n)>-1;return re||ve}),console.log($.value)})},ne=()=>{let o=i.value.body.filter(e=>e==k.value);d.value.state=!0,d.value.val=o[0],k.value=""},ue=o=>{k.value=o,console.log(k.value)},X=async()=>{let o=S.session.store.id;try{let e=await ke.get(`/cashier/getPrinters/${o}`);e.status==200&&(c.value.body=e.data,console.log("Impresoras listas :)"))}catch(e){console.log(e),v.notify({message:"No se pudiron obtener las impresoras",type:"negative",position:"center",icon:"error"})}},de=async()=>{v.loading.show({message:"Imprimiendo Diferencias"});let o={printer:c.value.val.ip_address,data:i.value,invalid:C.value,valid:_.value,diff:Q.value},a=`http://${S.session.store.ip_address}/access/public/modify/PrintDiff`;G.post(a,o).then(n=>{console.log(n.data),n.data==1&&(v.notify({message:"Impresion Correcta",type:"positive",position:"center"}),c.value.state=!1,c.value.val=null),v.loading.hide()}).catch(n=>{console.log(n.response.data),v.notify({html:!0,message:n.response.data,color:"negative",position:"center"}),v.loading.hide()})};return X(),X(),(o,e)=>(p(),M(Qe,{view:"hHh Lpr fFf"},{default:t(()=>[l(fe,{class:"transparent text-dark",bordered:""},{default:t(()=>[l(Te),l(b)]),_:1}),l(he,null,{default:t(()=>[l(_e,{class:"bg-grey-3",padding:""},{default:t(()=>[l(Ve,{class:"justify-between"},{default:t(()=>[s("div",null,[e[16]||(e[16]=m("Helpers ")),l(Y,{name:"navigate_next",color:"primary"}),e[17]||(e[17]=m()),e[18]||(e[18]=s("span",{class:"text-h6"},"TICKETS",-1))]),l(g,{color:"primary",icon:"add"},{default:t(()=>[l(we,null,{default:t(()=>[e[19]||(e[19]=s("div",{class:"q-pa-md bg-grey-2 text-primary"},"Buscar Folio",-1)),l(b),l(A,{dense:"",onSubmit:le,class:"q-gutter-md q-pa-md"},{default:t(()=>[l(U,{modelValue:P.value,"onUpdate:modelValue":e[0]||(e[0]=a=>P.value=a),options:j(Z),label:"Serie",autofocus:""},null,8,["modelValue","options"]),l(L,{modelValue:T.value,"onUpdate:modelValue":e[1]||(e[1]=a=>T.value=a),type:"number",label:"Folio"},null,8,["modelValue"]),ee.value?(p(),x("div",Ue,[l(g,{type:"submit",color:"primary",icon:"search"})])):N("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),i.value.state?(p(),x("div",qe,[s("div",Se,[l(ge,{name:"bounce"},{default:t(()=>[l(y,{style:{width:"700px","max-width":"80vw"}},{default:t(()=>[l(u,null,{default:t(()=>[l(me,null,{default:t(()=>[l(pe,null,{default:t(()=>[l(B,null,{default:t(()=>[l(V,null,{default:t(()=>e[20]||(e[20]=[m("Fecha:")])),_:1}),l(V,null,{default:t(()=>[m(r(i.value.head.fecha),1)]),_:1})]),_:1}),l(b,{spaced:"",inset:"",vertical:"",dark:""}),l(B,null,{default:t(()=>[l(V,null,{default:t(()=>e[21]||(e[21]=[m("Ticket:")])),_:1}),l(V,null,{default:t(()=>[m(r(i.value.head.ticket),1)]),_:1})]),_:1}),l(b,{spaced:"",inset:"",vertical:"",dark:""}),l(B,null,{default:t(()=>[l(V,null,{default:t(()=>e[22]||(e[22]=[m("Cliente:")])),_:1}),l(V,null,{default:t(()=>[m(r(i.value.head.cliente),1)]),_:1})]),_:1}),l(b,{spaced:"",inset:"",vertical:"",dark:""}),l(B,null,{default:t(()=>[l(V,null,{default:t(()=>e[23]||(e[23]=[m("Total:")])),_:1}),l(V,null,{default:t(()=>[m(r(i.value.head.total),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),l(b,{spaced:"",inset:"",vertical:"",dark:""}),s("div",De,[l(y,{class:"my-card col"},{default:t(()=>[l(u,null,{default:t(()=>e[24]||(e[24]=[s("div",{class:"text-h6 text-center"},"Articulos Por Validar",-1)])),_:1}),l(u,{class:"text-center text-h4"},{default:t(()=>[m(r(C.value.length),1)]),_:1})]),_:1}),l(b,{spaced:"",inset:"",vertical:"",dark:""}),l(y,{class:"my-card col"},{default:t(()=>[l(u,null,{default:t(()=>e[25]||(e[25]=[s("div",{class:"text-h6 text-center"},"Articulos Validados",-1)])),_:1}),l(u,{class:"text-center text-h4"},{default:t(()=>[m(r(_.value.length),1)]),_:1})]),_:1}),l(b,{spaced:"",inset:"",vertical:"",dark:""}),l(y,{class:"my-card col"},{default:t(()=>[l(u,null,{default:t(()=>e[26]||(e[26]=[s("div",{class:"text-h6 text-center"},"Diferencias",-1)])),_:1}),l(u,{class:"text-center text-h4"},{default:t(()=>[m(r(i.value.body.reduce((a,n)=>a+Number(n.diferencia),0)),1)]),_:1})]),_:1})]),l(b,{spaced:"",inset:"",vertical:"",dark:""}),s("div",Be,[l(y,{class:"my-card col",style:{width:"700px","max-width":"80vw"}},{default:t(()=>[l(u,null,{default:t(()=>[l(W,{flat:"",title:"Productos Sin Revisar",rows:C.value,columns:f.value.columns,"visible-columns":f.value.visibleColumns,"no-data-label":"No hay datos :(",pagination:f.value.pagination,onRowClick:K},{top:t(()=>[e[27]||(e[27]=s("div",{class:"text-h6"}," Productos Sin Revisar",-1)),l(J),l(U,{modelValue:f.value.visibleColumns,"onUpdate:modelValue":e[2]||(e[2]=a=>f.value.visibleColumns=a),multiple:"",outlined:"",dense:"","options-dense":"","display-value":j(v).lang.table.columns,"emit-value":"","map-options":"",options:f.value.columns,"option-value":"name","options-cover":"",style:{"min-width":"150px"}},null,8,["modelValue","display-value","options"])]),_:1},8,["rows","columns","visible-columns","pagination"])]),_:1})]),_:1}),l(b,{spaced:"",inset:"",vertical:"",dark:""}),l(y,{class:"my-card col",style:{width:"700px","max-width":"80vw"}},{default:t(()=>[l(u,null,{default:t(()=>[l(W,{flat:"",title:"Productos Revisados",rows:_.value,columns:f.value.columns,"visible-columns":f.value.visibleColumnstwo,"no-data-label":"No hay datos :(",pagination:f.value.pagination,onRowClick:K},{top:t(()=>[e[28]||(e[28]=s("div",{class:"text-h6"}," Productos Revisados",-1)),l(J),l(U,{modelValue:f.value.visibleColumnstwo,"onUpdate:modelValue":e[3]||(e[3]=a=>f.value.visibleColumnstwo=a),multiple:"",outlined:"",dense:"","options-dense":"","display-value":j(v).lang.table.columns,"emit-value":"","map-options":"",options:f.value.columns,"option-value":"name","options-cover":"",style:{"min-width":"150px"}},null,8,["modelValue","display-value","options"])]),_:1},8,["rows","columns","visible-columns","pagination"])]),_:1})]),_:1})])])):N("",!0),l(I,{modelValue:d.value.state,"onUpdate:modelValue":e[6]||(e[6]=a=>d.value.state=a),persistent:"",position:"bottom"},{default:t(()=>[l(y,null,{default:t(()=>[l(u,{class:"bg-grey-3"},{default:t(()=>[s("div",Ne,[s("div",Fe,[s("div",Re,"CCO: "+r(d.value.val.corto),1)]),s("div",Ee,[s("div",$e,r(d.value.val.codigo),1),s("div",Me,r(d.value.val.cb),1)])])]),_:1}),l(b),l(u,null,{default:t(()=>[m(r(d.value.val.descripcion),1)]),_:1}),l(A,{onSubmit:ye(te,["prevent"])},{default:t(()=>[l(u,null,{default:t(()=>[s("div",je,[s("div",He,[e[29]||(e[29]=s("div",null,"Cajas",-1)),l(L,{dense:"",borderless:"",modelValue:d.value.val.conteo,"onUpdate:modelValue":e[4]||(e[4]=a=>d.value.val.conteo=a),type:"number",min:"0","input-class":"text-h6 text-center",ref:"iptcounter"},null,8,["modelValue"])]),s("div",Le,[e[30]||(e[30]=s("div",null,"PXC",-1)),l(L,{dense:"",borderless:"",modelValue:d.value.val.pxc,"onUpdate:modelValue":e[5]||(e[5]=a=>d.value.val.pxc=a),type:"number",min:"0","input-class":"text-h6 text-center",ref:"iptcounter"},null,8,["modelValue"])]),s("div",Ae,[e[31]||(e[31]=s("div",null,"Conteo",-1)),s("div",Oe,r(d.value.val.conteo*d.value.val.pxc),1)])])]),_:1}),l(g,{color:"green-5",type:"submit",square:"",icon:"done_all","no-caps":"",class:"q-mt-md q-py-md full-width"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(I,{modelValue:O.value,"onUpdate:modelValue":e[8]||(e[8]=a=>O.value=a),persistent:""},{default:t(()=>[l(y,null,{default:t(()=>[l(u,{class:"row items-center"},{default:t(()=>[l(H,{icon:"mood",color:"positive","text-color":"white"}),e[32]||(e[32]=s("span",{class:"q-ml-sm"},"Productos validados correctamente",-1))]),_:1}),l(u,{class:"row"},{default:t(()=>[l(q,{class:"col"},{default:t(()=>[l(g,{flat:"",icon:"print",color:"primary",onClick:e[7]||(e[7]=a=>c.value.state=!c.value.state)})]),_:1}),l(q,null,{default:t(()=>[l(g,{flat:"",label:"TERMINAR",color:"positive",onClick:ae})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(I,{modelValue:z.value,"onUpdate:modelValue":e[10]||(e[10]=a=>z.value=a),persistent:""},{default:t(()=>[l(y,null,{default:t(()=>[l(u,{class:"row items-center"},{default:t(()=>[l(H,{icon:"sentiment_dissatisfied",color:"negative","text-color":"white"}),e[33]||(e[33]=s("span",{class:"q-ml-sm"},"Hay productos Con diferencia",-1))]),_:1}),l(u,null,{default:t(()=>[(p(!0),x(R,null,F(Q.value,(a,n)=>(p(),x("div",null,r(a.codigo),1))),256))]),_:1}),l(u,{class:"row"},{default:t(()=>[l(q,{class:"col"},{default:t(()=>[l(g,{flat:"",icon:"print",color:"primary",onClick:e[9]||(e[9]=a=>c.value.state=!c.value.state)})]),_:1}),l(q,null,{default:t(()=>[l(g,{flat:"",label:"Regresar",color:"negative",onClick:se})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(I,{modelValue:c.value.state,"onUpdate:modelValue":e[12]||(e[12]=a=>c.value.state=a)},{default:t(()=>[l(y,{class:"my-card"},{default:t(()=>[l(u,null,{default:t(()=>e[34]||(e[34]=[s("div",{class:"text-h6 text-center"},"Impresora",-1)])),_:1}),l(u,null,{default:t(()=>[l(A,{onSubmit:de,class:"q-gutter-md"},{default:t(()=>[l(U,{dense:"","option-label":"name",modelValue:c.value.val,"onUpdate:modelValue":e[11]||(e[11]=a=>c.value.val=a),options:c.value.body,label:"Impresora",filled:"",autofocus:"",style:{width:"200px"}},null,8,["modelValue","options"]),s("div",null,[l(g,{label:"Enviar",type:"submit",color:"primary",style:{width:"200px"}})])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(I,{modelValue:E.value.state,"onUpdate:modelValue":e[14]||(e[14]=a=>E.value.state=a),persistent:""},{default:t(()=>[l(y,null,{default:t(()=>[l(u,{class:"row items-center"},{default:t(()=>[l(H,{icon:"warning",color:"warning","text-color":"black"}),e[35]||(e[35]=s("span",{class:"q-ml-sm"},"Hay Productos que no estan validados",-1))]),_:1}),l(u,null,{default:t(()=>[e[36]||(e[36]=s("div",{class:"text-bold"}," Productos No Validados ",-1)),(p(!0),x(R,null,F(C.value,(a,n)=>(p(),x("div",{key:n},r(a.codigo),1))),128))]),_:1}),l(u,null,{default:t(()=>[e[37]||(e[37]=s("div",{class:"text-bold"}," Productos Con Diferencia ",-1)),(p(!0),x(R,null,F(Q.value,(a,n)=>(p(),x("div",{key:n},r(a.codigo),1))),128))]),_:1}),l(u,null,{default:t(()=>[e[38]||(e[38]=s("div",{class:"text-bold"}," Productos Validados ",-1)),(p(!0),x(R,null,F(_.value,(a,n)=>(p(),x("div",{key:n},r(a.codigo),1))),128))]),_:1}),l(q,{align:"right"},{default:t(()=>[l(g,{flat:"",color:"primary",icon:"print",onClick:e[13]||(e[13]=a=>c.value.state=!c.value.state)}),xe(l(g,{flat:"",label:"Continuar",color:"primary"},null,512),[[Pe]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),i.value.state?(p(),M(Ce,{key:0,reveal:"",elevated:"",bordered:"",class:"row"},{default:t(()=>[l(U,{class:"col",modelValue:k.value,"onUpdate:modelValue":[e[15]||(e[15]=a=>k.value=a),ne],options:$.value,filled:"","option-label":"codigo","use-input":"","fill-input":"","hide-selected":"","input-class":"text-white","input-debounce":"0",onFilter:ie,onInputValue:ue,dense:""},{before:t(()=>[l(Y,{name:"fas fa-barcode",color:"white"})]),_:1},8,["modelValue","options"]),_.value.length>0?(p(),M(g,{key:0,color:"white","text-color":"primary",size:"sm",label:"Terminar",onClick:oe})):N("",!0)]),_:1})):N("",!0)]),_:1})]),_:1}))}};export{gl as default};
