import{f as q,Z as H,u as O,r as f,g as k,a as x,h as y,i as l,p as M,d as t,l as p,k as o,a1 as d,a7 as T,Q as b,a4 as C,j as u,c as z,a2 as G,a3 as X,m as R,a5 as D,n as m,a6 as E,aX as N,aj as Z}from"./index.1921fa04.js";import{a as P,b as c,Q as S}from"./QList.6a7cc3c7.js";import{Q as h}from"./QForm.b9db1fda.js";import{Q as J}from"./QFooter.728d6bb2.js";import{Q as K}from"./QPage.7ee4e822.js";import{C as W}from"./ClosePopup.17837eb9.js";import{u as ee}from"./use-quasar.73c732a8.js";import"./jspdf.plugin.autotable.e7ec1955.js";import{r as w}from"./refundsApi.9be15ffa.js";import"./exceljs.min.9e24d01d.js";import"./JsBarcode.cb858474.js";import"./browser.c61f550a.js";import{d as te}from"./dayjs.min.cbcf888d.js";import"./QSelect.638f00a7.js";import"./axios.bf079879.js";/* empty css                                                                         */import"./QResizeObserver.56de7862.js";import"./_commonjsHelpers.88e99c8f.js";const le={class:"text-center"},oe={class:"text-bold"},se={class:"col text-center"},ae={class:"text-bold"},ie={class:"col text-center"},de={class:"text-bold"},ne={class:"col text-center"},re={class:"text-bold"},ue={class:"col text-center"},ce={class:"text-bold"},ve={class:"text-center text-h4"},fe={class:"text-center text-h6 text-grey-14"},pe={class:"row items-start justify-between"},me={class:"text-center col text-primary"},_e={class:"text-bold"},xe={class:"text-center col"},be={class:"text-center col"},ge={class:"col"},Ue={__name:"veriferRefund",setup(ye){const Q=q(),g=H(),B=O(),r=ee();f([]),f([]);const n=f(null),_=f(!1),v=f(null),a=f({state:!1,val:null}),I=k(()=>n.value.bodie.reduce((i,e)=>Number(i)+Number(e.to_received),0)),F=k(()=>v.value?n.value.bodie.filter(i=>{var e;return i.product.toLowerCase().includes((e=v.value)==null?void 0:e.toLowerCase())}):n.value.bodie),V=async()=>{r.loading.show({message:"Obteniendo Datos"});let i=B.session.store.id,e=g.params.rid;console.log(e);const s=await w.getRefundto(i,e);s.error?console.log(s):s.status.id==3?(console.log(s),r.loading.hide(),n.value=s):(r.notify({message:"Ya no se puede modificar la recepion",type:"negative",position:"top"}),Q.replace("/refunds"))},L=()=>{a.value={val:null,state:!1}},$=async()=>{r.loading.show({message:"Creando Proceso"});const i=await w.finallyRefund({id:g.params.rid});console.log(i),i.fail?console.log(i):(console.log(i),r.notify({message:"Se Realizo correctamente el proceso ",type:"positive",position:"center"}),Q.push("/refunds")),r.loading.hide()},A=async()=>{r.loading.show({message:"Editando Producto"}),console.log(a.value.val),a.value.val._refund=g.params.rid;const i=await w.editProductReceipt(a.value.val);if(i.fail)console.log(i);else{console.log(i);let e=n.value.bodie.findIndex(s=>s.product==a.value.val.product);e>=0&&(n.value.bodie[e].to_received=a.value.val.to_received,r.notify({type:"positive",position:"center"}),a.value={val:null,state:!1},r.loading.hide())}},Y=i=>{a.value.state=!0,a.value.val=i},j=()=>{if(v.value!=null){let i=n.value.bodie.find(e=>e.product.toLowerCase()==v.value.toLowerCase());i?(a.value.state=!0,a.value.val=i):r.notify({message:`No se encuentra el producto ${v.value}`,type:"negative",position:"top"}),v.value=null}};return V(),V(),(i,e)=>n.value?(x(),y(K,{key:0,padding:""},{default:l(()=>[t(b,{class:"my-card"},{default:l(()=>[t(p,{class:"row"},{default:l(()=>[o("div",le,[e[5]||(e[5]=o("div",{class:"text-caption"},"ID",-1)),o("div",oe,d(n.value.id),1)]),o("div",se,[e[6]||(e[6]=o("div",{class:"text-caption"},"REFERENCIA",-1)),o("div",ae,d(n.value.reference),1)]),o("div",ie,[e[7]||(e[7]=o("div",{class:"text-caption"},"ORIGEN",-1)),o("div",de,d(n.value.storefrom.name),1)]),o("div",ne,[e[8]||(e[8]=o("div",{class:"text-caption"},"CREADO",-1)),o("div",re,d(n.value.createdby.complete_name),1)]),o("div",ue,[e[9]||(e[9]=o("div",{class:"text-caption"},"FECHA",-1)),o("div",ce,d(T(te)(n.value.created_at).format("DD-MM-YYYY HH:mm:ss")),1)])]),_:1})]),_:1}),t(C,{spaced:"",inset:"",vertical:"",dark:""}),t(S,{bordered:""},{default:l(()=>[t(P,null,{default:l(()=>[t(c,null,{default:l(()=>e[10]||(e[10]=[u(" Producto ")])),_:1}),t(c,null,{default:l(()=>e[11]||(e[11]=[u(" Descripcion ")])),_:1}),t(c,{class:"text-center"},{default:l(()=>e[12]||(e[12]=[u(" Enviado ")])),_:1}),t(c,{class:"text-center"},{default:l(()=>e[13]||(e[13]=[u(" Recibido ")])),_:1}),t(c,{class:"text-center"},{default:l(()=>e[14]||(e[14]=[u(" Diferencia ")])),_:1})]),_:1})]),_:1}),(x(!0),z(X,null,G(F.value,(s,U)=>(x(),y(S,{bordered:"",key:U},{default:l(()=>[N((x(),y(P,{clickable:"",onClick:Ce=>Y(s)},{default:l(()=>[t(c,null,{default:l(()=>[u(d(s.product),1)]),_:2},1024),t(c,null,{default:l(()=>[u(d(s.description),1)]),_:2},1024),t(c,{class:"text-center"},{default:l(()=>[u(d(s.to_delivered),1)]),_:2},1024),t(c,{class:"text-center"},{default:l(()=>[u(d(s.to_received),1)]),_:2},1024),t(c,{class:"text-center"},{default:l(()=>[u(d(s.to_delivered-s.to_received),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[Z]]),t(C)]),_:2},1024))),128)),t(E,{modelValue:a.value.state,"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.state=s),persistent:"",position:"bottom"},{default:l(()=>[t(b,{style:{width:"300","max-width":"40vw"}},{default:l(()=>[t(p,null,{default:l(()=>[o("div",ve,d(a.value.val.product),1),o("div",fe,d(a.value.val.description),1)]),_:1}),t(p,null,{default:l(()=>[o("div",pe,[o("div",me,[e[15]||(e[15]=o("div",null,"Enviado",-1)),o("div",_e,d(a.value.val.to_delivered),1)]),o("div",xe,[e[16]||(e[16]=o("div",null,"Recibido",-1)),t(R,{dense:"",borderless:"",modelValue:a.value.val.to_received,"onUpdate:modelValue":e[0]||(e[0]=s=>a.value.val.to_received=s),type:"number",min:"0","input-class":"text-h6 text-center",ref:"iptcounter"},null,8,["modelValue"])]),o("div",be,[e[17]||(e[17]=o("div",null,"Diferencia",-1)),o("div",null,d(a.value.val.to_delivered-a.value.val.to_received),1)])])]),_:1}),t(D,{align:"center"},{default:l(()=>[t(m,{flat:"",icon:"close",color:"red-10",onClick:L}),t(m,{flat:"",label:"Editar",color:"blue-10",onClick:A})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(E,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=s=>_.value=s),persistent:""},{default:l(()=>[t(b,null,{default:l(()=>[t(p,{class:"row items-center"},{default:l(()=>e[18]||(e[18]=[o("span",{class:"text text-h6"},"Estas Seguro de terminar la verificacion no se podra editar",-1)])),_:1}),t(D,{align:"right"},{default:l(()=>[N(t(m,{flat:"",icon:"close",color:"negative"},null,512),[[W]]),t(m,{flat:"",icon:"check",color:"positive",onClick:$})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(J,{reveal:"",elevated:"",bordered:"",class:"bg-white"},{default:l(()=>[t(b,{class:"q-mb-md",flat:"",bordered:"",dense:""},{default:l(()=>[t(p,{class:"row"},{default:l(()=>[o("div",ge,[t(h,{onSubmit:j},{default:l(()=>[t(R,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=s=>v.value=s),type:"text",label:"Buscar Codigo",dense:""},null,8,["modelValue"])]),_:1})]),t(C,{spaced:"",inset:"",vertical:"",dark:""}),t(m,{color:"primary",icon:"send",label:"Terminar",onClick:e[4]||(e[4]=s=>_.value=!_.value),disable:I.value==0},null,8,["disable"])]),_:1})]),_:1})]),_:1})]),_:1})):M("",!0)}};export{Ue as default};
