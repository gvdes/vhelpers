import{Z,f as G,u as W,r as c,g as P,a as w,h as U,i as l,k as f,d as e,a4 as ee,m as te,ah as ae,Q as x,l as i,j as n,a1 as u,c as le,a2 as oe,a3 as se,a5 as Q,aX as h,n as v,a6 as y,ba as re,a7 as ie}from"./index.a1c295c1.js";import{Q as Y}from"./QTable.6dbea056.js";import{Q as ne}from"./QExpansionItem.2f8e3b0c.js";import{Q as R,a as ue,b as S}from"./QList.48a27591.js";import{Q as de}from"./QSelect.9d7be3ea.js";import{Q as me}from"./QPage.280a2f20.js";import{C as V}from"./ClosePopup.e501f1d3.js";import{d as A}from"./dayjs.min.cbcf888d.js";import{R as pe}from"./RestockApi.19fe9c8d.js";import{u as ce}from"./Restock.5ec8245a.js";import{u as fe}from"./use-quasar.1aaac9b4.js";import"./socket.168d2ba4.js";import"./QBtnGroup.7276a654.js";import"./QLinearProgress.8ae38f31.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.9730f76f.js";import"./QToolbar.0a659155.js";import"./QForm.ddbae44f.js";import"./QTd.b6d74464.js";import"./QPopupEdit.955e4fcd.js";import"./QTr.5a12ef76.js";import"./QLayout.17abf347.js";import"./QScrollObserver.061a8790.js";import"./QResizeObserver.73aad3aa.js";import"./QImg.485359ae.js";import"./QSpace.abbec46a.js";import"./favorites.6b442dd7.js";import"./jspdf.plugin.autotable.7c2955ee.js";import"./exceljs.min.9e24d01d.js";import"./JsBarcode.cb858474.js";import"./browser.c61f550a.js";/* empty css                                                       */const ve={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},be={class:"row justify-end q-gutter-sm full-width"},ge={class:"q-ml-sm text-h4"},_e={class:"text-bold"},Ge={__name:"dashboardStore",setup(we){Z();const M=G(),p=ce(),g=fe(),k=W(),d=c({state:!1,val:null}),s=c({state:!1,val:null}),r=c({state:!1,val:null}),O=c({rowsPerPage:[0]}),_=c(null),$=c({columns:[{name:"id",label:"ID",field:o=>o.id,align:"center"},{name:"invoice",label:"Factura",field:o=>o.invoice,align:"center"},{name:"invoiceReceived",label:"Factura R",field:o=>o.invoice_received,align:"center"},{name:"status",label:"Estado",field:o=>o.status.name,align:"left"},{name:"UACT",label:"U.Act",field:o=>{var t,a;return A((a=(t=o.log)==null?void 0:t.find(m=>m.id==o._status))==null?void 0:a.pivot.updated_at).format("YYYY/MM/DD HH:mm:ss")},align:"left"}],pagination:{rowsPerPage:10}}),T=P(()=>p.ordersok.filter(o=>o._workpoint_from==k.session.store.id_viz)),N=P(()=>p.printers.find(o=>o.id==k.session.store.id_viz).printers),j=()=>{M.push(`/distribute/dashboardStore/${s.value.val.id}`)},q=async()=>{p.setShowLYT(!0),p.setTitle("Dashboard"),p.setButtonShow(!0),p.setButtonShowAdd(!0)},E=(o,t)=>{d.value.state=!0,d.value.val=t},F=["text-grey-5","text-h6 text-red","text-indigo","4","5","text-pink-7","text-orange-8","8","text-primary","text-positive"],H=o=>{s.value.state=!0,s.value.val=o},L=(o,t)=>{const a=t.toUpperCase();return o.filter(m=>{var C,D;const J=Object.values(m).some(b=>String(b!=null?b:"").toUpperCase().includes(a)),K=(D=(C=m.partition)==null?void 0:C.some(b=>{var B;return(B=b.products)==null?void 0:B.some(X=>{var I;return(I=X.code)==null?void 0:I.toUpperCase().includes(a)})}))!=null?D:!1;return J||K})},z=async()=>{g.loading.show({message:"..."});let o={ip:r.value.val.ip,port:9100,order:s.value.val.id};const t=await pe.printforsupplyStore(o);console.log(t),t.status==200?(t.data?(g.notify({message:"Impresion correcta",icon:"done",color:"positive",position:"top"}),r.value.state=!1):g.notify({message:`Sin conexion a <b>${o.name} <small>(${o.ip})</small></b>`,icon:"fas fa-bug",color:"negative",position:"center",html:!0,timeout:4e3}),g.loading.hide()):(console.error(t),alert(`Error ${t.status}: ${t.data}`))};return q(),(o,t)=>(w(),U(me,{padding:""},{default:l(()=>[f("div",null,[e(Y,{rows:T.value,"row-key":"name",grid:"",pagination:O.value,filter:_.value,"hide-bottom":"","filter-method":L},{item:l(a=>[f("div",ve,[e(R,{bordered:"",onDblclick:m=>H(a.row)},{default:l(()=>[e(ne,{"header-class":`${F[a.row.status.id-1]}`,dense:"",icon:"list",label:`${a.row.id.toString()} (${a.row.status.name})`,caption:`${a.row.to.name} (${a.row.notes})`},{default:l(()=>[e(ee),e(Y,{"hide-bottom":"",flat:"",rows:a.row.partition,columns:$.value.columns,pagination:$.value.pagination,onRowClick:E},null,8,["rows","columns","pagination"])]),_:2},1032,["header-class","label","caption"])]),_:2},1032,["onDblclick"])])]),top:l(()=>[f("div",be,[e(te,{dense:"",debounce:"300",modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=a=>_.value=a),placeholder:"Buscar",class:"col-auto",outlined:""},{append:l(()=>[e(ae,{name:"search"})]),_:1},8,["modelValue"])])]),_:1},8,["rows","pagination","filter"])]),e(y,{modelValue:d.value.state,"onUpdate:modelValue":t[1]||(t[1]=a=>d.value.state=a),persistent:""},{default:l(()=>[e(x,null,{default:l(()=>[e(i,{class:"text-center text-h6"},{default:l(()=>[n(" ID: "+u(d.value.val.id),1)]),_:1}),e(i,{class:"text-center text-bold"},{default:l(()=>[n(u(d.value.val.status.name),1)]),_:1}),e(i,null,{default:l(()=>[(w(!0),le(se,null,oe(d.value.val.log,(a,m)=>(w(),U(R,{bordered:"",key:m},{default:l(()=>[e(ue,null,{default:l(()=>[e(S,null,{default:l(()=>[n(u(a.name),1)]),_:2},1024),e(S,null,{default:l(()=>[n(u(JSON.parse(a.pivot.details).responsable),1)]),_:2},1024),e(S,null,{default:l(()=>[n(u(ie(A)(a.pivot.updated_at).format("YYYY/MM/DD HH:mm:ss")),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(Q,{align:"right"},{default:l(()=>[h(e(v,{flat:"",label:"OK",color:"primary"},null,512),[[V]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(y,{modelValue:s.value.state,"onUpdate:modelValue":t[3]||(t[3]=a=>s.value.state=a),persistent:""},{default:l(()=>[e(x,null,{default:l(()=>[e(i,{class:"row items-center"},{default:l(()=>[e(re,{icon:"receipt_long",color:"primary","text-color":"white"}),f("span",ge,u(s.value.val.id),1)]),_:1}),e(i,{class:"text-h5"},{default:l(()=>[t[6]||(t[6]=n(" Notas : ")),f("span",_e,u(s.value.val.notes),1)]),_:1}),e(i,{class:"text-h5"},{default:l(()=>[t[7]||(t[7]=n(" Creado Por : ")),f("span",null,u(`${s.value.val.created_by.names} ${s.value.val.created_by.surname_pat}
            ${s.value.val.created_by.surname_mat}`),1)]),_:1}),e(Q,{align:"right"},{default:l(()=>[h(e(v,{flat:"",icon:"close",color:"negative"},null,512),[[V]]),e(v,{color:"teal",flat:"",icon:"print",onClick:t[2]||(t[2]=a=>r.value.state=!r.value.state),disabled:s.value.val._status==1},null,8,["disabled"]),e(v,{flat:"",icon:"send",color:"blue",onClick:j})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(y,{modelValue:r.value.state,"onUpdate:modelValue":t[5]||(t[5]=a=>r.value.state=a),persistent:""},{default:l(()=>[e(x,null,{default:l(()=>[e(i,{class:"row items-center bg-primary text-white text-h6"},{default:l(()=>t[8]||(t[8]=[n(" Selecciona Impresora ")])),_:1}),e(i,{class:""},{default:l(()=>[e(de,{modelValue:r.value.val,"onUpdate:modelValue":t[4]||(t[4]=a=>r.value.val=a),options:N.value,label:"Impresoras","option-label":"name",filled:""},null,8,["modelValue","options"])]),_:1}),e(Q,{align:"right"},{default:l(()=>[h(e(v,{flat:"",label:"Cancelar",color:"primary"},null,512),[[V]]),e(v,{flat:"",label:"Terminar",color:"primary",onClick:z,disabled:!r.value.val},null,8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Ge as default};
