import{i as G,aR as J,aS as K,j as W,r as x,o as k,d as C,w as s,e as l,a1 as a,ak as m,a0 as c,an as X,Q as w,a4 as B,c as I,f as d,h as D}from"./index.ec4bf414.js";import{Q as N,a as f}from"./axios.8befd5ce.js";import{b as q,Q as z}from"./QList.97c4757f.js";import{Q as E}from"./QInput.d15a8767.js";import{Q as $}from"./QTable.71748063.js";import{Q as Y}from"./QTooltip.4e3c3b5b.js";import{Q as R}from"./QCardActions.af9a8f71.js";import{Q as ee}from"./QPage.9d1e145b.js";import{C as P}from"./ClosePopup.b14ddd28.js";import{u as le}from"./use-quasar.913f46e2.js";import{c as h}from"./clientApi.6fd2018b.js";import{Q as te,a as _}from"./QTr.3d1d4d5e.js";import"./QSelect.ed154f5a.js";import"./QLinearProgress.f8f06df8.js";import"./QCheckbox.757a1db6.js";const ae='<g transform="translate(1 1)" stroke-width="2" fill="none" fill-rule="evenodd"><circle cx="5" cy="50" r="5"><animate attributeName="cy" begin="0s" dur="2.2s" values="50;5;50;50" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="cx" begin="0s" dur="2.2s" values="5;27;49;5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="27" cy="5" r="5"><animate attributeName="cy" begin="0s" dur="2.2s" from="5" to="5" values="5;50;50;5" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="cx" begin="0s" dur="2.2s" from="27" to="27" values="27;49;5;27" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="49" cy="50" r="5"><animate attributeName="cy" begin="0s" dur="2.2s" values="50;50;5;50" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="cx" from="49" to="49" begin="0s" dur="2.2s" values="49;5;27;49" calcMode="linear" repeatCount="indefinite"></animate></circle></g>';var se=G({name:"QSpinnerBall",props:J,setup(T){const{cSize:p,classes:n}=K(T);return()=>W("svg",{class:n.value,stroke:"currentColor",width:p.value,height:p.value,viewBox:"0 0 57 57",xmlns:"http://www.w3.org/2000/svg",innerHTML:ae})}});const oe={__name:"QuotesArchive",props:{quotes:{default:[],type:Array}},emits:["restore","destroy"],setup(T,{emit:p}){let n={0:{label:"Nueva",color:"text-pink"},1:{label:"Aprobada",color:"text-light-green-10"},2:{label:"Rechazada",color:"text-red-14"}},o=x({cols:[{name:"id",label:"ID"},{name:"client",label:"Cliente"},{name:"address",label:"Domicilio",field:u=>`${u.street}, ${u.num_ext}`},{name:"celphone",label:"Telefono"},{name:"email",label:"Correo"},{name:"price",label:"Precio"},{name:"tickets",label:"Ticket"},{name:"status",label:"Estado",field:u=>n[u._status].label,classes:u=>n[u._status].color},{name:"store",label:"Sucursal"},{name:"actions",label:"Actions"}]}),v=p,S=T;const y=u=>{v("restore",u)},g=u=>{v("destroy",u)};return(u,A)=>(k(),C(f,{class:"col"},{default:s(()=>[l($,{title:"Rechazadas",rows:a(S).quotes,"row-key":"name",columns:a(o).cols},{body:s(i=>[l(te,{props:i},{default:s(()=>[l(_,{key:"id",props:i},{default:s(()=>[m(c(i.row.id),1)]),_:2},1032,["props"]),l(_,{key:"client",props:i},{default:s(()=>[m(c(i.row.nom_cli),1)]),_:2},1032,["props"]),l(_,{key:"address",props:i},{default:s(()=>[m(c(`${i.row.street}, ${i.row.num_ext}`),1)]),_:2},1032,["props"]),l(_,{key:"celphone",props:i},{default:s(()=>[m(c(i.row.celphone),1)]),_:2},1032,["props"]),l(_,{key:"email",props:i},{default:s(()=>[m(c(i.row.email),1)]),_:2},1032,["props"]),l(_,{key:"price",props:i},{default:s(()=>[m(c(i.row.price),1)]),_:2},1032,["props"]),l(_,{key:"tickets",props:i},{default:s(()=>[m(c(i.row.tickets),1)]),_:2},1032,["props"]),l(_,{key:"status",props:i,class:X(a(n)[i.row._status].color)},{default:s(()=>[m(c(a(n)[i.row._status].label),1)]),_:2},1032,["props","class"]),l(_,{key:"store",props:i},{default:s(()=>[m(c(i.row.sucursal),1)]),_:2},1032,["props"]),l(_,{key:"actions",props:i},{default:s(()=>[l(w,{flat:"",round:"",icon:"settings_backup_restore",color:"primary",onClick:V=>y(i.row.id),title:"Restaurar"},null,8,["onClick"]),l(w,{flat:"",round:"",icon:"delete_forever",color:"negative",onClick:V=>g(i.row.id),title:"Eliminar permanentemente"},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),l(N,{class:"my-card"},{default:s(()=>[l(f,null,{default:s(()=>[l(R,null,{default:s(()=>[B(l(w,{flat:"",label:"Cancelar"},null,512),[[P]])]),_:1})]),_:1})]),_:1})]),_:1}))}},ie={class:"full-width row justify-between item-center"},ne={class:"full-width row justify-between item-center"},re={class:"full-width row justify-between item-center"},ce={class:"text-h6 text-center"},ue={class:"text-h5 text-left"},de={class:"text-subtitle2 text-left"},me={class:"text-subtitle2 text-left"},fe={class:"text-subtitle2 text-left"},pe={class:"text-subtitle2 text-left"},be={class:"text-subtitle2 text-left"},$e={__name:"addCli",setup(T){const p=le();let n=x([]),o=x({state:!1,row:null,pts:!1}),v={0:{label:"Nueva",color:"text-pink"},1:{label:"Aprobada",color:"text-light-green-10"},2:{label:"Rechazada",color:"text-red-14"},3:{label:"Sincronizadas",color:"text-deep-orange-10"},4:{label:"Eliminadas",color:"text-deep-orange-10"}},S=x({state:!1,row:null}),y=x({vcolumns:["client","celphone","price","status"],cols:[{name:"id",label:"ID",field:"id"},{name:"client",label:"Cliente",field:"nom_cli"},{name:"address",label:"Domicilio",field:e=>`${e.street}, ${e.num_ext}`},{name:"celphone",label:"Telefono",field:"celphone"},{name:"email",label:"Correo",field:"email"},{name:"price",label:"Precio",field:"price"},{name:"tickets",label:"Ticket",field:"tickets"},{name:"status",label:"Estado",field:e=>v[e._status].label,classes:e=>v[e._status].color},{name:"store",label:"Sucursal",field:"sucursal"}],filter:""}),g=x({vcolumns:["client","celphone","price","status","idfs","ReplyStore"],cols:[{name:"id",label:"ID",field:"id"},{name:"idfs",label:"Factusol",field:"fs_id"},{name:"client",label:"Cliente",field:"nom_cli"},{name:"address",label:"Domicilio",field:e=>`${e.street}, ${e.num_ext}`},{name:"celphone",label:"Telefono",field:"celphone"},{name:"email",label:"Correo",field:"email"},{name:"price",label:"Precio",field:"price"},{name:"tickets",label:"Ticket",field:"tickets"},{name:"status",label:"Estado",field:e=>v[e._status].label,classes:e=>v[e._status].color},{name:"store",label:"Sucursal",field:"sucursal"},{name:"ReplyStore",label:"ReplicadoEn:",field:"Stores"}],filter:""}),u=x({vcolumns:["client","celphone","price","status","idfs"],cols:[{name:"id",label:"ID",field:"id"},{name:"idfs",label:"Factusol",field:"fs_id"},{name:"client",label:"Cliente",field:"nom_cli"},{name:"address",label:"Domicilio",field:e=>`${e.street}, ${e.num_ext}`},{name:"celphone",label:"Telefono",field:"celphone"},{name:"email",label:"Correo",field:"email"},{name:"price",label:"Precio",field:"price"},{name:"tickets",label:"Ticket",field:"tickets"},{name:"status",label:"Estado",field:e=>v[e._status].label,classes:e=>v[e._status].color},{name:"store",label:"Sucursal",field:"sucursal"}],filter:""}),A=I(()=>n.value.filter(e=>e._status==0)),i=I(()=>n.value.filter(e=>e._status==2)),V=I(()=>n.value.filter(e=>e._status==1)),M=I(()=>n.value.filter(e=>e._status==3));const U=async()=>{console.log("Traiendo solicitudes creadas");const e=await h.getSolicitud();console.log(e),n.value=e.solicitudes},j=(e,t)=>{console.log(t._status),o.value.row=t,o.value.state=!0},O=async()=>{o.value.pts=!0;let e=await h.addClient(o.value.row);if(console.log(e),e.fail){console.log(e),console.log("error brou"),console.log(e);let t=e.fail.response.data.error.msg;o.value.pts=!1,p.notify({message:t,icon:"close",color:"negative"})}else{let t=e.id,r=n.value.findIndex(b=>b.id==t);n.value[r]._status=e._status,n.value[r].fs_id=e.fs_id,o.value.state=!1,o.value.pts=!1,p.notify({message:"Cliente Creado",icon:"check_circle",color:"positive"}),console.log(e)}},L=async()=>{o.value.pts=!0;const e=await h.ignoredClient(o.value.row);let t=e.id,r=n.value.findIndex(b=>b.id==t);n.value[r]._status=e._status,o.value.state=!1,o.value.pts=!1,console.log(r),p.notify({message:"Cliente Ignorado",icon:"close",color:"danger"}),console.log(e)},F=async e=>{let t=await h.restoreClient({id:e}),r=t.id,b=n.value.findIndex(Q=>Q.id==r);n.value[b]._status=t._status,p.notify({message:"Restaurado",icon:"check",color:"primary"}),console.log(t)},Z=async e=>{console.log("amo a destruira "+e);let t=await h.deleteClient({id:e}),r=t.id,b=n.value.findIndex(Q=>Q.id==r);n.value[b]._status=t._status,p.notify({message:"Eliminado",icon:"close",color:"negative"}),console.log(t)},H=async()=>{o.value.state=!0,o.value.pts=!0,console.log("SINCRONIZANDO CLIENTES");let e=await h.synclient();console.log(e),e.fail?p.notify({message:"hubo problemas con la replicacion",icon:"close",color:"negative"}):(e.forEach(r=>{let b=n.value.findIndex(Q=>Q.id==r.id);n.value[b]._status=r._status,n.value[b].Stores=r.Stores}),o.value.state=!1,o.value.pts=!1,p.notify({message:"CLIENTES SINCRONIZADOS",icon:"check_circle",color:"positive"}))};return U(),(e,t)=>(k(),C(ee,{padding:""},{default:s(()=>[l(N,{class:"my-card"},{default:s(()=>[l(f,{class:"text-right"},{default:s(()=>[l(w,{color:"negative",icon:"archive",label:"",onClick:t[0]||(t[0]=r=>a(S).state=!0)})]),_:1}),l(q),l(f,{horizontal:""},{default:s(()=>[l(f,{class:"col"},{default:s(()=>[l($,{title:"Solicitudes",rows:a(A),"row-key":"name",columns:a(y).cols,onRowClick:j,filter:a(y).filter,"visible-columns":a(y).vcolumns},{top:s(()=>[d("div",ie,[t[6]||(t[6]=d("div",{class:"text-h5"},"Pendientes",-1)),l(E,{modelValue:a(y).filter,"onUpdate:modelValue":t[1]||(t[1]=r=>a(y).filter=r),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter","visible-columns"])]),_:1}),l(f,{class:"col"},{default:s(()=>[l($,{title:"Aceptados",rows:a(V),columns:a(g).cols,"row-key":"name",filter:a(g).filter,"visible-columns":a(g).vcolumns},{top:s(()=>[d("div",ne,[d("div",null,[l(w,{color:"positive",icon:"sync",onClick:H,disabled:a(V)<=0},null,8,["disabled"])]),t[7]||(t[7]=d("div",{class:"text-h5"},"Aceptadas",-1)),l(E,{modelValue:a(g).filter,"onUpdate:modelValue":t[2]||(t[2]=r=>a(g).filter=r),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter","visible-columns"])]),_:1})]),_:1})]),_:1}),l(N,{class:"my-card"},{default:s(()=>[l(f,{class:"text-right"}),l(q),l(f,{horizontal:""},{default:s(()=>[l(f,{class:"col"},{default:s(()=>[l($,{title:"Terminadas",rows:a(M),"row-key":"name",columns:a(u).cols,filter:a(u).filter,"visible-columns":a(u).vcolumns},{top:s(()=>[d("div",re,[t[8]||(t[8]=d("div",{class:"text-h5"},"En Sucursales",-1)),l(E,{modelValue:a(u).filter,"onUpdate:modelValue":t[3]||(t[3]=r=>a(u).filter=r),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter","visible-columns"])]),_:1})]),_:1})]),_:1}),l(z,{modelValue:a(o).state,"onUpdate:modelValue":t[4]||(t[4]=r=>a(o).state=r),persistent:a(o).pts},{default:s(()=>[a(o).pts?(k(),C(N,{key:0},{default:s(()=>[l(f,null,{default:s(()=>[l(se,{color:"primary",size:"md"}),l(Y,{offset:[0,8]},{default:s(()=>t[9]||(t[9]=[m("Dando de alta en sucursales :)")])),_:1})]),_:1})]),_:1})):(k(),C(N,{key:1},{default:s(()=>[a(o).row._status==0?(k(),C(f,{key:0},{default:s(()=>[d("div",ce,"Solicitud: "+c(a(o).row.id),1),t[10]||(t[10]=d("div",{class:"text-h5 text-left"},"Cliente",-1)),d("div",ue,c(a(o).row.nom_cli),1),d("div",de,"Sucursal: "+c(a(o).row.sucursal),1),d("div",me,"Precio: "+c(a(o).row.price),1),d("div",fe,"Telefono: "+c(a(o).row.celphone),1),d("div",pe,"Correo: "+c(a(o).row.email),1),d("div",be,"Solicitado: "+c(a(o).row.created_at),1)]),_:1})):D("",!0),l(R,{align:"right"},{default:s(()=>[l(w,{flat:"",onClick:L,color:"negative"},{default:s(()=>t[11]||(t[11]=[m("Rechazar")])),_:1}),l(w,{flat:"",onClick:O,color:"positive"},{default:s(()=>t[12]||(t[12]=[m("Aprobar")])),_:1})]),_:1}),a(o).row._status==1?(k(),C(f,{key:1},{default:s(()=>[m(c(a(o).row)+" - 1 ",1)]),_:1})):D("",!0),a(o).row._status==2?(k(),C(f,{key:2},{default:s(()=>[m(c(a(o).row)+" - 2 ",1)]),_:1})):D("",!0),l(R,null,{default:s(()=>[B(l(w,{flat:"",label:"Cancelar"},null,512),[[P]])]),_:1})]),_:1}))]),_:1},8,["modelValue","persistent"]),l(z,{modelValue:a(S).state,"onUpdate:modelValue":t[5]||(t[5]=r=>a(S).state=r),persistent:""},{default:s(()=>[l(oe,{quotes:a(i),onRestore:F,onDestroy:Z},null,8,["quotes"])]),_:1},8,["modelValue"])]),_:1}))}};export{$e as default};
