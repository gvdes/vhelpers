import{a as f,Q as g}from"./QCard.15ecc077.js";import{Q}from"./QSeparator.2f7d0e50.js";import{Q as D,a as c}from"./QItemSection.2f8fe1b3.js";import{Q as R}from"./QList.f16f67ac.js";import{Q as E}from"./QInput.2dd99544.js";import{r as m,c as N,o as b,a as w,w as t,h as H,u as O,aD as j,e,i as o,a4 as r,f as C,a3 as u,g as M,a0 as T,a1 as z,Q as _,a2 as P,a6 as G}from"./index.18c0d58c.js";import{Q as S}from"./QCardActions.aeeb149f.js";import{Q as B}from"./QDialog.6e23e4d3.js";import{Q as J}from"./QForm.24d34716.js";import{Q as K}from"./QFooter.dc2c41d8.js";import{Q as W}from"./QPage.1ccf371a.js";import{C as X}from"./ClosePopup.876b0665.js";import{u as Z}from"./VDB.99fa37f2.js";import{u as ee}from"./use-quasar.aea79736.js";import"./jspdf.plugin.autotable.34861b3b.js";import{r as V}from"./refundsApi.3835e941.js";import"./exceljs.min.9e24d01d.js";import"./browser.94c942de.js";import{d as te}from"./dayjs.min.25545ff6.js";import"./QSelect.4f75be70.js";import"./axios.76bdd693.js";/* empty css                                                                         */import"./use-key-composition.28ca7067.js";import"./uid.42677368.js";import"./QResizeObserver.71b30587.js";import"./_commonjsHelpers.88e99c8f.js";import"./position-engine.0f50ac46.js";import"./rtl.b51694b1.js";import"./axios.f1f32898.js";const oe={class:"text-center"},se=o("div",{class:"text-caption"},"ID",-1),ae={class:"text-bold"},le={class:"col text-center"},ie=o("div",{class:"text-caption"},"REFERENCIA",-1),re={class:"text-bold"},ne={class:"col text-center"},de=o("div",{class:"text-caption"},"ORIGEN",-1),ce={class:"text-bold"},ue={class:"col text-center"},ve=o("div",{class:"text-caption"},"CREADO",-1),me={class:"text-bold"},pe={class:"col text-center"},fe=o("div",{class:"text-caption"},"FECHA",-1),_e={class:"text-bold"},xe={class:"text-center text-h4"},ge={class:"text-center text-h6 text-grey-14"},be={class:"row items-start justify-between"},he={class:"text-center col text-primary"},ye=o("div",null,"Enviado",-1),Qe={class:"text-bold"},we={class:"text-center col"},Ce=o("div",null,"Recibido",-1),Ve={class:"text-center col"},ke=o("div",null,"Diferencia",-1),De=o("span",{class:"text text-h6"},"Estas Seguro de terminar la verificacion no se podra editar",-1),Re={class:"col"},it={__name:"veriferRefund",setup(Ee){const h=O(),y=j(),p=Z(),d=ee();m([]),m([]);const n=m(null),x=m(!1),v=m(null),l=m({state:!1,val:null}),I=N(()=>n.value.bodie.reduce((i,a)=>Number(i)+Number(a.to_received),0)),F=N(()=>v.value?n.value.bodie.filter(i=>{var a;return i.product.toLowerCase().includes((a=v.value)==null?void 0:a.toLowerCase())}):n.value.bodie),k=async()=>{d.loading.show({message:"Obteniendo Datos"});let i=p.session.store.id,a=y.params.rid;console.log(a);const s=await V.getRefundto(i,a);s.error?console.log(s):s.status.id==3?(console.log(s),d.loading.hide(),n.value=s):(d.notify({message:"Ya no se puede modificar la recepion",type:"negative",position:"top"}),h.replace("/refunds"))},L=()=>{l.value={val:null,state:!1}},$=async()=>{d.loading.show({message:"Creando Proceso"});const i=await V.finallyRefund({id:y.params.rid});console.log(i),i.fail?console.log(i):(console.log(i),d.notify({message:"Se Realizo correctamente el proceso ",type:"positive",position:"center"}),h.push("/refunds")),d.loading.hide()},A=async()=>{d.loading.show({message:"Editando Producto"}),console.log(l.value.val),l.value.val._refund=y.params.rid;const i=await V.editProductReceipt(l.value.val);if(i.fail)console.log(i);else{console.log(i);let a=n.value.bodie.findIndex(s=>s.product==l.value.val.product);a>=0&&(n.value.bodie[a].to_received=l.value.val.to_received,d.notify({type:"positive",position:"center"}),l.value={val:null,state:!1},d.loading.hide())}},Y=i=>{l.value.state=!0,l.value.val=i},U=()=>{if(v.value!=null){let i=n.value.bodie.find(a=>a.product.toLowerCase()==v.value.toLowerCase());i?(l.value.state=!0,l.value.val=i):d.notify({message:`No se encuentra el producto ${v.value}`,type:"negative",position:"top"}),v.value=null}};return p.session.rol=="aux"||p.session.rol=="gen"||p.session.rol=="aud"||p.session.rol=="root"?k():(d.notify({message:"No tienes acceso a esta pagina",type:"negative",position:"center"}),h.replace("/")),k(),(i,a)=>n.value?(b(),w(W,{key:0,padding:""},{default:t(()=>[e(g,{class:"my-card"},{default:t(()=>[e(f,{class:"row"},{default:t(()=>[o("div",oe,[se,o("div",ae,r(n.value.id),1)]),o("div",le,[ie,o("div",re,r(n.value.reference),1)]),o("div",ne,[de,o("div",ce,r(n.value.storefrom.name),1)]),o("div",ue,[ve,o("div",me,r(n.value.createdby.complete_name),1)]),o("div",pe,[fe,o("div",_e,r(C(te)(n.value.created_at).format("DD-MM-YYYY HH:mm:ss")),1)])]),_:1})]),_:1}),e(Q,{spaced:"",inset:"",vertical:"",dark:""}),e(R,{bordered:""},{default:t(()=>[e(D,null,{default:t(()=>[e(c,null,{default:t(()=>[u(" Producto ")]),_:1}),e(c,null,{default:t(()=>[u(" Descripcion ")]),_:1}),e(c,{class:"text-center"},{default:t(()=>[u(" Enviado ")]),_:1}),e(c,{class:"text-center"},{default:t(()=>[u(" Recibido ")]),_:1}),e(c,{class:"text-center"},{default:t(()=>[u(" Diferencia ")]),_:1})]),_:1})]),_:1}),(b(!0),M(z,null,T(C(F),(s,q)=>(b(),w(R,{bordered:"",key:q},{default:t(()=>[P((b(),w(D,{clickable:"",onClick:Ne=>Y(s)},{default:t(()=>[e(c,null,{default:t(()=>[u(r(s.product),1)]),_:2},1024),e(c,null,{default:t(()=>[u(r(s.description),1)]),_:2},1024),e(c,{class:"text-center"},{default:t(()=>[u(r(s.to_delivered),1)]),_:2},1024),e(c,{class:"text-center"},{default:t(()=>[u(r(s.to_received),1)]),_:2},1024),e(c,{class:"text-center"},{default:t(()=>[u(r(s.to_delivered-s.to_received),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[G]]),e(Q)]),_:2},1024))),128)),e(B,{modelValue:l.value.state,"onUpdate:modelValue":a[1]||(a[1]=s=>l.value.state=s),persistent:"",position:"bottom"},{default:t(()=>[e(g,{style:{width:"300","max-width":"40vw"}},{default:t(()=>[e(f,null,{default:t(()=>[o("div",xe,r(l.value.val.product),1),o("div",ge,r(l.value.val.description),1)]),_:1}),e(f,null,{default:t(()=>[o("div",be,[o("div",he,[ye,o("div",Qe,r(l.value.val.to_delivered),1)]),o("div",we,[Ce,e(E,{dense:"",borderless:"",modelValue:l.value.val.to_received,"onUpdate:modelValue":a[0]||(a[0]=s=>l.value.val.to_received=s),type:"number",min:"0","input-class":"text-h6 text-center",ref:"iptcounter"},null,8,["modelValue"])]),o("div",Ve,[ke,o("div",null,r(l.value.val.to_delivered-l.value.val.to_received),1)])])]),_:1}),e(S,{align:"center"},{default:t(()=>[e(_,{flat:"",icon:"close",color:"red-10",onClick:L}),e(_,{flat:"",label:"Editar",color:"blue-10",onClick:A})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(B,{modelValue:x.value,"onUpdate:modelValue":a[2]||(a[2]=s=>x.value=s),persistent:""},{default:t(()=>[e(g,null,{default:t(()=>[e(f,{class:"row items-center"},{default:t(()=>[De]),_:1}),e(S,{align:"right"},{default:t(()=>[P(e(_,{flat:"",icon:"close",color:"negative"},null,512),[[X]]),e(_,{flat:"",icon:"check",color:"positive",onClick:$})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(K,{reveal:"",elevated:"",bordered:"",class:"bg-white"},{default:t(()=>[e(g,{class:"q-mb-md",flat:"",bordered:"",dense:""},{default:t(()=>[e(f,{class:"row"},{default:t(()=>[o("div",Re,[e(J,{onSubmit:U},{default:t(()=>[e(E,{modelValue:v.value,"onUpdate:modelValue":a[3]||(a[3]=s=>v.value=s),type:"text",label:"Buscar Codigo",dense:""},null,8,["modelValue"])]),_:1})]),e(Q,{spaced:"",inset:"",vertical:"",dark:""}),e(_,{color:"primary",icon:"send",label:"Terminar",onClick:a[4]||(a[4]=s=>x.value=!x.value),disable:C(I)==0},null,8,["disable"])]),_:1})]),_:1})]),_:1})]),_:1})):H("",!0)}};export{it as default};
