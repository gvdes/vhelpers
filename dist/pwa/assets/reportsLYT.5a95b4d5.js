import{Q as w}from"./QSeparator.2d240015.js";import{r as f,o as b,a as _,w as v,u as L,e as k,i as y,a3 as S,Y as F,g as x,a1 as P,a0 as W,h as B,a4 as E}from"./index.07617b25.js";import{Q as D}from"./QHeader.c733f1d0.js";import{Q as T}from"./QSelect.eeb98be9.js";import{Q as C,a as j}from"./QCard.4e9d5c9b.js";import{Q as $,a as z}from"./QLayout.0ceac48c.js";import{u as V}from"./VDB.88cbb2d2.js";import{u as A}from"./use-quasar.69149e48.js";import"./jspdf.plugin.autotable.2fa6b80f.js";import{v as M}from"./axios.d0e8637f.js";import{E as u}from"./exceljs.min.9e24d01d.js";import"./dayjs.min.25545ff6.js";import"./browser.94c942de.js";import{_ as Q}from"./UserToolbar.7fb5a57a.js";import"./QResizeObserver.88267b3e.js";import"./use-key-composition.9e872a4a.js";import"./uid.42677368.js";import"./QItemSection.801410fc.js";import"./position-engine.479304e9.js";import"./QDialog.33132f10.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.f1f32898.js";import"./QCardActions.327c4db8.js";import"./ClosePopup.00946d1e.js";var O={index(){return M.get("/reports").then(t=>t.data).catch(t=>({fail:t}))},getReport(t){return M.post("/reports/getReport",t).then(n=>n.data).catch(n=>({fail:n}))}};const U=async t=>{console.log(t);const n=new u.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await d(n,t.key)},G=async t=>{console.log(t);const n=new u.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await d(n,t.key)},N=async t=>{console.log(t);const n=new u.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await d(n,t.key)},q=async t=>{console.log(t);const n=new u.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await d(n,t.key)},H=async t=>{console.log(t);const n=new u.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await d(n,t.key)},I=async t=>{console.log(t);const n=new u.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await d(n,t.key)},X=async t=>{console.log(t);const n=new u.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await d(n,t.key)},Y=async t=>{console.log(t);const n=new u.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await d(n,t.key)},J=async(t,n)=>{console.log(t);const s=new u.Workbook,i=s.addWorksheet(t.key);let l=t.value.map(e=>({C\u00F3digo:e.id,Modelo:e.code,Descripci\u00F3n:e.description,Proveedor:e.provider.name,Fabricante:e.maker?e.maker.name:"",Status:e.status.name,Secci\u00F3n:e.category.familia.seccion.name,Familia:e.category.familia.name,Categor\u00EDa:e.category.name,"Piezas x caja":e.pieces,SOTANO:e.stocks.find(a=>a.id==n).pivot.stock,CEDIS:e.stocks.find(a=>a.id==1).pivot.stock,TEXCOCO:e.stocks.find(a=>a.id==2).pivot.stock,Maximo:e.stocks[0].pivot.max,Minimo:e.stocks[0].pivot.min,locations:e.locations.map(a=>a.path).join("/")}));const r=Object.keys(l[0]).map(e=>({name:e,filterButton:!0})),o=l.map(e=>Object.values(e));i.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:r,rows:o}),i.columns.forEach(e=>{let a=0;e.eachCell({includeEmpty:!0},c=>{const m=c.value?c.value.toString().length:10;m>a&&(a=m)}),e.width=a<10?10:a}),await d(s,t.key)},K=async t=>{console.log(t);const n=new u.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await d(n,t.key)},Z=async t=>{console.log(t);const n=new u.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await d(n,t.key)},oo=async t=>{console.log(t);const n=new u.Workbook,s=n.addWorksheet(t.key);let i=t.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.provider.name,Fabricante:o.maker?o.maker.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,CEDIS:o.stocks.find(e=>e.id==1).pivot.stock,TEXCOCO:o.stocks.find(e=>e.id==2).pivot.stock,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(e=>e.path).join("/")}));const l=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));s.addTable({name:`${t.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:l,rows:r}),s.columns.forEach(o=>{let e=0;o.eachCell({includeEmpty:!0},a=>{const c=a.value?a.value.toString().length:10;c>e&&(e=c)}),o.width=e<10?10:e}),await d(n,t.key)},d=async(t,n)=>{try{const s=await t.xlsx.writeBuffer(),i=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=URL.createObjectURL(i),r=document.createElement("a");r.href=l,r.download=`${n}.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(s){console.error("Error al escribir el buffer:",s)}};var p={catalogo:U,conStock:G,conStockUbicados:N,conStockSinUbicar:q,sinStock:H,sinStockUbicados:I,sinMaximos:X,generalVsExhibicion:Y,generalVsCedis:J,conMaximos:K,negativos:Z,cedisStock:oo};const eo={class:"row justify-between"},to=y("span",{class:"text-h6"},"Reporteria",-1),ao={class:"row"},so={key:0,class:"row q-pl-sm"},io=["onClick"],no={class:"text--1 text-right q-pa-md"},Wo={__name:"reportsLYT",setup(t){const n=L(),s=V(),i=A(),l=f([]),r=f({seccion:null,familia:null,categoria:null}),o=f([]),e=async()=>{const m=await O.index();m.error?console.log(m):(console.log(m),l.value=m)},a=async()=>{i.loading.show({message:"Obteniendo Datos"});let m={workpoint:s.session.store.id_viz,secciones:r.value.seccion.map(g=>g.id)};const h=await O.getReport(m);h.error?console.log(h):(console.log(h),o.value=Object.keys(h).map(g=>({key:g,value:h[g]})),i.loading.hide())},c=m=>{i.loading.show({message:"Generando Reporte"});let h=s.session.store.id_viz;switch(m.key){case"catalogo":p.catalogo(m);break;case"conStock":p.conStock(m);break;case"conStockUbicados":p.conStockUbicados(m);break;case"conStockSinUbicar":p.conStockSinUbicar(m);break;case"sinStock":p.sinStock(m);break;case"sinStockUbicados":p.sinStockUbicados(m);break;case"sinMaximos":p.sinMaximos(m);break;case"generalVsExhibicion":p.generalVsExhibicion(m);break;case"generalVsCedis":p.generalVsCedis(m,h);break;case"conMaximos":p.conMaximos(m);break;case"negativos":p.negativos(m);break;case"cedisStock":p.cedisStock(m);break}i.loading.hide()};return s.session.rol=="aux"||s.session.rol=="gen"||s.session.rol=="aud"||s.session.rol=="root"?e():(i.notify({message:"No tienes acceso a esta pagina",type:"negative",position:"center"}),n.replace("/")),(m,h)=>(b(),_($,{view:"hHh Lpr fFf"},{default:v(()=>[k(D,{class:"transparent text-dark",bordered:""},{default:v(()=>[k(Q),k(w),y("div",eo,[y("div",null,[S("Helpers "),k(F,{name:"navigate_next",color:"primary"}),S(),to])]),k(w)]),_:1}),k(w,{spaced:"",inset:"",vertical:"",dark:""}),k(z,null,{default:v(()=>[k(C,{class:"my-card"},{default:v(()=>[k(j,null,{default:v(()=>[y("div",ao,[k(w,{spaced:"",inset:"",vertical:"",dark:""}),k(T,{dense:"",class:"col",modelValue:r.value.seccion,"onUpdate:modelValue":h[0]||(h[0]=g=>r.value.seccion=g),options:l.value.seccion,label:"Seccion","option-label":"name",filled:"",multiple:"","use-chips":"",onBlur:a},null,8,["modelValue","options"]),k(w,{spaced:"",inset:"",vertical:"",dark:""})])]),_:1})]),_:1}),k(w,{spaced:"",inset:"",vertical:"",dark:""}),o.value.length>0?(b(),x("div",so,[(b(!0),x(P,null,W(o.value,(g,R)=>(b(),x("div",{class:"col-md-3 col-xs-6 q-pb-sm q-pr-sm",key:R,onClick:co=>c(g)},[k(C,{class:"bg-darkl1"},{default:v(()=>[k(j,{class:"text-h4 text-left"},{default:v(()=>[y("span",null,E(g.value.length),1)]),_:2},1024),y("div",no,E(g.key.toUpperCase()),1)]),_:2},1024)],8,io))),128))])):B("",!0)]),_:1})]),_:1}))}};export{Wo as default};
