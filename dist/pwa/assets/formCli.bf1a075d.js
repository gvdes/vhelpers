import{u as D,r as f,c as V,o as p,d as Q,w as t,e as o,f as n,I as k,Q as b,h as g,g as w,ak as F}from"./index.bbb73c9f.js";import{Q as S}from"./QToolbar.5484c4d6.js";import{Q as r}from"./axios.2fbafe9c.js";import{Q as y}from"./QCard.6880113c.js";import{b as A,Q as O}from"./QList.e5fc0feb.js";import{Q as u}from"./QInput.b42210d7.js";import{Q as L}from"./QSelect.f268eb85.js";import{Q as U}from"./QForm.00096cdd.js";import{Q as j}from"./QTable.4f763291.js";import{Q as M}from"./QPage.b975c971.js";import{c}from"./clientApi.e517ab4c.js";import{u as P}from"./use-quasar.6967678f.js";import"./QLinearProgress.598b928c.js";import"./QCheckbox.de9b95b3.js";const R={class:"row"},$={class:"flex flex-center"},H={class:"row q-my-sm"},X={class:"row q-my-sm"},z={key:0},G={class:"text-h4"},J={class:"row justify-between"},K={key:0},re={__name:"formCli",setup(W){const x=D(),C=P(),m=f({state:!1}),d=f({state:!1,val:"",table:{cols:[{name:"Fs_id",label:"Codigo",field:"CODCLI"},{name:"Nombre",label:"Nombre",field:"NOFCLI"},{name:"Email",label:"Correo",field:"EMACLI"},{name:"Telefono",label:"Telefono",field:"TELCLI"},{name:"Tarifa",label:"Precio",field:"TARCLI"}],rows:[],noresults:"><"}}),e=f({branch:x.session.store,name:"",ticket:null,address:{street:null,numint:null,numext:null,cp:null,colinia:null,mun:null,state:null},phone:"",email:null,priceList:{val:null,opts:[{id:2,label:"Mayoreo"},{id:3,label:"Docena"},{id:4,label:"Caja"},{id:5,label:"Especial"},{id:6,label:"Centro"}]},agent:{db:[],val:null,opts:[]},notes:null,state:!1}),q=V(()=>e.value.priceList.val&&e.value.name&&e.value.name.length>4&&(e.value.phone&&e.value.phone.length==12||e.value.email)&&e.value.agent&&e.value.ticket&&e.value.address.street&&e.value.address.state&&e.value.address.mun),I=V(()=>e.value.agent.db.filter(s=>s._store==x.session.store.id)),v=V(()=>({branch:e.value.branch,name:e.value.name.toUpperCase(),ticket:e.value.ticket,address:e.value.address,phone:e.value.phone?e.value.phone.split("-").join(""):null,email:e.value.email?e.value.email:null,priceList:e.value.priceList.val,agent:e.value.agent.val,notes:e.value.notes})),T=async()=>{const s=await c.index();console.log(s),e.value.agent.db=s.agents},E=async()=>{e.value.state=!0;let s=[],l=await c.getClientVac();console.log(l),s=l;let a=s.findIndex(i=>i.TELCLI==v.value.phone||i.EMACLI==v.value.email);if(console.log(a),a<0){let i=await c.create(v.value);N(),console.log(v.value),e.value.state=!1,C.notify({message:"Formulario Enviado....",icon:"check_circle",color:"positive"}),console.log(i)}else{e.value.state=!1,console.log(s[a]);let i=s[a].CODCLI+" - "+s[a].NOFCLI;C.notify({message:"El cliente existe ID "+i,icon:"close",color:"negative"})}},N=()=>{e.value.ticket=null,e.value.branch.val=null,e.value.priceList.val=null,e.value.name="",e.value.agent.val=null,e.value.address={street:null,numint:null,numext:null,cp:null,colinia:null,mun:null,state:null},e.value.phone="",e.value.email=null,e.value.notes=null},B=async()=>{let s=d.value.val;const l=await c.getClient(s);console.log(l),m.value.state=!0,d.value.table.rows=l,d.value.state=!0,console.log(l)};return T(),(s,l)=>(p(),Q(M,null,{default:t(()=>[o(y,null,{default:t(()=>[o(r,null,{default:t(()=>[o(S,{class:"justify-between"},{default:t(()=>[n("div",null,[l[17]||(l[17]=n("span",{class:"text-grey"},"Helpers",-1)),o(k,{name:"navigate_next",color:"primary"}),l[18]||(l[18]=n("span",{class:"text-h6"},"Formulario Clientes",-1))]),n("div",R,[o(b,{flat:"",round:"",icon:"search",color:"teal",onClick:l[0]||(l[0]=a=>m.value.state=!0),title:"Restaurar"})])]),_:1})]),_:1})]),_:1}),o(A,{spaced:"",inset:"",vertical:"",dark:""}),n("div",$,[o(y,{flat:"",style:{width:"700px","max-width":"80vw"}},{default:t(()=>[o(r,null,{default:t(()=>[o(U,{onSubmit:E,class:"q-gutter-md text-grey-10"},{default:t(()=>[n("div",null,[o(r,{class:""},{default:t(()=>l[19]||(l[19]=[n("div",{class:"text-h4 text-center text-bold",style:{"text-decoration":"underline"}},"Datos cliente",-1)])),_:1}),o(u,{rounded:"",outlined:"",modelValue:e.value.name,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.name=a),label:"Nombre del Cliente",class:"q-my-sm"},null,8,["modelValue"]),o(u,{rounded:"",outlined:"",modelValue:e.value.address.street,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.address.street=a),label:"Calle",class:"q-my-sm"},null,8,["modelValue"]),n("div",H,[o(u,{rounded:"",outlined:"",modelValue:e.value.address.numint,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.address.numint=a),label:"Num INT",class:"col"},null,8,["modelValue"]),o(u,{rounded:"",outlined:"",modelValue:e.value.address.numext,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.address.numext=a),label:"Num EXT",class:"col"},null,8,["modelValue"])]),n("div",X,[o(u,{rounded:"",outlined:"",modelValue:e.value.address.cp,"onUpdate:modelValue":l[5]||(l[5]=a=>e.value.address.cp=a),label:"Codigo Postal",mask:"#####",class:"col"},null,8,["modelValue"]),o(u,{rounded:"",outlined:"",modelValue:e.value.address.state,"onUpdate:modelValue":l[6]||(l[6]=a=>e.value.address.state=a),label:"Estado",class:"col"},null,8,["modelValue"])]),o(u,{rounded:"",outlined:"",modelValue:e.value.address.colinia,"onUpdate:modelValue":l[7]||(l[7]=a=>e.value.address.colinia=a),label:"Colonia",class:"q-my-sm"},null,8,["modelValue"]),o(u,{rounded:"",outlined:"",modelValue:e.value.address.mun,"onUpdate:modelValue":l[8]||(l[8]=a=>e.value.address.mun=a),label:"Municipio",class:"q-my-sm"},null,8,["modelValue"]),o(u,{rounded:"",outlined:"",modelValue:e.value.phone,"onUpdate:modelValue":l[9]||(l[9]=a=>e.value.phone=a),label:"Telefono",mask:"##-####-####",class:"q-my-sm"},null,8,["modelValue"]),o(u,{rounded:"",outlined:"",modelValue:e.value.email,"onUpdate:modelValue":l[10]||(l[10]=a=>e.value.email=a),label:"Correo Electronico",class:"q-my-sm"},null,8,["modelValue"]),o(r,{class:""},{default:t(()=>l[20]||(l[20]=[n("div",{class:"text-h4 text-center",style:{"text-decoration":"underline"}},"Datos Sucursal",-1)])),_:1}),o(u,{rounded:"",outlined:"",modelValue:e.value.ticket,"onUpdate:modelValue":l[11]||(l[11]=a=>e.value.ticket=a),label:"Ticket",mask:"#-######",class:"q-my-sm"},null,8,["modelValue"]),e.value.branch?(p(),Q(L,{key:0,rounded:"",outlined:"","option-label":"complete_name",modelValue:e.value.agent.val,"onUpdate:modelValue":l[12]||(l[12]=a=>e.value.agent.val=a),options:I.value,label:"Quien atendio",class:"q-my-sm"},null,8,["modelValue","options"])):g("",!0),o(L,{rounded:"",outlined:"",modelValue:e.value.priceList.val,"onUpdate:modelValue":l[13]||(l[13]=a=>e.value.priceList.val=a),options:e.value.priceList.opts,label:"Precio Otorgado",class:"q-my-sm"},null,8,["modelValue","options"]),o(u,{rounded:"",outlined:"",modelValue:e.value.notes,"onUpdate:modelValue":l[14]||(l[14]=a=>e.value.notes=a),label:"Notas",class:"q-my-sm"},null,8,["modelValue"])]),q.value?(p(),w("div",z,[o(b,{label:"Enviar",type:"submit",color:"primary",loading:e.value.state},null,8,["loading"])])):g("",!0)]),_:1})]),_:1})]),_:1})]),o(O,{modelValue:m.value.state,"onUpdate:modelValue":l[16]||(l[16]=a=>m.value.state=a)},{default:t(()=>[o(y,{class:"my-card"},{default:t(()=>[o(r,null,{default:t(()=>[n("div",G,[o(k,{name:"search",class:"q-mr-xs"}),l[21]||(l[21]=F(" Buscador de Clientes "))]),o(r,null,{default:t(()=>[o(U,{onSubmit:B},{default:t(()=>[n("div",J,[o(u,{modelValue:d.value.val,"onUpdate:modelValue":l[15]||(l[15]=a=>d.value.val=a),type:"text",label:"Buscar"},null,8,["modelValue"]),o(b,{icon:"search",type:"submit",color:"primary"})]),d.value.state?(p(),w("div",K,[o(j,{rows:d.value.table.rows,columns:d.value.table.cols,"row-key":"name","no-data-label":d.value.table.noresults},null,8,["rows","columns","no-data-label"])])):g("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{re as default};
