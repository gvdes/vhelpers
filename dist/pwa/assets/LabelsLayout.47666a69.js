import{b as B,Q as G,a as te,d as oe,e as M}from"./QList.2fc5d49c.js";import{Q as pe}from"./QHeader.ba574551.js";import{i as ie,aL as ve,c as g,j as A,q as re,s as me,L as H,M as ge,k as be,u as xe,r as F,o as V,d as I,w as l,e as t,f as n,ak as q,E as ae,Q as v,an as ye,a1 as ke,g as N,a3 as j,h as J,a0 as m,a2 as K,al as _e,a4 as le}from"./index.05ff72a9.js";import{l as we,m as he,Q as R,a as D}from"./axios.65383d55.js";import{Q as Ce}from"./QRadio.d034372c.js";import{Q as Qe}from"./QCheckbox.0690902d.js";import{Q as Ve}from"./QToggle.e81bb5d8.js";import{Q as se}from"./QBtnGroup.69fe82f8.js";import{b as Pe}from"./QDrawer.a43c43ed.js";import{Q as Fe}from"./QInput.b7d3c1ab.js";import{q as Se,a as W}from"./QSelect.5e7e632a.js";import{Q as X}from"./QCardActions.4756b14c.js";import{Q as qe}from"./QTable.c1c539dc.js";import{Q as $e}from"./QPage.90a557e3.js";import{Q as Le,a as De}from"./QLayout.3c93dc4e.js";import{C as ne}from"./ClosePopup.33e37736.js";import{_ as Ee}from"./UserToolbar.11f483ca.js";import{P as Oe,d as Be}from"./ProductsAutocomplete.18e79e61.js";import{_ as Ie}from"./OptionsLabels.12d76267.js";import{u as Ne}from"./use-quasar.c6ebca0d.js";import{E as Ae}from"./exceljs.min.9e24d01d.js";import"./browser.eff7c919.js";import"./jspdf.plugin.autotable.34d1989c.js";import"./dayjs.min.cbcf888d.js";import"./QResizeObserver.35ab880e.js";import"./QScrollObserver.77c2a3c7.js";import"./QLinearProgress.751a70e7.js";import"./auth.f4b9a933.js";/* empty css                                                                         */import"./_commonjsHelpers.88e99c8f.js";const de={radio:Ce,checkbox:Qe,toggle:Ve},ze=Object.keys(de);function Y(a,w){if(typeof a=="function")return a;const r=a!==void 0?a:w;return p=>p[r]}var Te=ie({name:"QOptionGroup",props:{...we,modelValue:{required:!0},options:{type:Array,validator:a=>a.every(ve),default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],name:String,type:{type:String,default:"radio",validator:a=>ze.includes(a)},color:String,keepColor:Boolean,dense:Boolean,size:String,leftLabel:Boolean,inline:Boolean,disable:Boolean},emits:["update:modelValue"],setup(a,{emit:w,slots:r}){const{proxy:{$q:p}}=re(),x=Array.isArray(a.modelValue);a.type==="radio"?x===!0&&console.error("q-option-group: model should not be array"):x===!1&&console.error("q-option-group: model should be array in your case");const y=he(a,p),h=g(()=>de[a.type]),k=g(()=>Y(a.optionValue,"value")),$=g(()=>Y(a.optionLabel,"label")),d=g(()=>Y(a.optionDisable,"disable")),E=g(()=>a.options.map(s=>({val:k.value(s),name:s.name===void 0?a.name:s.name,disable:a.disable||d.value(s),leftLabel:s.leftLabel===void 0?a.leftLabel:s.leftLabel,color:s.color===void 0?a.color:s.color,checkedIcon:s.checkedIcon,uncheckedIcon:s.uncheckedIcon,dark:s.dark===void 0?y.value:s.dark,size:s.size===void 0?a.size:s.size,dense:a.dense,keepColor:s.keepColor===void 0?a.keepColor:s.keepColor}))),c=g(()=>"q-option-group q-gutter-x-sm"+(a.inline===!0?" q-option-group--inline":"")),C=g(()=>{const s={role:"group"};return a.type==="radio"&&(s.role="radiogroup",a.disable===!0&&(s["aria-disabled"]="true")),s});function b(s){w("update:modelValue",s)}return()=>A("div",{class:c.value,...C.value},a.options.map((s,_)=>{const z=r["label-"+_]!==void 0?()=>r["label-"+_](s):r.label!==void 0?()=>r.label(s):void 0;return A("div",[A(h.value,{label:z===void 0?$.value(s):null,modelValue:a.modelValue,"onUpdate:modelValue":b,...E.value[_]},z)])}))}});const je={position:{type:String,default:"bottom-right",validator:a=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(a)},offset:{type:Array,validator:a=>a.length===2},expand:Boolean};function Re(){const{props:a,proxy:{$q:w}}=re(),r=me(ge,H);if(r===H)return console.error("QPageSticky needs to be child of QLayout"),H;const p=g(()=>{const c=a.position;return{top:c.indexOf("top")!==-1,right:c.indexOf("right")!==-1,bottom:c.indexOf("bottom")!==-1,left:c.indexOf("left")!==-1,vertical:c==="top"||c==="bottom",horizontal:c==="left"||c==="right"}}),x=g(()=>r.header.offset),y=g(()=>r.right.offset),h=g(()=>r.footer.offset),k=g(()=>r.left.offset),$=g(()=>{let c=0,C=0;const b=p.value,s=w.lang.rtl===!0?-1:1;b.top===!0&&x.value!==0?C=`${x.value}px`:b.bottom===!0&&h.value!==0&&(C=`${-h.value}px`),b.left===!0&&k.value!==0?c=`${s*k.value}px`:b.right===!0&&y.value!==0&&(c=`${-s*y.value}px`);const _={transform:`translate(${c}, ${C})`};return a.offset&&(_.margin=`${a.offset[1]}px ${a.offset[0]}px`),b.vertical===!0?(k.value!==0&&(_[w.lang.rtl===!0?"right":"left"]=`${k.value}px`),y.value!==0&&(_[w.lang.rtl===!0?"left":"right"]=`${y.value}px`)):b.horizontal===!0&&(x.value!==0&&(_.top=`${x.value}px`),h.value!==0&&(_.bottom=`${h.value}px`)),_}),d=g(()=>`q-page-sticky row flex-center fixed-${a.position} q-page-sticky--${a.expand===!0?"expand":"shrink"}`);function E(c){const C=be(c.default);return A("div",{class:d.value,style:$.value},a.expand===!0?C:[A("div",C)])}return{$layout:r,getStickyContent:E}}var Ue=ie({name:"QPageSticky",props:je,setup(a,{slots:w}){const{getStickyContent:r}=Re();return()=>r(w)}});const Ge={class:"flex jutify-between row"},Me={class:"col"},He={class:"q-pa-md"},Je={class:"q-pa-md"},Ke={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},We={class:"text-h5 text-bold text-center"},Xe={class:"text-subtitle2 text-bold text-center"},Ye={class:"text-subtitle2 text-bold text-center"},Ze={class:"text-subtitle2 text-bold text-center"},et={class:"text-subtitle2 text-bold text-center"},tt={class:"row"},ot={class:"text-center"},at={class:"text-center"},lt={class:"text-bold q-pb-sm text-center"},st={class:"row q-pt-xs"},nt={class:"text-negative"},At={__name:"LabelsLayout",setup(a){const w=xe(),r=Ne(),p=F([]),x=F({filter:"",pagination:{rowsPerPage:9}}),y=F({state:!1}),h=F({state:!1}),k=F({val:[0,1,2,4],opts:[{label:"Menudeo",value:1},{label:"Mayoreo",value:2},{label:"Docena",value:3},{label:"Caja",value:4}]}),$=F(null),d=F({state:!1,wndGetRows:[],wndNoDataFound:[],wndTotal:[],wndGetAdded:[],_supply_by:0,message:"",messageRepeat:"",wndNotExist:[]}),E=i=>{let o=[],e=[],u=new Object;return i.products.map(f=>c(f.prices)?o.push(f):e.push(f)),console.log(i),u.notFound=o,u.add=e,u},c=i=>{let o=!0;return i.map((e,u)=>{o=e.pivot.price==0}),o},C=i=>{console.log(i)},b=F({state:!1}),s=i=>{console.log(i);let o=p.value.findIndex(e=>e.id==i.id);if(console.log(o),o>=0)r.notify({message:"El Producto ya esta agregado",type:"negative",position:"center"});else{let e=Z(i.prices,i.pieces);i._copies=1,i.type=e.type,i.usedPrices=e.prices,i._copies=1,p.value.push(i),console.log(i)}},_=i=>{let o=p.value.findIndex(e=>e.id==i.id);p.value.splice(o,1)},z=()=>{p.value=[],y.value.state=!1},ue=()=>{$.value.click()},ce=async()=>{let i=document.getElementById("inputFile").files[0],o=new Ae.Workbook,e=[],u=[],f=0;o.xlsx.load(i).then(P=>{if(o.worksheets[0].getColumn("A").eachCell({includeEmpty:!0},function(S,L){S.value&&e.push(S.value)}),u=e.filter((S,L,O)=>O.indexOf(S)==L),e.length){let S={codes:e,_workpoint:w.session.store.id_viz};console.log(S),r.loading.show({message:"Procesando archivo, espera.."}),Be.getMassive(S).then(L=>{let O=L.data,U=0,T=E(O);if(O.fails.notFound.map(Q=>d.value.wndNotExist.push(Q)),d.value.wndGetRows=T.add.length,d.value.state=!d.value.state,d.value.wndGetAdded=T.add,d.value.wndNoDataFound=T.notFound,d.value.wndNoDataFound.length>0){let Q=d.value.wndNoDataFound.length;d.value.message=Q<=1?"El producto no contiene precios.":"Los productos no contienen precios."}T.add.map(Q=>{let ee=Z(Q.prices,Q.pieces);Q._copies=1,Q.type=ee.type,Q.usedPrices=ee.prices,p.value.push(Q),U++}),U&&!O.fails.notFound.length&&u.length==e.length?r.notify({message:`Etiquetas generadas: ${U}`,color:"positive",icon:"done",timeout:1e3}):(f=e.length-u.length,d.value.messageRepeat=f<=1?`${f} producto se repitio. Favor de validar su documento antes de subirlo.`:`${f} productos se repitieron. Favor de validar su documento antes de subirlo.`),console.log(d.value),r.loading.hide()}).catch(L=>{console.log(L),r.notify({message:"Hay un problema con obtener los datos :/.",icon:"fas fa-grin-beam-sweat",color:"negative"})})}else r.notify({message:"Vaya!! Al parecer este archivo esta vacio.",icon:"fas fa-grin-beam-sweat",color:"negative"})})},Z=(i,o)=>{let e=[...i];const u=e.find(P=>P.pivot._type==4),f=e.find(P=>P.pivot._type==1);if(u.pivot.price==f.pivot.price){let P={id:0,alias:"OFERTA",name:"Oferta",pivot:{price:e[0].pivot.price},used:!0};return console.log("oferta"),{type:"off",prices:[P]}}else return console.log("estandar"),{type:"std",prices:e}},fe=i=>{switch(i){case"off":return"orange-9";case"std":return"green-9"}};return(i,o)=>(V(),I(Le,{view:"hHh Lpr fFf"},{default:l(()=>[t(pe,{class:"transparent text-dark",bordered:""},{default:l(()=>[t(Ee),t(B)]),_:1}),t(De,null,{default:l(()=>[t($e,{padding:""},{default:l(()=>[n("div",Ge,[n("div",Me,[o[9]||(o[9]=q("Helpers ")),t(ae,{name:"navigate_next",color:"primary"}),o[10]||(o[10]=q()),o[11]||(o[11]=n("span",{class:"text-h6"},"Creacion de Etiquetas",-1))]),t(v,{class:"flex justify-end",flat:"",onClick:o[0]||(o[0]=e=>b.value.state=!b.value.state),round:"",dense:"",icon:"menu"})]),t(R,{class:"my-card"},{default:l(()=>[t(Oe,{checkState:!1,onInput:C,with_prices:"",onAgregar:s,with_locations:"",withHistoric:""})]),_:1}),t(B,{spaced:"",inset:"",vertical:"",dark:""}),t(Pe,{modelValue:b.value.state,"onUpdate:modelValue":o[4]||(o[4]=e=>b.value.state=e),width:200,breakpoint:500,bordered:"",class:ye(ke(r).dark.isActive?"bg-grey-9":"bg-grey-3")},{default:l(()=>[n("div",null,[t(B,{spaced:"",inset:"",vertical:"",dark:""}),o[12]||(o[12]=n("div",{class:"text-center text-bold"},"Precios",-1)),n("div",He,[t(Te,{options:k.value.opts,type:"checkbox",modelValue:k.value.val,"onUpdate:modelValue":o[1]||(o[1]=e=>k.value.val=e)},null,8,["options","modelValue"])])]),t(B,{spaced:"",inset:"",vertical:"",dark:""}),o[13]||(o[13]=n("div",{class:"text-center text-bold"}," Opciones ",-1)),n("div",Je,[t(se,{spread:""},{default:l(()=>[t(v,{color:"primary",icon:"upload_file",flat:"",title:"Subir Etiquetas",onClick:ue}),p.value.length?(V(),N(j,{key:0},[t(v,{color:"primary",icon:"delete",flat:"",title:"Eliminar Etiquetas",onClick:o[2]||(o[2]=e=>y.value.state=!y.value.state)}),t(v,{color:"primary",icon:"download",flat:"",title:"Descargar Etquetas",onClick:o[3]||(o[3]=e=>h.value.state=!h.value.state)})],64)):J("",!0)]),_:1}),n("input",{type:"file",ref_key:"inputFile",ref:$,id:"inputFile",onInput:ce,hidden:"",accept:".xlsx,.xls"},null,544)])]),_:1},8,["modelValue","class"]),t(qe,{rows:p.value,"row-key":"name",grid:"",filter:x.value.filter,pagination:x.value.pagination,"no-data-label":"''"},{"top-right":l(()=>[t(Fe,{borderless:"",dense:"",debounce:"300",modelValue:x.value.filter,"onUpdate:modelValue":o[5]||(o[5]=e=>x.value.filter=e),placeholder:"Buscar"},{append:l(()=>[t(ae,{name:"search"})]),_:1},8,["modelValue"])]),item:l(e=>[n("div",Ke,[t(R,{class:"my-card"},{default:l(()=>[t(D,null,{default:l(()=>{var u;return[t(Se,{size:"sm",class:"fixed-right absolute-right text-bold text-white text-uppercase",color:fe(e.row.type)},{default:l(()=>[q(m(e.row.type),1)]),_:2},1032,["color"]),n("div",We,m(e.row.code),1),n("div",Xe,m(e.row.name),1),n("div",Ye,m(e.row.label),1),n("div",Ze,"Longitud: "+m(e.row.large),1),n("div",et,"Ubicacion: "+m((u=e.row.locations)==null?void 0:u.map(f=>f.path).join("/")),1),t(B,{spaced:"",inset:"",vertical:"",dark:""}),n("div",tt,[(V(!0),N(j,null,K(e.row.usedPrices.filter(f=>k.value.val.includes(f.id)),(f,P)=>(V(),N("div",{class:"col items-start",key:P},[n("div",ot,m(f.alias),1),n("div",at,m(f.pivot.price),1)]))),128))])]}),_:2},1024),t(X,{align:"center"},{default:l(()=>[t(v,{flat:"",icon:"delete",color:"negative",onClick:u=>_(e.row)},null,8,["onClick"]),t(v,{flat:"",icon:"add",onClick:u=>e.row._copies++},null,8,["onClick"]),n("div",null,[o[14]||(o[14]=n("div",{class:"text-caption text--2"},"copias",-1)),n("div",lt,m(e.row._copies),1)]),t(v,{flat:"",icon:"remove",onClick:u=>e.row._copies<=1?"":e.row._copies--},null,8,["onClick"])]),_:2},1024)]),_:2},1024)])]),bottom:l(e=>[t(Ue,{position:"bottom",class:"full-width",offset:[0,18]},{default:l(()=>[n("div",st,[t(se,{rounded:"",flat:"",color:"primary"},{default:l(()=>[e.pagesNumber>2?(V(),I(v,{key:0,icon:"first_page",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.firstPage,class:"q-px-sm"},null,8,["disable","onClick"])):J("",!0),t(v,{icon:"chevron_left",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.prevPage,class:"q-px-sm"},null,8,["disable","onClick"]),t(v,{flat:"",disable:"","no-caps":""},{default:l(()=>[q(m(e.pagination.page)+" / "+m(e.pagesNumber),1)]),_:2},1024),t(v,{icon:"chevron_right",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.nextPage,class:"q-px-sm"},null,8,["disable","onClick"]),e.pagesNumber>2?(V(),I(v,{key:1,icon:"last_page",round:"",dense:"",flat:"",onClick:e.lastPage,class:"q-px-sm"},null,8,["onClick"])):J("",!0)]),_:2},1024)])]),_:2},1024)]),"no-data":l(()=>o[15]||(o[15]=[])),_:1},8,["rows","filter","pagination"]),t(G,{modelValue:y.value.state,"onUpdate:modelValue":o[6]||(o[6]=e=>y.value.state=e),persistent:""},{default:l(()=>[t(R,null,{default:l(()=>[t(D,{class:"row items-center"},{default:l(()=>[t(_e,{icon:"warning",color:"white","text-color":"negative"}),o[16]||(o[16]=n("div",{class:"q-ml-sm"},"Se eliminaran todos los articulos de la lista ",-1))]),_:1}),t(D,null,{default:l(()=>o[17]||(o[17]=[n("div",{class:"q-ml-sm"},"Deseas Continuar?",-1)])),_:1}),t(X,{align:"right"},{default:l(()=>[le(t(v,{flat:"",label:"No",color:"positive"},null,512),[[ne]]),t(v,{flat:"",label:"Si",color:"negative",onClick:z})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(G,{modelValue:h.value.state,"onUpdate:modelValue":o[7]||(o[7]=e=>h.value.state=e),persistent:""},{default:l(()=>[t(Ie,{products:p.value,prices:k.value},null,8,["products","prices"])]),_:1},8,["modelValue"]),t(G,{modelValue:d.value.state,"onUpdate:modelValue":o[8]||(o[8]=e=>d.value.state=e)},{default:l(()=>[t(R,{class:"my-card",style:{width:"70%"}},{default:l(()=>[t(D,{class:"items-center"},{default:l(()=>[o[18]||(o[18]=n("div",{class:"text-center text-bold"},"Repetidos",-1)),n("div",nt,m(d.value.messageRepeat),1)]),_:1}),t(D,null,{default:l(()=>[o[19]||(o[19]=n("div",{class:"text-center"},"Productos Sin Precio",-1)),t(te,null,{default:l(()=>[(V(!0),N(j,null,K(d.value.wndNoDataFound,(e,u)=>(V(),I(oe,{key:u},{default:l(()=>[t(M,null,{default:l(()=>[t(W,{overline:""},{default:l(()=>[q(m(e.code),1)]),_:2},1024)]),_:2},1024),t(M,null,{default:l(()=>[t(W,{caption:""},{default:l(()=>[q(m(e.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(D,null,{default:l(()=>[o[20]||(o[20]=n("div",{class:"text-center"},"Productos Sin Existencia",-1)),t(te,null,{default:l(()=>[(V(!0),N(j,null,K(d.value.wndNotExist,(e,u)=>(V(),I(oe,{key:u},{default:l(()=>[t(M,null,{default:l(()=>[t(W,{overline:""},{default:l(()=>[q(m(e),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(X,{align:"right"},{default:l(()=>[le(t(v,{flat:"",label:"OK",color:"primary"},null,512),[[ne]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}};export{At as default};
