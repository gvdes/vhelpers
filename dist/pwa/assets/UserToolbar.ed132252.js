import{u as Z,f as aa,r as y,g as ea,a as i,c as p,k as v,d as a,n as c,a7 as s,a1 as m,p as $,h as w,i as t,b9 as Q,ba as D,j as k,a4 as b,bb as ta,a3 as h,a2 as q,aX as B,bc as sa,aj as la,Q as j,l as z,ah as oa,a5 as E,a6 as F}from"./index.a1c295c1.js";import{Q as ra,e as na,a as C}from"./QSelect.9d7be3ea.js";import{Q as M}from"./QImg.485359ae.js";import{Q as R,a as I,b as x}from"./QList.48a27591.js";import{Q as ia}from"./QSpace.abbec46a.js";import{Q as da}from"./QExpansionItem.2f8e3b0c.js";import{u as ca,Q as ua,a as pa,C as T}from"./favorites.6b442dd7.js";import{C as P}from"./ClosePopup.e501f1d3.js";import{a as K}from"./auth.620d6bf8.js";import{u as va}from"./use-quasar.1aaac9b4.js";const ma={class:"col"},ga={key:0,class:"col text-center fs-inc1 text-primary fw-sbold"},fa={class:"text-center fs-inc1 text-primary fw-sbold"},ka={class:"row"},ba={class:"row q-gutter-md justify-center q-pa-md"},ya=["onClick"],Ba={__name:"UserToolbar",setup(xa){const U=ca(),r=Z(),u=r.session,V=aa(),A=y({state:!1}),O=()=>{r.sessionDestroy(),V.replace("/auth")},o=va();y([]);const _=y(!1),g=y({val:r.session,opts:[]}),N=ea(()=>o.platform.is.mobile),n=y({val:null,state:!1,opts:["avatar0.png","avatar1.png","avatar2.png","avatar3.png","avatar4.png","avatar5.png","avatar6.png","avatar7.png","avatar8.png","avatar9.png","avatar10.png","avatar11.png","avatar12.png","avatar13.png","avatar14.png","avatar15.png","avatar16.png","avatar17.png","avatar18.png","avatar19.png","avatar20.png","avatar21.gif","avatar22.png","avatar23.png","avatar24.png","avatar25.png","avatar26.png","avatar27.png"]}),W=async()=>{const d=await K.getResources(u.credentials.id);d.fail?console.log(d):(console.log(d),r.setModules(d.grouped_modules),r.setStores(d.stores),r.modulesLoaded=!0)},X=()=>{o.loading.show({message:"Cambiando sucursal"}),r.session.store=g.value.val.store,r.setSession({...r.session,store:g.value.val.store}),console.log(r.session),window.location.reload(),o.loading.hide()},L=localStorage.getItem("mode");L&&o.dark.set(L==="dark");const G=()=>{o.dark.toggle(),localStorage.setItem("mode",o.dark.isActive?"dark":"light")},H=d=>{n.value.val=d},J=async()=>{o.loading.show({message:"Cambiando Avatar :)"});let d={id:r.session.credentials.id,avatar:n.value.val};const e=await K.changeAvatar(d);e.fail?(console.log(e),T.emit("error","algo salio mal")):(console.log(e),r.setSession({...r.session,credentials:{...r.session.credentials,avatar:n.value.val}}),T.emit("error","algo salio bien"),n.value.val=null,n.value.state=!1,o.notify({type:"positive",icon:"check"}),o.loading.hide())};return W(),(d,e)=>(i(),p(h,null,[v("div",{class:Q(["q-pa-sm row items-center",s(o).dark.isActive?"text-white bg-dark":"text-dark bg-white"])},[a(c,{color:"primary",icon:"list",flat:"",dense:"",class:"q-mr-sm",onClick:e[0]||(e[0]=l=>_.value=!_.value)}),v("div",ma,[a(c,{class:"text-pink",flat:"",label:s(u).credentials.nick,onClick:e[1]||(e[1]=l=>s(V).push("/"))},null,8,["label"])]),s(r).stores.length==0?(i(),p("div",ga,m(N.value?s(u).store.alias:s(u).store.name),1)):$("",!0),s(r).stores.length>1?(i(),w(ra,{key:1,modelValue:g.value.val,"onUpdate:modelValue":[e[2]||(e[2]=l=>g.value.val=l),X],options:s(r).stores,"option-label":l=>l.store.name,borderless:"",color:"primary",dense:"",class:"text-center","options-selected-class":"text-primary text-bold"},{selected:t(()=>[v("div",fa,m(N.value?g.value.val.store.alias:g.value.val.store.name),1)]),_:1},8,["modelValue","options","option-label"])):$("",!0),e[10]||(e[10]=v("div",{class:"col text-right"},null,-1))],2),a(pa,{modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=l=>_.value=l),width:300,breakpoint:500,bordered:"",class:Q(s(o).dark.isActive?"bg-grey-9":"bg-grey-3")},{default:t(()=>[a(ua,{class:"fit text-bold text-dark"},{default:t(()=>[a(R,null,{default:t(()=>[a(I,null,{default:t(()=>[a(c,{round:"",flat:"",class:"q-mr-md"},{default:t(()=>[a(D,{size:"40px"},{default:t(()=>[a(M,{src:`/avatares/${s(r).session.credentials.avatar}`},null,8,["src"])]),_:1}),a(na,{anchor:"bottom right",self:"top right"},{default:t(()=>[a(R,{style:{"min-width":"180px"}},{default:t(()=>[a(I,{clickable:"",onClick:e[3]||(e[3]=()=>{n.value.state=!n.value.state,n.value.val=s(r).session.credentials.avatar})},{default:t(()=>[a(x,null,{default:t(()=>e[11]||(e[11]=[k("Cambiar Avatar")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(x,null,{default:t(()=>[a(C,null,{default:t(()=>[k(m(s(u).credentials.staff.complete_name),1)]),_:1}),a(C,{caption:""},{default:t(()=>[k(m(s(u).store.alias)+" ",1),a(ia),k(" ("+m(s(u).credentials.nick)+")",1)]),_:1})]),_:1})]),_:1}),a(b),v("div",ka,[a(c,{color:"primary",icon:"home",flat:"",dense:"",class:"col",onClick:e[4]||(e[4]=l=>s(V).push("/"))}),a(b,{spaced:"",inset:"",vertical:"",dark:""}),a(c,{class:"col",color:"pink",icon:"logout","no-caps":"",flat:"",onClick:e[5]||(e[5]=l=>A.value.state=!0)}),a(b,{spaced:"",inset:"",vertical:"",dark:""}),a(ta,{modelValue:s(o).dark.mode,"onUpdate:modelValue":[e[6]||(e[6]=l=>s(o).dark.mode=l),G],color:"primary",icon:s(o).dark.mode?"light_mode":"dark_mode","keep-color":"",class:"col text-center"},null,8,["modelValue","icon"])]),a(b),a(b,{spaced:"",inset:"",vertical:"",dark:""}),(i(!0),p(h,null,q(s(r).modules,(l,S)=>(i(),w(da,{key:S,"expand-separator":"",label:l.name,dark:s(o).dark.isActive,"header-class":s(o).dark.isActive?"text-white":"text-dark"},{default:t(()=>[(i(!0),p(h,null,q(l.modules,(f,Y)=>(i(),p("div",{key:Y},[B((i(),w(I,{clickable:"",to:`/${f.path}`,dark:s(o).dark.isActive},{default:t(()=>[a(x,{side:""},{default:t(()=>[a(c,{flat:"",round:"",dense:"",icon:"star",color:s(U).isFavorite(f.path)?"yellow-8":"grey",onClick:sa(_a=>s(U).toggle(f),["stop","prevent"])},null,8,["color","onClick"])]),_:2},1024),a(x,null,{default:t(()=>[a(C,{class:Q(s(o).dark.isActive?"text-white":"text-dark")},{default:t(()=>[k(m(f.name),1)]),_:2},1032,["class"]),a(C,{caption:"",class:Q(s(o).dark.isActive?"text-grey-4":"text-grey-7")},{default:t(()=>[k(m(f.desc),1)]),_:2},1032,["class"])]),_:2},1024),a(x,{avatar:""},{default:t(()=>[a(D,{flat:"",color:"transparent","text-color":(s(o).dark.isActive,"primary"),icon:"arrow_forward"},null,8,["text-color"])]),_:1})]),_:2},1032,["to","dark"])),[[la]]),a(b,{dark:s(o).dark.isActive},null,8,["dark"])]))),128))]),_:2},1032,["label","dark","header-class"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue","class"]),a(F,{modelValue:n.value.state,"onUpdate:modelValue":e[8]||(e[8]=l=>n.value.state=l),persistent:""},{default:t(()=>[a(j,null,{default:t(()=>[a(z,null,{default:t(()=>[v("div",ba,[(i(!0),p(h,null,q(n.value.opts,(l,S)=>(i(),p("div",{key:S,class:"relative-position",style:{width:"100px",height:"100px",cursor:"pointer"},onClick:f=>H(l)},[a(M,{src:`/avatares/${l}`,alt:l,style:{width:"100px",height:"100px"},class:"rounded-borders"},null,8,["src","alt"]),n.value.val===l?(i(),w(oa,{key:0,name:"check_circle",color:"",size:"sm",class:"absolute-bottom-right q-mt-sm q-mr-sm"})):$("",!0)],8,ya))),128))])]),_:1}),a(E,null,{default:t(()=>[a(c,{flat:"",label:"OK",onClick:J,color:"positive"}),B(a(c,{flat:"",label:"Cancelar",color:"negative"},null,512),[[P]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(F,{modelValue:A.value.state,"onUpdate:modelValue":e[9]||(e[9]=l=>A.value.state=l),persistent:""},{default:t(()=>[a(j,null,{default:t(()=>[a(z,{class:"row items-center"},{default:t(()=>[a(D,{icon:"logout",color:"primary","text-color":"white"}),e[12]||(e[12]=v("span",{class:"q-ml-sm"},"Estas por cerrar sesion",-1))]),_:1}),a(E,{align:"right"},{default:t(()=>[B(a(c,{flat:"",label:"Nope!",color:"primary"},null,512),[[P]]),a(c,{flat:"",label:"Simon!",color:"primary",onClick:O})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{Ba as _};
