import{Q as L}from"./QPage.c4c89dc0.js";import{aW as M,a as T,u as _,r as i,c as k,p as $,l as C,o as D,d as F,w as G,e as d,a1 as h}from"./index.722c96ba.js";import"./QSelect.c275295e.js";import{u as R}from"./use-quasar.70cae317.js";import"./dayjs.min.cbcf888d.js";import"./QList.b9334b06.js";import"./QDrawer.66399704.js";import"./QExpansionItem.73a1f451.js";import"./QCardSection.2772bee0.js";import"./QCardActions.acc2993a.js";import"./QCard.3248d843.js";import"./ClosePopup.fcc85c1b.js";import"./axios.511d92c0.js";import{u as X,m as f}from"./vue3-apexcharts.d3b3966a.js";import"./use-key-composition.4dbf594e.js";import"./format.8ac60962.js";import"./_commonjsHelpers.88e99c8f.js";import"./use-checkbox.eaa0af27.js";import"./QResizeObserver.36318aa8.js";import"./QScrollObserver.1037fb2d.js";const lt={__name:"daily",setup(B){const x=R(),l=X();M(),T(),_();const v=i({}),A=i([]),g=i({}),b=i([]),m=i(null),y=i({}),O=i([]),u=i(null),S=k(()=>x.platform.is.mobile),n=k(()=>u.value==null?l.stores:l.stores.filter(t=>t.sucursal.id==u.value.sucursal.id)),w=()=>{v.value={chart:{id:"stores",background:"none",toolbar:{show:!1},events:{dataPointSelection(t,s,{dataPointIndex:e}){e===m.value?(m.value=null,u.value=null,p(),c()):(m.value=e,u.value=l.stores[e],p(),c(),console.log(n.value))}}},tooltip:{y:{formatter:t=>"$"+t.toLocaleString("es-MX")}},xaxis:{categories:l.stores.map(t=>S.value?t.sucursal.alias:t.sucursal.name),labels:{show:!1}},plotOptions:{bar:{horizontal:!0,columnWidth:"100%",barHeight:"90%"}},dataLabels:{formatter:t=>"$ "+t.toLocaleString("es-MX"),style:{colors:["#333"]}}},A.value=[{name:`VENTA ${l.today}`,data:l.stores.map(t=>{var s,e;return((e=(s=t.data)==null?void 0:s.salesAct)==null?void 0:e.total)||0})}]},c=()=>{const t={};n.value.forEach(e=>{e.data.salesAct.desglose.forEach(a=>{t[a.FORMAPAGO]?t[a.FORMAPAGO]+=parseFloat(a.TOTAL):t[a.FORMAPAGO]=parseFloat(a.TOTAL)})});let s=Object.entries(t).map(([e,a])=>({FORMAPAGO:e,TOTAL:a}));console.log(s),y.value={chart:{type:"donut",background:"none",toolbar:{show:!1}},labels:s.map(e=>e.FORMAPAGO),tooltip:{y:{formatter:e=>"$"+e.toLocaleString("es-MX")}},legend:{position:"bottom"}},O.value=s.map(e=>e.TOTAL)},p=()=>{const t=n.value.reduce((o,r)=>o+(r.data.salesAct.total||0),0),s=n.value.reduce((o,r)=>o+(r.data.salesAnt.total||0),0),e=n.value.reduce((o,r)=>o+(r.data.salesAct.tickets||0),0),a=n.value.reduce((o,r)=>o+(r.data.salesAnt.tickets||0),0);g.value={chart:{id:"global",toolbar:{show:!1},background:"transparent"},colors:["#4ECDC4","#556270"],tooltip:{y:{formatter:o=>"$"+o.toLocaleString("es-MX")}},xaxis:{categories:["A\xD1O Anterior","A\xD1O Actual"]},yaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},dataLabels:{formatter:(o,{dataPointIndex:r})=>`${"$ "+o.toLocaleString("es-MX")}
Tcks: ${r===0?a:e}`,style:{colors:["#333"]}}},b.value=[{data:[s,t]}]};return $(()=>{l.stores.length>0?(w(),p(),c()):C(()=>l.stores,t=>{t.length>0&&(w(),p(),c())},{immediate:!0})}),(t,s)=>(D(),F(L,{padding:""},{default:G(()=>[d(h(f),{type:"bar",width:"97%",height:"300px",options:g.value,series:b.value},null,8,["options","series"]),d(h(f),{type:"bar",width:"97%",height:"400px",options:v.value,series:A.value},null,8,["options","series"]),d(h(f),{type:"donut",width:"97%",height:"200x",options:y.value,series:O.value},null,8,["options","series"])]),_:1}))}};export{lt as default};
