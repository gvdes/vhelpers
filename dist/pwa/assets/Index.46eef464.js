import{a$ as F,aW as j,a as z,u as W,r as s,c as w,l as G,o as f,d as b,w as m,f as J,e as n,Q as k,h as y,a1 as K,b6 as X,S as C,b5 as $,ak as h}from"./index.4ec92603.js";import{Q as Y}from"./QSelect.2fd94609.js";import{b as x}from"./QList.598a2190.js";import{Q as I}from"./QInput.e2a1c041.js";import{Q as S}from"./QTable.a27310a8.js";import{Q as Z}from"./QPage.fb2e21ce.js";import{d as ee}from"./dayjs.min.cbcf888d.js";import"./axios.4fbe9239.js";import{o as le}from"./orderApi.898acd99.js";import{u as ae}from"./OrderStore.f7bf5897.js";import{u as te}from"./use-quasar.599def75.js";import{r as oe}from"./reports.26d44d3a.js";import"./QDrawer.5af14b59.js";import"./QExpansionItem.ed933133.js";import"./QCardSection.a5c7acdc.js";import"./QCardActions.3c8cecf8.js";import"./QCard.3d861cc2.js";import"./ClosePopup.df452371.js";/* empty css                                                                         */import"./socket.41f46bf6.js";import"./use-key-composition.0a046c6b.js";import"./QLinearProgress.4484223c.js";import"./QCheckbox.72a96ec6.js";import"./use-checkbox.ac422b0e.js";import"./_commonjsHelpers.88e99c8f.js";import"./exceljs.min.9e24d01d.js";import"./QResizeObserver.fe7070ea.js";import"./QScrollObserver.c2183070.js";const re={__name:"Index",setup(se){j();const O=z(),d=ae();d.setTitle("INICIO"),d.setshowLyt(!0),d.setShowEvent(!0);const g=te(),T=W(),o=s(null),r=s(null),u=s(!1);s(null);let V=null;const Q=s({rowsPerPage:10}),c=s([]),t=s(null),p=s({columns:[{name:"id",label:"FOLIO",field:e=>e.id,align:"left",sortable:!0},{name:"created",label:"Creado Por",field:e=>{var l,a,i;return`${(l=e.created_by)==null?void 0:l.names} ${(a=e.created_by)==null?void 0:a.surname_pat} ${(i=e.created_by)==null?void 0:i.surname_mat}`},align:"left",sortable:!0},{name:"client",label:"CLIENTE",field:e=>e.name,align:"left",sortable:!0},{name:"status",label:"ESTADO",field:e=>{var l;return(l=e.status)==null?void 0:l.name},align:"center",classes:e=>`text-${D.value[e.status.id-1]}`,sortable:!0},{name:"created_time",label:"HORA",field:e=>ee(e.created_at).format("HH:mm:ss"),align:"center",sortable:!0}],filter:null}),v=s({columns:[{name:"id",label:"ID",field:e=>e.id,sortable:!0,align:"left"},{name:"name",label:"Nombre",field:e=>`${e.names} ${e.surname_pat} ${e.surname_mat}`,sortable:!0,align:"left"},{name:"pedidos",label:"Pedidos",field:e=>e.filteredCount,sortable:!0,align:"center"}],filter:null}),D=s(["grey-6","red-5","deep-orange-10","blue-4","blue-10","teal-4","teal-10","green-5","green-10","light-green-10"]),_=w(()=>g.platform.is.mobile),B=w(()=>{let e=d.orders;return o.value&&(e=e.filter(l=>l._created_by===o.value.id)),t.value&&(e=e.filter(l=>l._status===t.value.id)),r.value&&(e=e.filter(l=>l.id===r.value.id)),e}),U=()=>{u.value=!0},E=()=>{V=setTimeout(()=>{u.value=!0},600)},P=()=>{clearTimeout(V)},R=w(()=>d.users.map(e=>{let l=e.orders;return r.value&&(l=l.filter(a=>a.id===r.value.id)),t.value&&(l=l.filter(a=>a._status===t.value.id)),o.value&&o.value.id!==e.id&&(l=[]),{...e,filteredOrders:l,filteredCount:l.length}}).filter(e=>e.filteredCount>0||!t.value&&!r.value&&!o.value)),N=(e,l)=>{o.value=l,r.value=null},A=(e,l)=>{r.value=l,o.value=null},q=()=>{o.value=null,r.value=null,t.value=null},H=(e,l)=>{O.push(`/preorders/pedidos/${l.id}`)},L=()=>{u.value=!1,c.value=[]},M=async()=>{console.log("Descargar:",c.value),g.loading.show({message:"Descargando Datos"});let e=c.value.map(a=>a.id);console.log(e);const l=await le.getOrdersDownload({prvs:e,store:T.session.store.id_va});if(l.fail)console.log(l);else{console.log(l);let a={key:"Preventas",value:l};await oe.preorders(a),u.value=!1,c.value=[],g.loading.hide()}};return G(t,()=>{r.value=null,o.value=null}),(e,l)=>(f(),b(Z,{padding:""},{default:m(()=>[J("div",{class:h(_.value?"":"row")},[n(S,{class:h(_.value?"":"col"),rows:B.value,columns:p.value.columns,filter:p.value.filter,pagination:Q.value,"row-key":"id","row-class":a=>{var i;return((i=r.value)==null?void 0:i.id)===a.id?"bg-blue-1":""},onRowClick:A,onRowDblclick:H,onTouchstart:E,onContextmenu:$(U,["prevent"]),onTouchend:P,selection:u.value?"multiple":"none",selected:c.value,"onUpdate:selected":l[3]||(l[3]=a=>c.value=a)},{"top-right":m(()=>[u.value?(f(),b(k,{key:0,icon:"download",color:"primary",flat:"",onClick:M})):y("",!0),u.value?(f(),b(k,{key:1,flat:"",dense:"",icon:"close",class:"q-ml-sm",onClick:L})):y("",!0),n(Y,{modelValue:t.value,"onUpdate:modelValue":l[1]||(l[1]=a=>t.value=a),options:K(d).process,label:"Estado",filled:"",style:{width:"130px"},dense:"","option-label":"name"},X({_:2},[t.value?{name:"append",fn:m(()=>[n(C,{name:"cancel",onClick:l[0]||(l[0]=$(a=>t.value=null,["stop","prevent"])),class:"cursor-pointer"})]),key:"0"}:void 0]),1032,["modelValue","options"]),o.value||r.value||t.value?(f(),b(k,{key:2,class:"q-ml-md",icon:"filter_alt_off",flat:"",dense:"",onClick:q})):y("",!0),n(x,{spaced:"",inset:"",vertical:"",dark:""}),n(I,{borderless:"",dense:"",debounce:"300",modelValue:p.value.filter,"onUpdate:modelValue":l[2]||(l[2]=a=>p.value.filter=a),placeholder:"Buscar"},{append:m(()=>[n(C,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["class","rows","columns","filter","pagination","row-class","selection","selected"]),n(x,{spaced:"",inset:"",vertical:"",dark:""}),n(S,{class:h(_.value?"":"col"),rows:R.value,columns:v.value.columns,filter:v.value.filter,pagination:Q.value,"row-key":"id","row-class":a=>{var i;return((i=o.value)==null?void 0:i.id)===a.id?"bg-blue-1":""},onRowClick:N},{"top-right":m(()=>[n(I,{borderless:"",dense:"",debounce:"300",modelValue:v.value.filter,"onUpdate:modelValue":l[4]||(l[4]=a=>v.value.filter=a),placeholder:"Buscar"},{append:m(()=>[n(C,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["class","rows","columns","filter","pagination","row-class"])],2)]),_:1}))}};var Ee=F(re,[["__scopeId","data-v-741e4a18"]]);export{Ee as default};
