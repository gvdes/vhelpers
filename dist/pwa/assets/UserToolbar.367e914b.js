import{u as J,f as Y,r as b,a as i,c as u,k as p,d as a,n as c,a7 as s,a1 as v,p as D,h as _,i as t,b4 as Q,b5 as $,j as g,a4 as f,b6 as Z,a3 as w,a2 as q,aX as B,aj as aa,Q as N,l as L,ah as ea,a5 as j,a6 as z}from"./index.12f3892e.js";import{Q as ta,c as sa,a as h}from"./QSelect.f2b7a151.js";import{Q as E}from"./QImg.60cba884.js";import{Q as R,a as I,b as C}from"./QList.76900103.js";import{Q as la}from"./QSpace.56cadeb4.js";import{Q as oa}from"./QExpansionItem.c6479fcd.js";import{Q as ra,a as na,C as T}from"./CandyBus.73965bf9.js";import{C as M}from"./ClosePopup.9250a65c.js";import{a as P}from"./auth.9cdf3e31.js";import{u as ia}from"./use-quasar.ad7bddfa.js";const da={class:"col"},ca={key:0,class:"col text-center fs-inc1 text-primary fw-sbold"},ua={class:"text-center fs-inc1 text-primary fw-sbold"},pa={class:"row"},va={class:"row q-gutter-md justify-center q-pa-md"},ma=["onClick"],Va={__name:"UserToolbar",setup(ga){const o=J(),m=o.session,V=Y(),A=b({state:!1}),F=()=>{o.sessionDestroy(),V.replace("/auth")},r=ia();b([]);const x=b(!1),k=b({val:o.session,opts:[]}),n=b({val:null,state:!1,opts:["avatar0.png","avatar1.png","avatar2.png","avatar3.png","avatar4.png","avatar5.png","avatar6.png","avatar7.png","avatar8.png","avatar9.png","avatar10.png","avatar11.png","avatar12.png","avatar13.png","avatar14.png","avatar15.png","avatar16.png","avatar17.png","avatar18.png","avatar19.png","avatar20.png","avatar21.gif","avatar22.png","avatar23.png","avatar24.png","avatar25.png","avatar26.png","avatar27.png"]}),K=async()=>{const d=await P.getResources(m.credentials.id);d.fail?console.log(d):(console.log(d),o.setModules(d.grouped_modules),o.setStores(d.stores),o.modulesLoaded=!0)},O=()=>{r.loading.show({message:"Cambiando sucursal"}),o.session.store=k.value.val.store,o.setSession({...o.session,store:k.value.val.store}),console.log(o.session),window.location.reload(),r.loading.hide()},U=localStorage.getItem("mode");U&&r.dark.set(U==="dark");const W=()=>{r.dark.toggle(),localStorage.setItem("mode",r.dark.isActive?"dark":"light")},X=d=>{n.value.val=d},G=async()=>{r.loading.show({message:"Cambiando Avatar :)"});let d={id:o.session.credentials.id,avatar:n.value.val};const e=await P.changeAvatar(d);e.fail?(console.log(e),T.emit("error","algo salio mal")):(console.log(e),o.setSession({...o.session,credentials:{...o.session.credentials,avatar:n.value.val}}),T.emit("error","algo salio bien"),n.value.val=null,n.value.state=!1,r.notify({type:"positive",icon:"check"}),r.loading.hide())};return K(),(d,e)=>(i(),u(w,null,[p("div",{class:Q(["q-pa-sm row items-center",s(r).dark.isActive?"text-white bg-dark":"text-dark bg-white"])},[a(c,{color:"primary",icon:"list",flat:"",dense:"",class:"q-mr-sm",onClick:e[0]||(e[0]=l=>x.value=!x.value)}),p("div",da,[a(c,{class:"text-pink",flat:"",label:s(m).credentials.nick,onClick:e[1]||(e[1]=l=>s(V).push("/"))},null,8,["label"])]),s(o).stores.length==0?(i(),u("div",ca,v(s(m).store.name),1)):D("",!0),s(o).stores.length>1?(i(),_(ta,{key:1,modelValue:k.value.val,"onUpdate:modelValue":[e[2]||(e[2]=l=>k.value.val=l),O],options:s(o).stores,"option-label":l=>l.store.name,borderless:"",color:"primary",dense:"",class:"text-center","options-selected-class":"text-primary text-bold"},{selected:t(()=>[p("div",ua,v(k.value.val.store.name),1)]),_:1},8,["modelValue","options","option-label"])):D("",!0),e[10]||(e[10]=p("div",{class:"col text-right"},null,-1))],2),a(na,{modelValue:x.value,"onUpdate:modelValue":e[7]||(e[7]=l=>x.value=l),width:300,breakpoint:500,bordered:"",class:Q(s(r).dark.isActive?"bg-grey-9":"bg-grey-3")},{default:t(()=>[a(ra,{class:"fit text-bold text-dark"},{default:t(()=>[a(R,null,{default:t(()=>[a(I,null,{default:t(()=>[a(c,{round:"",flat:"",class:"q-mr-md"},{default:t(()=>[a($,{size:"40px"},{default:t(()=>[a(E,{src:`/avatares/${s(o).session.credentials.avatar}`},null,8,["src"])]),_:1}),a(sa,{anchor:"bottom right",self:"top right"},{default:t(()=>[a(R,{style:{"min-width":"180px"}},{default:t(()=>[a(I,{clickable:"",onClick:e[3]||(e[3]=()=>{n.value.state=!n.value.state,n.value.val=s(o).session.credentials.avatar})},{default:t(()=>[a(C,null,{default:t(()=>e[11]||(e[11]=[g("Cambiar Avatar")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(C,null,{default:t(()=>[a(h,null,{default:t(()=>[g(v(s(m).credentials.staff.complete_name),1)]),_:1}),a(h,{caption:""},{default:t(()=>[g(v(s(m).store.alias)+" ",1),a(la),g(" ("+v(s(m).credentials.nick)+")",1)]),_:1})]),_:1})]),_:1}),a(f),p("div",pa,[a(c,{color:"primary",icon:"home",flat:"",dense:"",class:"col",onClick:e[4]||(e[4]=l=>s(V).push("/"))}),a(f,{spaced:"",inset:"",vertical:"",dark:""}),a(c,{class:"col",color:"pink",icon:"logout","no-caps":"",flat:"",onClick:e[5]||(e[5]=l=>A.value.state=!0)}),a(f,{spaced:"",inset:"",vertical:"",dark:""}),a(Z,{modelValue:s(r).dark.mode,"onUpdate:modelValue":[e[6]||(e[6]=l=>s(r).dark.mode=l),W],color:"primary",icon:s(r).dark.mode?"light_mode":"dark_mode","keep-color":"",class:"col text-center"},null,8,["modelValue","icon"])]),a(f),a(f,{spaced:"",inset:"",vertical:"",dark:""}),(i(!0),u(w,null,q(s(o).modules,(l,S)=>(i(),_(oa,{key:S,"expand-separator":"",label:l.name,dark:s(r).dark.isActive,"header-class":s(r).dark.isActive?"text-white":"text-dark"},{default:t(()=>[(i(!0),u(w,null,q(l.modules,(y,H)=>(i(),u("div",{key:H},[B((i(),_(I,{clickable:"",to:`/${y.path}`,dark:s(r).dark.isActive},{default:t(()=>[a(C,null,{default:t(()=>[a(h,{class:Q(s(r).dark.isActive?"text-white":"text-dark")},{default:t(()=>[g(v(y.name),1)]),_:2},1032,["class"]),a(h,{caption:"",class:Q(s(r).dark.isActive?"text-grey-4":"text-grey-7")},{default:t(()=>[g(v(y.desc),1)]),_:2},1032,["class"])]),_:2},1024),a(C,{avatar:""},{default:t(()=>[a($,{flat:"",color:"transparent","text-color":(s(r).dark.isActive,"primary"),icon:"arrow_forward"},null,8,["text-color"])]),_:1})]),_:2},1032,["to","dark"])),[[aa]]),a(f,{dark:s(r).dark.isActive},null,8,["dark"])]))),128))]),_:2},1032,["label","dark","header-class"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue","class"]),a(z,{modelValue:n.value.state,"onUpdate:modelValue":e[8]||(e[8]=l=>n.value.state=l),persistent:""},{default:t(()=>[a(N,null,{default:t(()=>[a(L,null,{default:t(()=>[p("div",va,[(i(!0),u(w,null,q(n.value.opts,(l,S)=>(i(),u("div",{key:S,class:"relative-position",style:{width:"100px",height:"100px",cursor:"pointer"},onClick:y=>X(l)},[a(E,{src:`/avatares/${l}`,alt:l,style:{width:"100px",height:"100px"},class:"rounded-borders"},null,8,["src","alt"]),n.value.val===l?(i(),_(ea,{key:0,name:"check_circle",color:"",size:"sm",class:"absolute-bottom-right q-mt-sm q-mr-sm"})):D("",!0)],8,ma))),128))])]),_:1}),a(j,null,{default:t(()=>[a(c,{flat:"",label:"OK",onClick:G,color:"positive"}),B(a(c,{flat:"",label:"Cancelar",color:"negative"},null,512),[[M]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:A.value.state,"onUpdate:modelValue":e[9]||(e[9]=l=>A.value.state=l),persistent:""},{default:t(()=>[a(N,null,{default:t(()=>[a(L,{class:"row items-center"},{default:t(()=>[a($,{icon:"logout",color:"primary","text-color":"white"}),e[12]||(e[12]=p("span",{class:"q-ml-sm"},"Estas por cerrar sesion",-1))]),_:1}),a(j,{align:"right"},{default:t(()=>[B(a(c,{flat:"",label:"Nope!",color:"primary"},null,512),[[M]]),a(c,{flat:"",label:"Simon!",color:"primary",onClick:F})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{Va as _};
