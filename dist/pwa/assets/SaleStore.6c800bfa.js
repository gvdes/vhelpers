import{br as Z,a as X,u as j,r as S,c as $,bs as ee,o as k,d as w,w as l,e,ab as b,g as s,a1 as R,k as C,j as A,W as o,Q as g,f as r,aa as te,h as le,ad as d,a0 as P,a_ as ae,i as I,af as se,Y as oe,Z as K,_ as O}from"./index.02e98f23.js";import{Q as de}from"./QHeader.8a0807d4.js";import{Q as re,a as c}from"./QSelect.53941b07.js";import{Q as ne}from"./QToolbar.8b422708.js";import{Q as ie}from"./QBadge.ff79e128.js";import{Q as ue}from"./QLinearProgress.aa0b5254.js";import{Q as D,a as V,b as m}from"./QList.87ca2251.js";import{a as ce}from"./QExpansionItem.3c424fa7.js";import{Q as me}from"./QTable.6c1ae328.js";import{Q as ve,a as fe}from"./QLayout.035d2614.js";import"./auto.f3db4540.js";import{u as xe}from"./use-quasar.dc53eb3e.js";import"./dayjs.min.cbcf888d.js";import{E as be}from"./exceljs.min.9e24d01d.js";import{_ as _e}from"./UserToolbar.27610a49.js";import{A as q}from"./assistApi.311d6b8f.js";import"./QResizeObserver.04e1b2fd.js";import"./QScrollObserver.beba53c5.js";import"./_commonjsHelpers.88e99c8f.js";import"./QDrawer.eb1e7cb5.js";import"./ClosePopup.5123f35e.js";import"./auth.b5328b31.js";import"./axios.87cc1b88.js";const pe={class:"row"},ke={class:"text-bold text-h6 q-ml-md"},ge={class:"text-h4 text-center"},we={class:"text-h4 text-center"},ye={class:"text-h4 text-center"},Ne={class:"text-h4 text-center"},he={class:"text-h4 text-center"},Fe={class:"text-h4 text-center"},Te={class:"text-h4 text-center"},$e={class:"text-h4 text-center"},Ce={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition"},Ve={class:"text-bold"},Ee={class:"text-overline"},Qe={class:"q-pa-sm flex justify-start"},Se={class:"absolute-full flex flex-center"},Re={key:0,class:""},De={class:"text-h6"},Ae={class:"text-subtitle2"},Ie={class:"text-h5 text-center"},Be={class:"text-h5 text-center"},Le={class:"text-h5 text-center"},He={class:"text-h5 text-center"},Pe={class:"text-h5 text-center"},Ke={class:"text-h5 text-center"},Oe={class:"text-h5 text-center"},qe={class:"text-h5 text-center"},Ue={class:"text-h5 text-center"},Ye={class:"text-h5 text-center"},bt={__name:"SaleStore",setup(ze){const N=xe();Z(),X(),j();const _=S([]),E=S({pagination:{rowsPerPage:0},filter:""}),i=S({state:!1,val:null}),h=S({val:null}),B=[{id:1,label:"Enero"},{id:2,label:"Febrero"},{id:3,label:"Marzo"},{id:4,label:"Abril"},{id:5,label:"Mayo"},{id:6,label:"Junio"},{id:7,label:"Julio"},{id:8,label:"Agosto"},{id:9,label:"Septiembre"},{id:10,label:"Octubre"},{id:11,label:"Noviembre"},{id:12,label:"Diciembre"}],F=$(()=>N.platform.is.mobile),U=$(()=>Number(_.value.reduce((v,t)=>{var f;return v+Number(((f=t.sales)==null?void 0:f.salesant)*1.1||0)},0)).toFixed(2)),Y=$(()=>Number(_.value.reduce((v,t)=>{var f;return v+Number(((f=t.sales)==null?void 0:f.salesact)||0)},0)).toFixed(2)),z=$(()=>Number(_.value.reduce((v,t)=>{var f,a;return v+Number(((f=t.sales)==null?void 0:f.salesact)-((a=t.sales)==null?void 0:a.salesant)*1.1||0)},0)).toFixed(2)),L=$(()=>Number(_.value.reduce((v,t)=>{var f;return v+Number(((f=t.sales)==null?void 0:f.saleshoy)||0)},0)).toFixed(2)),H=async()=>{const t=new Date().getMonth()+1;h.value.val=B.filter(a=>a.id===t)[0],N.loading.show({message:"Cargando Informacion"}),console.log("se inicia el init");const f=await q.GetReportVhelp(t);f.error?console.log(f):(console.log(f),_.value=f,N.loading.hide())};H();const M=async()=>{_.value=[],N.loading.show({message:"Obteniendo Datos"});const v=await q.GetReportVhelp(h.value.val.id);v.error?console.log(v):(console.log(v),_.value=v,N.loading.hide())},J=v=>{i.value.state=!0,i.value.val=v,console.log(v)},W=async()=>{const v=new be.Workbook,t=v.addWorksheet("Venta");console.log(),t.addTable({name:"Venta",ref:"A1",headerRow:!0,totalsRow:!0,style:{showRowStripes:!0},columns:[{name:"Sucursal",filterButton:!0},{name:"Total",filterButton:!0,totalsRowFunction:"sum"},{name:"Tickets",filterButton:!0,totalsRowFunction:"sum"}],rows:_.value.map(u=>{var p,y;return[u.name,Number((p=u.sales)==null?void 0:p.saleshoy),Number((y=u.sales)==null?void 0:y.hoytck)]})}),t.columns.forEach(u=>{let p=0;u.eachCell({includeEmpty:!0},y=>{const Q=y.value?y.value.toString().length:10;Q>p&&(p=Q)}),u.width=p<10?10:p}),t.getRow(1).eachCell(u=>{u.font={bold:!0}});const f=2,a=_.value.length+2;for(let u=f;u<a;u++)t.getRow(u).eachCell(p=>{p.font={bold:!0}});t.getRow(a).eachCell(u=>{u.font={size:12,bold:!0},u.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFF00"}}});const n=2;t.getColumn(n).numFmt='"$"#,##0.00',t.getCell(`B${a}`).numFmt='"$"#,##0.00',(async()=>{const p=new Date().toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}),y=await v.xlsx.writeBuffer(),Q=new Blob([y],{type:"application/octet-stream"}),G=URL.createObjectURL(Q),T=document.createElement("a");T.href=G,T.download=`Ventas${p}.xlsx`,document.body.appendChild(T),T.click(),document.body.removeChild(T)})()};return(v,t)=>{const f=ee("router-view");return k(),w(ve,{view:"hHh Lpr fFf"},{default:l(()=>[e(fe,{class:"q-ml-md"},{default:l(()=>[e(de,{class:"bg-grey-3 text-dark",bordered:""},{default:l(()=>[e(_e),e(b)]),_:1}),e(ne,{class:"justify-between"},{default:l(()=>[s("div",null,[t[3]||(t[3]=s("span",{class:"text-grey"},"Helpers",-1)),e(R,{name:"navigate_next",color:"primary"}),t[4]||(t[4]=s("span",{class:"text-h6"},"Ventas Sucursales",-1))]),s("div",pe,[F.value?C("",!0):(k(),w(re,{key:0,modelValue:h.value.val,"onUpdate:modelValue":[t[0]||(t[0]=a=>h.value.val=a),M],options:B,label:"mes",outlined:"",dense:""},null,8,["modelValue"])),e(A,{dense:"",flat:"",color:"primary",icon:"autorenew",onClick:H})])]),_:1}),e(b,{spaced:"",inset:"",vertical:"",dark:""}),s("div",ke,o(h.value.val.label),1),e(b,{spaced:"",inset:"",vertical:"",dark:""}),s("div",{class:te(F.value?"":"row")},[F.value?C("",!0):(k(),w(g,{key:0,class:"my-card col",bordered:"",dense:""},{default:l(()=>[e(r,null,{default:l(()=>[t[5]||(t[5]=s("div",{class:"text-h6 text-center"},"Ventas 2024",-1)),s("div",ge,o(U.value.replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[6]||(t[6]=s("div",{class:"text-h6 text-center"},"Tickets 2024",-1)),s("div",we,o(Number(_.value.reduce((a,n)=>{var x;return a+Number(((x=n.sales)==null?void 0:x.tiketsant)||0)},0)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1})),e(b,{spaced:"",inset:"",vertical:"",dark:""}),F.value?C("",!0):(k(),w(g,{key:1,class:"my-card col",bordered:"",dense:""},{default:l(()=>[e(r,null,{default:l(()=>[t[7]||(t[7]=s("div",{class:"text-h6 text-center"},"Ventas 2025",-1)),s("div",ye,o(Y.value.replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[8]||(t[8]=s("div",{class:"text-h6 text-center"},"Tickets 2025",-1)),s("div",Ne,o(Number(_.value.reduce((a,n)=>{var x;return a+Number(((x=n.sales)==null?void 0:x.tiketsact)||0)},0)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1})),e(b,{spaced:"",inset:"",vertical:"",dark:""}),F.value?C("",!0):(k(),w(g,{key:2,class:"my-card col",bordered:"",dense:""},{default:l(()=>[e(r,null,{default:l(()=>[t[9]||(t[9]=s("div",{class:"text-h6 text-center"},"Diferencia",-1)),s("div",he,o(z.value.replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[10]||(t[10]=s("div",{class:"text-h6 text-center"},"Diferencia Tickets",-1)),s("div",Fe,o(Number(_.value.reduce((a,n)=>{var x,u;return a+Number(((x=n.sales)==null?void 0:x.tiketsact)-((u=n.sales)==null?void 0:u.tiketsant)||0)},0)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1})),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(g,{class:"my-card col",bordered:"",dense:""},{default:l(()=>[e(r,null,{default:l(()=>[t[11]||(t[11]=s("div",{class:"text-h6 text-center"},"VENTAS HOY",-1)),s("div",Te,o(L.value.replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[12]||(t[12]=s("div",{class:"text-h6 text-center"},"Tickets HOY",-1)),s("div",$e,o(_.value.reduce((a,n)=>{var x;return a+Number(((x=n.sales)==null?void 0:x.hoytck)||0)},0)),1)]),_:1})]),_:1})],2),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(me,{title:"Sucursales",rows:_.value.sort((a,n)=>{var x,u;return((x=n.sales)==null?void 0:x.saleshoy)-((u=a.sales)==null?void 0:u.saleshoy)}),"row-key":"id",pagination:E.value.pagination,filter:E.value.filter,"hide-header":""},{"top-right":l(()=>[e(le,{borderless:"",dense:"",debounce:"300",modelValue:E.value.filter,"onUpdate:modelValue":t[1]||(t[1]=a=>E.value.filter=a),placeholder:"Buscar"},{append:l(()=>[e(R,{name:"search"})]),_:1},8,["modelValue"]),e(A,{color:"primary",icon:"ios_share",flat:"",onClick:W})]),body:l(a=>[s("div",Ce,[e(D,{bordered:"",dense:""},{default:l(()=>[e(V,null,{default:l(()=>[e(m,null,{default:l(()=>[e(c,{class:"flex justify-between"},{default:l(()=>{var n;return[s("div",Ve,o(a.row.name),1),s("div",Ee,[d(o(`Tickets ${(n=a.row.sales)==null?void 0:n.hoytck}`)+" ",1),e(A,{color:"grey",flat:"",dense:"",icon:a.expand?"keyboard_arrow_up":"keyboard_arrow_down",onClick:x=>a.expand=!a.expand},null,8,["icon","onClick"])])]}),_:2},1024),e(c,null,{default:l(()=>{var n;return[s("div",Qe,[e(ue,{value:Number((n=a.row.sales)==null?void 0:n.saleshoy)/Number(L.value),buffer:1,size:"20px"},{default:l(()=>{var x;return[s("div",Se,[e(ie,{color:"white","text-color":"accent",label:`$ ${Number((x=a.row.sales)==null?void 0:x.saleshoy).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")}`},null,8,["label"])])]}),_:2},1032,["value"])])]}),_:2},1024)]),_:2},1024)]),_:2},1024),e(ce,null,{default:l(()=>[a.row.sales?P((k(),I("div",Re,[e(b),P((k(),w(V,{class:"text-center",dense:"",clickable:"",onClick:n=>J(a.row)},{default:l(()=>[e(m,null,{default:l(()=>[e(c,{overline:""},{default:l(()=>t[13]||(t[13]=[d("VENTAS 2024")])),_:1}),e(c,{caption:""},{default:l(()=>[d(o(Number(a.row.sales.salesant*1.1).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(c,{overline:""},{default:l(()=>t[14]||(t[14]=[d("TICKETS 2024")])),_:1}),e(c,{caption:""},{default:l(()=>[d(o(a.row.sales.tiketsant),1)]),_:2},1024)]),_:2},1024),e(m,null,{default:l(()=>[e(c,{overline:""},{default:l(()=>t[15]||(t[15]=[d("Promedio 2024")])),_:1}),e(c,{caption:""},{default:l(()=>[d(o(Number(Number(a.row.sales.salesant*1.1)/Number(a.row.sales.tiketsant)).toFixed(2)),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""})]),_:2},1024),e(m,null,{default:l(()=>[e(c,{overline:""},{default:l(()=>t[16]||(t[16]=[d("VENTAS 2025")])),_:1}),e(c,{caption:""},{default:l(()=>[d(o(Number(a.row.sales.salesact).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(c,{overline:""},{default:l(()=>t[17]||(t[17]=[d("TICKETS 2025")])),_:1}),e(c,{caption:""},{default:l(()=>[d(o(a.row.sales.tiketsact),1)]),_:2},1024)]),_:2},1024),e(m,null,{default:l(()=>[e(c,{overline:""},{default:l(()=>t[18]||(t[18]=[d("Promedio 2025 ")])),_:1}),e(c,{caption:""},{default:l(()=>[d(o(Number(Number(a.row.sales.salesact)/Number(a.row.sales.tiketsact)).toFixed(2)),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""})]),_:2},1024),e(m,null,{default:l(()=>[e(c,{overline:""},{default:l(()=>t[19]||(t[19]=[d("DIFERENCIA")])),_:1}),e(c,{caption:""},{default:l(()=>[d(o((Number(a.row.sales.salesact).toFixed(2)-Number(a.row.sales.salesant*1.1).toFixed(2)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(c,{overline:""},{default:l(()=>t[20]||(t[20]=[d("DIFERENCIA TICKETS")])),_:1}),e(c,{caption:""},{default:l(()=>[d(o(a.row.sales.tiketsact-a.row.sales.tiketsant),1)]),_:2},1024)]),_:2},1024),e(m,null,{default:l(()=>[e(c,{overline:""},{default:l(()=>t[21]||(t[21]=[d("VENTA HOY ")])),_:1}),e(c,{caption:""},{default:l(()=>[d(o(Number(a.row.sales.saleshoy).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(c,{overline:""},{default:l(()=>t[22]||(t[22]=[d("TICKETS HOY")])),_:1}),e(c,{caption:""},{default:l(()=>[d(o(a.row.sales.hoytck),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[se]])],512)),[[ae,a.expand]]):C("",!0)]),_:2},1024)]),_:2},1024),e(b,{spaced:"",inset:"",vertical:"",dark:""})])]),_:1},8,["rows","pagination","filter"]),e(oe,{modelValue:i.value.state,"onUpdate:modelValue":t[2]||(t[2]=a=>i.value.state=a),"full-width":""},{default:l(()=>[e(g,{class:"my-card"},{default:l(()=>[e(r,null,{default:l(()=>[s("div",De,o(i.value.val.name),1),s("div",Ae,o(i.value.val.alias),1)]),_:1}),e(r,{class:"row"},{default:l(()=>[e(g,{class:"my-card col"},{default:l(()=>[e(r,null,{default:l(()=>[t[23]||(t[23]=s("div",{class:"text-h6 text-center"},"Ventas 2023",-1)),s("div",Ie,o(Number(i.value.val.sales.salesant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[24]||(t[24]=s("div",{class:"text-h6 text-center"},"Tickets 2023",-1)),s("div",Be,o(Number(i.value.val.sales.tiketsant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[25]||(t[25]=s("div",{class:"text-h6 text-center"},"Tickets Promedio 2023",-1)),s("div",Le,o(Number(i.value.val.sales.salesant/i.value.val.sales.tiketsant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1}),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(g,{class:"my-card col"},{default:l(()=>[e(r,null,{default:l(()=>[t[26]||(t[26]=s("div",{class:"text-h6 text-center"},"Ventas 2024",-1)),s("div",He,o(Number(i.value.val.sales.salesact).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[27]||(t[27]=s("div",{class:"text-h6 text-center"},"Tickets 2024",-1)),s("div",Pe,o(Number(i.value.val.sales.tiketsact).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[28]||(t[28]=s("div",{class:"text-h6 text-center"},"Tickets Promedio 2024",-1)),s("div",Ke,o(Number(i.value.val.sales.salesact/i.value.val.sales.tiketsact).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1}),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(g,{class:"my-card col"},{default:l(()=>[e(r,null,{default:l(()=>[t[29]||(t[29]=s("div",{class:"text-h6 text-center"},"Diferencias",-1)),s("div",Oe,o(Number(i.value.val.sales.salesact-i.value.val.sales.salesant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[30]||(t[30]=s("div",{class:"text-h6 text-center"},"Diferencia Tickts",-1)),s("div",qe,o(Number(i.value.val.sales.tiketsact-i.value.val.sales.tiketsant).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1}),e(b,{spaced:"",inset:"",vertical:"",dark:""}),e(g,{class:"my-card col"},{default:l(()=>[e(r,null,{default:l(()=>[t[31]||(t[31]=s("div",{class:"text-h6 text-center"},"Ventas Hoy",-1)),s("div",Ue,o(Number(i.value.val.sales.saleshoy).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1}),e(r,null,{default:l(()=>[t[32]||(t[32]=s("div",{class:"text-h6 text-center"},"Tickets Hoy",-1)),s("div",Ye,o(Number(i.value.val.sales.hoytck).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:1})]),_:1})]),_:1}),e(r,null,{default:l(()=>[e(g,{class:"my-card"},{default:l(()=>[e(r,null,{default:l(()=>[e(D,{bordered:""},{default:l(()=>[e(V,null,{default:l(()=>[e(m,{avatar:""}),e(m,null,{default:l(()=>t[33]||(t[33]=[d("Caja")])),_:1}),e(m,null,{default:l(()=>t[34]||(t[34]=[d("Venta")])),_:1}),e(m,null,{default:l(()=>t[35]||(t[35]=[d("Tickets")])),_:1}),e(m,null,{default:l(()=>t[36]||(t[36]=[d("Promedio")])),_:1})]),_:1})]),_:1})]),_:1}),e(r,null,{default:l(()=>[t[37]||(t[37]=s("div",{class:"text-h6"},"Resumen Dia",-1)),e(D,{bordered:""},{default:l(()=>[(k(!0),I(O,null,K(i.value.val.sales.ventasdepday,(a,n)=>(k(),w(V,{key:n},{default:l(()=>[e(m,{avatar:""},{default:l(()=>[e(R,{color:"primary",name:"point_of_sale"})]),_:1}),e(m,null,{default:l(()=>[d(o(a.DESTER),1)]),_:2},1024),e(m,null,{default:l(()=>[d(o(Number(a.VENTA).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(m,null,{default:l(()=>[d(o(a.TCK),1)]),_:2},1024),e(m,null,{default:l(()=>[d(o(Number(a.VENTA/a.TCK).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(r,null,{default:l(()=>[t[38]||(t[38]=s("div",{class:"text-h6"},"Resumen Mensual",-1)),e(D,{bordered:""},{default:l(()=>[(k(!0),I(O,null,K(i.value.val.sales.ventasdepmonth,(a,n)=>(k(),w(V,{key:n},{default:l(()=>[e(m,{avatar:""},{default:l(()=>[e(R,{color:"primary",name:"point_of_sale"})]),_:1}),e(m,null,{default:l(()=>[d(o(a.DESTER),1)]),_:2},1024),e(m,null,{default:l(()=>[d(o(Number(a.VENTA).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024),e(m,null,{default:l(()=>[d(o(a.TCK),1)]),_:2},1024),e(m,null,{default:l(()=>[d(o(Number(a.VENTA/a.TCK).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(f)]),_:1})]),_:1})}}};export{bt as default};
