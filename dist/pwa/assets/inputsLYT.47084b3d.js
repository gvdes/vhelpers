import{Q as T}from"./QSeparator.33bb701b.js";import{a$ as V,u as k,aE as O,r as n,aW as N,o as d,a as f,w as o,e as a,f as C,a4 as v,Y,_ as B,g as A,a1 as L,a2 as P,Q as m,a3 as x,aY as U,h as $,a5 as D}from"./index.8d4418ba.js";import{Q as H}from"./QToolbar.f5a298b1.js";import{Q as F}from"./QHeader.89a7245c.js";import{Q as R,a as _}from"./QTr.0825e177.js";import{Q as g}from"./QTable.e93a3685.js";import{Q as M,a as j}from"./QLayout.e8e3128b.js";import{u as z,Q as W,a as b}from"./use-quasar.d5e46d85.js";import{Q as G}from"./QSelect.0fcb3fb0.js";import{Q as J}from"./QCardActions.6695afb6.js";import{Q as K}from"./QDialog.83a411f1.js";import{C as X}from"./ClosePopup.0ef2e594.js";import{u as Z}from"./VDB.48cb35ee.js";import{_ as ee}from"./UserToolbar.298a6466.js";import{d as ae}from"./dayjs.min.cbcf888d.js";import{u as oe,r as Q}from"./requisitionApi.b7b001f8.js";import"./QResizeObserver.9289ca1a.js";import"./QList.246dff16.js";import"./QLinearProgress.6541ac03.js";import"./QCheckbox.7b53914b.js";import"./use-key-composition.9c5d58be.js";import"./uid.937d8ee7.js";import"./QItemSection.99563d0e.js";import"./position-engine.0aa96943.js";import"./rtl.276c3f1b.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.ba7b1b0e.js";import"./axios.9ab26c22.js";const te={class:"row items-center"},se={__name:"inputsLYT",setup(le){const w=Z();oe();const S=k();O();const i=z();n(""),n([]);const r=n([]),t=n({state:!1,val:null}),y=n([]),c=n({columnsReq:[{name:"id",label:"ID",field:e=>e.id},{name:"user",label:"USUARIO",field:e=>e.user.complete_name},{name:"status",label:"ESTADO",field:e=>e.status.name},{name:"date",label:"FECHA",field:e=>ae(e.created_at).format("YYYY/MM/DD")},{name:"products",label:"PRODUCTOS",field:e=>e.bodie.length},{name:"notes",label:"NOTAS",field:e=>e.notes}],columns:[{name:"id",label:"ID",field:e=>e.id},{name:"name",label:"NOMBRE",field:e=>e.name},{name:"countRequisition",label:"REQUISISIONES",field:e=>e.requisition_count}],columnsRequired:[{name:"code",label:"CODE",field:e=>e.code},{name:"descripcion",label:"DESCRIPCION",field:e=>e.description},{name:"amount",label:"CANTIDAD",field:e=>e.amount}]}),q=async()=>{i.loading.show({message:"Obteniendo Datos"});const e=await Q.getRequisitionsStore();e.status!==200?console.log(e):(i.loading.hide(),r.value=e.data.stores,y.value=e.data.status,console.log(e.data))},h=(e,s)=>{t.value.state=!0,t.value.val=s,console.log(s)},I=async()=>{i.loading.show({message:"Imprimiendo"});const e=await Q.printReq(t.value.val._stores,t.value.val.id);e.status!=200?console.log(e):(console.log(e),i.loading.hide())},E=async()=>{i.loading.hide({message:"Cambiando Status"});const e=await Q.change(t.value.val._stores,t.value.val.id);e.status!=200?console.log(e):(console.log(e),i.loading.hide(),i.notify({message:"El pedido se cambio de estado",type:"positive",position:"center"}),r.value.forEach(s=>{if(s.id==e.data._stores){let u=s.requisition.findIndex(l=>l.id==e.data.id);u>=0&&(s.requisition[u]=e.data)}}),t.value.val=e.data,t.value.state=!1)};return w.session.rol=="adm"||w.session.rol=="root"?q():(i.notify({message:"No tienes acceso a esta pagina",type:"negative",position:"center"}),S.replace("/")),(e,s)=>{const u=N("router-view");return d(),f(M,{view:"hHh Lpr fFf"},{default:o(()=>[a(F,{class:"transparent text-dark",bordered:""},{default:o(()=>[a(ee),a(T),a(H,{class:"justify-between"},{default:o(()=>[C("div",te,[s[3]||(s[3]=v(" Helpers ")),a(Y,{name:"navigate_next",color:"primary",class:"q-mx-sm"}),a(B,{name:"fade"},{default:o(()=>s[2]||(s[2]=[C("span",{class:"text-h6"},"Pedidos Insumos ",-1)])),_:1})])]),_:1})]),_:1}),a(j,null,{default:o(()=>[r.value.length>0?(d(),f(g,{key:0,title:"Pedidos",rows:r.value,columns:c.value.columns},{body:o(l=>[a(R,{props:l},{default:o(()=>[(d(!0),A(P,null,L(l.cols,p=>(d(),f(_,{key:p.name,props:l},{default:o(()=>[v(D(p.value),1)]),_:2},1032,["props"]))),128)),a(_,{"auto-width":""},{default:o(()=>[a(m,{size:"sm",color:"accent",round:"",dense:"",onClick:p=>l.expand=!l.expand,icon:l.expand?"remove":"add"},null,8,["onClick","icon"])]),_:2},1024)]),_:2},1032,["props"]),x(a(R,{props:l},{default:o(()=>[a(_,{colspan:"100%"},{default:o(()=>[a(g,{rows:l.row.requisition,columns:c.value.columnsReq,onRowClick:h},null,8,["rows","columns"])]),_:2},1024)]),_:2},1032,["props"]),[[U,l.expand]])]),_:1},8,["rows","columns"])):$("",!0),a(u)]),_:1}),a(K,{modelValue:t.value.state,"onUpdate:modelValue":s[1]||(s[1]=l=>t.value.state=l),persistent:""},{default:o(()=>[a(W,{style:{width:"500px"}},{default:o(()=>[a(b,{class:"text-bold text-h6 text-center"},{default:o(()=>[v(" PEDIDO: "+D(t.value.val.id),1)]),_:1}),a(b,null,{default:o(()=>[a(G,{modelValue:t.value.val.status,"onUpdate:modelValue":s[0]||(s[0]=l=>t.value.val.status=l),options:y.value,label:"Estado",filled:"","option-label":"name",disable:""},null,8,["modelValue","options"])]),_:1}),a(b,null,{default:o(()=>[a(g,{rows:t.value.val.bodie,columns:c.value.columnsRequired},null,8,["rows","columns"])]),_:1}),a(J,{align:"right"},{default:o(()=>[x(a(m,{flat:"",icon:"close",color:"primary"},null,512),[[X]]),a(m,{flat:"",icon:"print",color:"primary",onClick:I}),a(m,{flat:"",icon:"send",color:"primary",onClick:E,disable:t.value.val._status>3},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};var Oe=V(se,[["__scopeId","data-v-34bf5ba8"]]);export{Oe as default};
