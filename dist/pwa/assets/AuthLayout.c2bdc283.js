import{Q as A}from"./QToolbarTitle.041aafdb.js";import{Q as N}from"./QToolbar.04979db5.js";import{Q as W}from"./QHeader.14623a66.js";import{_ as O,r as T,o as U,a as P,c as C,u as $,d as D,e as z,w as J,f as j,g as i,h as n,i as x,j as V,Q as G,k as S,l as I,m as X,n as K,P as Y}from"./index.01aad732.js";import{Q as Z}from"./QForm.fce9930c.js";import{Q as ee}from"./QPage.45fc3825.js";import{Q as te}from"./QFooter.9f2893f8.js";import{Q as ae,a as se}from"./QLayout.a7bbe833.js";import{u as oe}from"./use-quasar.00e0b448.js";import{a as le}from"./auth.06336982.js";import"./QResizeObserver.955528d4.js";import"./QScrollObserver.1be2845e.js";import"./axios.60d20557.js";const ne={__name:"animateStudio",setup(E,{expose:u}){const p=T(null);let e,f=0;const o=T("idle");let d=0,m=!1,y=0,h=0,l=0,t=0,r=0,v=0,k=0,w=0,_=0;U(()=>{e=p.value.getContext("2d"),requestAnimationFrame(Q)});const Q=()=>{e.clearRect(0,0,220,170),o.value==="idle"?(h+=.03,l=Math.sin(h)*2):l*=.9,o.value==="idle"&&(y+=.02,y>3&&(m=!0,setTimeout(()=>m=!1,120),y=0)),o.value==="user"?(r=.08,k=4):o.value==="password"?(r=.14,k=7):(r=0,k=0),t+=(r-t)*.08,v+=(k-v)*.08,_+=-w*.15,_*=.7,w+=_,F(),requestAnimationFrame(Q)},F=()=>{e.save(),e.translate(0,l),e.save(),e.translate(110,95+v+w),e.rotate(t),e.translate(-110,-95),M(),B(),H(),e.restore(),e.restore()},M=()=>{e.strokeStyle="#039be5",e.lineWidth=3,e.beginPath(),e.moveTo(110,18),e.lineTo(110,50),e.stroke(),e.beginPath(),e.arc(110,15,5,0,Math.PI*2),e.fillStyle="#039be5",e.fill()},B=()=>{e.fillStyle="#039be5",e.strokeStyle="#000",e.lineWidth=3,e.beginPath(),e.roundRect(30,45,160,100,18),e.fill(),e.stroke(),e.fillStyle="#fff",e.beginPath(),e.roundRect(55,70,110,55,30),e.fill()},H=()=>{if(o.value==="password"||m){R(90,85);return}if(o.value==="error"){q(90,85);return}let c=0;if(o.value==="user"&&(c=d),o.value==="loading"){L(90,85);return}e.fillStyle="#039be5",e.fillRect(90+c,85,8,24),e.fillRect(90+35+c,85,8,24)},L=(a,s)=>{e.strokeStyle="#039be5",e.lineWidth=4,e.lineCap="round";const c=9,g=35,b=s+10;f+=.05,f>Math.PI*2&&(f=0),e.beginPath(),e.arc(a,b,c,f,f+Math.PI*1.5),e.stroke(),e.beginPath(),e.arc(a+g,b,c,f+Math.PI,f+Math.PI*2.5),e.stroke()},R=(a,s)=>{e.strokeStyle="#039be5",e.lineWidth=3,e.lineCap="round";const c=10,g=12,b=35;e.beginPath(),e.moveTo(a,s),e.lineTo(a+c,s+g/2),e.lineTo(a,s+g),e.stroke(),e.beginPath(),e.moveTo(a+b+c,s),e.lineTo(a+b,s+g/2),e.lineTo(a+b+c,s+g),e.stroke()},q=(a,s)=>{e.strokeStyle="red",e.lineWidth=3,e.beginPath(),e.moveTo(a,s),e.lineTo(a+8,s+24),e.moveTo(a+8,s),e.lineTo(a,s+24),e.moveTo(a+34,s),e.lineTo(a+42,s+24),e.moveTo(a+42,s),e.lineTo(a+34,s+24),e.stroke()};return u({setUser:()=>o.value="user",setPassword:()=>o.value="password",setIdle:()=>o.value="idle",setLoading:()=>o.value="loading",setError:()=>{o.value="error",setTimeout(()=>o.value="idle",1200)},setSuccess:()=>{m=!0,setTimeout(()=>m=!1,600)},typing:a=>{d=Math.min(a.length*1.1,10),_-=2}}),(a,s)=>(P(),C("canvas",{ref_key:"canvas",ref:p,width:"260",height:"200",class:"robot-canvas"},null,512))}};var re=O(ne,[["__scopeId","data-v-0b574c58"]]);const ie={key:0,class:"text-center"},Ie={__name:"AuthLayout",setup(E){const u=T(null),p=T(null),e=$(),f=oe(),o=D(),d=T({nick:"",pass:""}),m=z(()=>d.value.nick&&d.value.pass),y=async()=>{console.log("Iniciando sesion ...",d.value),u.value.setLoading();const l=await le.trySignin(d.value);if(l.fail)l.fail.status==404&&(u.value.setError(),f.notify({message:"Credenciales erroneas",color:"negative",icon:"fas fa-bugs"})),console.log(l);else{let t=JSON.parse(JSON.stringify(l));console.log(t),u.value.setSuccess(),Y.set("auth",t),e.setSession(t),o.replace("/")}},h=l=>{l.currentTarget.contains(l.relatedTarget)||(p.value=null)};return J(p,l=>{!u.value||(l==="user"?u.value.setUser():l==="password"?u.value.setPassword():u.value.setIdle())}),(l,t)=>(P(),j(ae,{view:"hHh Lpr fFf"},{default:i(()=>[n(se,null,{default:i(()=>[n(W,{class:"bg-transparent"},{default:i(()=>[n(N,null,{default:i(()=>[n(A,null,{default:i(()=>t[5]||(t[5]=[x(" Accesso ")])),_:1}),t[6]||(t[6]=V("div",{class:"text-primary text-bold"},"VH v.2.0",-1))]),_:1})]),_:1}),n(ee,{padding:"",class:"flex flex-center"},{default:i(()=>[n(G,{flat:"",class:"bg-transparent"},{default:i(()=>[n(S,null,{default:i(()=>[n(S,{class:"q-pb-sm q-pt-sm flex flex-center"},{default:i(()=>[n(re,{ref_key:"robot",ref:u},null,512)]),_:1}),n(S,null,{default:i(()=>[n(Z,{onSubmit:y,class:"q-gutter-lg",onFocusout:h},{default:i(()=>[n(I,{outlined:"",rounded:"",standout:"text-primary",placeholder:"nick","input-class":"fs-inc2 text-center",modelValue:d.value.nick,"onUpdate:modelValue":[t[0]||(t[0]=r=>d.value.nick=r),t[2]||(t[2]=r=>{var v;return(v=u.value)==null?void 0:v.typing(r)})],type:"text",autocapitalize:"off",autocomplete:"off",onFocus:t[1]||(t[1]=r=>p.value="user")},null,8,["modelValue"]),n(I,{outlined:"",rounded:"",placeholder:"nip","input-class":"fs-inc2 text-center",modelValue:d.value.pass,"onUpdate:modelValue":t[3]||(t[3]=r=>d.value.pass=r),type:"password",onFocus:t[4]||(t[4]=r=>p.value="password")},null,8,["modelValue"]),m.value?(P(),C("div",ie,[n(X,{label:"Entrar",rounded:"",outline:"",type:"submit",color:"primary"})])):K("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(te,{class:"text-center text-caption text-grey bg-transparent"},{default:i(()=>t[7]||(t[7]=[x("Grupo Vizcarra 2026")])),_:1}),t[8]||(t[8]=V("div",null,null,-1))]),_:1})]),_:1}))}};export{Ie as default};
