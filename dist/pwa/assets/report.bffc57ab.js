import{b as p,Q as x}from"./QList.8062b860.js";import{aH as y,r as v,o as E,d as I,w as n,f as b,a0 as T,e as o,Q as D,S as F,g as G,a2 as $,a3 as B,a4 as P,aA as H,ak as Y}from"./index.b11a8f4f.js";import{Q as w}from"./QSelect.8809373c.js";import{Q as j}from"./QInput.869a3a41.js";import{Q as R}from"./QTd.a0597356.js";import{Q as S}from"./QTr.250c6f87.js";import{Q as N}from"./QTable.5a6033de.js";import{Q as q}from"./QDate.7820515d.js";import{Q as O}from"./QCardSection.236c077d.js";import{Q as M}from"./QCardActions.a6ffdca0.js";import{Q as z}from"./QCard.8b512e05.js";import{Q as W}from"./QPage.2696f942.js";import{R as k}from"./RestockApi.7f9207cf.js";import{u as J}from"./use-quasar.171e4e67.js";import{u as K}from"./Restock.20101a03.js";import{d as X}from"./dayjs.min.cbcf888d.js";import{E as Z}from"./exceljs.min.9e24d01d.js";import"./use-key-composition.dd58b7c9.js";import"./QLinearProgress.b2c20821.js";import"./QCheckbox.6a26100e.js";import"./use-render-cache.3aae9b27.js";import"./date.a51588c0.js";import"./axios.f56067dd.js";import"./QToolbar.b270ca82.js";import"./QForm.cb9e54b6.js";import"./QRadio.07481197.js";import"./QPopupEdit.52b0ddf4.js";import"./QLayout.ab70e857.js";import"./QScrollObserver.e06eae8f.js";import"./QResizeObserver.314d7e3f.js";import"./ClosePopup.60077ce2.js";import"./QDrawer.e52f0ff6.js";import"./jspdf.plugin.autotable.4f04876d.js";import"./_commonjsHelpers.88e99c8f.js";import"./JsBarcode.cb858474.js";import"./browser.c61f550a.js";/* empty css                                                       */const ee={class:"text-center text-h6 text-bold"},ae={class:"row"},le={class:"q-pa-md"},Be={__name:"report",setup(oe){const g=J();y();const L=K(),r=v({workpoints:[],cedis:null,val:null}),m=v(!1),s=v({from:null,to:null});v({salidas:null,entradas:null});const C=v([]),u=v({columns:[{name:"partition",label:"Particion",field:a=>a.id,sortable:!0,align:"left"},{name:"status",label:"Estado",field:a=>a.status.name,sortable:!0,align:"left"},{name:"invoice",label:"Salida",field:a=>a.invoice,sortable:!0,align:"left"},{name:"invoiceReceived",label:"Entrada",field:a=>a.invoice_received,sortable:!0,align:"left"},{name:"warehouse",label:"Almacen",field:a=>a._warehouse,sortable:!0,align:"left"}],rows:[],filter:"",loading:!1,columnsSub:[{name:"invoice",label:"Salida",field:a=>a.SALIDA_FACTURA,sortable:!0,align:"left"},{name:"code",label:"Codigo",field:a=>a.CODIGO,sortable:!0,align:"left"},{name:"amount",label:"Cantidad",field:a=>a.CANTIDAD,sortable:!0,align:"left"},{name:"codevalid",label:"CodigoI",field:a=>a.codigoIGUAL,sortable:!0,align:"left"},{name:"amountvalid",label:"CantiI",field:a=>a.CANTIDADIGUAL,sortable:!0,align:"left"},{name:"invoicereceived",label:"Entrada",field:a=>a.ENTRADA_FACTURA,sortable:!0,align:"left"},{name:"codereceived",label:"Codigo",field:a=>a.ENTRADA_CODIGO,sortable:!0,align:"left"},{name:"amountreceived",label:"Cantidad",field:a=>a.ENTRADA_CANTIDAD,sortable:!0,align:"left"}]}),_=async()=>{L.setShowLYT(!1);let a=new Date,e=X(a).format("YYYY/MM/DD");s.value={from:e,to:e},console.log(e);const l=await k.getStores();l.status==200?(console.log(l.data),r.value.workpoints=l.data,r.value.cedis=l.data.filter(f=>f.id==1)[0]):console.log(l)},Q=async()=>{u.value.rows=[],u.value.loading=!0,g.loading.show({message:"Obteniendo datos"});let a={cedis:r.value.cedis,sucursal:r.value.val,fechas:s.value};console.log(a);const e=await k.getData(a);console.log(e),e.status==200?(console.log(e.data),C.value=e.data,g.loading.hide(),u.value.loading=!1):alert(e)},h=async()=>{console.log(s.value),m.value=!1,r.value.val=null,u.value.rows=[]},U=async()=>{const a=new Z.Workbook,e=a.addWorksheet("SALIDASVSENTRADAS"),l=["PARTICION","STATUS","SALIDA","ENTRADA","ALMACEN","SALIDA FACTURA","SALIDAFECHA","REFERENCIA","CODIGO","DESCRIPCION","CANTIDAD","CODIGOIGUAL","CANTIDADIGUAL","PRECIOIGUAL","TOTALIGUAL","ENTRADA FACTURA","ENTRADA SALIDA","ENTRADA FECHA","ENTRADA CODIGO","ENTRADA DESCRIPCION","ENTRADA CANTIDAD"];e.addRow(l),e.getColumn(1).width=15,C.value.forEach(i=>{const c=i.comparaciones,A=e.lastRow.number+1;c.forEach(t=>{e.addRow([i.id,i.status.name,i.invoice,i.invoice_received,i._warehouse,t.SALIDA_FACTURA,t.SALIDA_FECHA,t.REFERENCIA,t.CODIGO,t.DESCRIPCION,t.CANTIDAD,t.codigoIGUAL?"VERDADERO":"FALSO",t.CANTIDADIGUAL?"VERDADERO":"FALSO",t.PRECIOIGUAL?"VERDADERO":"FALSO",t.TOTALIGUAL?"VERDADERO":"FALSO",t.ENTRADA_FACTURA,t.ENTRADA_SALIDA,t.ENTRADA_FECHA,t.ENTRADA_CODIGO,t.ENTRADA_DESCRIPCION,t.ENTRADA_CANTIDAD])});const d=e.lastRow.number;["A","B","C","D","E"].forEach(t=>{e.mergeCells(`${t}${A}:${t}${d}`);const V=e.getCell(`${t}${A}`);V.alignment={vertical:"middle",horizontal:"center"}})}),e.columns.forEach(i=>{let c=0;i.eachCell({includeEmpty:!0},A=>{const d=A.value?A.value.toString().length:10;d>c&&(c=d)}),i.width=c<10?10:c}),(async()=>{const i=await a.xlsx.writeBuffer(),c=new Blob([i],{type:"application/octet-stream"}),A=URL.createObjectURL(c),d=document.createElement("a");d.href=A,d.download=`SalidasVSEntradas ${r.value.val.name} ${typeof s.value=="object"?`Del ${s.value.from} a ${s.value.to}`:s.value}.xlsx`,document.body.appendChild(d),d.click(),document.body.removeChild(d)})()};return _(),(a,e)=>(E(),I(W,{padding:""},{default:n(()=>[b("div",ee,"Reporte "+T(s.value&&s.value.from?`Del ${s.value.from} a ${s.value.to}`:s.value),1),o(p,{spaced:"",inset:"",vertical:"",dark:""}),b("div",ae,[o(D,{color:"primary",icon:"event",onClick:e[0]||(e[0]=l=>m.value=!m.value),flat:"",rounded:"",dense:""}),o(p,{spaced:"",inset:"",vertical:"",dark:""}),o(w,{dense:"",modelValue:r.value.cedis,"onUpdate:modelValue":e[1]||(e[1]=l=>r.value.cedis=l),options:r.value.workpoints,label:"Cedis",class:"col","option-label":"name",disable:!0,outlined:""},null,8,["modelValue","options"]),o(p,{spaced:"",inset:"",vertical:"",dark:""}),o(w,{dense:"",modelValue:r.value.val,"onUpdate:modelValue":[e[2]||(e[2]=l=>r.value.val=l),Q],options:r.value.workpoints,label:"Sucursal",class:"col","option-label":"name",outlined:"","option-disable":l=>l.id==1},null,8,["modelValue","options","option-disable"])]),o(p,{spaced:"",inset:"",vertical:"",dark:""}),o(N,{title:"Comparativo",rows:C.value,columns:u.value.columns,filter:u.value.filter},{"top-right":n(()=>[o(j,{borderless:"",dense:"",debounce:"300",modelValue:u.value.filter,"onUpdate:modelValue":e[3]||(e[3]=l=>u.value.filter=l),placeholder:"Buscar"},{append:n(()=>[o(F,{name:"search"})]),_:1},8,["modelValue"]),o(p,{spaced:"",inset:"",vertical:"",dark:""}),o(D,{color:"primary",icon:"ios_share",onClick:U,flat:"",disable:C.value.length<=0},null,8,["disable"])]),body:n(l=>[o(S,{props:l},{default:n(()=>[(E(!0),G(B,null,$(l.cols,f=>(E(),I(R,{key:f.name,props:l},{default:n(()=>[Y(T(f.value),1)]),_:2},1032,["props"]))),128)),o(R,null,{default:n(()=>[o(D,{size:"sm",color:"primary",round:"",dense:"",onClick:f=>l.expand=!l.expand,icon:l.expand?"remove":"add"},null,8,["onClick","icon"])]),_:2},1024)]),_:2},1032,["props"]),P(o(S,{props:l},{default:n(()=>[o(R,{colspan:"50%"},{default:n(()=>[o(N,{rows:l.row.comparaciones,columns:u.value.columnsSub},null,8,["rows","columns"])]),_:2},1024)]),_:2},1032,["props"]),[[H,l.expand]])]),_:1},8,["rows","columns","filter"]),o(x,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=l=>m.value=l)},{default:n(()=>[o(z,{class:"my-card"},{default:n(()=>[o(O,null,{default:n(()=>[b("div",le,[e[7]||(e[7]=b("div",{class:"q-pb-sm"},null,-1)),o(q,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value=l),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),o(O,null,{default:n(()=>[o(M,{align:"right"},{default:n(()=>[o(D,{flat:"",icon:"close",color:"negative",onClick:e[5]||(e[5]=l=>m.value=!m.value)}),o(D,{flat:"",icon:"check",color:"positive",onClick:h})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Be as default};
