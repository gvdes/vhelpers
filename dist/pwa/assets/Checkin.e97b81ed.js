import{Z as x,f as b,u as Q,r as p,g as S,a as f,h as _,i as o,k as l,d as s,m as y,aX as V,j as q,a1 as g,aj as D}from"./index.6772a291.js";import{Q as C}from"./QForm.5265d4cf.js";import{a as k}from"./QSelect.4738e4d7.js";import{Q as $,a as B,b as I}from"./QList.832348b5.js";import{Q as j}from"./QTable.b4dcb871.js";import{Q as P}from"./QPage.a5cb312a.js";import"./dayjs.min.cbcf888d.js";import"./axios.b16d05b9.js";import{o as R}from"./orderApi.0ed34f4c.js";import{u as L}from"./OrderStore.b019d38e.js";import{u as N}from"./use-quasar.e757a0da.js";import"./QImg.087d1b59.js";import"./QSpace.62a5af0f.js";import"./QExpansionItem.5fb7069d.js";import"./favorites.f52709b7.js";import"./ClosePopup.fff889ca.js";import{$sktRestock as m,$sktOrders as O}from"./socket.168d2ba4.js";import"./QLinearProgress.427c6ef3.js";import"./_commonjsHelpers.88e99c8f.js";import"./QResizeObserver.212d10b7.js";import"./QScrollObserver.6bb52127.js";const T={class:"flex justify-center"},E={class:"text-center",style:"width: 50%;"},U={class:"q-pa-xs col-xs-12 col-sm-2 col-sm-1"},A={class:"text-bold q-mr-md"},me={__name:"Checkin",setup(F){x(),b();const a=L();a.setTitle("Checkin"),a.setshowLyt(!0),a.setShowEvent(!1);const d=N(),i=Q(),v={profile:{me:{id:i.session.credentials.staff.id_va,nick:i.session.credentials.nick,picture:"",names:i.session.credentials.staff.complete_name,surname_pat:"",surname_mat:"",change_password:!1,_rol:i.session.credentials._rol},workpoint:i.session.store},workpoint:i.session.store};m.connect(),m.emit("joinat",v);const r=p(null),h=p({rowsPerPage:[0]}),w=S(()=>a.orders.filter(n=>n._status==3)),u=async n=>{d.loading.show({message:"Cambiando Estado"}),a.orders.find(t=>t.id==n);const e=await R.nextStepCheck({id:n});if(e.fail)e.fail.status==404&&(d.loading.hide(),r.value=null,d.notify({message:e.fail.response.data.msg,type:"negative",position:"top"})),console.log(e);else{d.loading.hide(),console.log(e),e.requisition&&(m.emit("creating",{order:e.requisition.requisition}),m.emit("partitionCreate",e.requisition.partition));let c={order:e.order,newstate:e.status};console.log(c),O.emit("order_update",c),a.addOrUpdate(c),r.value=null}};return(n,e)=>(f(),_(P,{padding:""},{default:o(()=>[l("div",null,[l("div",T,[l("div",E,[s(C,{onSubmit:e[1]||(e[1]=t=>u(r.value))},{default:o(()=>[s(y,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),type:"number",label:"Pedido",autofocus:"",rounded:"",outlined:""},null,8,["modelValue"])]),_:1})])]),s(j,{rows:w.value,grid:"",pagination:h.value,"hide-bottom":""},{item:o(t=>[l("div",U,[s($,{bordered:""},{default:o(()=>[V((f(),_(B,{clickable:"",onDblclick:c=>u(t.row.id)},{default:o(()=>[s(I,null,{default:o(()=>[s(k,{class:"text-center text-bold text-h5"},{default:o(()=>[q(g(t.row.id),1)]),_:2},1024),s(k,{class:"text-center text-overline text-caption"},{default:o(()=>[l("span",A,g(t.row.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onDblclick"])),[[D]])]),_:2},1024)])]),_:1},8,["rows","pagination"])])]),_:1}))}};export{me as default};
