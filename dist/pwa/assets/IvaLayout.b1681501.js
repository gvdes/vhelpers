import{Q as T,a as q,b as z}from"./QSelect.c0d32718.js";import{r as f,c as A,I as K,o as c,a as y,w as a,e,a3 as n,a4 as p,f as g,h as x,Q as D,i as l,am as M,an as R,g as B,a1 as G,U as W,W as J}from"./index.fdbc6478.js";import{Q as j}from"./QInput.fd09a5af.js";import{Q as L,u as X}from"./use-quasar.7a70b695.js";import{Q as Y,a as P}from"./axios.f477f88b.js";import{a as Z,_ as ee,Q as ae}from"./UserToolbar.8326c71f.js";import{Q as te,a as Q,b as r,c as E,e as le}from"./QDialog.95ee8c40.js";import{b as N,c as U,Q as se,a as oe,d as ne}from"./QLayout.5fb66f85.js";import{u as ie}from"./VDB.4bbf8d5e.js";const ue={__name:"Ticket",props:{data:{type:Object,default:null}},emits:["openCashDesk"],setup(I,{emit:_}){const m=f(I.data),t=f(null),b=["6%","8%","16%"],s={"6%":.06,"8%":.08,"16%":.16},u=A(()=>{if(t.value&&m.value){let h=s[t.value],o=parseFloat(m.value.total).toFixed(2);return parseFloat((o*h).toFixed(2))}return 0}),$=()=>{_("openCashDesk",{_inc:u.value,_iva:s[t.value]})};return K(()=>{console.log("El componente ha muerto!!")}),(h,o)=>(c(),y(N,{style:{"min-width":"400px"},flat:"",bordered:""},{default:a(()=>[e(te,{bordered:""},{default:a(()=>[e(Q,null,{default:a(()=>[e(r,null,{default:a(()=>[n("Ticket")]),_:1}),e(r,null,{default:a(()=>[n(p(m.value.ticket),1)]),_:1})]),_:1}),e(Q,null,{default:a(()=>[e(r,null,{default:a(()=>[n("Cliente")]),_:1}),e(r,null,{default:a(()=>[n(p(m.value.cliente),1)]),_:1})]),_:1}),e(Q,null,{default:a(()=>[e(r,null,{default:a(()=>[n("Fecha")]),_:1}),e(r,null,{default:a(()=>[n(p(m.value.fecha),1)]),_:1})]),_:1}),e(Q,null,{default:a(()=>[e(r,null,{default:a(()=>[n("Total")]),_:1}),e(r,null,{default:a(()=>[n("$ "+p(m.value.total),1)]),_:1})]),_:1}),e(T),e(Q,{class:"bg-deep-purple-1"},{default:a(()=>[e(r,null,{default:a(()=>[n("IVA")]),_:1}),e(r,null,{default:a(()=>[e(q,{dense:"",modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=i=>t.value=i),options:b,label:"Seleccione",filled:"",autofocus:""},null,8,["modelValue"])]),_:1})]),_:1}),g(u)?(c(),y(Q,{key:0,class:"bg-deep-purple-1"},{default:a(()=>[e(r,null,{default:a(()=>[n("Total")]),_:1}),e(r,null,{default:a(()=>[e(E,{class:"fc-bluegrey text-h4 fw-sbold"},{default:a(()=>[n("$ "+p(g(u)),1)]),_:1}),e(E,{caption:""},{default:a(()=>[n("$ "+p((parseFloat(m.value.total)+parseFloat(g(u))).toFixed(2)),1)]),_:1})]),_:1})]),_:1})):x("",!0)]),_:1}),t.value?(c(),y(Z,{key:0,align:"between"},{default:a(()=>[e(D,{color:"primary",label:"Cancelar",flat:"","no-caps":""}),e(D,{color:"primary",label:"Cobrar",onClick:$})]),_:1})):x("",!0)]),_:1}))}},de={class:"bg-primary row items-center justify-between q-pa-md text-white"},re=l("div",{class:"fs-dec3"},"TICKET",-1),ce={class:"text-h4"},pe={class:"text-right"},me=l("div",{class:"fs-dec3"},"IVA",-1),fe={class:"fw-bold text-h4"},ve={class:"row items-center"},_e=l("div",{class:"col-3"},"Efectivo",-1),be={class:"row"},ye={class:"bg-grey-2 row items-stretch justify-between q-pa-sm"},ge=l("div",{class:"fs-dec1"},"Cambio:",-1),he={class:"text-h5 fw-sbold fc-primary"},ke=l("div",{class:"fs-dec1"},"Falta:",-1),Ve={class:"text-h6 fs-inc3 fw-bold fc-negative"},xe={__name:"CashDesk",props:{data:{type:Object,default:null},inc:{type:Number,default:0}},emits:["pay"],setup(I,{emit:_}){const v=I,m=[{id:"TBA",desc:"Tarjeta Credito/Debito BBVA (Bancomer)"},{id:"TDB",desc:"Transferencia/Deposito BBVA (Bancomer)"},{id:"TSA",desc:"Tarjeta Credito/Debito Santander"},{id:"TDA",desc:"Transferencia/Deposito Santander"},{id:"TSC",desc:"Tarjeta Credito/Debito Scotiabank"},{id:"TDS",desc:"Transferencia/Deposito Scotiabank"}],t=f({EFE:0,DIG:{id:null,val:0}}),b=f(v.data),s=f(v.inc),u=A(()=>(parseFloat(t.value.EFE)+parseFloat(t.value.DIG.val)).toFixed(2)),$=()=>{_("pay",t.value)};return(h,o)=>b.value?(c(),y(N,{key:0},{default:a(()=>[l("div",de,[l("div",null,[re,l("div",ce,p(b.value.ticket),1)]),l("div",pe,[me,l("div",fe,"$ "+p(s.value),1)])]),e(L,{class:"q-pa-none",onSubmit:$},{default:a(()=>[e(U,null,{default:a(()=>[l("div",ve,[_e,e(j,{class:"col",modelValue:t.value.EFE,"onUpdate:modelValue":o[0]||(o[0]=i=>t.value.EFE=i),type:"number",autofocus:"",min:0,step:"any",dense:"","input-class":"q-pl-md fw-sbold fs-inc4"},null,8,["modelValue","min"]),parseFloat(t.value.EFE)?(c(),y(D,{key:0,color:"primary",icon:"backspace",flat:"",dense:"",round:"",onClick:o[1]||(o[1]=i=>t.value.EFE=0)})):x("",!0)])]),_:1}),e(U,null,{default:a(()=>[l("div",be,[e(q,{class:"col-3",modelValue:t.value.DIG.id,"onUpdate:modelValue":o[2]||(o[2]=i=>t.value.DIG.id=i),options:m,label:"Terminal","option-value":"id","emit-value":"","option-label":"id",dense:""},{option:a(i=>[e(Q,M(R(i.itemProps)),{default:a(()=>[e(r,null,{default:a(()=>[e(E,{class:"text-bold"},{default:a(()=>[n(p(i.opt.id),1)]),_:2},1024),e(E,{caption:""},{default:a(()=>[n(p(i.opt.desc),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"]),e(j,{class:"col",modelValue:t.value.DIG.val,"onUpdate:modelValue":o[3]||(o[3]=i=>t.value.DIG.val=i),type:"number",min:0,step:"any",dense:"","input-class":"q-pl-md fw-sbold fs-inc4"},null,8,["modelValue","min"]),parseFloat(t.value.DIG.val)?(c(),y(D,{key:0,color:"primary",icon:"backspace",flat:"",dense:"",round:"",onClick:o[4]||(o[4]=i=>{t.value.DIG.val=0,t.value.DIG.id=null})})):x("",!0)])]),_:1}),e(T),l("div",ye,[l("div",null,[g(u)>=s.value?(c(),B(G,{key:0},[ge,l("div",he,"$ "+p((g(u)-s.value).toFixed(2)),1)],64)):(c(),B(G,{key:1},[ke,l("div",Ve,"$ "+p((s.value-g(u)).toFixed(2)),1)],64))]),l("div",null,[g(u)>=s.value?(c(),y(D,{key:0,color:"positive",icon:"fas fa-dollar-sign",label:"Pagar",type:"submit",class:"full-height"})):x("",!0)])])]),_:1})]),_:1})):x("",!0)}};const Fe=l("span",{class:"text-h6"},"IVA",-1),Qe=l("div",{class:"q-pa-md bg-grey-2 text-primary"},"Buscar Folio",-1),De={key:0,class:"text-right"},$e={class:"row justify-center"},Ae={__name:"IvaLayout",setup(I){const _=ie(),v=X(),m=_.series,t=f(null),b=f(""),s=f(null),u=f(0),$=f(0),h=f({state:!1}),o=A(()=>t.value&&b.value.length),i=async()=>{s.value=null,u.value=0;let F=t.value,d=b.value,S=`http://${_.session.store.ip}/access/public/iva/ticket?serie=${F}&folio=${d}`;P.get(S).then(V=>{s.value=V.data}).catch(V=>{console.log(V);let C=V.response.status,w=V.response.data;console.log(C),console.log(w),v.notify({html:!0,message:w.message,color:"negative",position:"center"})})},H=({_inc:F,_iva:d})=>{console.log(F,d),u.value=parseFloat(F),$.value=parseFloat(d),h.value.state=!0},O=F=>{console.log("pagando...");let d=_.session.store.ip,k=`${_.session.name} - ${_.session.store.alias}`,S=`http://${d}/access/public/iva/create`,V={modes:F,by:k,ticket:s.value.ticket,iva:$.value};v.loading.show({message:"Imprimiendo..."}),console.log(V),P.post(S,V).then(C=>{console.log(C.data);let w=C.data;v.loading.hide(),h.value.state=!1,s.iva=null,s.value=null,v.notify({html:!0,color:"positive",position:"center",message:`<span class="fs-inc2"> El ticket <b>${w.ticket}</b> fue generado! </span>`}),w.printed||v.notify({html:!0,color:"negative",position:"top",icon:"fas fa-bugs",message:'<span class="fs-inc2"> No se pudo emitir el ticket, la conexion a la impresora no esta disponible! </span>'})}).catch(C=>{console.log(C),v.loading.hide()})};return(F,d)=>(c(),y(se,{view:"hHh Lpr fFf"},{default:a(()=>[e(ae,{class:"transparent text-dark",bordered:""},{default:a(()=>[e(ee),e(T),e(Y,{class:"justify-between"},{default:a(()=>[l("div",null,[n("Helpers "),e(W,{name:"navigate_next",color:"primary"}),n(),Fe]),e(D,{color:"primary",icon:"add"},{default:a(()=>[e(z,null,{default:a(()=>[Qe,e(T),e(L,{dense:"",onSubmit:i,class:"q-gutter-md q-pa-md"},{default:a(()=>[e(q,{modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=k=>t.value=k),options:g(m),label:"Serie",autofocus:""},null,8,["modelValue","options"]),e(j,{modelValue:b.value,"onUpdate:modelValue":d[1]||(d[1]=k=>b.value=k),type:"number",label:"Folio"},null,8,["modelValue"]),g(o)?(c(),B("div",De,[e(D,{type:"submit",color:"primary",icon:"search"})])):x("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(ne,null,{default:a(()=>[e(oe,{class:"bg-grey-3",padding:""},{default:a(()=>[l("div",$e,[e(J,{name:"bounce"},{default:a(()=>[s.value?(c(),y(ue,{key:0,data:s.value,onOpenCashDesk:H},null,8,["data"])):x("",!0)]),_:1})]),e(le,{modelValue:h.value.state,"onUpdate:modelValue":d[2]||(d[2]=k=>h.value.state=k)},{default:a(()=>[e(xe,{data:s.value,inc:u.value,onPay:O},null,8,["data","inc"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}};export{Ae as default};
