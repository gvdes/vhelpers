import{Q as L}from"./QPage.cf9194a7.js";import{aH as M,a as T,u as _,r as i,c as k,p as $,l as C,o as D,d as F,w as G,e as d,a1 as h}from"./index.384925f7.js";import"./QSelect.67045144.js";import{u as R}from"./use-quasar.6f820b66.js";import"./dayjs.min.cbcf888d.js";import"./QList.d72f5b4a.js";import"./QDrawer.ab6b2875.js";import"./QCardSection.38f8c080.js";import"./QCardActions.b66e71e1.js";import"./QCard.95a4d469.js";import"./ClosePopup.1a712208.js";import"./axios.17e30a83.js";import{u as X,m as f}from"./vue3-apexcharts.d76ecc1c.js";import"./_commonjsHelpers.88e99c8f.js";import"./QResizeObserver.b797df0d.js";import"./QScrollObserver.d0a43316.js";const ot={__name:"daily",setup(B){const x=R(),r=X();M(),T(),_();const v=i({}),A=i([]),g=i({}),b=i([]),m=i(null),y=i({}),O=i([]),u=i(null),S=k(()=>x.platform.is.mobile),n=k(()=>u.value==null?r.stores:r.stores.filter(t=>t.sucursal.id==u.value.sucursal.id)),w=()=>{v.value={chart:{id:"stores",background:"none",toolbar:{show:!1},events:{dataPointSelection(t,s,{dataPointIndex:e}){e===m.value?(m.value=null,u.value=null,p(),c()):(m.value=e,u.value=r.stores[e],p(),c(),console.log(n.value))}}},tooltip:{y:{formatter:t=>"$"+t.toLocaleString("es-MX")}},xaxis:{categories:r.stores.map(t=>S.value?t.sucursal.alias:t.sucursal.name),labels:{show:!1}},plotOptions:{bar:{horizontal:!0,columnWidth:"100%",barHeight:"90%"}},dataLabels:{formatter:t=>"$ "+t.toLocaleString("es-MX"),style:{colors:["#333"]}}},A.value=[{name:`VENTA ${r.today}`,data:r.stores.map(t=>{var s,e;return((e=(s=t.data)==null?void 0:s.salesAct)==null?void 0:e.total)||0})}]},c=()=>{const t={};n.value.forEach(e=>{e.data.salesAct.desglose.forEach(a=>{t[a.FORMAPAGO]?t[a.FORMAPAGO]+=parseFloat(a.TOTAL):t[a.FORMAPAGO]=parseFloat(a.TOTAL)})});let s=Object.entries(t).map(([e,a])=>({FORMAPAGO:e,TOTAL:a}));console.log(s),y.value={chart:{type:"donut",background:"none",toolbar:{show:!1}},labels:s.map(e=>e.FORMAPAGO),tooltip:{y:{formatter:e=>"$"+e.toLocaleString("es-MX")}},legend:{position:"bottom"}},O.value=s.map(e=>e.TOTAL)},p=()=>{const t=n.value.reduce((o,l)=>o+(l.data.salesAct.total||0),0),s=n.value.reduce((o,l)=>o+(l.data.salesAnt.total||0),0),e=n.value.reduce((o,l)=>o+(l.data.salesAct.tickets||0),0),a=n.value.reduce((o,l)=>o+(l.data.salesAnt.tickets||0),0);g.value={chart:{id:"global",toolbar:{show:!1},background:"transparent"},colors:["#4ECDC4","#556270"],tooltip:{y:{formatter:o=>"$"+o.toLocaleString("es-MX")}},xaxis:{categories:["A\xD1O Anterior","A\xD1O Actual"]},yaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},dataLabels:{formatter:(o,{dataPointIndex:l})=>`${"$ "+o.toLocaleString("es-MX")}
Tcks: ${l===0?a:e}`,style:{colors:["#333"]}}},b.value=[{data:[s,t]}]};return $(()=>{r.stores.length>0?(w(),p(),c()):C(()=>r.stores,t=>{t.length>0&&(w(),p(),c())},{immediate:!0})}),(t,s)=>(D(),F(L,{padding:""},{default:G(()=>[d(h(f),{type:"bar",width:"97%",height:"300px",options:g.value,series:b.value},null,8,["options","series"]),d(h(f),{type:"bar",width:"97%",height:"400px",options:v.value,series:A.value},null,8,["options","series"]),d(h(f),{type:"donut",width:"97%",height:"200x",options:y.value,series:O.value},null,8,["options","series"])]),_:1}))}};export{ot as default};
