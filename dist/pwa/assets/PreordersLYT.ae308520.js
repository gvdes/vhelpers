import{b as k}from"./QList.3b79dd01.js";import{Q as B}from"./QHeader.25a2e894.js";import{aW as D,a as S,u as P,r as R,p as Y,l as $,m as q,aX as L,o as m,d as p,w as n,e as r,a1 as f,f as c,al as y,S as M,a0 as N,Q as b,h as j}from"./index.e6a9205c.js";import{Q as A}from"./QDate.f840cd2b.js";import{Q as H}from"./QCardSection.89aaf3a1.js";import{Q as T}from"./QCardActions.b189b550.js";import{Q as z}from"./QCard.d6d1ca67.js";import{d as E}from"./QSelect.8e7dd0b4.js";import{Q as F}from"./QToolbar.582a09d0.js";import{Q as I,a as W}from"./QLayout.aae819c7.js";import{d as X}from"./dayjs.min.cbcf888d.js";import"./axios.6fa5544b.js";import{o as O}from"./orderApi.c7b0500d.js";import{u as G}from"./OrderStore.e1349cdc.js";import{u as J}from"./use-quasar.4a442d8c.js";import{_ as K}from"./UserToolbar.f695bc07.js";import{$sktOrders as t}from"./socket.1392d064.js";import"./use-key-composition.879881fd.js";import"./QResizeObserver.d08643f2.js";import"./use-render-cache.3aae9b27.js";import"./date.cb4a7552.js";import"./QScrollObserver.06cd418b.js";import"./_commonjsHelpers.88e99c8f.js";import"./QDrawer.fc0d05de.js";import"./use-checkbox.2d7e2161.js";import"./QExpansionItem.7b7ddab1.js";import"./ClosePopup.38dc60cf.js";import"./auth.db233fc4.js";const Z={class:"text-h6"},ke={__name:"PreordersLYT",setup(ee){const h=new Audio("sounds/success01.mp3"),V=D();S();const s=G(),d=J(),i=P();let u=!1;const l=R({from:null,to:null}),_=e=>{switch(e){case 1:case 2:case 6:case 12:case 22:return"admins";case 8:return"sales";case 4:case 24:case 26:case 28:return"supply";default:return"sales"}},g=e=>{console.log(e)},w=e=>{console.log(e)},v=e=>{console.log(e),s.addOrUpdate(e)},Q=e=>{console.log(e),s.addOrUpdate(e),e.order._status==5&&V.path==="/preorders/warehouse"?(console.log("aqui suena"),h.play()):console.log("aqui no suena")},x=async()=>{d.loading.show({message:"Obteniendo datos"});let e=X(new Date).format("YYYY/MM/DD");l.value={from:e,to:e};let o={uid:i.session.credentials.staff.id_va,wid:i.session.store.id_viz,view:_(i.session.credentials._rol),date:l.value};console.log(o);const a=await O.getOrders(o);a.fail?console.log(a):(console.log(a),s.setOrders(a.orders),s.setPrinters(a.prints),s.setUnits(a.units),s.setRules(a.rules),s.setUsers(a.user),s.setProcess(a.process),d.loading.hide())},C=async()=>{d.loading.show({message:"Obteniendo datos"});let e={uid:i.session.credentials.staff.id_va,wid:i.session.store.id_viz,view:_(i.session.credentials._rol),date:l.value};console.log(e);const o=await O.getOrders(e);o.fail?console.log(o):(console.log(o),s.setOrders(o.orders),s.setPrinters(o.prints),s.setUnits(o.units),s.setRules(o.rules),s.setUsers(o.user),s.setProcess(o.process),d.loading.hide())};return Y(()=>{x(),t.on("connect",()=>{!u&&s.socket_user&&(u=!0,t.emit("join",s.socket_user))}),t.connect(),$(()=>s.socket_user,e=>{e&&!u&&t.connected&&(u=!0,t.emit("join",e))},{immediate:!0}),t.on("joinedat",g),t.on("newjoin",w),t.on("order_add",v),t.on("order_update",Q)}),q(()=>{t.off("joinedat",g),t.off("newjoin",w),t.off("order_add",v),t.off("order_update",Q)}),(e,o)=>{const a=L("router-view");return m(),p(I,{view:"hHh Lpr fFf"},{default:n(()=>[r(B,{class:"transparent text-dark",bordered:""},{default:n(()=>[r(K),r(k)]),_:1}),r(W,null,{default:n(()=>[f(s).showLyt?(m(),p(F,{key:0,class:"justify-between"},{default:n(()=>[c("div",null,[o[1]||(o[1]=y("Helpers ")),r(M,{name:"navigate_next",color:"primary"}),o[2]||(o[2]=y()),c("span",Z,N(f(s).title),1)]),f(s).showEvent?(m(),p(b,{key:0,color:"primary",icon:"event",flat:""},{default:n(()=>[r(E,null,{default:n(()=>[r(z,{class:"my-card"},{default:n(()=>[r(H,null,{default:n(()=>[c("div",null,[o[3]||(o[3]=c("div",{class:"q-pb-sm text-center"},null,-1)),r(A,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=U=>l.value=U),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),r(T,{vertical:"",align:"center"},{default:n(()=>[r(b,{flat:"",label:"Obtener",color:"positive",onClick:C})]),_:1})]),_:1})]),_:1})]),_:1})):j("",!0)]),_:1})):j("",!0),r(a)]),_:1})]),_:1})}}};export{ke as default};
