import{E as l}from"./exceljs.min.9e24d01d.js";import"./dayjs.min.cbcf888d.js";const u=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},h=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},d=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>{var t,a;return{C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,UGeneral:(t=o.bodega)==null?void 0:t.map(s=>s.path).join("/"),UExhibicion:(a=o.ventas)==null?void 0:a.map(s=>s.path).join("/")}});const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},g=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>{var t,a;return{C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,UGeneral:(t=o.bodega)==null?void 0:t.map(s=>s.path).join("/"),UExhibicion:(a=o.ventas)==null?void 0:a.map(s=>s.path).join("/")}});const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},v=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},w=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>{var t,a;return{C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,UGeneral:(t=o.bodega)==null?void 0:t.map(s=>s.path).join("/"),UExhibicion:(a=o.ventas)==null?void 0:a.map(s=>s.path).join("/")}});const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},y=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},b=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},x=async(e,c)=>{console.log(e);const n=new l.Workbook,i=n.addWorksheet(e.key);let m=e.value.map(t=>({C\u00F3digo:t.id,Modelo:t.code,Descripci\u00F3n:t.description,Proveedor:t.providers.name,Fabricante:t.makers?t.makers.name:"",Status:t.status.name,Secci\u00F3n:t.category.familia.seccion.name,Familia:t.category.familia.name,Categor\u00EDa:t.category.name,"Piezas x caja":t.pieces,SOTANO:t.stocks.find(a=>a.id==c).pivot.stock,CEDIS:t.stocks.find(a=>a.id==1).pivot.stock,TEXCOCO:t.stocks.find(a=>a.id==2).pivot.stock,Maximo:t.stocks[0].pivot.max,Minimo:t.stocks[0].pivot.min,locations:t.locations.map(a=>a.path).join("/")}));const r=Object.keys(m[0]).map(t=>({name:t,filterButton:!0})),o=m.map(t=>Object.values(t));i.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:r,rows:o}),i.columns.forEach(t=>{let a=0;t.eachCell({includeEmpty:!0},s=>{const p=s.value?s.value.toString().length:10;p>a&&(a=p)}),t.width=a<10?10:a}),await k(n,e.key)},f=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},S=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,Stock:o.stocks[0].pivot.stock,General:o.stocks[0].pivot.gen,Exhibici\u00F3n:o.stocks[0].pivot.exh,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},E=async e=>{console.log(e);const c=new l.Workbook,n=c.addWorksheet(e.key);let i=e.value.map(o=>({C\u00F3digo:o.id,Modelo:o.code,Descripci\u00F3n:o.description,Proveedor:o.providers.name,Fabricante:o.makers?o.makers.name:"",Status:o.status.name,Secci\u00F3n:o.category.familia.seccion.name,Familia:o.category.familia.name,Categor\u00EDa:o.category.name,"Piezas x caja":o.pieces,CEDIS:o.stocks.find(t=>t.id==1).pivot.stock,TEXCOCO:o.stocks.find(t=>t.id==2).pivot.stock,Maximo:o.stocks[0].pivot.max,Minimo:o.stocks[0].pivot.min,locations:o.locations.map(t=>t.path).join("/")}));const m=Object.keys(i[0]).map(o=>({name:o,filterButton:!0})),r=i.map(o=>Object.values(o));n.addTable({name:`${e.key}`,ref:"A1",headerRow:!0,style:{showRowStripes:!0},columns:m,rows:r}),n.columns.forEach(o=>{let t=0;o.eachCell({includeEmpty:!0},a=>{const s=a.value?a.value.toString().length:10;s>t&&(t=s)}),o.width=t<10?10:t}),await k(c,e.key)},k=async(e,c)=>{try{const n=await e.xlsx.writeBuffer(),i=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),m=URL.createObjectURL(i),r=document.createElement("a");r.href=m,r.download=`${c}.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(n){console.error("Error al escribir el buffer:",n)}};var M={catalogo:u,conStock:h,conStockUbicados:d,conStockSinUbicar:g,sinStock:v,sinStockUbicados:w,sinMaximos:y,generalVsExhibicion:b,generalVsCedis:x,conMaximos:f,negativos:S,cedisStock:E};export{M as r};
