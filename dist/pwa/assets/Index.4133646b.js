import{Q as b}from"./QSeparator.970ad44f.js";import{r as f,c as U,o as _,g as y,e,w as a,a1 as C,u as L,i as c,a3 as o,Y as T,Q as v,a0 as Y,f as V,a as D,a2 as E,a4 as u,a6 as M}from"./index.d6535de1.js";import{Q as j}from"./QDate.502a4650.js";import{b as q,Q as F}from"./QSelect.6babb7a7.js";import{Q as H}from"./QHeader.d986479a.js";import{Q as k,a as n}from"./QItemSection.db0401dc.js";import{Q as O}from"./QList.bed8137d.js";import{Q as P}from"./QPage.4498dc94.js";import{Q as W,a as w}from"./QCard.eab9b540.js";import{Q as z}from"./QInput.ae6dc5c4.js";import{Q as G}from"./QCardActions.60a5f8a8.js";import{Q as J}from"./QDialog.5e34c3f3.js";import{u as K}from"./VDB.6b3d0108.js";import{u as X}from"./use-quasar.505fcb9f.js";import"./jspdf.plugin.autotable.c08a6e5a.js";import{o as h}from"./outputsApi.8b92d922.js";import"./exceljs.min.9e24d01d.js";import"./browser.94c942de.js";import{d as Z}from"./dayjs.min.25545ff6.js";import{_ as ee}from"./UserToolbar.19b8884d.js";import"./use-cache.b0833c75.js";import"./use-key-composition.3e547522.js";import"./uid.42677368.js";import"./date.90c38258.js";import"./position-engine.3b6f86a4.js";import"./rtl.b51694b1.js";import"./QResizeObserver.36001cf2.js";import"./_commonjsHelpers.88e99c8f.js";import"./axios.d0e8637f.js";import"./axios.f1f32898.js";import"./ClosePopup.1d106147.js";const ae={class:"row justify-between"},te=c("span",{class:"text-h6"},"Salidas Internas",-1),se={class:"q-pa-md"},oe=c("div",{class:"q-pb-sm"},null,-1),le={class:"flex justify-center"},Ye={__name:"Index",setup(ne){const g=L(),d=K(),i=X(),m=f(!1),p=f(null),x=f([]),Q=f([]),r=f({warehouse:null,notes:null}),S=U(()=>d.session.rol!=="alm"?Q.value.filter(l=>[1,2,3,4].includes(l.id)):Q.value.filter(l=>[5,6].includes(l.id))),A=async()=>{console.log("Recibiendo Datos :)"),i.loading.show({message:"Obteniendo Datos"});let l=d.session.store.id;const s=await h.index(l);s.error?console.log(s):(console.log(s),x.value=s.output,Q.value=s.warehouses,i.loading.hide())},N=async()=>{console.log(p.value),i.loading.show({message:"Obteniendo Datos"});let s={store:d.session.store.id,date:p.value};console.log("Recibiendo Datos :)");const t=await h.getDate(s);t.fail?console.log(t):(console.log(t),x.value=t,i.loading.hide(),p.value=null)},I=async()=>{i.loading.show({message:"Creando Traspaso"}),r.value.created_by=d.session.name,r.value._store=d.session.store.id,console.log(r.value);const l=await h.addOuts(r.value);console.log(l),l.error?(console.log(l),i.notify({message:"No se logro crear el traspaso",position:"center",type:"negative"})):(i.loading.hide(),i.notify({message:`Salida ${l.code_fs} creada`,position:"center",type:"positive"}),g.push(`/outputs/${l.id}`))},R=()=>{m.value=!1,r.value={warehouse:null,notes:null}},$=l=>{g.push(`/outputs/${l.id}`)};return d.session.rol=="root"||d.session.rol=="aud"?A():(i.notify({message:"No tienes acceso a esta pagina",type:"negative",position:"center"}),g.replace("/")),(l,s)=>(_(),y(C,null,[e(P,{padding:""},{default:a(()=>[e(H,{class:"transparent text-dark",bordered:""},{default:a(()=>[e(ee),e(b),c("div",ae,[c("div",null,[o("Helpers "),e(T,{name:"navigate_next",color:"primary"}),o(),te]),c("div",null,[e(v,{color:"primary",icon:"add",flat:"",onClick:s[0]||(s[0]=t=>m.value=!m.value),round:""}),e(v,{color:"primary",icon:"event",flat:"",round:""},{default:a(()=>[e(q,null,{default:a(()=>[c("div",se,[oe,e(j,{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=t=>p.value=t),range:"",minimal:""},null,8,["modelValue"])]),c("div",le,[e(v,{flat:"",label:"Obtener",color:"positive",onClick:N})])]),_:1})]),_:1})])]),e(b)]),_:1}),e(O,null,{default:a(()=>[e(k,null,{default:a(()=>[e(n,{class:"text-center"},{default:a(()=>[o("ID")]),_:1}),e(n,{class:"text-center"},{default:a(()=>[o("CREADO")]),_:1}),e(n,{class:"text-center"},{default:a(()=>[o("CREADO POR")]),_:1}),e(n,{class:"text-center"},{default:a(()=>[o("NOTAS")]),_:1}),e(n,{class:"text-center"},{default:a(()=>[o("ALMACEN")]),_:1}),e(n,{class:"text-center"},{default:a(()=>[o("FACTUSOL")]),_:1}),e(n,{class:"text-center"},{default:a(()=>[o("ARTICULOS")]),_:1})]),_:1})]),_:1}),e(b,{spaced:"",inset:"",vertical:"",dark:""}),(_(!0),y(C,null,Y(x.value,(t,B)=>(_(),D(O,{bordered:"",key:B},{default:a(()=>[E((_(),D(k,{clickable:"",onClick:re=>$(t)},{default:a(()=>[e(n,{class:"text-center"},{default:a(()=>[o(u(t.id),1)]),_:2},1024),e(n,{class:"text-center"},{default:a(()=>[o(u(V(Z)(t.created_at).format("YYYY-MM-D")),1)]),_:2},1024),e(n,{class:"text-center"},{default:a(()=>[o(u(t.created_by),1)]),_:2},1024),e(n,{class:"text-center"},{default:a(()=>[o(u(t.notes),1)]),_:2},1024),e(n,{class:"text-center"},{default:a(()=>[o(u(t.warehouse.alias),1)]),_:2},1024),e(n,{class:"text-center"},{default:a(()=>[o(u(t.code_fs),1)]),_:2},1024),e(n,{class:"text-center"},{default:a(()=>[o(u(t.bodie.length),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[M]])]),_:2},1024))),128))]),_:1}),e(J,{modelValue:m.value,"onUpdate:modelValue":s[4]||(s[4]=t=>m.value=t),persistent:""},{default:a(()=>[e(W,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(w,{class:"text-h5 text-bold text-center"},{default:a(()=>[o(" Nueva Salida ")]),_:1}),e(w,{class:"row items-center"},{default:a(()=>[e(F,{modelValue:r.value.warehouse,"onUpdate:modelValue":s[2]||(s[2]=t=>r.value.warehouse=t),options:V(S),label:"Almacen Origen",class:"col","option-label":"name"},null,8,["modelValue","options"])]),_:1}),e(w,null,{default:a(()=>[e(z,{modelValue:r.value.notes,"onUpdate:modelValue":s[3]||(s[3]=t=>r.value.notes=t),type:"text",label:"Notas"},null,8,["modelValue"])]),_:1}),e(G,{align:"center"},{default:a(()=>[e(v,{flat:"",label:"Cancelar",color:"negative",onClick:R}),e(v,{flat:"",label:"Crear",color:"positive",onClick:I,disable:!r.value.warehouse||!r.value.notes},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{Ye as default};
