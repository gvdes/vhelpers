import{b as Q,Q as y}from"./QList.b9334b06.js";import{Q as F}from"./QHeader.aab1aaaf.js";import{aW as B,a as I,u as O,r as m,c as A,aX as P,o as k,d as E,w as t,e as l,f as r,S as g,Q as v,h as M}from"./index.722c96ba.js";import{Q as R}from"./QSelect.c275295e.js";import{Q as S}from"./QToolbar.d5567cb6.js";import{Q as H}from"./QInput.905c375d.js";import{Q as D}from"./QTable.f0e964fd.js";import{Q as L}from"./QDate.73a79d5b.js";import{Q as T}from"./QCardSection.2772bee0.js";import{Q as N}from"./QCardActions.acc2993a.js";import{Q as U}from"./QCard.3248d843.js";import{Q as $,a as j}from"./QLayout.6aaa4ec7.js";import"./auto.6eac3d5d.js";import{u as G}from"./use-quasar.70cae317.js";import{d as Y}from"./dayjs.min.cbcf888d.js";import{E as q}from"./exceljs.min.9e24d01d.js";import"./jspdf.plugin.autotable.8b63eb13.js";import{_ as K}from"./UserToolbar.78c1fb01.js";import{A as W}from"./assistApi.6c745f4d.js";import{b as J}from"./axios.511d92c0.js";import"./use-key-composition.4dbf594e.js";import"./QResizeObserver.36318aa8.js";import"./format.8ac60962.js";import"./QLinearProgress.9441f2d2.js";import"./QCheckbox.ddce8d62.js";import"./use-checkbox.eaa0af27.js";import"./use-render-cache.3aae9b27.js";import"./date.7a87d444.js";import"./QScrollObserver.1037fb2d.js";import"./_commonjsHelpers.88e99c8f.js";import"./QDrawer.66399704.js";import"./QExpansionItem.73a1f451.js";import"./ClosePopup.fcc85c1b.js";import"./auth.b38f42a4.js";const X={class:"col"},z={class:"col"},Z={class:"row"},ee={class:"row"},oe={class:"col"},le={class:"q-pa-md"},He={__name:"BoxesReport",setup(ae){const i=G();B(),I(),O();const u=m(!1),p=m(null),d=m({opts:[],val:null}),c=m({columns:[{name:"cash",label:"CAJA",field:o=>o.TERMINAL,align:"left",sortable:!0},{name:"ticket",label:"TICKET",field:o=>o.TICKET,align:"left",sortable:!0},{name:"cliet",label:"CLIENTE",field:o=>o.CLIENTE,align:"left",sortable:!0},{name:"date",label:"FECHA",field:o=>o.FECHA,align:"left",sortable:!0},{name:"hour",label:"HORA",field:o=>o.HORA,align:"left",sortable:!0},{name:"fop",label:"FORMA DE PAGO",field:o=>o.FORMA_PAGO,align:"left",sortable:!0},{name:"import",label:"IMPORTE",field:o=>parseFloat(o.IMPORTE),align:"left",sortable:!0}],pagination:{rowsPerPage:20},filter:""}),C=m([]),n=m({val:null,opts:[]});A(()=>i.platform.is.mobile);const b=A(()=>C.value.filter(o=>n.value.val?o.FORMA_PAGO==n.value.val.DESFPA:o)),V=async()=>{i.loading.show({message:"Cargando Informacion"}),console.log("se inicia el init");const o=await W.index();if(!o.error){console.log(o),d.value.opts=o;let e=new Date,s=Y(e).format("YYYY/MM/DD");p.value=s,console.log(s),i.loading.hide()}},w=async()=>{console.log(d.value.val.ip_address),i.loading.show({message:"Obteniendo Registros"}),console.log(p.value);let e=`http://${d.value.val.ip_address}/access/public/reports/getCashCob`;const s=await J.post(e,{filt:p.value});s.status!=200?console.log(s):(console.log(s.data),C.value=s.data.formaspagos,n.value.opts=s.data.formas,u.value=!1,i.loading.hide())};V();const _=()=>{i.loading.show({message:"Importando Ticket"});const o=new q.Workbook;o.addWorksheet("Venta").addTable({name:"Venta",ref:"A1",headerRow:!0,totalsRow:!0,style:{showRowStripes:!0},columns:[{name:"Terminal",filterButton:!0},{name:"Tickets",filterButton:!0},{name:"Cliente",filterButton:!0},{name:"Fecha",filterButton:!0},{name:"Hora",filterButton:!0},{name:"Forma de Pago",filterButton:!0},{name:"Importe",filterButton:!0,totalsRowFunction:"sum"}],rows:b.value.map(a=>[a.TERMINAL,a.TICKET,a.CLIENTE,a.FECHA,a.HORA,a.FORMA_PAGO,parseFloat(a.IMPORTE)])}),(async()=>{const a=await o.xlsx.writeBuffer(),h=new Blob([a],{type:"application/octet-stream"}),x=URL.createObjectURL(h),f=document.createElement("a");f.href=x,f.download="ReporteCajas.xlsx",document.body.appendChild(f),f.click(),document.body.removeChild(f)})(),i.loading.hide()};return(o,e)=>{const s=P("router-view");return k(),E($,{view:"hHh Lpr fFf"},{default:t(()=>[l(j,null,{default:t(()=>[l(F,{class:"bg-grey-3 text-dark",bordered:""},{default:t(()=>[l(K),l(Q)]),_:1}),l(S,{class:"justify-between row"},{default:t(()=>[r("div",X,[e[8]||(e[8]=r("span",{class:"text-grey"},"Helpers",-1)),l(g,{name:"navigate_next",color:"primary"}),e[9]||(e[9]=r("span",{class:"text-h6"},"Cajas Abiertas",-1))]),r("div",z,[r("div",Z,[e[10]||(e[10]=r("div",{class:"col"},null,-1)),l(v,{color:"primary",icon:"event",onClick:e[0]||(e[0]=a=>u.value=!u.value),flat:"",round:"",disable:!d.value.val},null,8,["disable"]),l(v,{color:"primary",icon:"download",onClick:_,flat:"",round:"",disable:b.value.length<=0},null,8,["disable"]),l(R,{class:"col",modelValue:d.value.val,"onUpdate:modelValue":[e[1]||(e[1]=a=>d.value.val=a),w],options:d.value.opts,label:"Sucursales",filled:"","option-label":"name",dense:""},null,8,["modelValue","options"])])])]),_:1}),l(D,{title:"Tickets",rows:b.value,pagination:c.value.pagination,filter:c.value.filter,columns:c.value.columns},{"top-right":t(()=>[r("div",ee,[r("div",oe,[l(H,{borderless:"",dense:"",debounce:"300",modelValue:c.value.filter,"onUpdate:modelValue":e[2]||(e[2]=a=>c.value.filter=a),placeholder:"Buscar"},{append:t(()=>[l(g,{name:"search"})]),_:1},8,["modelValue"])]),l(Q,{spaced:"",inset:"",vertical:"",dark:""}),l(R,{class:"col",modelValue:n.value.val,"onUpdate:modelValue":e[4]||(e[4]=a=>n.value.val=a),options:n.value.opts,label:"Formas de pago",filled:"","option-label":"DESFPA",dense:""},{append:t(()=>[n.value.val?(k(),E(g,{key:0,name:"close",onClick:e[3]||(e[3]=a=>n.value.val=null)})):M("",!0)]),_:1},8,["modelValue","options"])])]),_:1},8,["rows","pagination","filter","columns"]),l(y,{modelValue:u.value,"onUpdate:modelValue":e[7]||(e[7]=a=>u.value=a)},{default:t(()=>[l(U,{class:"my-card"},{default:t(()=>[l(T,null,{default:t(()=>[r("div",le,[e[11]||(e[11]=r("div",{class:"q-pb-sm"},null,-1)),l(L,{modelValue:p.value,"onUpdate:modelValue":e[5]||(e[5]=a=>p.value=a),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),l(T,null,{default:t(()=>[l(N,{align:"right"},{default:t(()=>[l(v,{flat:"",icon:"close",color:"negative",onClick:e[6]||(e[6]=a=>u.value=!u.value)}),l(v,{flat:"",icon:"check",color:"positive",onClick:w})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(s)]),_:1})]),_:1})}}};export{He as default};
