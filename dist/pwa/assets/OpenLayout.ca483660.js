import{Q}from"./QSeparator.a28f9e19.js";import{r as v,c as S,o as c,a as A,w as o,e as a,f as r,a3 as k,Y as B,g as f,h as y,Q as T}from"./index.bfaa50dc.js";import{Q as O}from"./QToolbar.daa7f3b6.js";import{Q as P}from"./QHeader.2fb0ba53.js";import{Q as $,a as u}from"./QCard.15518d82.js";import{Q as _}from"./QSelect.99ec8f2d.js";import{Q as i}from"./QInput.c6efea11.js";import{Q as I}from"./QUploader.e70ee609.js";import{Q as L}from"./QForm.22bca63e.js";import{Q as F}from"./QPage.2eb80b0c.js";import{Q as H,a as J}from"./QLayout.29e9b2b2.js";import{u as Y}from"./VDB.fcbc5d96.js";import{_ as z}from"./UserToolbar.fb76eb12.js";import{a as b}from"./axios.2f5f6197.js";import{a as G}from"./axios.9ab26c22.js";import{u as K}from"./use-quasar.ee0b50fe.js";import"./QItemSection.8b803668.js";import"./QSlideTransition.3e13568a.js";import"./QList.0bc6d8ca.js";import"./QTable.63f8d1bb.js";import"./QDate.ec7af91d.js";import"./QCardActions.45905821.js";import"./QDialog.7fcf9d67.js";import"./AppFullscreen.bc284e05.js";import"./auto.38810c21.js";import"./dayjs.min.cbcf888d.js";import"./exceljs.min.9e24d01d.js";import"./jspdf.plugin.autotable.41d6e634.js";import"./QResizeObserver.20d0d4a3.js";import"./use-key-composition.80587ab3.js";import"./uid.937d8ee7.js";import"./position-engine.70345e34.js";import"./rtl.276c3f1b.js";import"./ClosePopup.d49d3a1a.js";import"./QLinearProgress.331664d1.js";import"./QCheckbox.d7c1709b.js";import"./use-render-cache.3aae9b27.js";import"./date.7fa7ea55.js";import"./_commonjsHelpers.88e99c8f.js";var g={index(d){return b.get(`/cashier/getStaff/${d}`).then(n=>n.data).catch(n=>({fail:n}))},opening(d){return b.post("/cashier/Opening",d).then(n=>n.data).catch(n=>({fail:n}))},getPrinters(d){return b.get(`/cashier/getPrinters/${d}`).then(n=>n.data).catch(n=>({fail:n}))}};const W={class:"flex justify-center"},X={key:0},Z={key:1},ee={key:2},le={key:0},ae={class:"col flex justify-center"},Ie={__name:"OpenLayout",setup(d){const n=Y(),p=K(),V=v(null),h=v({val:null,opts:[]}),E=[{id:1,label:"Descuadre"},{id:2,label:"Mal Devolucion"},{id:3,label:"Retirada Mal"}],U=[{id:1,label:"Eliminar"},{id:2,label:"Modificar"}],w=v({val:null,opts:null}),m=v({val:null,opts:[]}),e=v({_store:null,cash:null,_created_by:null,_cashier:null,_type:{id:0,label:"Ninguno"},unsquare:null,mismatch_reason:null,current_cut:null,ticket:null,refund_ticket:null,refund_reason:null,withdrawal_number:null,movement_type_id:{id:0,label:"Ninguno"},reason_modify:null,withdrawal_mount:null}),q=S(()=>e.value._type.id==1&&e.value.cash&&e.value._cashier&&e.value.unsquare&&e.value.mismatch_reason&&e.value.current_cut||e.value._type.id==2&&e.value.cash&&e.value._cashier&&e.value.ticket&&e.value.refund_reason&&e.value.current_cut?!1:!(e.value._type.id==3&&e.value.cash&&e.value._cashier&&e.value.current_cut&&e.value.withdrawal_number&&e.value.movement_type_id.id!=0&&e.value.reason_modify)),x=async()=>{let s=n.session.store.id;const l=await g.index(s);l.fail?console.log(l):(w.value.opts=l,M())},C=async()=>{let l=`http://${n.session.store.ip_address}/access/public/modify/getCash`;const t=await G.get(l);t.status==200?(console.log(t.data),h.value.opts=t.data):console.log(t)},D=()=>{p.notify({message:"No se acepta este archivo",type:"negative",position:"center"})},N=s=>{e.value.current_cut=s[0]},M=async()=>{let s=n.session.store.id;console.log(s);const l=await g.getPrinters(s);l.fail?console.log(l):(m.value.opts=l,console.log("Impresoras listas :)"))},R=async()=>{p.loading.show({message:"Enviando Datos"});let s=e.value._type.id;e.value._store=n.session.store.id,e.value._created_by=n.session.id;const l=new FormData;l.append("_store",e.value._store),l.append("cash",e.value.cash.CODTER),l.append("cash_name",e.value.cash.DESTER),l.append("_created_by",e.value._created_by),l.append("_cashier",e.value._cashier.id),l.append("_type",e.value._type.id),l.append("current_cut",e.value.current_cut),s==1?(l.append("unsquare",e.value.unsquare),l.append("mismatch_reason",e.value.mismatch_reason)):s==2?(l.append("ticket",e.value.ticket),l.append("refund_ticket",e.value.refund_ticket),l.append("refund_reason",e.value.refund_reason)):s==3&&(l.append("withdrawal_number",e.value.withdrawal_number),l.append("movement_type_id",e.value.movement_type_id.id),l.append("reason_modify",e.value.reason_modify),l.append("print",m.value.val.ip_address),e.value.movement_type_id.id==2&&l.append("withdrawal_mount",e.value.withdrawal_mount));const t=await g.opening(l);t.fail?(console.log(t),p.notify({type:"negative",message:t.fail.data,position:"center"})):(console.log(t),p.notify({type:"positive",message:t,position:"center"}),p.loading.hide(),j())},j=()=>{e.value={_store:null,cash:null,_created_by:null,_cashier:null,_type:{id:0,label:"Ninguno"},unsquare:null,mismatch_reason:null,current_cut:null,ticket:null,refund_ticket:null,refund_reason:null,withdrawal_number:null,movement_type_id:{id:0,label:"Ninguno"},reason_modify:null,withdrawal_mount:null},V.value.reset(),m.value.val=null};return n.session.rol=="aux"||n.session.rol=="gen"||n.session.rol=="aud"||n.session.rol=="root"?x():(p.notify({message:"No tienes acceso a esta pagina",type:"negative",position:"center"}),$router.replace("/")),x(),C(),(s,l)=>(c(),A(H,{view:"hHh Lpr fFf"},{default:o(()=>[a(P,{class:"transparent text-dark",bordered:""},{default:o(()=>[a(z),a(Q),a(O,{class:"justify-between"},{default:o(()=>[r("div",null,[l[13]||(l[13]=k("Helpers ")),a(B,{name:"navigate_next",color:"primary"}),l[14]||(l[14]=k()),l[15]||(l[15]=r("span",{class:"text-h6"},"Apertura de Cajas",-1))])]),_:1})]),_:1}),a(Q,{spaced:"",inset:"",vertical:"",dark:""}),a(J,null,{default:o(()=>[a(F,null,{default:o(()=>[r("div",W,[a(L,{class:"q-gutter-md",onSubmit:R},{default:o(()=>[a($,{class:"my-card",square:"",bordere:""},{default:o(()=>[a(u,null,{default:o(()=>l[16]||(l[16]=[r("div",{class:"text-h4 text-center"},"APERTURA DE CAJA",-1),r("div",{class:"text-subtitle2 text-center"},"Movimientos en cajas despues de el corte",-1),r("div",{class:"text-center text-bold text-subtitle2 text-red"},"Recuerda que se tienen que guardar los cortes anteriores",-1)])),_:1}),a(u,null,{default:o(()=>[a(_,{modelValue:e.value.cash,"onUpdate:modelValue":l[0]||(l[0]=t=>e.value.cash=t),options:h.value.opts,label:"Caja","option-label":"DESTER","option-value":"CODTER",outlined:"",dense:""},null,8,["modelValue","options"])]),_:1}),a(u,null,{default:o(()=>[a(_,{modelValue:e.value._cashier,"onUpdate:modelValue":l[1]||(l[1]=t=>e.value._cashier=t),options:w.value.opts,label:"Cajero","option-label":"complete_name",outlined:"",dense:""},null,8,["modelValue","options"])]),_:1}),a(u,null,{default:o(()=>[a(_,{modelValue:e.value._type,"onUpdate:modelValue":l[2]||(l[2]=t=>e.value._type=t),options:E,label:"Motivo",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),e.value._type.label=="Descuadre"?(c(),f("div",X,[a(u,null,{default:o(()=>[a(i,{modelValue:e.value.unsquare,"onUpdate:modelValue":l[3]||(l[3]=t=>e.value.unsquare=t),type:"Number",label:"Monto de descuadre",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),a(u,null,{default:o(()=>[a(i,{modelValue:e.value.mismatch_reason,"onUpdate:modelValue":l[4]||(l[4]=t=>e.value.mismatch_reason=t),type:"text",label:"Motivo de descuadre",outlined:"",dense:""},null,8,["modelValue"])]),_:1})])):y("",!0),e.value._type.label=="Mal Devolucion"?(c(),f("div",Z,[a(u,null,{default:o(()=>[a(i,{modelValue:e.value.ticket,"onUpdate:modelValue":l[5]||(l[5]=t=>e.value.ticket=t),type:"text",label:"Cual es el numero de ticket original",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),a(u,null,{default:o(()=>[a(i,{modelValue:e.value.refund_ticket,"onUpdate:modelValue":l[6]||(l[6]=t=>e.value.refund_ticket=t),type:"text",label:"Cual es el numero de devolucion original",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),a(u,null,{default:o(()=>[a(i,{modelValue:e.value.refund_reason,"onUpdate:modelValue":l[7]||(l[7]=t=>e.value.refund_reason=t),type:"text",label:"Especifica por que se creara una devolucion nueva",outlined:"",dense:""},null,8,["modelValue"])]),_:1})])):y("",!0),e.value._type.label=="Retirada Mal"?(c(),f("div",ee,[a(u,null,{default:o(()=>[a(i,{modelValue:e.value.withdrawal_number,"onUpdate:modelValue":l[8]||(l[8]=t=>e.value.withdrawal_number=t),type:"Number",label:"Numero de retirada",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),a(u,null,{default:o(()=>[a(_,{modelValue:e.value.movement_type_id,"onUpdate:modelValue":l[9]||(l[9]=t=>e.value.movement_type_id=t),options:U,label:"Que se la hara?",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),e.value.movement_type_id.label=="Modificar"?(c(),f("div",le,[a(u,null,{default:o(()=>[a(i,{modelValue:e.value.withdrawal_mount,"onUpdate:modelValue":l[10]||(l[10]=t=>e.value.withdrawal_mount=t),type:"Number",label:"Monto a modificar",outlined:"",dense:""},null,8,["modelValue"])]),_:1})])):y("",!0),a(u,null,{default:o(()=>[a(i,{modelValue:e.value.reason_modify,"onUpdate:modelValue":l[11]||(l[11]=t=>e.value.reason_modify=t),type:"text",label:"Especifica por que el cambio de la retirada",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),a(u,null,{default:o(()=>[a(_,{modelValue:m.value.val,"onUpdate:modelValue":l[12]||(l[12]=t=>m.value.val=t),options:m.value.opts,label:"Impresora","option-label":"name",outlined:"",dense:""},null,8,["modelValue","options"])]),_:1})])):y("",!0),a(u,null,{default:o(()=>[r("div",ae,[a(I,{"hide-upload-btn":"",style:{height:"auto",width:"100%"},label:"Evidencia",accept:"image/*",ref_key:"reference",ref:V,onAdded:N,"field-name":"file",flat:"",onRejected:D},null,512)])]),_:1})]),_:1}),r("div",null,[a(T,{label:"Enviar",type:"submit",color:"primary",class:"full-width",disable:q.value},null,8,["disable"])])]),_:1})])]),_:1})]),_:1})]),_:1}))}};export{Ie as default};
