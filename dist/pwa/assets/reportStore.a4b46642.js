import{W as y,u as $,r as f,o as g,d as T,w as n,g as b,_ as w,e as o,a1 as D,j as p,h as F,ae as G,i as B,$ as P,a0 as Y,aV as j,aW as H,Q as W,f as S,a2 as q,a3 as M,Y as z}from"./index.05780af2.js";import{Q as N}from"./QSelect.3cfe8482.js";import{Q as R}from"./QTd.11568bef.js";import{Q as O}from"./QTr.aac61035.js";import{Q as L}from"./QTable.75c520e2.js";import{Q as J}from"./QDate.cedbc1ba.js";import{Q as K}from"./QPage.fa21fb6b.js";import{u as X}from"./use-quasar.8c58ebcf.js";import{u as Z}from"./Restock.45637bd3.js";import{d as ee}from"./dayjs.min.cbcf888d.js";import{E as ae}from"./exceljs.min.9e24d01d.js";import{R as k}from"./RestockApi.b2c1fc8d.js";import"./QList.f18c3160.js";import"./QLinearProgress.6a044d08.js";import"./use-render-cache.3aae9b27.js";import"./date.d378a12b.js";import"./QToolbar.23f3164d.js";import"./QForm.263861be.js";import"./QPopupEdit.c001cfe2.js";import"./QLayout.5752a4cb.js";import"./QScrollObserver.7bc9a7bb.js";import"./QResizeObserver.34af1731.js";import"./ClosePopup.6ace4e34.js";import"./QExpansionItem.88d53ce4.js";import"./QDrawer.2ceec1d5.js";import"./axios.dbc32149.js";import"./jspdf.plugin.autotable.2185c89a.js";import"./_commonjsHelpers.88e99c8f.js";import"./JsBarcode.cb858474.js";import"./browser.c61f550a.js";/* empty css                                                       */const le={class:"text-center text-h6 text-bold"},oe={class:"row"},te={class:"q-pa-md"},ye={__name:"reportStore",setup(se){const I=X();y();const _=Z(),V=$(),i=f({workpoints:[],cedis:null,val:null}),A=f(!1),s=f({from:null,to:null});f({salidas:null,entradas:null});const C=f([]),d=f({columns:[{name:"partition",label:"Particion",field:a=>a.id,sortable:!0,align:"left"},{name:"status",label:"Estado",field:a=>a.status.name,sortable:!0,align:"left"},{name:"invoice",label:"Salida",field:a=>a.invoice,sortable:!0,align:"left"},{name:"invoiceReceived",label:"Entrada",field:a=>a.invoice_received,sortable:!0,align:"left"},{name:"warehouse",label:"Almacen",field:a=>a._warehouse,sortable:!0,align:"left"}],rows:[],filter:"",loading:!1,columnsSub:[{name:"invoice",label:"Salida",field:a=>a.SALIDA_FACTURA,sortable:!0,align:"left"},{name:"code",label:"Codigo",field:a=>a.CODIGO,sortable:!0,align:"left"},{name:"amount",label:"Cantidad",field:a=>a.CANTIDAD,sortable:!0,align:"left"},{name:"codevalid",label:"CodigoI",field:a=>a.codigoIGUAL,sortable:!0,align:"left"},{name:"amountvalid",label:"CantiI",field:a=>a.CANTIDADIGUAL,sortable:!0,align:"left"},{name:"invoicereceived",label:"Entrada",field:a=>a.ENTRADA_FACTURA,sortable:!0,align:"left"},{name:"codereceived",label:"Codigo",field:a=>a.ENTRADA_CODIGO,sortable:!0,align:"left"},{name:"amountreceived",label:"Cantidad",field:a=>a.ENTRADA_CANTIDAD,sortable:!0,align:"left"}]}),h=async()=>{_.setShowLYT(!1);let a=new Date,e=ee(a).format("YYYY/MM/DD");s.value={from:e,to:e},console.log(e);const l=await k.getStores();l.status==200?(console.log(l.data),i.value.workpoints=l.data,i.value.val=l.data.find(c=>c.id==V.session.store.id),i.value.cedis=l.data.filter(c=>c.id==1)[0],E()):console.log(l)},E=async()=>{d.value.rows=[],d.value.loading=!0,I.loading.show({message:"Obteniendo datos"});let a={cedis:i.value.cedis,sucursal:i.value.val,fechas:s.value};console.log(a);const e=await k.getData(a);console.log(e),e.status==200?(console.log(e.data),C.value=e.data,I.loading.hide(),d.value.loading=!1):alert(e)},U=async()=>{console.log(s.value),A.value=!1,d.value.rows=[],E()},Q=async()=>{const a=new ae.Workbook,e=a.addWorksheet("SALIDASVSENTRADAS"),l=["PARTICION","STATUS","SALIDA","ENTRADA","ALMACEN","SALIDA FACTURA","SALIDAFECHA","REFERENCIA","CODIGO","DESCRIPCION","CANTIDAD","CODIGOIGUAL","CANTIDADIGUAL","PRECIOIGUAL","TOTALIGUAL","ENTRADA FACTURA","ENTRADA SALIDA","ENTRADA FECHA","ENTRADA CODIGO","ENTRADA DESCRIPCION","ENTRADA CANTIDAD"];e.addRow(l),e.getColumn(1).width=15,C.value.forEach(r=>{const m=r.comparaciones,v=e.lastRow.number+1;m.forEach(t=>{e.addRow([r.id,r.status.name,r.invoice,r.invoice_received,r._warehouse,t.SALIDA_FACTURA,t.SALIDA_FECHA,t.REFERENCIA,t.CODIGO,t.DESCRIPCION,t.CANTIDAD,t.codigoIGUAL?"VERDADERO":"FALSO",t.CANTIDADIGUAL?"VERDADERO":"FALSO",t.PRECIOIGUAL?"VERDADERO":"FALSO",t.TOTALIGUAL?"VERDADERO":"FALSO",t.ENTRADA_FACTURA,t.ENTRADA_SALIDA,t.ENTRADA_FECHA,t.ENTRADA_CODIGO,t.ENTRADA_DESCRIPCION,t.ENTRADA_CANTIDAD])});const u=e.lastRow.number;["A","B","C","D","E"].forEach(t=>{e.mergeCells(`${t}${v}:${t}${u}`);const x=e.getCell(`${t}${v}`);x.alignment={vertical:"middle",horizontal:"center"}})}),e.columns.forEach(r=>{let m=0;r.eachCell({includeEmpty:!0},v=>{const u=v.value?v.value.toString().length:10;u>m&&(m=u)}),r.width=m<10?10:m}),(async()=>{const r=await a.xlsx.writeBuffer(),m=new Blob([r],{type:"application/octet-stream"}),v=URL.createObjectURL(m),u=document.createElement("a");u.href=v,u.download=`SalidasVSEntradas ${i.value.val.name} ${typeof s.value=="object"?`Del ${s.value.from} a ${s.value.to}`:s.value}.xlsx`,document.body.appendChild(u),u.click(),document.body.removeChild(u)})()};return h(),(a,e)=>(g(),T(K,{padding:""},{default:n(()=>[b("div",le,"Reporte "+w(s.value&&s.value.from?`Del ${s.value.from} a ${s.value.to}`:s.value),1),o(D,{spaced:"",inset:"",vertical:"",dark:""}),b("div",oe,[o(p,{color:"primary",icon:"event",onClick:e[0]||(e[0]=l=>A.value=!A.value),flat:"",rounded:""}),o(D,{spaced:"",inset:"",vertical:"",dark:""}),o(N,{modelValue:i.value.cedis,"onUpdate:modelValue":e[1]||(e[1]=l=>i.value.cedis=l),options:i.value.workpoints,label:"Cedis",class:"col","option-label":"name",disable:!0,outlined:""},null,8,["modelValue","options"]),o(D,{spaced:"",inset:"",vertical:"",dark:""}),o(N,{disable:"",modelValue:i.value.val,"onUpdate:modelValue":[e[2]||(e[2]=l=>i.value.val=l),E],options:i.value.workpoints,label:"Sucursal",class:"col","option-label":"name",outlined:"","option-disable":l=>l.id==1},null,8,["modelValue","options","option-disable"])]),o(D,{spaced:"",inset:"",vertical:"",dark:""}),o(L,{title:"Comparativo",rows:C.value,filter:d.value.filter,loading:d.value.loading,columns:d.value.columns},{"top-right":n(()=>[o(F,{borderless:"",dense:"",debounce:"300",modelValue:d.value.filter,"onUpdate:modelValue":e[3]||(e[3]=l=>d.value.filter=l),placeholder:"Buscar"},{append:n(()=>[o(G,{name:"search"})]),_:1},8,["modelValue"]),o(D,{spaced:"",inset:"",vertical:"",dark:""}),o(p,{color:"primary",icon:"ios_share",onClick:Q,flat:"",disable:C.value.length<=0},null,8,["disable"])]),body:n(l=>[o(O,{props:l},{default:n(()=>[(g(!0),B(Y,null,P(l.cols,c=>(g(),T(R,{key:c.name,props:l},{default:n(()=>[z(w(c.value),1)]),_:2},1032,["props"]))),128)),o(R,null,{default:n(()=>[o(p,{size:"sm",color:"primary",round:"",dense:"",onClick:c=>l.expand=!l.expand,icon:l.expand?"remove":"add"},null,8,["onClick","icon"])]),_:2},1024)]),_:2},1032,["props"]),j(o(O,{props:l},{default:n(()=>[o(R,{colspan:"50%"},{default:n(()=>[o(L,{rows:l.row.comparaciones,columns:d.value.columnsSub},null,8,["rows","columns"])]),_:2},1024)]),_:2},1032,["props"]),[[H,l.expand]])]),_:1},8,["rows","filter","loading","columns"]),o(M,{modelValue:A.value,"onUpdate:modelValue":e[6]||(e[6]=l=>A.value=l)},{default:n(()=>[o(W,{class:"my-card"},{default:n(()=>[o(S,null,{default:n(()=>[b("div",te,[e[7]||(e[7]=b("div",{class:"q-pb-sm"},null,-1)),o(J,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value=l),range:"",minimal:""},null,8,["modelValue"])])]),_:1}),o(S,null,{default:n(()=>[o(q,{align:"right"},{default:n(()=>[o(p,{flat:"",icon:"close",color:"negative",onClick:e[5]||(e[5]=l=>A.value=!A.value)}),o(p,{flat:"",icon:"check",color:"positive",onClick:U})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{ye as default};
